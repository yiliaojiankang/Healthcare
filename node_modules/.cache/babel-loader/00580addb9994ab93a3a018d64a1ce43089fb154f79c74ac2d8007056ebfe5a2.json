{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _excluded = [\"id\", \"style\", \"minZoom\", \"maxZoom\", \"token\", \"mapInstance\", \"plugin\", \"version\"];\nvar _dec, _class;\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/**\n * AMapService\n */\nimport AMapLoader from '@amap/amap-jsapi-loader';\nimport { CoordinateSystem } from '@antv/l7-core';\nimport { DOM, amap2Project } from '@antv/l7-utils';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { injectable } from 'inversify';\nimport 'reflect-metadata';\nimport AMapBaseService from \"../utils/amap/AMapBaseService\";\nimport Viewport from \"./Viewport\";\n// @ts-ignore\nfunction loadStyles(css, doc) {\n  var isMiniAli = typeof my !== 'undefined' && !!my && typeof my.showToast === 'function' && my.isFRM !== true;\n  var isWeChatMiniProgram = typeof wx !== 'undefined' && wx !== null && (typeof wx.request !== 'undefined' || typeof wx.miniProgram !== 'undefined');\n  if (isMiniAli || isWeChatMiniProgram) {\n    return;\n  }\n  if (!doc) doc = document;\n  if (!doc) {\n    return;\n  }\n  var head = doc.head || doc.getElementsByTagName('head')[0];\n  if (!head) {\n    head = doc.createElement('head');\n    var body = doc.body || doc.getElementsByTagName('body')[0];\n    if (body) {\n      body.parentNode.insertBefore(head, body);\n    } else {\n      doc.documentElement.appendChild(head);\n    }\n  }\n  var style = doc.createElement('style');\n  style.type = 'text/css';\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(doc.createTextNode(css));\n  }\n  head.appendChild(style);\n  return style;\n}\nloadStyles(\".amap-logo{\\n display: none !important;\\n}\\n.amap-copyright {\\n  display: none !important;\\n}\\n\");\nvar DEFAULTMAPCENTER = [108.92361, 34.54083];\n\n// @ts-ignore\nwindow.forceWebGL = true;\nvar AMAP_API_KEY = 'f59bcf249433f8b05caaee19f349b3d7';\n// 'ff533602d57df6f8ab3b0fea226ae52f';\nvar AMAP_VERSION = '2.0';\n\n/**\n * 高德地图脚本是否加载完毕\n */\nvar amapLoaded = false;\n/**\n * 高德地图脚本加载成功等待队列，成功之后依次触发\n */\nvar pendingResolveQueue = [];\n\n/**\n * AMapService\n */\nvar AMapService = (_dec = injectable(), _dec(_class = /*#__PURE__*/function (_AMapBaseService) {\n  _inherits(AMapService, _AMapBaseService);\n  var _super = _createSuper(AMapService);\n  function AMapService() {\n    var _this;\n    _classCallCheck(this, AMapService);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"version\", 'GAODE2.x');\n    /**\n     *\n     * @param e\n     */\n    _defineProperty(_assertThisInitialized(_this), \"handleViewChanged\", function (e) {\n      var _this$map$customCoord = _this.map.customCoords.getCameraParams(),\n        fov = _this$map$customCoord.fov,\n        near = _this$map$customCoord.near,\n        far = _this$map$customCoord.far,\n        aspect = _this$map$customCoord.aspect,\n        position = _this$map$customCoord.position,\n        lookAt = _this$map$customCoord.lookAt,\n        up = _this$map$customCoord.up;\n      // Tip: 统一触发地图变化事件\n      _this.emit('mapchange');\n      // @ts-ignore\n      var center = _this.map.customCoords.getCenter();\n      if (_this.cameraChangedCallback) {\n        // resync viewport\n        _this.viewport.syncWithMapCamera({\n          aspect: aspect,\n          far: far,\n          fov: fov,\n          cameraPosition: position,\n          lookAt: lookAt,\n          up: up,\n          near: near,\n          // AMap 定义的缩放等级 与 Mapbox 相差 1\n          zoom: _this.map.getZoom() - 1,\n          // 与amap1.x对比相差一个级别\n          center: center,\n          offsetOrigin: [position[0], position[1]]\n\n          // @ts-ignore\n          // left, right, bottom, top\n        });\n        // set coordinate system\n        _this.coordinateSystemService.setCoordinateSystem(CoordinateSystem.P20_2);\n        _this.cameraChangedCallback(_this.viewport);\n      }\n    });\n    return _this;\n  }\n  _createClass(AMapService, [{\n    key: \"setCustomCoordCenter\",\n    value:\n    /**\n     * 用于 customCooords 数据的计算\n     */\n    // 一般使用用户数据的第一个\n    // 莫卡托\n\n    /**\n     *   设置数据的绘制中心 高德2.0\n     */\n    function setCustomCoordCenter(center) {\n      this.sceneCenter = center;\n      this.sceneCenterMercator = amap2Project.apply(void 0, _toConsumableArray(center));\n    }\n  }, {\n    key: \"getCustomCoordCenter\",\n    value: function getCustomCoordCenter() {\n      return this.sceneCenterMercator;\n    }\n  }, {\n    key: \"lngLatToCoordByLayer\",\n    value: function lngLatToCoordByLayer(lnglat, layerCenterMercator) {\n      var layerCenterFlat = layerCenterMercator || this.sceneCenterMercator;\n      var coord = this._sub(amap2Project(lnglat[0], lnglat[1]), layerCenterFlat);\n      // Z 参数\n      if (lnglat[2]) {\n        coord.push(lnglat[2]);\n      }\n      return coord;\n    }\n  }, {\n    key: \"coordToAMap2RelativeCoordinates\",\n    value: function coordToAMap2RelativeCoordinates(lnglatArray, layerCenter) {\n      var _this2 = this;\n      var layerCenterMercator = amap2Project(layerCenter[0], layerCenter[1]);\n      if (typeof lnglatArray[0] === 'number') {\n        return this.lngLatToCoordByLayer(lnglatArray, layerCenterMercator);\n      } else {\n        // @ts-ignore\n        return lnglatArray.map(function (lnglats) {\n          if (Array.isArray(lnglats) && typeof lnglats[0] === 'number') {\n            return _this2.lngLatToCoordByLayer(lnglats, layerCenterMercator);\n          } else {\n            // @ts-ignore\n            return lnglats.map(function (lnglat) {\n              return _this2.lngLatToCoordByLayer(lnglat, layerCenterMercator);\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"setCoordCenter\",\n    value: function setCoordCenter(center) {\n      // @ts-ignore\n      this.map.customCoords.setCenter(center || DEFAULTMAPCENTER);\n      this.setCustomCoordCenter(center || DEFAULTMAPCENTER);\n    }\n\n    /**\n     * 根据数据的绘制中心转换经纬度数据 高德2.0\n     */\n  }, {\n    key: \"lngLatToCoord\",\n    value: function lngLatToCoord(lnglat) {\n      // 单点\n      if (!this.sceneCenter) {\n        // @ts-ignore\n        this.map.customCoords.setCenter(lnglat);\n        this.setCustomCoordCenter(lnglat);\n      }\n      return this._sub(amap2Project(lnglat[0], lnglat[1]), this.sceneCenterMercator);\n    }\n\n    /**\n     * 转化线、面类型的点位数据\n     */\n  }, {\n    key: \"lngLatToCoords\",\n    value: function lngLatToCoords(lnglatArray) {\n      var _this3 = this;\n      // @ts-ignore\n      return lnglatArray.map(function (lnglats) {\n        if (typeof lnglats[0] === 'number') {\n          return _this3.lngLatToCoord(lnglats);\n        } else {\n          // @ts-ignore\n          return lnglats.map(function (lnglat) {\n            return _this3.lngLatToCoord(lnglat);\n          });\n        }\n      });\n    }\n  }, {\n    key: \"addMarkerContainer\",\n    value: function addMarkerContainer() {\n      if (!this.map) {\n        return;\n      }\n      var mapContainer = this.map.getContainer();\n      if (mapContainer !== null) {\n        var amap = mapContainer.getElementsByClassName('amap-maps')[0];\n        // amap2 的 amap-maps 新增 z-index=0; 样式，让 marker 中 zIndex 失效\n        amap.style.zIndex = 'auto';\n        this.markerContainer = DOM.create('div', 'l7-marker-container2', amap);\n      }\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    // tslint:disable-next-line:variable-name no-empty\n  }, {\n    key: \"updateView\",\n    value: function updateView(_viewOption) {}\n  }, {\n    key: \"getOverlayContainer\",\n    value: function getOverlayContainer() {\n      return undefined;\n    }\n  }, {\n    key: \"getType\",\n    value: function getType() {\n      return 'amap2';\n    }\n  }, {\n    key: \"getBounds\",\n    value: function getBounds() {\n      var bounds = this.map.getBounds();\n\n      // @ts-ignore\n      var NE = bounds.getNorthEast();\n      // @ts-ignore\n      var SW = bounds.getSouthWest();\n      var center = this.getCenter();\n      var maxlng = center.lng > NE.getLng() || center.lng < SW.getLng() ? 180 - NE.getLng() : NE.getLng();\n      var minlng = center.lng < SW.getLng() ? SW.getLng() - 180 : SW.getLng();\n      // 兼容 Mapbox，统一返回西南、东北\n      return [[minlng, SW.getLat()], [maxlng, NE.getLat()]];\n    }\n  }, {\n    key: \"getMinZoom\",\n    value: function getMinZoom() {\n      // const zooms = this.map.get('zooms') as [number, number];\n      // @ts-ignore\n      var zooms = this.map.getZooms();\n      return zooms[0] - 1;\n    }\n  }, {\n    key: \"getMaxZoom\",\n    value: function getMaxZoom() {\n      // const zooms = this.map.get('zooms') as [number, number];\n      // @ts-ignore\n      var zooms = this.map.getZooms();\n      return zooms[1] - 1;\n    }\n  }, {\n    key: \"lngLatToContainer\",\n    value: function lngLatToContainer(lnglat) {\n      var pixel = this.map.lngLatToContainer(lnglat);\n      return {\n        x: pixel.getX(),\n        y: pixel.getY()\n      };\n    }\n  }, {\n    key: \"lngLatToPixel\",\n    value: function lngLatToPixel(lnglat) {\n      // @ts-ignore\n      var p = this.map.lngLatToPixel(new AMap.LngLat(lnglat[0], lnglat[1]));\n      // lngLatToPixel\n      return {\n        x: p.getX(),\n        y: p.getY()\n      };\n    }\n  }, {\n    key: \"getModelMatrix\",\n    value: function getModelMatrix(lnglat, altitude, rotate) {\n      var scale = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [1, 1, 1];\n      // const flat = this.viewport.projectFlat(lnglat);\n      // @ts-ignore\n      var flat = this.map.customCoords.lngLatToCoord(lnglat);\n      // @ts-ignore\n      var modelMatrix = mat4.create();\n      mat4.translate(modelMatrix, modelMatrix, vec3.fromValues(flat[0], flat[1], altitude));\n      mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(scale[0], scale[1], scale[2]));\n      mat4.rotateX(modelMatrix, modelMatrix, rotate[0]);\n      mat4.rotateY(modelMatrix, modelMatrix, rotate[1]);\n      mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]);\n      return modelMatrix;\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this$config, id, _this$config$style, style, _this$config$minZoom, minZoom, _this$config$maxZoom, maxZoom, _this$config$token, token, mapInstance, _this$config$plugin, plugin, _this$config$version, version, rest, _this$map$customCoord2, mapInitCenter, _this$map$customCoord3, mapConstructorOptions, map, _mapInitCenter;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this$config = this.config, id = _this$config.id, _this$config$style = _this$config.style, style = _this$config$style === void 0 ? 'light' : _this$config$style, _this$config$minZoom = _this$config.minZoom, minZoom = _this$config$minZoom === void 0 ? 0 : _this$config$minZoom, _this$config$maxZoom = _this$config.maxZoom, maxZoom = _this$config$maxZoom === void 0 ? 24 : _this$config$maxZoom, _this$config$token = _this$config.token, token = _this$config$token === void 0 ? AMAP_API_KEY : _this$config$token, mapInstance = _this$config.mapInstance, _this$config$plugin = _this$config.plugin, plugin = _this$config$plugin === void 0 ? [] : _this$config$plugin, _this$config$version = _this$config.version, version = _this$config$version === void 0 ? AMAP_VERSION : _this$config$version, rest = _objectWithoutProperties(_this$config, _excluded);\n              this.viewport = new Viewport();\n              if (window.AMap || mapInstance) {\n                _context.next = 6;\n                break;\n              }\n              plugin.push('Map3D');\n              // if (AMapLoader.status.AMap === 'notload') {\n              _context.next = 6;\n              return AMapLoader.load({\n                key: token,\n                // 申请好的Web端开发者Key，首次调用 load 时必填\n                version: AMAP_VERSION,\n                // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\n                plugins: plugin // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n              });\n\n            case 6:\n              if (mapInstance) {\n                this.map = mapInstance;\n                this.$mapContainer = this.map.getContainer();\n\n                // 在使用 map.customCoords 的时候必须使用\n                mapInitCenter = this.map.getCenter(); // @ts-ignore\n                (_this$map$customCoord2 = this.map.customCoords) === null || _this$map$customCoord2 === void 0 || _this$map$customCoord2.setCenter([\n                // @ts-ignore\n                mapInitCenter.lng,\n                // @ts-ignore\n                mapInitCenter.lat]);\n                // @ts-ignore\n                this.setCustomCoordCenter([mapInitCenter.lng, mapInitCenter.lat]);\n                this.map.on('viewchange', this.handleViewChanged);\n              } else {\n                this.$mapContainer = this.creatMapContainer(id);\n                mapConstructorOptions = _objectSpread({\n                  mapStyle: this.getMapStyleValue(style),\n                  zooms: [minZoom, maxZoom],\n                  viewMode: '3D'\n                }, rest);\n                if (mapConstructorOptions.zoom) {\n                  // 高德地图在相同大小下需要比 MapBox 多一个 zoom 层级\n                  mapConstructorOptions.zoom += 1;\n                }\n                if (token === AMAP_API_KEY) {\n                  // @ts-ignore\n                  window._AMapSecurityConfig = {\n                    securityJsCode: '2653011adeb04230b3a26cc9a780a800'\n                  };\n                  console.warn(\"%c\".concat(this.configService.getSceneWarninfo('MapToken'), \"!\"), 'color: #873bf4;font-weigh:900;font-size: 16px;');\n                }\n                // @ts-ignore\n                map = new AMap.Map(this.$mapContainer, mapConstructorOptions); // @ts-ignore\n                this.map = map;\n                // 在使用 map.customCoords 的时候必须使用\n                _mapInitCenter = map.getCenter(); // @ts-ignore\n                // @ts-ignore\n                (_this$map$customCoord3 = this.map.customCoords) === null || _this$map$customCoord3 === void 0 || _this$map$customCoord3.setCenter([_mapInitCenter.lng, _mapInitCenter.lat]);\n\n                // @ts-ignore\n                this.setCustomCoordCenter([_mapInitCenter.lng, _mapInitCenter.lat]);\n                // 监听地图相机事件\n                map.on('viewchange', this.handleViewChanged);\n              }\n              this.initViewPort();\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function init() {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }, {\n    key: \"getMapContainer\",\n    value: function getMapContainer() {\n      return this.$mapContainer;\n    }\n  }, {\n    key: \"onCameraChanged\",\n    value: function onCameraChanged(callback) {\n      this.cameraChangedCallback = callback;\n    }\n  }, {\n    key: \"initViewPort\",\n    value: function initViewPort() {\n      var _this$map$customCoord4;\n      // @ts-ignore\n      var _ref = ((_this$map$customCoord4 = this.map.customCoords) === null || _this$map$customCoord4 === void 0 ? void 0 : _this$map$customCoord4.getCameraParams()) || {},\n        fov = _ref.fov,\n        near = _ref.near,\n        far = _ref.far,\n        aspect = _ref.aspect,\n        position = _ref.position,\n        lookAt = _ref.lookAt,\n        up = _ref.up;\n      // Tip: 统一触发地图变化事件\n      this.emit('mapchange');\n      // // @ts-ignore\n      // console.log('this.map.customCoords.getCameraParams()', this.map.customCoords.getCameraParams())\n      // const { left, right, bottom, top, near, far, position } = this.map.customCoords.getCameraParams();\n\n      // @ts-ignore\n      var center = this.map.customCoords.getCenter();\n      var zoom = this.map.getZoom();\n      // @ts-ignore\n      if (this.cameraChangedCallback) {\n        this.viewport.syncWithMapCamera({\n          aspect: aspect,\n          far: far,\n          fov: fov,\n          cameraPosition: position,\n          lookAt: lookAt,\n          near: near,\n          up: up,\n          // AMap 定义的缩放等级 与 Mapbox 相差 1\n          zoom: zoom - 1,\n          // 与amap1.x对比相差一个级别\n          center: center,\n          offsetOrigin: [position[0], position[1]]\n\n          // @ts-ignore\n          // left, right, bottom, top\n        });\n        // set coordinate system\n        this.coordinateSystemService.setCoordinateSystem(CoordinateSystem.P20_2);\n        this.cameraChangedCallback(this.viewport);\n      }\n    }\n  }, {\n    key: \"_sub\",\n    value: function _sub(a, b) {\n      var r = [0, 0];\n      r[0] = a[0] - b[0];\n      r[1] = a[1] - b[1];\n      return r;\n    }\n  }]);\n  return AMapService;\n}(AMapBaseService)) || _class);\nexport { AMapService as default };","map":{"version":3,"names":["_objectSpread","_objectWithoutProperties","_asyncToGenerator","_toConsumableArray","_classCallCheck","_createClass","_assertThisInitialized","_inherits","_possibleConstructorReturn","_getPrototypeOf","_defineProperty","_excluded","_dec","_class","_regeneratorRuntime","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","arguments","apply","sham","Proxy","Boolean","prototype","valueOf","call","e","AMapLoader","CoordinateSystem","DOM","amap2Project","mat4","vec3","injectable","AMapBaseService","Viewport","loadStyles","css","doc","isMiniAli","my","showToast","isFRM","isWeChatMiniProgram","wx","request","miniProgram","document","head","getElementsByTagName","createElement","body","parentNode","insertBefore","documentElement","appendChild","style","type","styleSheet","cssText","createTextNode","DEFAULTMAPCENTER","window","forceWebGL","AMAP_API_KEY","AMAP_VERSION","amapLoaded","pendingResolveQueue","AMapService","_AMapBaseService","_super","_this","_len","length","args","Array","_key","concat","_this$map$customCoord","map","customCoords","getCameraParams","fov","near","far","aspect","position","lookAt","up","emit","center","getCenter","cameraChangedCallback","viewport","syncWithMapCamera","cameraPosition","zoom","getZoom","offsetOrigin","coordinateSystemService","setCoordinateSystem","P20_2","key","value","setCustomCoordCenter","sceneCenter","sceneCenterMercator","getCustomCoordCenter","lngLatToCoordByLayer","lnglat","layerCenterMercator","layerCenterFlat","coord","_sub","push","coordToAMap2RelativeCoordinates","lnglatArray","layerCenter","_this2","lnglats","isArray","setCoordCenter","setCenter","lngLatToCoord","lngLatToCoords","_this3","addMarkerContainer","mapContainer","getContainer","amap","getElementsByClassName","zIndex","markerContainer","create","updateView","_viewOption","getOverlayContainer","undefined","getType","getBounds","bounds","NE","getNorthEast","SW","getSouthWest","maxlng","lng","getLng","minlng","getLat","getMinZoom","zooms","getZooms","getMaxZoom","lngLatToContainer","pixel","x","getX","y","getY","lngLatToPixel","p","AMap","LngLat","getModelMatrix","altitude","rotate","scale","flat","modelMatrix","translate","fromValues","rotateX","rotateY","rotateZ","_init","mark","_callee","_this$config","id","_this$config$style","_this$config$minZoom","minZoom","_this$config$maxZoom","maxZoom","_this$config$token","token","mapInstance","_this$config$plugin","plugin","_this$config$version","version","rest","_this$map$customCoord2","mapInitCenter","_this$map$customCoord3","mapConstructorOptions","_mapInitCenter","wrap","_callee$","_context","prev","next","config","load","plugins","$mapContainer","lat","on","handleViewChanged","creatMapContainer","mapStyle","getMapStyleValue","viewMode","_AMapSecurityConfig","securityJsCode","console","warn","configService","getSceneWarninfo","Map","initViewPort","stop","init","getMapContainer","onCameraChanged","callback","_this$map$customCoord4","_ref","a","b","r","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-maps/es/amap2/map.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _excluded = [\"id\", \"style\", \"minZoom\", \"maxZoom\", \"token\", \"mapInstance\", \"plugin\", \"version\"];\nvar _dec, _class;\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/**\n * AMapService\n */\nimport AMapLoader from '@amap/amap-jsapi-loader';\nimport { CoordinateSystem } from '@antv/l7-core';\nimport { DOM, amap2Project } from '@antv/l7-utils';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { injectable } from 'inversify';\nimport 'reflect-metadata';\nimport AMapBaseService from \"../utils/amap/AMapBaseService\";\nimport Viewport from \"./Viewport\";\n// @ts-ignore\nfunction loadStyles(css, doc) {\n  var isMiniAli = typeof my !== 'undefined' && !!my && typeof my.showToast === 'function' && my.isFRM !== true;\n  var isWeChatMiniProgram = typeof wx !== 'undefined' && wx !== null && (typeof wx.request !== 'undefined' || typeof wx.miniProgram !== 'undefined');\n  if (isMiniAli || isWeChatMiniProgram) {\n    return;\n  }\n  if (!doc) doc = document;\n  if (!doc) {\n    return;\n  }\n  var head = doc.head || doc.getElementsByTagName('head')[0];\n  if (!head) {\n    head = doc.createElement('head');\n    var body = doc.body || doc.getElementsByTagName('body')[0];\n    if (body) {\n      body.parentNode.insertBefore(head, body);\n    } else {\n      doc.documentElement.appendChild(head);\n    }\n  }\n  var style = doc.createElement('style');\n  style.type = 'text/css';\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(doc.createTextNode(css));\n  }\n  head.appendChild(style);\n  return style;\n}\nloadStyles(\".amap-logo{\\n display: none !important;\\n}\\n.amap-copyright {\\n  display: none !important;\\n}\\n\");\nvar DEFAULTMAPCENTER = [108.92361, 34.54083];\n\n// @ts-ignore\nwindow.forceWebGL = true;\nvar AMAP_API_KEY = 'f59bcf249433f8b05caaee19f349b3d7';\n// 'ff533602d57df6f8ab3b0fea226ae52f';\nvar AMAP_VERSION = '2.0';\n\n/**\n * 高德地图脚本是否加载完毕\n */\nvar amapLoaded = false;\n/**\n * 高德地图脚本加载成功等待队列，成功之后依次触发\n */\nvar pendingResolveQueue = [];\n\n/**\n * AMapService\n */\nvar AMapService = (_dec = injectable(), _dec(_class = /*#__PURE__*/function (_AMapBaseService) {\n  _inherits(AMapService, _AMapBaseService);\n  var _super = _createSuper(AMapService);\n  function AMapService() {\n    var _this;\n    _classCallCheck(this, AMapService);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"version\", 'GAODE2.x');\n    /**\n     *\n     * @param e\n     */\n    _defineProperty(_assertThisInitialized(_this), \"handleViewChanged\", function (e) {\n      var _this$map$customCoord = _this.map.customCoords.getCameraParams(),\n        fov = _this$map$customCoord.fov,\n        near = _this$map$customCoord.near,\n        far = _this$map$customCoord.far,\n        aspect = _this$map$customCoord.aspect,\n        position = _this$map$customCoord.position,\n        lookAt = _this$map$customCoord.lookAt,\n        up = _this$map$customCoord.up;\n      // Tip: 统一触发地图变化事件\n      _this.emit('mapchange');\n      // @ts-ignore\n      var center = _this.map.customCoords.getCenter();\n      if (_this.cameraChangedCallback) {\n        // resync viewport\n        _this.viewport.syncWithMapCamera({\n          aspect: aspect,\n          far: far,\n          fov: fov,\n          cameraPosition: position,\n          lookAt: lookAt,\n          up: up,\n          near: near,\n          // AMap 定义的缩放等级 与 Mapbox 相差 1\n          zoom: _this.map.getZoom() - 1,\n          // 与amap1.x对比相差一个级别\n          center: center,\n          offsetOrigin: [position[0], position[1]]\n\n          // @ts-ignore\n          // left, right, bottom, top\n        });\n        // set coordinate system\n        _this.coordinateSystemService.setCoordinateSystem(CoordinateSystem.P20_2);\n        _this.cameraChangedCallback(_this.viewport);\n      }\n    });\n    return _this;\n  }\n  _createClass(AMapService, [{\n    key: \"setCustomCoordCenter\",\n    value:\n    /**\n     * 用于 customCooords 数据的计算\n     */\n    // 一般使用用户数据的第一个\n    // 莫卡托\n\n    /**\n     *   设置数据的绘制中心 高德2.0\n     */\n    function setCustomCoordCenter(center) {\n      this.sceneCenter = center;\n      this.sceneCenterMercator = amap2Project.apply(void 0, _toConsumableArray(center));\n    }\n  }, {\n    key: \"getCustomCoordCenter\",\n    value: function getCustomCoordCenter() {\n      return this.sceneCenterMercator;\n    }\n  }, {\n    key: \"lngLatToCoordByLayer\",\n    value: function lngLatToCoordByLayer(lnglat, layerCenterMercator) {\n      var layerCenterFlat = layerCenterMercator || this.sceneCenterMercator;\n      var coord = this._sub(amap2Project(lnglat[0], lnglat[1]), layerCenterFlat);\n      // Z 参数\n      if (lnglat[2]) {\n        coord.push(lnglat[2]);\n      }\n      return coord;\n    }\n  }, {\n    key: \"coordToAMap2RelativeCoordinates\",\n    value: function coordToAMap2RelativeCoordinates(lnglatArray, layerCenter) {\n      var _this2 = this;\n      var layerCenterMercator = amap2Project(layerCenter[0], layerCenter[1]);\n      if (typeof lnglatArray[0] === 'number') {\n        return this.lngLatToCoordByLayer(lnglatArray, layerCenterMercator);\n      } else {\n        // @ts-ignore\n        return lnglatArray.map(function (lnglats) {\n          if (Array.isArray(lnglats) && typeof lnglats[0] === 'number') {\n            return _this2.lngLatToCoordByLayer(lnglats, layerCenterMercator);\n          } else {\n            // @ts-ignore\n            return lnglats.map(function (lnglat) {\n              return _this2.lngLatToCoordByLayer(lnglat, layerCenterMercator);\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"setCoordCenter\",\n    value: function setCoordCenter(center) {\n      // @ts-ignore\n      this.map.customCoords.setCenter(center || DEFAULTMAPCENTER);\n      this.setCustomCoordCenter(center || DEFAULTMAPCENTER);\n    }\n\n    /**\n     * 根据数据的绘制中心转换经纬度数据 高德2.0\n     */\n  }, {\n    key: \"lngLatToCoord\",\n    value: function lngLatToCoord(lnglat) {\n      // 单点\n      if (!this.sceneCenter) {\n        // @ts-ignore\n        this.map.customCoords.setCenter(lnglat);\n        this.setCustomCoordCenter(lnglat);\n      }\n      return this._sub(amap2Project(lnglat[0], lnglat[1]), this.sceneCenterMercator);\n    }\n\n    /**\n     * 转化线、面类型的点位数据\n     */\n  }, {\n    key: \"lngLatToCoords\",\n    value: function lngLatToCoords(lnglatArray) {\n      var _this3 = this;\n      // @ts-ignore\n      return lnglatArray.map(function (lnglats) {\n        if (typeof lnglats[0] === 'number') {\n          return _this3.lngLatToCoord(lnglats);\n        } else {\n          // @ts-ignore\n          return lnglats.map(function (lnglat) {\n            return _this3.lngLatToCoord(lnglat);\n          });\n        }\n      });\n    }\n  }, {\n    key: \"addMarkerContainer\",\n    value: function addMarkerContainer() {\n      if (!this.map) {\n        return;\n      }\n      var mapContainer = this.map.getContainer();\n      if (mapContainer !== null) {\n        var amap = mapContainer.getElementsByClassName('amap-maps')[0];\n        // amap2 的 amap-maps 新增 z-index=0; 样式，让 marker 中 zIndex 失效\n        amap.style.zIndex = 'auto';\n        this.markerContainer = DOM.create('div', 'l7-marker-container2', amap);\n      }\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    // tslint:disable-next-line:variable-name no-empty\n  }, {\n    key: \"updateView\",\n    value: function updateView(_viewOption) {}\n  }, {\n    key: \"getOverlayContainer\",\n    value: function getOverlayContainer() {\n      return undefined;\n    }\n  }, {\n    key: \"getType\",\n    value: function getType() {\n      return 'amap2';\n    }\n  }, {\n    key: \"getBounds\",\n    value: function getBounds() {\n      var bounds = this.map.getBounds();\n\n      // @ts-ignore\n      var NE = bounds.getNorthEast();\n      // @ts-ignore\n      var SW = bounds.getSouthWest();\n      var center = this.getCenter();\n      var maxlng = center.lng > NE.getLng() || center.lng < SW.getLng() ? 180 - NE.getLng() : NE.getLng();\n      var minlng = center.lng < SW.getLng() ? SW.getLng() - 180 : SW.getLng();\n      // 兼容 Mapbox，统一返回西南、东北\n      return [[minlng, SW.getLat()], [maxlng, NE.getLat()]];\n    }\n  }, {\n    key: \"getMinZoom\",\n    value: function getMinZoom() {\n      // const zooms = this.map.get('zooms') as [number, number];\n      // @ts-ignore\n      var zooms = this.map.getZooms();\n      return zooms[0] - 1;\n    }\n  }, {\n    key: \"getMaxZoom\",\n    value: function getMaxZoom() {\n      // const zooms = this.map.get('zooms') as [number, number];\n      // @ts-ignore\n      var zooms = this.map.getZooms();\n      return zooms[1] - 1;\n    }\n  }, {\n    key: \"lngLatToContainer\",\n    value: function lngLatToContainer(lnglat) {\n      var pixel = this.map.lngLatToContainer(lnglat);\n      return {\n        x: pixel.getX(),\n        y: pixel.getY()\n      };\n    }\n  }, {\n    key: \"lngLatToPixel\",\n    value: function lngLatToPixel(lnglat) {\n      // @ts-ignore\n      var p = this.map.lngLatToPixel(new AMap.LngLat(lnglat[0], lnglat[1]));\n      // lngLatToPixel\n      return {\n        x: p.getX(),\n        y: p.getY()\n      };\n    }\n  }, {\n    key: \"getModelMatrix\",\n    value: function getModelMatrix(lnglat, altitude, rotate) {\n      var scale = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [1, 1, 1];\n      // const flat = this.viewport.projectFlat(lnglat);\n      // @ts-ignore\n      var flat = this.map.customCoords.lngLatToCoord(lnglat);\n      // @ts-ignore\n      var modelMatrix = mat4.create();\n      mat4.translate(modelMatrix, modelMatrix, vec3.fromValues(flat[0], flat[1], altitude));\n      mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(scale[0], scale[1], scale[2]));\n      mat4.rotateX(modelMatrix, modelMatrix, rotate[0]);\n      mat4.rotateY(modelMatrix, modelMatrix, rotate[1]);\n      mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]);\n      return modelMatrix;\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this$config, id, _this$config$style, style, _this$config$minZoom, minZoom, _this$config$maxZoom, maxZoom, _this$config$token, token, mapInstance, _this$config$plugin, plugin, _this$config$version, version, rest, _this$map$customCoord2, mapInitCenter, _this$map$customCoord3, mapConstructorOptions, map, _mapInitCenter;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this$config = this.config, id = _this$config.id, _this$config$style = _this$config.style, style = _this$config$style === void 0 ? 'light' : _this$config$style, _this$config$minZoom = _this$config.minZoom, minZoom = _this$config$minZoom === void 0 ? 0 : _this$config$minZoom, _this$config$maxZoom = _this$config.maxZoom, maxZoom = _this$config$maxZoom === void 0 ? 24 : _this$config$maxZoom, _this$config$token = _this$config.token, token = _this$config$token === void 0 ? AMAP_API_KEY : _this$config$token, mapInstance = _this$config.mapInstance, _this$config$plugin = _this$config.plugin, plugin = _this$config$plugin === void 0 ? [] : _this$config$plugin, _this$config$version = _this$config.version, version = _this$config$version === void 0 ? AMAP_VERSION : _this$config$version, rest = _objectWithoutProperties(_this$config, _excluded);\n              this.viewport = new Viewport();\n              if (window.AMap || mapInstance) {\n                _context.next = 6;\n                break;\n              }\n              plugin.push('Map3D');\n              // if (AMapLoader.status.AMap === 'notload') {\n              _context.next = 6;\n              return AMapLoader.load({\n                key: token,\n                // 申请好的Web端开发者Key，首次调用 load 时必填\n                version: AMAP_VERSION,\n                // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\n                plugins: plugin // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n              });\n            case 6:\n              if (mapInstance) {\n                this.map = mapInstance;\n                this.$mapContainer = this.map.getContainer();\n\n                // 在使用 map.customCoords 的时候必须使用\n                mapInitCenter = this.map.getCenter(); // @ts-ignore\n                (_this$map$customCoord2 = this.map.customCoords) === null || _this$map$customCoord2 === void 0 || _this$map$customCoord2.setCenter([\n                // @ts-ignore\n                mapInitCenter.lng,\n                // @ts-ignore\n                mapInitCenter.lat]);\n                // @ts-ignore\n                this.setCustomCoordCenter([mapInitCenter.lng, mapInitCenter.lat]);\n                this.map.on('viewchange', this.handleViewChanged);\n              } else {\n                this.$mapContainer = this.creatMapContainer(id);\n                mapConstructorOptions = _objectSpread({\n                  mapStyle: this.getMapStyleValue(style),\n                  zooms: [minZoom, maxZoom],\n                  viewMode: '3D'\n                }, rest);\n                if (mapConstructorOptions.zoom) {\n                  // 高德地图在相同大小下需要比 MapBox 多一个 zoom 层级\n                  mapConstructorOptions.zoom += 1;\n                }\n                if (token === AMAP_API_KEY) {\n                  // @ts-ignore\n                  window._AMapSecurityConfig = {\n                    securityJsCode: '2653011adeb04230b3a26cc9a780a800'\n                  };\n                  console.warn(\"%c\".concat(this.configService.getSceneWarninfo('MapToken'), \"!\"), 'color: #873bf4;font-weigh:900;font-size: 16px;');\n                }\n                // @ts-ignore\n                map = new AMap.Map(this.$mapContainer, mapConstructorOptions); // @ts-ignore\n                this.map = map;\n                // 在使用 map.customCoords 的时候必须使用\n                _mapInitCenter = map.getCenter(); // @ts-ignore\n                // @ts-ignore\n                (_this$map$customCoord3 = this.map.customCoords) === null || _this$map$customCoord3 === void 0 || _this$map$customCoord3.setCenter([_mapInitCenter.lng, _mapInitCenter.lat]);\n\n                // @ts-ignore\n                this.setCustomCoordCenter([_mapInitCenter.lng, _mapInitCenter.lat]);\n                // 监听地图相机事件\n                map.on('viewchange', this.handleViewChanged);\n              }\n              this.initViewPort();\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function init() {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }, {\n    key: \"getMapContainer\",\n    value: function getMapContainer() {\n      return this.$mapContainer;\n    }\n  }, {\n    key: \"onCameraChanged\",\n    value: function onCameraChanged(callback) {\n      this.cameraChangedCallback = callback;\n    }\n  }, {\n    key: \"initViewPort\",\n    value: function initViewPort() {\n      var _this$map$customCoord4;\n      // @ts-ignore\n      var _ref = ((_this$map$customCoord4 = this.map.customCoords) === null || _this$map$customCoord4 === void 0 ? void 0 : _this$map$customCoord4.getCameraParams()) || {},\n        fov = _ref.fov,\n        near = _ref.near,\n        far = _ref.far,\n        aspect = _ref.aspect,\n        position = _ref.position,\n        lookAt = _ref.lookAt,\n        up = _ref.up;\n      // Tip: 统一触发地图变化事件\n      this.emit('mapchange');\n      // // @ts-ignore\n      // console.log('this.map.customCoords.getCameraParams()', this.map.customCoords.getCameraParams())\n      // const { left, right, bottom, top, near, far, position } = this.map.customCoords.getCameraParams();\n\n      // @ts-ignore\n      var center = this.map.customCoords.getCenter();\n      var zoom = this.map.getZoom();\n      // @ts-ignore\n      if (this.cameraChangedCallback) {\n        this.viewport.syncWithMapCamera({\n          aspect: aspect,\n          far: far,\n          fov: fov,\n          cameraPosition: position,\n          lookAt: lookAt,\n          near: near,\n          up: up,\n          // AMap 定义的缩放等级 与 Mapbox 相差 1\n          zoom: zoom - 1,\n          // 与amap1.x对比相差一个级别\n          center: center,\n          offsetOrigin: [position[0], position[1]]\n\n          // @ts-ignore\n          // left, right, bottom, top\n        });\n        // set coordinate system\n        this.coordinateSystemService.setCoordinateSystem(CoordinateSystem.P20_2);\n        this.cameraChangedCallback(this.viewport);\n      }\n    }\n  }, {\n    key: \"_sub\",\n    value: function _sub(a, b) {\n      var r = [0, 0];\n      r[0] = a[0] - b[0];\n      r[1] = a[1] - b[1];\n      return r;\n    }\n  }]);\n  return AMapService;\n}(AMapBaseService)) || _class);\nexport { AMapService as default };"],"mappings":";AAAA,OAAOA,aAAa,MAAM,0CAA0C;AACpE,OAAOC,wBAAwB,MAAM,oDAAoD;AACzF,OAAOC,iBAAiB,MAAM,6CAA6C;AAC3E,OAAOC,kBAAkB,MAAM,8CAA8C;AAC7E,OAAOC,eAAe,MAAM,2CAA2C;AACvE,OAAOC,YAAY,MAAM,wCAAwC;AACjE,OAAOC,sBAAsB,MAAM,kDAAkD;AACrF,OAAOC,SAAS,MAAM,qCAAqC;AAC3D,OAAOC,0BAA0B,MAAM,sDAAsD;AAC7F,OAAOC,eAAe,MAAM,2CAA2C;AACvE,OAAOC,eAAe,MAAM,2CAA2C;AACvE,IAAIC,SAAS,GAAG,CAAC,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,SAAS,CAAC;AAClG,IAAIC,IAAI,EAAEC,MAAM;AAChB,OAAOC,mBAAmB,MAAM,4BAA4B;AAC5D,SAASC,YAAYA,CAACC,OAAO,EAAE;EAAE,IAAIC,yBAAyB,GAAGC,yBAAyB,CAAC,CAAC;EAAE,OAAO,SAASC,oBAAoBA,CAAA,EAAG;IAAE,IAAIC,KAAK,GAAGX,eAAe,CAACO,OAAO,CAAC;MAAEK,MAAM;IAAE,IAAIJ,yBAAyB,EAAE;MAAE,IAAIK,SAAS,GAAGb,eAAe,CAAC,IAAI,CAAC,CAACc,WAAW;MAAEF,MAAM,GAAGG,OAAO,CAACC,SAAS,CAACL,KAAK,EAAEM,SAAS,EAAEJ,SAAS,CAAC;IAAE,CAAC,MAAM;MAAED,MAAM,GAAGD,KAAK,CAACO,KAAK,CAAC,IAAI,EAAED,SAAS,CAAC;IAAE;IAAE,OAAOlB,0BAA0B,CAAC,IAAI,EAAEa,MAAM,CAAC;EAAE,CAAC;AAAE;AACxa,SAASH,yBAAyBA,CAAA,EAAG;EAAE,IAAI,OAAOM,OAAO,KAAK,WAAW,IAAI,CAACA,OAAO,CAACC,SAAS,EAAE,OAAO,KAAK;EAAE,IAAID,OAAO,CAACC,SAAS,CAACG,IAAI,EAAE,OAAO,KAAK;EAAE,IAAI,OAAOC,KAAK,KAAK,UAAU,EAAE,OAAO,IAAI;EAAE,IAAI;IAAEC,OAAO,CAACC,SAAS,CAACC,OAAO,CAACC,IAAI,CAACT,OAAO,CAACC,SAAS,CAACK,OAAO,EAAE,EAAE,EAAE,YAAY,CAAC,CAAC,CAAC,CAAC;IAAE,OAAO,IAAI;EAAE,CAAC,CAAC,OAAOI,CAAC,EAAE;IAAE,OAAO,KAAK;EAAE;AAAE;AACxU;AACA;AACA;AACA;AACA,OAAOC,UAAU,MAAM,yBAAyB;AAChD,SAASC,gBAAgB,QAAQ,eAAe;AAChD,SAASC,GAAG,EAAEC,YAAY,QAAQ,gBAAgB;AAClD,SAASC,IAAI,EAAEC,IAAI,QAAQ,WAAW;AACtC,SAASC,UAAU,QAAQ,WAAW;AACtC,OAAO,kBAAkB;AACzB,OAAOC,eAAe,MAAM,+BAA+B;AAC3D,OAAOC,QAAQ,MAAM,YAAY;AACjC;AACA,SAASC,UAAUA,CAACC,GAAG,EAAEC,GAAG,EAAE;EAC5B,IAAIC,SAAS,GAAG,OAAOC,EAAE,KAAK,WAAW,IAAI,CAAC,CAACA,EAAE,IAAI,OAAOA,EAAE,CAACC,SAAS,KAAK,UAAU,IAAID,EAAE,CAACE,KAAK,KAAK,IAAI;EAC5G,IAAIC,mBAAmB,GAAG,OAAOC,EAAE,KAAK,WAAW,IAAIA,EAAE,KAAK,IAAI,KAAK,OAAOA,EAAE,CAACC,OAAO,KAAK,WAAW,IAAI,OAAOD,EAAE,CAACE,WAAW,KAAK,WAAW,CAAC;EAClJ,IAAIP,SAAS,IAAII,mBAAmB,EAAE;IACpC;EACF;EACA,IAAI,CAACL,GAAG,EAAEA,GAAG,GAAGS,QAAQ;EACxB,IAAI,CAACT,GAAG,EAAE;IACR;EACF;EACA,IAAIU,IAAI,GAAGV,GAAG,CAACU,IAAI,IAAIV,GAAG,CAACW,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;EAC1D,IAAI,CAACD,IAAI,EAAE;IACTA,IAAI,GAAGV,GAAG,CAACY,aAAa,CAAC,MAAM,CAAC;IAChC,IAAIC,IAAI,GAAGb,GAAG,CAACa,IAAI,IAAIb,GAAG,CAACW,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IAC1D,IAAIE,IAAI,EAAE;MACRA,IAAI,CAACC,UAAU,CAACC,YAAY,CAACL,IAAI,EAAEG,IAAI,CAAC;IAC1C,CAAC,MAAM;MACLb,GAAG,CAACgB,eAAe,CAACC,WAAW,CAACP,IAAI,CAAC;IACvC;EACF;EACA,IAAIQ,KAAK,GAAGlB,GAAG,CAACY,aAAa,CAAC,OAAO,CAAC;EACtCM,KAAK,CAACC,IAAI,GAAG,UAAU;EACvB,IAAID,KAAK,CAACE,UAAU,EAAE;IACpBF,KAAK,CAACE,UAAU,CAACC,OAAO,GAAGtB,GAAG;EAChC,CAAC,MAAM;IACLmB,KAAK,CAACD,WAAW,CAACjB,GAAG,CAACsB,cAAc,CAACvB,GAAG,CAAC,CAAC;EAC5C;EACAW,IAAI,CAACO,WAAW,CAACC,KAAK,CAAC;EACvB,OAAOA,KAAK;AACd;AACApB,UAAU,CAAC,iGAAiG,CAAC;AAC7G,IAAIyB,gBAAgB,GAAG,CAAC,SAAS,EAAE,QAAQ,CAAC;;AAE5C;AACAC,MAAM,CAACC,UAAU,GAAG,IAAI;AACxB,IAAIC,YAAY,GAAG,kCAAkC;AACrD;AACA,IAAIC,YAAY,GAAG,KAAK;;AAExB;AACA;AACA;AACA,IAAIC,UAAU,GAAG,KAAK;AACtB;AACA;AACA;AACA,IAAIC,mBAAmB,GAAG,EAAE;;AAE5B;AACA;AACA;AACA,IAAIC,WAAW,IAAIhE,IAAI,GAAG6B,UAAU,CAAC,CAAC,EAAE7B,IAAI,CAACC,MAAM,GAAG,aAAa,UAAUgE,gBAAgB,EAAE;EAC7FtE,SAAS,CAACqE,WAAW,EAAEC,gBAAgB,CAAC;EACxC,IAAIC,MAAM,GAAG/D,YAAY,CAAC6D,WAAW,CAAC;EACtC,SAASA,WAAWA,CAAA,EAAG;IACrB,IAAIG,KAAK;IACT3E,eAAe,CAAC,IAAI,EAAEwE,WAAW,CAAC;IAClC,KAAK,IAAII,IAAI,GAAGtD,SAAS,CAACuD,MAAM,EAAEC,IAAI,GAAG,IAAIC,KAAK,CAACH,IAAI,CAAC,EAAEI,IAAI,GAAG,CAAC,EAAEA,IAAI,GAAGJ,IAAI,EAAEI,IAAI,EAAE,EAAE;MACvFF,IAAI,CAACE,IAAI,CAAC,GAAG1D,SAAS,CAAC0D,IAAI,CAAC;IAC9B;IACAL,KAAK,GAAGD,MAAM,CAAC7C,IAAI,CAACN,KAAK,CAACmD,MAAM,EAAE,CAAC,IAAI,CAAC,CAACO,MAAM,CAACH,IAAI,CAAC,CAAC;IACtDxE,eAAe,CAACJ,sBAAsB,CAACyE,KAAK,CAAC,EAAE,SAAS,EAAE,UAAU,CAAC;IACrE;AACJ;AACA;AACA;IACIrE,eAAe,CAACJ,sBAAsB,CAACyE,KAAK,CAAC,EAAE,mBAAmB,EAAE,UAAU7C,CAAC,EAAE;MAC/E,IAAIoD,qBAAqB,GAAGP,KAAK,CAACQ,GAAG,CAACC,YAAY,CAACC,eAAe,CAAC,CAAC;QAClEC,GAAG,GAAGJ,qBAAqB,CAACI,GAAG;QAC/BC,IAAI,GAAGL,qBAAqB,CAACK,IAAI;QACjCC,GAAG,GAAGN,qBAAqB,CAACM,GAAG;QAC/BC,MAAM,GAAGP,qBAAqB,CAACO,MAAM;QACrCC,QAAQ,GAAGR,qBAAqB,CAACQ,QAAQ;QACzCC,MAAM,GAAGT,qBAAqB,CAACS,MAAM;QACrCC,EAAE,GAAGV,qBAAqB,CAACU,EAAE;MAC/B;MACAjB,KAAK,CAACkB,IAAI,CAAC,WAAW,CAAC;MACvB;MACA,IAAIC,MAAM,GAAGnB,KAAK,CAACQ,GAAG,CAACC,YAAY,CAACW,SAAS,CAAC,CAAC;MAC/C,IAAIpB,KAAK,CAACqB,qBAAqB,EAAE;QAC/B;QACArB,KAAK,CAACsB,QAAQ,CAACC,iBAAiB,CAAC;UAC/BT,MAAM,EAAEA,MAAM;UACdD,GAAG,EAAEA,GAAG;UACRF,GAAG,EAAEA,GAAG;UACRa,cAAc,EAAET,QAAQ;UACxBC,MAAM,EAAEA,MAAM;UACdC,EAAE,EAAEA,EAAE;UACNL,IAAI,EAAEA,IAAI;UACV;UACAa,IAAI,EAAEzB,KAAK,CAACQ,GAAG,CAACkB,OAAO,CAAC,CAAC,GAAG,CAAC;UAC7B;UACAP,MAAM,EAAEA,MAAM;UACdQ,YAAY,EAAE,CAACZ,QAAQ,CAAC,CAAC,CAAC,EAAEA,QAAQ,CAAC,CAAC,CAAC;;UAEvC;UACA;QACF,CAAC,CAAC;QACF;QACAf,KAAK,CAAC4B,uBAAuB,CAACC,mBAAmB,CAACxE,gBAAgB,CAACyE,KAAK,CAAC;QACzE9B,KAAK,CAACqB,qBAAqB,CAACrB,KAAK,CAACsB,QAAQ,CAAC;MAC7C;IACF,CAAC,CAAC;IACF,OAAOtB,KAAK;EACd;EACA1E,YAAY,CAACuE,WAAW,EAAE,CAAC;IACzBkC,GAAG,EAAE,sBAAsB;IAC3BC,KAAK;IACL;AACJ;AACA;IACI;IACA;;IAEA;AACJ;AACA;IACI,SAASC,oBAAoBA,CAACd,MAAM,EAAE;MACpC,IAAI,CAACe,WAAW,GAAGf,MAAM;MACzB,IAAI,CAACgB,mBAAmB,GAAG5E,YAAY,CAACX,KAAK,CAAC,KAAK,CAAC,EAAExB,kBAAkB,CAAC+F,MAAM,CAAC,CAAC;IACnF;EACF,CAAC,EAAE;IACDY,GAAG,EAAE,sBAAsB;IAC3BC,KAAK,EAAE,SAASI,oBAAoBA,CAAA,EAAG;MACrC,OAAO,IAAI,CAACD,mBAAmB;IACjC;EACF,CAAC,EAAE;IACDJ,GAAG,EAAE,sBAAsB;IAC3BC,KAAK,EAAE,SAASK,oBAAoBA,CAACC,MAAM,EAAEC,mBAAmB,EAAE;MAChE,IAAIC,eAAe,GAAGD,mBAAmB,IAAI,IAAI,CAACJ,mBAAmB;MACrE,IAAIM,KAAK,GAAG,IAAI,CAACC,IAAI,CAACnF,YAAY,CAAC+E,MAAM,CAAC,CAAC,CAAC,EAAEA,MAAM,CAAC,CAAC,CAAC,CAAC,EAAEE,eAAe,CAAC;MAC1E;MACA,IAAIF,MAAM,CAAC,CAAC,CAAC,EAAE;QACbG,KAAK,CAACE,IAAI,CAACL,MAAM,CAAC,CAAC,CAAC,CAAC;MACvB;MACA,OAAOG,KAAK;IACd;EACF,CAAC,EAAE;IACDV,GAAG,EAAE,iCAAiC;IACtCC,KAAK,EAAE,SAASY,+BAA+BA,CAACC,WAAW,EAAEC,WAAW,EAAE;MACxE,IAAIC,MAAM,GAAG,IAAI;MACjB,IAAIR,mBAAmB,GAAGhF,YAAY,CAACuF,WAAW,CAAC,CAAC,CAAC,EAAEA,WAAW,CAAC,CAAC,CAAC,CAAC;MACtE,IAAI,OAAOD,WAAW,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;QACtC,OAAO,IAAI,CAACR,oBAAoB,CAACQ,WAAW,EAAEN,mBAAmB,CAAC;MACpE,CAAC,MAAM;QACL;QACA,OAAOM,WAAW,CAACrC,GAAG,CAAC,UAAUwC,OAAO,EAAE;UACxC,IAAI5C,KAAK,CAAC6C,OAAO,CAACD,OAAO,CAAC,IAAI,OAAOA,OAAO,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;YAC5D,OAAOD,MAAM,CAACV,oBAAoB,CAACW,OAAO,EAAET,mBAAmB,CAAC;UAClE,CAAC,MAAM;YACL;YACA,OAAOS,OAAO,CAACxC,GAAG,CAAC,UAAU8B,MAAM,EAAE;cACnC,OAAOS,MAAM,CAACV,oBAAoB,CAACC,MAAM,EAAEC,mBAAmB,CAAC;YACjE,CAAC,CAAC;UACJ;QACF,CAAC,CAAC;MACJ;IACF;EACF,CAAC,EAAE;IACDR,GAAG,EAAE,gBAAgB;IACrBC,KAAK,EAAE,SAASkB,cAAcA,CAAC/B,MAAM,EAAE;MACrC;MACA,IAAI,CAACX,GAAG,CAACC,YAAY,CAAC0C,SAAS,CAAChC,MAAM,IAAI7B,gBAAgB,CAAC;MAC3D,IAAI,CAAC2C,oBAAoB,CAACd,MAAM,IAAI7B,gBAAgB,CAAC;IACvD;;IAEA;AACJ;AACA;EACE,CAAC,EAAE;IACDyC,GAAG,EAAE,eAAe;IACpBC,KAAK,EAAE,SAASoB,aAAaA,CAACd,MAAM,EAAE;MACpC;MACA,IAAI,CAAC,IAAI,CAACJ,WAAW,EAAE;QACrB;QACA,IAAI,CAAC1B,GAAG,CAACC,YAAY,CAAC0C,SAAS,CAACb,MAAM,CAAC;QACvC,IAAI,CAACL,oBAAoB,CAACK,MAAM,CAAC;MACnC;MACA,OAAO,IAAI,CAACI,IAAI,CAACnF,YAAY,CAAC+E,MAAM,CAAC,CAAC,CAAC,EAAEA,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,CAACH,mBAAmB,CAAC;IAChF;;IAEA;AACJ;AACA;EACE,CAAC,EAAE;IACDJ,GAAG,EAAE,gBAAgB;IACrBC,KAAK,EAAE,SAASqB,cAAcA,CAACR,WAAW,EAAE;MAC1C,IAAIS,MAAM,GAAG,IAAI;MACjB;MACA,OAAOT,WAAW,CAACrC,GAAG,CAAC,UAAUwC,OAAO,EAAE;QACxC,IAAI,OAAOA,OAAO,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;UAClC,OAAOM,MAAM,CAACF,aAAa,CAACJ,OAAO,CAAC;QACtC,CAAC,MAAM;UACL;UACA,OAAOA,OAAO,CAACxC,GAAG,CAAC,UAAU8B,MAAM,EAAE;YACnC,OAAOgB,MAAM,CAACF,aAAa,CAACd,MAAM,CAAC;UACrC,CAAC,CAAC;QACJ;MACF,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACDP,GAAG,EAAE,oBAAoB;IACzBC,KAAK,EAAE,SAASuB,kBAAkBA,CAAA,EAAG;MACnC,IAAI,CAAC,IAAI,CAAC/C,GAAG,EAAE;QACb;MACF;MACA,IAAIgD,YAAY,GAAG,IAAI,CAAChD,GAAG,CAACiD,YAAY,CAAC,CAAC;MAC1C,IAAID,YAAY,KAAK,IAAI,EAAE;QACzB,IAAIE,IAAI,GAAGF,YAAY,CAACG,sBAAsB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;QAC9D;QACAD,IAAI,CAACzE,KAAK,CAAC2E,MAAM,GAAG,MAAM;QAC1B,IAAI,CAACC,eAAe,GAAGvG,GAAG,CAACwG,MAAM,CAAC,KAAK,EAAE,sBAAsB,EAAEJ,IAAI,CAAC;MACxE;IACF;;IAEA;IACA;EACF,CAAC,EAAE;IACD3B,GAAG,EAAE,YAAY;IACjBC,KAAK,EAAE,SAAS+B,UAAUA,CAACC,WAAW,EAAE,CAAC;EAC3C,CAAC,EAAE;IACDjC,GAAG,EAAE,qBAAqB;IAC1BC,KAAK,EAAE,SAASiC,mBAAmBA,CAAA,EAAG;MACpC,OAAOC,SAAS;IAClB;EACF,CAAC,EAAE;IACDnC,GAAG,EAAE,SAAS;IACdC,KAAK,EAAE,SAASmC,OAAOA,CAAA,EAAG;MACxB,OAAO,OAAO;IAChB;EACF,CAAC,EAAE;IACDpC,GAAG,EAAE,WAAW;IAChBC,KAAK,EAAE,SAASoC,SAASA,CAAA,EAAG;MAC1B,IAAIC,MAAM,GAAG,IAAI,CAAC7D,GAAG,CAAC4D,SAAS,CAAC,CAAC;;MAEjC;MACA,IAAIE,EAAE,GAAGD,MAAM,CAACE,YAAY,CAAC,CAAC;MAC9B;MACA,IAAIC,EAAE,GAAGH,MAAM,CAACI,YAAY,CAAC,CAAC;MAC9B,IAAItD,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,CAAC;MAC7B,IAAIsD,MAAM,GAAGvD,MAAM,CAACwD,GAAG,GAAGL,EAAE,CAACM,MAAM,CAAC,CAAC,IAAIzD,MAAM,CAACwD,GAAG,GAAGH,EAAE,CAACI,MAAM,CAAC,CAAC,GAAG,GAAG,GAAGN,EAAE,CAACM,MAAM,CAAC,CAAC,GAAGN,EAAE,CAACM,MAAM,CAAC,CAAC;MACnG,IAAIC,MAAM,GAAG1D,MAAM,CAACwD,GAAG,GAAGH,EAAE,CAACI,MAAM,CAAC,CAAC,GAAGJ,EAAE,CAACI,MAAM,CAAC,CAAC,GAAG,GAAG,GAAGJ,EAAE,CAACI,MAAM,CAAC,CAAC;MACvE;MACA,OAAO,CAAC,CAACC,MAAM,EAAEL,EAAE,CAACM,MAAM,CAAC,CAAC,CAAC,EAAE,CAACJ,MAAM,EAAEJ,EAAE,CAACQ,MAAM,CAAC,CAAC,CAAC,CAAC;IACvD;EACF,CAAC,EAAE;IACD/C,GAAG,EAAE,YAAY;IACjBC,KAAK,EAAE,SAAS+C,UAAUA,CAAA,EAAG;MAC3B;MACA;MACA,IAAIC,KAAK,GAAG,IAAI,CAACxE,GAAG,CAACyE,QAAQ,CAAC,CAAC;MAC/B,OAAOD,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC;IACrB;EACF,CAAC,EAAE;IACDjD,GAAG,EAAE,YAAY;IACjBC,KAAK,EAAE,SAASkD,UAAUA,CAAA,EAAG;MAC3B;MACA;MACA,IAAIF,KAAK,GAAG,IAAI,CAACxE,GAAG,CAACyE,QAAQ,CAAC,CAAC;MAC/B,OAAOD,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC;IACrB;EACF,CAAC,EAAE;IACDjD,GAAG,EAAE,mBAAmB;IACxBC,KAAK,EAAE,SAASmD,iBAAiBA,CAAC7C,MAAM,EAAE;MACxC,IAAI8C,KAAK,GAAG,IAAI,CAAC5E,GAAG,CAAC2E,iBAAiB,CAAC7C,MAAM,CAAC;MAC9C,OAAO;QACL+C,CAAC,EAAED,KAAK,CAACE,IAAI,CAAC,CAAC;QACfC,CAAC,EAAEH,KAAK,CAACI,IAAI,CAAC;MAChB,CAAC;IACH;EACF,CAAC,EAAE;IACDzD,GAAG,EAAE,eAAe;IACpBC,KAAK,EAAE,SAASyD,aAAaA,CAACnD,MAAM,EAAE;MACpC;MACA,IAAIoD,CAAC,GAAG,IAAI,CAAClF,GAAG,CAACiF,aAAa,CAAC,IAAIE,IAAI,CAACC,MAAM,CAACtD,MAAM,CAAC,CAAC,CAAC,EAAEA,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;MACrE;MACA,OAAO;QACL+C,CAAC,EAAEK,CAAC,CAACJ,IAAI,CAAC,CAAC;QACXC,CAAC,EAAEG,CAAC,CAACF,IAAI,CAAC;MACZ,CAAC;IACH;EACF,CAAC,EAAE;IACDzD,GAAG,EAAE,gBAAgB;IACrBC,KAAK,EAAE,SAAS6D,cAAcA,CAACvD,MAAM,EAAEwD,QAAQ,EAAEC,MAAM,EAAE;MACvD,IAAIC,KAAK,GAAGrJ,SAAS,CAACuD,MAAM,GAAG,CAAC,IAAIvD,SAAS,CAAC,CAAC,CAAC,KAAKuH,SAAS,GAAGvH,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MACzF;MACA;MACA,IAAIsJ,IAAI,GAAG,IAAI,CAACzF,GAAG,CAACC,YAAY,CAAC2C,aAAa,CAACd,MAAM,CAAC;MACtD;MACA,IAAI4D,WAAW,GAAG1I,IAAI,CAACsG,MAAM,CAAC,CAAC;MAC/BtG,IAAI,CAAC2I,SAAS,CAACD,WAAW,EAAEA,WAAW,EAAEzI,IAAI,CAAC2I,UAAU,CAACH,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,EAAEH,QAAQ,CAAC,CAAC;MACrFtI,IAAI,CAACwI,KAAK,CAACE,WAAW,EAAEA,WAAW,EAAEzI,IAAI,CAAC2I,UAAU,CAACJ,KAAK,CAAC,CAAC,CAAC,EAAEA,KAAK,CAAC,CAAC,CAAC,EAAEA,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;MACnFxI,IAAI,CAAC6I,OAAO,CAACH,WAAW,EAAEA,WAAW,EAAEH,MAAM,CAAC,CAAC,CAAC,CAAC;MACjDvI,IAAI,CAAC8I,OAAO,CAACJ,WAAW,EAAEA,WAAW,EAAEH,MAAM,CAAC,CAAC,CAAC,CAAC;MACjDvI,IAAI,CAAC+I,OAAO,CAACL,WAAW,EAAEA,WAAW,EAAEH,MAAM,CAAC,CAAC,CAAC,CAAC;MACjD,OAAOG,WAAW;IACpB;EACF,CAAC,EAAE;IACDnE,GAAG,EAAE,MAAM;IACXC,KAAK,EAAE,YAAY;MACjB,IAAIwE,KAAK,GAAGrL,iBAAiB,EAAE,aAAaY,mBAAmB,CAAC0K,IAAI,CAAC,SAASC,OAAOA,CAAA,EAAG;QACtF,IAAIC,YAAY,EAAEC,EAAE,EAAEC,kBAAkB,EAAE5H,KAAK,EAAE6H,oBAAoB,EAAEC,OAAO,EAAEC,oBAAoB,EAAEC,OAAO,EAAEC,kBAAkB,EAAEC,KAAK,EAAEC,WAAW,EAAEC,mBAAmB,EAAEC,MAAM,EAAEC,oBAAoB,EAAEC,OAAO,EAAEC,IAAI,EAAEC,sBAAsB,EAAEC,aAAa,EAAEC,sBAAsB,EAAEC,qBAAqB,EAAErH,GAAG,EAAEsH,cAAc;QAClU,OAAO/L,mBAAmB,CAACgM,IAAI,CAAC,SAASC,QAAQA,CAACC,QAAQ,EAAE;UAC1D,OAAO,CAAC,EAAE,QAAQA,QAAQ,CAACC,IAAI,GAAGD,QAAQ,CAACE,IAAI;YAC7C,KAAK,CAAC;cACJxB,YAAY,GAAG,IAAI,CAACyB,MAAM,EAAExB,EAAE,GAAGD,YAAY,CAACC,EAAE,EAAEC,kBAAkB,GAAGF,YAAY,CAAC1H,KAAK,EAAEA,KAAK,GAAG4H,kBAAkB,KAAK,KAAK,CAAC,GAAG,OAAO,GAAGA,kBAAkB,EAAEC,oBAAoB,GAAGH,YAAY,CAACI,OAAO,EAAEA,OAAO,GAAGD,oBAAoB,KAAK,KAAK,CAAC,GAAG,CAAC,GAAGA,oBAAoB,EAAEE,oBAAoB,GAAGL,YAAY,CAACM,OAAO,EAAEA,OAAO,GAAGD,oBAAoB,KAAK,KAAK,CAAC,GAAG,EAAE,GAAGA,oBAAoB,EAAEE,kBAAkB,GAAGP,YAAY,CAACQ,KAAK,EAAEA,KAAK,GAAGD,kBAAkB,KAAK,KAAK,CAAC,GAAGzH,YAAY,GAAGyH,kBAAkB,EAAEE,WAAW,GAAGT,YAAY,CAACS,WAAW,EAAEC,mBAAmB,GAAGV,YAAY,CAACW,MAAM,EAAEA,MAAM,GAAGD,mBAAmB,KAAK,KAAK,CAAC,GAAG,EAAE,GAAGA,mBAAmB,EAAEE,oBAAoB,GAAGZ,YAAY,CAACa,OAAO,EAAEA,OAAO,GAAGD,oBAAoB,KAAK,KAAK,CAAC,GAAG7H,YAAY,GAAG6H,oBAAoB,EAAEE,IAAI,GAAGvM,wBAAwB,CAACyL,YAAY,EAAE/K,SAAS,CAAC;cACz0B,IAAI,CAAC0F,QAAQ,GAAG,IAAI1D,QAAQ,CAAC,CAAC;cAC9B,IAAI2B,MAAM,CAACoG,IAAI,IAAIyB,WAAW,EAAE;gBAC9Ba,QAAQ,CAACE,IAAI,GAAG,CAAC;gBACjB;cACF;cACAb,MAAM,CAAC3E,IAAI,CAAC,OAAO,CAAC;cACpB;cACAsF,QAAQ,CAACE,IAAI,GAAG,CAAC;cACjB,OAAO/K,UAAU,CAACiL,IAAI,CAAC;gBACrBtG,GAAG,EAAEoF,KAAK;gBACV;gBACAK,OAAO,EAAE9H,YAAY;gBACrB;gBACA4I,OAAO,EAAEhB,MAAM,CAAC;cAClB,CAAC,CAAC;;YACJ,KAAK,CAAC;cACJ,IAAIF,WAAW,EAAE;gBACf,IAAI,CAAC5G,GAAG,GAAG4G,WAAW;gBACtB,IAAI,CAACmB,aAAa,GAAG,IAAI,CAAC/H,GAAG,CAACiD,YAAY,CAAC,CAAC;;gBAE5C;gBACAkE,aAAa,GAAG,IAAI,CAACnH,GAAG,CAACY,SAAS,CAAC,CAAC,CAAC,CAAC;gBACtC,CAACsG,sBAAsB,GAAG,IAAI,CAAClH,GAAG,CAACC,YAAY,MAAM,IAAI,IAAIiH,sBAAsB,KAAK,KAAK,CAAC,IAAIA,sBAAsB,CAACvE,SAAS,CAAC;gBACnI;gBACAwE,aAAa,CAAChD,GAAG;gBACjB;gBACAgD,aAAa,CAACa,GAAG,CAAC,CAAC;gBACnB;gBACA,IAAI,CAACvG,oBAAoB,CAAC,CAAC0F,aAAa,CAAChD,GAAG,EAAEgD,aAAa,CAACa,GAAG,CAAC,CAAC;gBACjE,IAAI,CAAChI,GAAG,CAACiI,EAAE,CAAC,YAAY,EAAE,IAAI,CAACC,iBAAiB,CAAC;cACnD,CAAC,MAAM;gBACL,IAAI,CAACH,aAAa,GAAG,IAAI,CAACI,iBAAiB,CAAC/B,EAAE,CAAC;gBAC/CiB,qBAAqB,GAAG5M,aAAa,CAAC;kBACpC2N,QAAQ,EAAE,IAAI,CAACC,gBAAgB,CAAC5J,KAAK,CAAC;kBACtC+F,KAAK,EAAE,CAAC+B,OAAO,EAAEE,OAAO,CAAC;kBACzB6B,QAAQ,EAAE;gBACZ,CAAC,EAAErB,IAAI,CAAC;gBACR,IAAII,qBAAqB,CAACpG,IAAI,EAAE;kBAC9B;kBACAoG,qBAAqB,CAACpG,IAAI,IAAI,CAAC;gBACjC;gBACA,IAAI0F,KAAK,KAAK1H,YAAY,EAAE;kBAC1B;kBACAF,MAAM,CAACwJ,mBAAmB,GAAG;oBAC3BC,cAAc,EAAE;kBAClB,CAAC;kBACDC,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC5I,MAAM,CAAC,IAAI,CAAC6I,aAAa,CAACC,gBAAgB,CAAC,UAAU,CAAC,EAAE,GAAG,CAAC,EAAE,gDAAgD,CAAC;gBACnI;gBACA;gBACA5I,GAAG,GAAG,IAAImF,IAAI,CAAC0D,GAAG,CAAC,IAAI,CAACd,aAAa,EAAEV,qBAAqB,CAAC,CAAC,CAAC;gBAC/D,IAAI,CAACrH,GAAG,GAAGA,GAAG;gBACd;gBACAsH,cAAc,GAAGtH,GAAG,CAACY,SAAS,CAAC,CAAC,CAAC,CAAC;gBAClC;gBACA,CAACwG,sBAAsB,GAAG,IAAI,CAACpH,GAAG,CAACC,YAAY,MAAM,IAAI,IAAImH,sBAAsB,KAAK,KAAK,CAAC,IAAIA,sBAAsB,CAACzE,SAAS,CAAC,CAAC2E,cAAc,CAACnD,GAAG,EAAEmD,cAAc,CAACU,GAAG,CAAC,CAAC;;gBAE5K;gBACA,IAAI,CAACvG,oBAAoB,CAAC,CAAC6F,cAAc,CAACnD,GAAG,EAAEmD,cAAc,CAACU,GAAG,CAAC,CAAC;gBACnE;gBACAhI,GAAG,CAACiI,EAAE,CAAC,YAAY,EAAE,IAAI,CAACC,iBAAiB,CAAC;cAC9C;cACA,IAAI,CAACY,YAAY,CAAC,CAAC;YACrB,KAAK,CAAC;YACN,KAAK,KAAK;cACR,OAAOrB,QAAQ,CAACsB,IAAI,CAAC,CAAC;UAC1B;QACF,CAAC,EAAE7C,OAAO,EAAE,IAAI,CAAC;MACnB,CAAC,CAAC,CAAC;MACH,SAAS8C,IAAIA,CAAA,EAAG;QACd,OAAOhD,KAAK,CAAC5J,KAAK,CAAC,IAAI,EAAED,SAAS,CAAC;MACrC;MACA,OAAO6M,IAAI;IACb,CAAC,CAAC;EACJ,CAAC,EAAE;IACDzH,GAAG,EAAE,iBAAiB;IACtBC,KAAK,EAAE,SAASyH,eAAeA,CAAA,EAAG;MAChC,OAAO,IAAI,CAAClB,aAAa;IAC3B;EACF,CAAC,EAAE;IACDxG,GAAG,EAAE,iBAAiB;IACtBC,KAAK,EAAE,SAAS0H,eAAeA,CAACC,QAAQ,EAAE;MACxC,IAAI,CAACtI,qBAAqB,GAAGsI,QAAQ;IACvC;EACF,CAAC,EAAE;IACD5H,GAAG,EAAE,cAAc;IACnBC,KAAK,EAAE,SAASsH,YAAYA,CAAA,EAAG;MAC7B,IAAIM,sBAAsB;MAC1B;MACA,IAAIC,IAAI,GAAG,CAAC,CAACD,sBAAsB,GAAG,IAAI,CAACpJ,GAAG,CAACC,YAAY,MAAM,IAAI,IAAImJ,sBAAsB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,sBAAsB,CAAClJ,eAAe,CAAC,CAAC,KAAK,CAAC,CAAC;QACnKC,GAAG,GAAGkJ,IAAI,CAAClJ,GAAG;QACdC,IAAI,GAAGiJ,IAAI,CAACjJ,IAAI;QAChBC,GAAG,GAAGgJ,IAAI,CAAChJ,GAAG;QACdC,MAAM,GAAG+I,IAAI,CAAC/I,MAAM;QACpBC,QAAQ,GAAG8I,IAAI,CAAC9I,QAAQ;QACxBC,MAAM,GAAG6I,IAAI,CAAC7I,MAAM;QACpBC,EAAE,GAAG4I,IAAI,CAAC5I,EAAE;MACd;MACA,IAAI,CAACC,IAAI,CAAC,WAAW,CAAC;MACtB;MACA;MACA;;MAEA;MACA,IAAIC,MAAM,GAAG,IAAI,CAACX,GAAG,CAACC,YAAY,CAACW,SAAS,CAAC,CAAC;MAC9C,IAAIK,IAAI,GAAG,IAAI,CAACjB,GAAG,CAACkB,OAAO,CAAC,CAAC;MAC7B;MACA,IAAI,IAAI,CAACL,qBAAqB,EAAE;QAC9B,IAAI,CAACC,QAAQ,CAACC,iBAAiB,CAAC;UAC9BT,MAAM,EAAEA,MAAM;UACdD,GAAG,EAAEA,GAAG;UACRF,GAAG,EAAEA,GAAG;UACRa,cAAc,EAAET,QAAQ;UACxBC,MAAM,EAAEA,MAAM;UACdJ,IAAI,EAAEA,IAAI;UACVK,EAAE,EAAEA,EAAE;UACN;UACAQ,IAAI,EAAEA,IAAI,GAAG,CAAC;UACd;UACAN,MAAM,EAAEA,MAAM;UACdQ,YAAY,EAAE,CAACZ,QAAQ,CAAC,CAAC,CAAC,EAAEA,QAAQ,CAAC,CAAC,CAAC;;UAEvC;UACA;QACF,CAAC,CAAC;QACF;QACA,IAAI,CAACa,uBAAuB,CAACC,mBAAmB,CAACxE,gBAAgB,CAACyE,KAAK,CAAC;QACxE,IAAI,CAACT,qBAAqB,CAAC,IAAI,CAACC,QAAQ,CAAC;MAC3C;IACF;EACF,CAAC,EAAE;IACDS,GAAG,EAAE,MAAM;IACXC,KAAK,EAAE,SAASU,IAAIA,CAACoH,CAAC,EAAEC,CAAC,EAAE;MACzB,IAAIC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;MACdA,CAAC,CAAC,CAAC,CAAC,GAAGF,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC;MAClBC,CAAC,CAAC,CAAC,CAAC,GAAGF,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC;MAClB,OAAOC,CAAC;IACV;EACF,CAAC,CAAC,CAAC;EACH,OAAOnK,WAAW;AACpB,CAAC,CAAClC,eAAe,CAAC,CAAC,IAAI7B,MAAM,CAAC;AAC9B,SAAS+D,WAAW,IAAIoK,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}
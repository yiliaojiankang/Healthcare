{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"extent\", \"width\", \"height\"];\nimport { percentile } from \"../../utils/bandOperation/operationSchema\";\n\n/**\n * @description: 栅格数据解析\n */\n\nexport default function rasterRgb(data, cfg) {\n  var extent = cfg.extent,\n    width = cfg.width,\n    height = cfg.height,\n    options = _objectWithoutProperties(cfg, _excluded);\n  if (data.length < 3) {\n    console.warn('RGB解析需要三个波段的数据');\n  }\n  var _ref = options.bands || [0, 1, 2],\n    _ref2 = _slicedToArray(_ref, 3),\n    r = _ref2[0],\n    g = _ref2[1],\n    b = _ref2[2];\n  var bandsData = [data[r], data[g], data[b]];\n  var rgbdata = [];\n  var _ref3 = (options === null || options === void 0 ? void 0 : options.countCut) || [2, 98],\n    _ref4 = _slicedToArray(_ref3, 2),\n    low = _ref4[0],\n    high = _ref4[1];\n  var minMaxR = (options === null || options === void 0 ? void 0 : options.RMinMax) || percentile(bandsData[0], low, high);\n  var minMaxG = (options === null || options === void 0 ? void 0 : options.GMinMax) || percentile(bandsData[1], low, high);\n  var minMaxB = (options === null || options === void 0 ? void 0 : options.BMinMax) || percentile(bandsData[2], low, high);\n  for (var i = 0; i < bandsData[0].length; i++) {\n    rgbdata.push(Math.max(0, bandsData[0][i] - minMaxR[0]));\n    rgbdata.push(Math.max(0, bandsData[1][i] - minMaxG[0]));\n    rgbdata.push(Math.max(0, bandsData[2][i] - minMaxB[0]));\n  }\n  var resultData = {\n    _id: 1,\n    dataArray: [_objectSpread(_objectSpread({\n      _id: 1,\n      data: rgbdata,\n      width: width,\n      height: height,\n      rMinMax: minMaxR,\n      gMinMax: minMaxG,\n      bMinMax: minMaxB\n    }, options), {}, {\n      coordinates: [[extent[0], extent[1]], [extent[2], extent[3]]]\n    })]\n  };\n  return resultData;\n}","map":{"version":3,"names":["_objectSpread","_slicedToArray","_objectWithoutProperties","_excluded","percentile","rasterRgb","data","cfg","extent","width","height","options","length","console","warn","_ref","bands","_ref2","r","g","b","bandsData","rgbdata","_ref3","countCut","_ref4","low","high","minMaxR","RMinMax","minMaxG","GMinMax","minMaxB","BMinMax","i","push","Math","max","resultData","_id","dataArray","rMinMax","gMinMax","bMinMax","coordinates"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-source/es/parser/raster/rgb.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"extent\", \"width\", \"height\"];\nimport { percentile } from \"../../utils/bandOperation/operationSchema\";\n\n/**\n * @description: 栅格数据解析\n */\n\nexport default function rasterRgb(data, cfg) {\n  var extent = cfg.extent,\n    width = cfg.width,\n    height = cfg.height,\n    options = _objectWithoutProperties(cfg, _excluded);\n  if (data.length < 3) {\n    console.warn('RGB解析需要三个波段的数据');\n  }\n  var _ref = options.bands || [0, 1, 2],\n    _ref2 = _slicedToArray(_ref, 3),\n    r = _ref2[0],\n    g = _ref2[1],\n    b = _ref2[2];\n  var bandsData = [data[r], data[g], data[b]];\n  var rgbdata = [];\n  var _ref3 = (options === null || options === void 0 ? void 0 : options.countCut) || [2, 98],\n    _ref4 = _slicedToArray(_ref3, 2),\n    low = _ref4[0],\n    high = _ref4[1];\n  var minMaxR = (options === null || options === void 0 ? void 0 : options.RMinMax) || percentile(bandsData[0], low, high);\n  var minMaxG = (options === null || options === void 0 ? void 0 : options.GMinMax) || percentile(bandsData[1], low, high);\n  var minMaxB = (options === null || options === void 0 ? void 0 : options.BMinMax) || percentile(bandsData[2], low, high);\n  for (var i = 0; i < bandsData[0].length; i++) {\n    rgbdata.push(Math.max(0, bandsData[0][i] - minMaxR[0]));\n    rgbdata.push(Math.max(0, bandsData[1][i] - minMaxG[0]));\n    rgbdata.push(Math.max(0, bandsData[2][i] - minMaxB[0]));\n  }\n  var resultData = {\n    _id: 1,\n    dataArray: [_objectSpread(_objectSpread({\n      _id: 1,\n      data: rgbdata,\n      width: width,\n      height: height,\n      rMinMax: minMaxR,\n      gMinMax: minMaxG,\n      bMinMax: minMaxB\n    }, options), {}, {\n      coordinates: [[extent[0], extent[1]], [extent[2], extent[3]]]\n    })]\n  };\n  return resultData;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
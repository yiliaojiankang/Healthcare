{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nimport { AttributeType, gl } from '@antv/l7-core';\nimport BaseModel from \"../../core/BaseModel\";\nimport { earthTriangulation } from \"../../core/triangulation\";\n/* babel-plugin-inline-import '../shaders/base/base_frag.glsl' */\nvar baseFrag = \"uniform sampler2D u_texture;\\n\\nin vec2 v_texCoord;\\nin float v_lightWeight;\\nout vec4 outputColor;\\n\\nvoid main() {\\n    vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));\\n    color.xyz = color.xyz * v_lightWeight;\\n    outputColor = color;\\n}\\n\";\n/* babel-plugin-inline-import '../shaders/base/base_vert.glsl' */\nvar baseVert = \"// attribute vec4 a_Color;\\nlayout(location = 0) in vec3 a_Position;\\nlayout(location = 13) in vec3 a_Normal;\\nlayout(location = 14) in vec2 a_Uv;\\n\\n// attribute vec2 a_Extrude;\\n// attribute float a_Size;\\n// attribute float a_Shape;\\n\\nlayout(std140) uniform commonUniforms {\\n\\tvec4 u_sunLight: [1.0, -10.5, 12.0,0.0];\\n\\tfloat u_ambientRatio : 0.5;\\n\\tfloat u_diffuseRatio : 0.3;\\n\\tfloat u_specularRatio : 0.2;\\n};\\n\\n#pragma include \\\"scene_uniforms\\\"\\n\\nout vec2 v_texCoord;\\nout float v_lightWeight;\\n\\nfloat calc_lighting(vec4 pos) {\\n\\n\\tvec3 worldPos = vec3(pos * u_ModelMatrix);\\n\\n\\tvec3 worldNormal = a_Normal;\\n\\n\\t// cal light weight\\n\\tvec3 viewDir = normalize(u_CameraPosition - worldPos);\\n\\n\\tvec3 lightDir = normalize(u_sunLight.xyz);\\n\\n\\tvec3 halfDir = normalize(viewDir+lightDir);\\n\\t// lambert\\n\\tfloat lambert = dot(worldNormal, lightDir);\\n\\t// specular\\n\\tfloat specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\\n\\t//sum to light weight\\n\\tfloat lightWeight = u_ambientRatio + u_diffuseRatio * lambert + u_specularRatio * specular;\\n\\n\\treturn lightWeight;\\n}\\n\\nvoid main() {\\n\\n\\tv_texCoord = a_Uv;\\n\\n\\tfloat lightWeight = calc_lighting(vec4(a_Position, 1.0));\\n\\tv_lightWeight = lightWeight;\\n\\n\\tgl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);\\n}\\n\";\nimport { ShaderLocation } from \"../../core/CommonStyleAttribute\";\nvar BaseEarthModel = /*#__PURE__*/function (_BaseModel) {\n  _inherits(BaseEarthModel, _BaseModel);\n  var _super = _createSuper(BaseEarthModel);\n  function BaseEarthModel() {\n    var _this;\n    _classCallCheck(this, BaseEarthModel);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    // T: 当前的地球时间 - 控制太阳的方位\n    _defineProperty(_assertThisInitialized(_this), \"earthTime\", 3.4);\n    _defineProperty(_assertThisInitialized(_this), \"sunX\", 1000);\n    _defineProperty(_assertThisInitialized(_this), \"sunY\", 1000);\n    _defineProperty(_assertThisInitialized(_this), \"sunZ\", 1000);\n    _defineProperty(_assertThisInitialized(_this), \"sunRadius\", Math.sqrt(_this.sunX * _this.sunX + _this.sunY * _this.sunY + _this.sunZ * _this.sunZ));\n    return _this;\n  }\n  _createClass(BaseEarthModel, [{\n    key: \"getCommonUniformsInfo\",\n    value: function getCommonUniformsInfo() {\n      var _this$layer$getLayerC = this.layer.getLayerConfig(),\n        animateOption = _this$layer$getLayerC.animateOption,\n        globalOptions = _this$layer$getLayerC.globalOptions;\n      if (animateOption !== null && animateOption !== void 0 && animateOption.enable) {\n        // @ts-ignore\n        // T: rotateY 方法只有在地球模式下存在\n        this.mapService.rotateY({\n          reg: 0.002\n        });\n        this.earthTime += 0.02;\n        this.sunY = 10;\n        this.sunX = Math.cos(this.earthTime) * (this.sunRadius - this.sunY);\n        this.sunZ = Math.sin(this.earthTime) * (this.sunRadius - this.sunY);\n      }\n      var commonOptions = {\n        u_sunLight: [this.sunX, this.sunY, this.sunZ, 0.0],\n        u_ambientRatio: (globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.ambientRatio) || 0.6,\n        // 环境光\n        u_diffuseRatio: (globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.diffuseRatio) || 0.4,\n        // 漫反射\n        u_specularRatio: (globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.specularRatio) || 0.1 // 高光反射\n        // u_texture: this.texture,\n      };\n\n      this.textures = [this.texture];\n      var commonBufferInfo = this.getUniformsBufferInfo(commonOptions);\n      return commonBufferInfo;\n    }\n  }, {\n    key: \"setEarthTime\",\n    value: function setEarthTime(time) {\n      this.earthTime = time;\n      this.sunY = 10;\n      this.sunX = Math.cos(this.earthTime) * (this.sunRadius - this.sunY);\n      this.sunZ = Math.sin(this.earthTime) * (this.sunRadius - this.sunY);\n      this.layerService.throttleRenderLayers();\n    }\n  }, {\n    key: \"initModels\",\n    value: function () {\n      var _initModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n        var _this$layer$getLayerC2, globalOptions, source, createTexture2D;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this$layer$getLayerC2 = this.layer.getLayerConfig(), globalOptions = _this$layer$getLayerC2.globalOptions;\n              if ((globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.earthTime) !== undefined) {\n                this.setEarthTime(globalOptions.earthTime);\n              }\n              source = this.layer.getSource();\n              createTexture2D = this.rendererService.createTexture2D;\n              this.texture = createTexture2D({\n                height: 0,\n                width: 0\n              });\n              source.data.images.then(function (imageData) {\n                _this2.texture = createTexture2D({\n                  data: imageData[0],\n                  width: imageData[0].width,\n                  height: imageData[0].height\n                });\n                _this2.textures = [_this2.texture];\n                _this2.layerService.reRender();\n              });\n              this.initUniformsBuffer();\n              return _context.abrupt(\"return\", this.buildModels());\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function initModels() {\n        return _initModels.apply(this, arguments);\n      }\n      return initModels;\n    }()\n  }, {\n    key: \"clearModels\",\n    value: function clearModels() {\n      return '';\n    }\n  }, {\n    key: \"buildModels\",\n    value: function () {\n      var _buildModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var model;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              // Tip: 调整图层的绘制顺序 地球大气层\n              this.layer.zIndex = -998;\n              _context2.next = 3;\n              return this.layer.buildLayerModel({\n                moduleName: 'earthBase',\n                vertexShader: baseVert,\n                fragmentShader: baseFrag,\n                triangulation: earthTriangulation,\n                depth: {\n                  enable: true\n                },\n                blend: this.getBlend()\n              });\n            case 3:\n              model = _context2.sent;\n              return _context2.abrupt(\"return\", [model]);\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function buildModels() {\n        return _buildModels.apply(this, arguments);\n      }\n      return buildModels;\n    }()\n  }, {\n    key: \"registerBuiltinAttributes\",\n    value: function registerBuiltinAttributes() {\n      this.styleAttributeService.registerStyleAttribute({\n        name: 'size',\n        type: AttributeType.Attribute,\n        descriptor: {\n          name: 'a_Size',\n          shaderLocation: ShaderLocation.SIZE,\n          buffer: {\n            usage: gl.DYNAMIC_DRAW,\n            data: [],\n            type: gl.FLOAT\n          },\n          size: 1,\n          update: function update(feature) {\n            var _feature$size = feature.size,\n              size = _feature$size === void 0 ? 1 : _feature$size;\n            return Array.isArray(size) ? [size[0]] : [size];\n          }\n        }\n      });\n      this.styleAttributeService.registerStyleAttribute({\n        name: 'normal',\n        type: AttributeType.Attribute,\n        descriptor: {\n          name: 'a_Normal',\n          shaderLocation: ShaderLocation.NORMAL,\n          buffer: {\n            usage: gl.STATIC_DRAW,\n            data: [],\n            type: gl.FLOAT\n          },\n          size: 3,\n          update: function update(feature, featureIdx, vertex, attributeIdx, normal) {\n            return normal;\n          }\n        }\n      });\n      this.styleAttributeService.registerStyleAttribute({\n        name: 'uv',\n        type: AttributeType.Attribute,\n        descriptor: {\n          name: 'a_Uv',\n          shaderLocation: ShaderLocation.UV,\n          buffer: {\n            // give the WebGL driver a hint that this buffer may change\n            usage: gl.DYNAMIC_DRAW,\n            data: [],\n            type: gl.FLOAT\n          },\n          size: 2,\n          update: function update(feature, featureIdx, vertex) {\n            return [vertex[3], vertex[4]];\n          }\n        }\n      });\n    }\n  }]);\n  return BaseEarthModel;\n}(BaseModel);\nexport { BaseEarthModel as default };","map":{"version":3,"names":["_asyncToGenerator","_classCallCheck","_createClass","_assertThisInitialized","_inherits","_possibleConstructorReturn","_getPrototypeOf","_defineProperty","_regeneratorRuntime","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","arguments","apply","sham","Proxy","Boolean","prototype","valueOf","call","e","AttributeType","gl","BaseModel","earthTriangulation","baseFrag","baseVert","ShaderLocation","BaseEarthModel","_BaseModel","_super","_this","_len","length","args","Array","_key","concat","Math","sqrt","sunX","sunY","sunZ","key","value","getCommonUniformsInfo","_this$layer$getLayerC","layer","getLayerConfig","animateOption","globalOptions","enable","mapService","rotateY","reg","earthTime","cos","sunRadius","sin","commonOptions","u_sunLight","u_ambientRatio","ambientRatio","u_diffuseRatio","diffuseRatio","u_specularRatio","specularRatio","textures","texture","commonBufferInfo","getUniformsBufferInfo","setEarthTime","time","layerService","throttleRenderLayers","_initModels","mark","_callee","_this2","_this$layer$getLayerC2","source","createTexture2D","wrap","_callee$","_context","prev","next","undefined","getSource","rendererService","height","width","data","images","then","imageData","reRender","initUniformsBuffer","abrupt","buildModels","stop","initModels","clearModels","_buildModels","_callee2","model","_callee2$","_context2","zIndex","buildLayerModel","moduleName","vertexShader","fragmentShader","triangulation","depth","blend","getBlend","sent","registerBuiltinAttributes","styleAttributeService","registerStyleAttribute","name","type","Attribute","descriptor","shaderLocation","SIZE","buffer","usage","DYNAMIC_DRAW","FLOAT","size","update","feature","_feature$size","isArray","NORMAL","STATIC_DRAW","featureIdx","vertex","attributeIdx","normal","UV","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-layers/es/earth/models/base.js"],"sourcesContent":["import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport { AttributeType, gl } from '@antv/l7-core';\nimport BaseModel from \"../../core/BaseModel\";\nimport { earthTriangulation } from \"../../core/triangulation\";\n/* babel-plugin-inline-import '../shaders/base/base_frag.glsl' */\nvar baseFrag = \"uniform sampler2D u_texture;\\n\\nin vec2 v_texCoord;\\nin float v_lightWeight;\\nout vec4 outputColor;\\n\\nvoid main() {\\n    vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));\\n    color.xyz = color.xyz * v_lightWeight;\\n    outputColor = color;\\n}\\n\";\n/* babel-plugin-inline-import '../shaders/base/base_vert.glsl' */\nvar baseVert = \"// attribute vec4 a_Color;\\nlayout(location = 0) in vec3 a_Position;\\nlayout(location = 13) in vec3 a_Normal;\\nlayout(location = 14) in vec2 a_Uv;\\n\\n// attribute vec2 a_Extrude;\\n// attribute float a_Size;\\n// attribute float a_Shape;\\n\\nlayout(std140) uniform commonUniforms {\\n\\tvec4 u_sunLight: [1.0, -10.5, 12.0,0.0];\\n\\tfloat u_ambientRatio : 0.5;\\n\\tfloat u_diffuseRatio : 0.3;\\n\\tfloat u_specularRatio : 0.2;\\n};\\n\\n#pragma include \\\"scene_uniforms\\\"\\n\\nout vec2 v_texCoord;\\nout float v_lightWeight;\\n\\nfloat calc_lighting(vec4 pos) {\\n\\n\\tvec3 worldPos = vec3(pos * u_ModelMatrix);\\n\\n\\tvec3 worldNormal = a_Normal;\\n\\n\\t// cal light weight\\n\\tvec3 viewDir = normalize(u_CameraPosition - worldPos);\\n\\n\\tvec3 lightDir = normalize(u_sunLight.xyz);\\n\\n\\tvec3 halfDir = normalize(viewDir+lightDir);\\n\\t// lambert\\n\\tfloat lambert = dot(worldNormal, lightDir);\\n\\t// specular\\n\\tfloat specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\\n\\t//sum to light weight\\n\\tfloat lightWeight = u_ambientRatio + u_diffuseRatio * lambert + u_specularRatio * specular;\\n\\n\\treturn lightWeight;\\n}\\n\\nvoid main() {\\n\\n\\tv_texCoord = a_Uv;\\n\\n\\tfloat lightWeight = calc_lighting(vec4(a_Position, 1.0));\\n\\tv_lightWeight = lightWeight;\\n\\n\\tgl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);\\n}\\n\";\nimport { ShaderLocation } from \"../../core/CommonStyleAttribute\";\nvar BaseEarthModel = /*#__PURE__*/function (_BaseModel) {\n  _inherits(BaseEarthModel, _BaseModel);\n  var _super = _createSuper(BaseEarthModel);\n  function BaseEarthModel() {\n    var _this;\n    _classCallCheck(this, BaseEarthModel);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    // T: 当前的地球时间 - 控制太阳的方位\n    _defineProperty(_assertThisInitialized(_this), \"earthTime\", 3.4);\n    _defineProperty(_assertThisInitialized(_this), \"sunX\", 1000);\n    _defineProperty(_assertThisInitialized(_this), \"sunY\", 1000);\n    _defineProperty(_assertThisInitialized(_this), \"sunZ\", 1000);\n    _defineProperty(_assertThisInitialized(_this), \"sunRadius\", Math.sqrt(_this.sunX * _this.sunX + _this.sunY * _this.sunY + _this.sunZ * _this.sunZ));\n    return _this;\n  }\n  _createClass(BaseEarthModel, [{\n    key: \"getCommonUniformsInfo\",\n    value: function getCommonUniformsInfo() {\n      var _this$layer$getLayerC = this.layer.getLayerConfig(),\n        animateOption = _this$layer$getLayerC.animateOption,\n        globalOptions = _this$layer$getLayerC.globalOptions;\n      if (animateOption !== null && animateOption !== void 0 && animateOption.enable) {\n        // @ts-ignore\n        // T: rotateY 方法只有在地球模式下存在\n        this.mapService.rotateY({\n          reg: 0.002\n        });\n        this.earthTime += 0.02;\n        this.sunY = 10;\n        this.sunX = Math.cos(this.earthTime) * (this.sunRadius - this.sunY);\n        this.sunZ = Math.sin(this.earthTime) * (this.sunRadius - this.sunY);\n      }\n      var commonOptions = {\n        u_sunLight: [this.sunX, this.sunY, this.sunZ, 0.0],\n        u_ambientRatio: (globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.ambientRatio) || 0.6,\n        // 环境光\n        u_diffuseRatio: (globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.diffuseRatio) || 0.4,\n        // 漫反射\n        u_specularRatio: (globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.specularRatio) || 0.1 // 高光反射\n        // u_texture: this.texture,\n      };\n\n      this.textures = [this.texture];\n      var commonBufferInfo = this.getUniformsBufferInfo(commonOptions);\n      return commonBufferInfo;\n    }\n  }, {\n    key: \"setEarthTime\",\n    value: function setEarthTime(time) {\n      this.earthTime = time;\n      this.sunY = 10;\n      this.sunX = Math.cos(this.earthTime) * (this.sunRadius - this.sunY);\n      this.sunZ = Math.sin(this.earthTime) * (this.sunRadius - this.sunY);\n      this.layerService.throttleRenderLayers();\n    }\n  }, {\n    key: \"initModels\",\n    value: function () {\n      var _initModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n        var _this$layer$getLayerC2, globalOptions, source, createTexture2D;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this$layer$getLayerC2 = this.layer.getLayerConfig(), globalOptions = _this$layer$getLayerC2.globalOptions;\n              if ((globalOptions === null || globalOptions === void 0 ? void 0 : globalOptions.earthTime) !== undefined) {\n                this.setEarthTime(globalOptions.earthTime);\n              }\n              source = this.layer.getSource();\n              createTexture2D = this.rendererService.createTexture2D;\n              this.texture = createTexture2D({\n                height: 0,\n                width: 0\n              });\n              source.data.images.then(function (imageData) {\n                _this2.texture = createTexture2D({\n                  data: imageData[0],\n                  width: imageData[0].width,\n                  height: imageData[0].height\n                });\n                _this2.textures = [_this2.texture];\n                _this2.layerService.reRender();\n              });\n              this.initUniformsBuffer();\n              return _context.abrupt(\"return\", this.buildModels());\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function initModels() {\n        return _initModels.apply(this, arguments);\n      }\n      return initModels;\n    }()\n  }, {\n    key: \"clearModels\",\n    value: function clearModels() {\n      return '';\n    }\n  }, {\n    key: \"buildModels\",\n    value: function () {\n      var _buildModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var model;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              // Tip: 调整图层的绘制顺序 地球大气层\n              this.layer.zIndex = -998;\n              _context2.next = 3;\n              return this.layer.buildLayerModel({\n                moduleName: 'earthBase',\n                vertexShader: baseVert,\n                fragmentShader: baseFrag,\n                triangulation: earthTriangulation,\n                depth: {\n                  enable: true\n                },\n                blend: this.getBlend()\n              });\n            case 3:\n              model = _context2.sent;\n              return _context2.abrupt(\"return\", [model]);\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function buildModels() {\n        return _buildModels.apply(this, arguments);\n      }\n      return buildModels;\n    }()\n  }, {\n    key: \"registerBuiltinAttributes\",\n    value: function registerBuiltinAttributes() {\n      this.styleAttributeService.registerStyleAttribute({\n        name: 'size',\n        type: AttributeType.Attribute,\n        descriptor: {\n          name: 'a_Size',\n          shaderLocation: ShaderLocation.SIZE,\n          buffer: {\n            usage: gl.DYNAMIC_DRAW,\n            data: [],\n            type: gl.FLOAT\n          },\n          size: 1,\n          update: function update(feature) {\n            var _feature$size = feature.size,\n              size = _feature$size === void 0 ? 1 : _feature$size;\n            return Array.isArray(size) ? [size[0]] : [size];\n          }\n        }\n      });\n      this.styleAttributeService.registerStyleAttribute({\n        name: 'normal',\n        type: AttributeType.Attribute,\n        descriptor: {\n          name: 'a_Normal',\n          shaderLocation: ShaderLocation.NORMAL,\n          buffer: {\n            usage: gl.STATIC_DRAW,\n            data: [],\n            type: gl.FLOAT\n          },\n          size: 3,\n          update: function update(feature, featureIdx, vertex, attributeIdx, normal) {\n            return normal;\n          }\n        }\n      });\n      this.styleAttributeService.registerStyleAttribute({\n        name: 'uv',\n        type: AttributeType.Attribute,\n        descriptor: {\n          name: 'a_Uv',\n          shaderLocation: ShaderLocation.UV,\n          buffer: {\n            // give the WebGL driver a hint that this buffer may change\n            usage: gl.DYNAMIC_DRAW,\n            data: [],\n            type: gl.FLOAT\n          },\n          size: 2,\n          update: function update(feature, featureIdx, vertex) {\n            return [vertex[3], vertex[4]];\n          }\n        }\n      });\n    }\n  }]);\n  return BaseEarthModel;\n}(BaseModel);\nexport { BaseEarthModel as default };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"// calculate simplification data using optimized Douglas-Peucker algorithm\n\nexport default function simplify(coords, first, last, sqTolerance) {\n  var maxSqDist = sqTolerance;\n  var mid = last - first >> 1;\n  var minPosToMid = last - first;\n  var index;\n  var ax = coords[first];\n  var ay = coords[first + 1];\n  var bx = coords[last];\n  var by = coords[last + 1];\n  for (var i = first + 3; i < last; i += 3) {\n    var d = getSqSegDist(coords[i], coords[i + 1], ax, ay, bx, by);\n    if (d > maxSqDist) {\n      index = i;\n      maxSqDist = d;\n    } else if (d === maxSqDist) {\n      // a workaround to ensure we choose a pivot close to the middle of the list,\n      // reducing recursion depth, for certain degenerate inputs\n      // https://github.com/mapbox/geojson-vt/issues/104\n      var posToMid = Math.abs(i - mid);\n      if (posToMid < minPosToMid) {\n        index = i;\n        minPosToMid = posToMid;\n      }\n    }\n  }\n  if (maxSqDist > sqTolerance) {\n    if (index - first > 3) simplify(coords, first, index, sqTolerance);\n    coords[index + 2] = maxSqDist;\n    if (last - index > 3) simplify(coords, index, last, sqTolerance);\n  }\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(px, py, x, y, bx, by) {\n  var dx = bx - x;\n  var dy = by - y;\n  if (dx !== 0 || dy !== 0) {\n    var t = ((px - x) * dx + (py - y) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      x = bx;\n      y = by;\n    } else if (t > 0) {\n      x += dx * t;\n      y += dy * t;\n    }\n  }\n  dx = px - x;\n  dy = py - y;\n  return dx * dx + dy * dy;\n}","map":{"version":3,"names":["simplify","coords","first","last","sqTolerance","maxSqDist","mid","minPosToMid","index","ax","ay","bx","by","i","d","getSqSegDist","posToMid","Math","abs","px","py","x","y","dx","dy","t"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/geojson-vt/src/simplify.js"],"sourcesContent":["\n// calculate simplification data using optimized Douglas-Peucker algorithm\n\nexport default function simplify(coords, first, last, sqTolerance) {\n    var maxSqDist = sqTolerance;\n    var mid = (last - first) >> 1;\n    var minPosToMid = last - first;\n    var index;\n\n    var ax = coords[first];\n    var ay = coords[first + 1];\n    var bx = coords[last];\n    var by = coords[last + 1];\n\n    for (var i = first + 3; i < last; i += 3) {\n        var d = getSqSegDist(coords[i], coords[i + 1], ax, ay, bx, by);\n\n        if (d > maxSqDist) {\n            index = i;\n            maxSqDist = d;\n\n        } else if (d === maxSqDist) {\n            // a workaround to ensure we choose a pivot close to the middle of the list,\n            // reducing recursion depth, for certain degenerate inputs\n            // https://github.com/mapbox/geojson-vt/issues/104\n            var posToMid = Math.abs(i - mid);\n            if (posToMid < minPosToMid) {\n                index = i;\n                minPosToMid = posToMid;\n            }\n        }\n    }\n\n    if (maxSqDist > sqTolerance) {\n        if (index - first > 3) simplify(coords, first, index, sqTolerance);\n        coords[index + 2] = maxSqDist;\n        if (last - index > 3) simplify(coords, index, last, sqTolerance);\n    }\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(px, py, x, y, bx, by) {\n\n    var dx = bx - x;\n    var dy = by - y;\n\n    if (dx !== 0 || dy !== 0) {\n\n        var t = ((px - x) * dx + (py - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n            x = bx;\n            y = by;\n\n        } else if (t > 0) {\n            x += dx * t;\n            y += dy * t;\n        }\n    }\n\n    dx = px - x;\n    dy = py - y;\n\n    return dx * dx + dy * dy;\n}\n"],"mappings":"AACA;;AAEA,eAAe,SAASA,QAAQA,CAACC,MAAM,EAAEC,KAAK,EAAEC,IAAI,EAAEC,WAAW,EAAE;EAC/D,IAAIC,SAAS,GAAGD,WAAW;EAC3B,IAAIE,GAAG,GAAIH,IAAI,GAAGD,KAAK,IAAK,CAAC;EAC7B,IAAIK,WAAW,GAAGJ,IAAI,GAAGD,KAAK;EAC9B,IAAIM,KAAK;EAET,IAAIC,EAAE,GAAGR,MAAM,CAACC,KAAK,CAAC;EACtB,IAAIQ,EAAE,GAAGT,MAAM,CAACC,KAAK,GAAG,CAAC,CAAC;EAC1B,IAAIS,EAAE,GAAGV,MAAM,CAACE,IAAI,CAAC;EACrB,IAAIS,EAAE,GAAGX,MAAM,CAACE,IAAI,GAAG,CAAC,CAAC;EAEzB,KAAK,IAAIU,CAAC,GAAGX,KAAK,GAAG,CAAC,EAAEW,CAAC,GAAGV,IAAI,EAAEU,CAAC,IAAI,CAAC,EAAE;IACtC,IAAIC,CAAC,GAAGC,YAAY,CAACd,MAAM,CAACY,CAAC,CAAC,EAAEZ,MAAM,CAACY,CAAC,GAAG,CAAC,CAAC,EAAEJ,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,CAAC;IAE9D,IAAIE,CAAC,GAAGT,SAAS,EAAE;MACfG,KAAK,GAAGK,CAAC;MACTR,SAAS,GAAGS,CAAC;IAEjB,CAAC,MAAM,IAAIA,CAAC,KAAKT,SAAS,EAAE;MACxB;MACA;MACA;MACA,IAAIW,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAACL,CAAC,GAAGP,GAAG,CAAC;MAChC,IAAIU,QAAQ,GAAGT,WAAW,EAAE;QACxBC,KAAK,GAAGK,CAAC;QACTN,WAAW,GAAGS,QAAQ;MAC1B;IACJ;EACJ;EAEA,IAAIX,SAAS,GAAGD,WAAW,EAAE;IACzB,IAAII,KAAK,GAAGN,KAAK,GAAG,CAAC,EAAEF,QAAQ,CAACC,MAAM,EAAEC,KAAK,EAAEM,KAAK,EAAEJ,WAAW,CAAC;IAClEH,MAAM,CAACO,KAAK,GAAG,CAAC,CAAC,GAAGH,SAAS;IAC7B,IAAIF,IAAI,GAAGK,KAAK,GAAG,CAAC,EAAER,QAAQ,CAACC,MAAM,EAAEO,KAAK,EAAEL,IAAI,EAAEC,WAAW,CAAC;EACpE;AACJ;;AAEA;AACA,SAASW,YAAYA,CAACI,EAAE,EAAEC,EAAE,EAAEC,CAAC,EAAEC,CAAC,EAAEX,EAAE,EAAEC,EAAE,EAAE;EAExC,IAAIW,EAAE,GAAGZ,EAAE,GAAGU,CAAC;EACf,IAAIG,EAAE,GAAGZ,EAAE,GAAGU,CAAC;EAEf,IAAIC,EAAE,KAAK,CAAC,IAAIC,EAAE,KAAK,CAAC,EAAE;IAEtB,IAAIC,CAAC,GAAG,CAAC,CAACN,EAAE,GAAGE,CAAC,IAAIE,EAAE,GAAG,CAACH,EAAE,GAAGE,CAAC,IAAIE,EAAE,KAAKD,EAAE,GAAGA,EAAE,GAAGC,EAAE,GAAGA,EAAE,CAAC;IAE7D,IAAIC,CAAC,GAAG,CAAC,EAAE;MACPJ,CAAC,GAAGV,EAAE;MACNW,CAAC,GAAGV,EAAE;IAEV,CAAC,MAAM,IAAIa,CAAC,GAAG,CAAC,EAAE;MACdJ,CAAC,IAAIE,EAAE,GAAGE,CAAC;MACXH,CAAC,IAAIE,EAAE,GAAGC,CAAC;IACf;EACJ;EAEAF,EAAE,GAAGJ,EAAE,GAAGE,CAAC;EACXG,EAAE,GAAGJ,EAAE,GAAGE,CAAC;EAEX,OAAOC,EAAE,GAAGA,EAAE,GAAGC,EAAE,GAAGA,EAAE;AAC5B"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { ClipSpaceNearZ, preprocessShader_GLSL, ViewportOrigin } from '@antv/g-device-api';\nimport { gl, removeDuplicateUniforms } from '@antv/l7-core';\nimport { lodashUtil } from '@antv/l7-utils';\nimport { blendEquationMap, blendFuncMap, cullFaceMap, depthFuncMap, primitiveMap, stencilFuncMap, stencilOpMap } from \"./constants\";\nvar isPlainObject = lodashUtil.isPlainObject,\n  isTypedArray = lodashUtil.isTypedArray;\n\n/**\n * adaptor for regl.DrawCommand\n */\nvar ReglModel = /*#__PURE__*/function () {\n  function ReglModel(reGl, options) {\n    _classCallCheck(this, ReglModel);\n    _defineProperty(this, \"destroyed\", false);\n    _defineProperty(this, \"uniforms\", {});\n    this.reGl = reGl;\n    var vs = options.vs,\n      fs = options.fs,\n      attributes = options.attributes,\n      uniforms = options.uniforms,\n      primitive = options.primitive,\n      count = options.count,\n      elements = options.elements,\n      depth = options.depth,\n      cull = options.cull,\n      instances = options.instances;\n\n    /**\n     * try to compile GLSL 300 to 100\n     */\n    var vendorInfo = {\n      platformString: 'WebGL1',\n      glslVersion: '#version 100',\n      explicitBindingLocations: false,\n      separateSamplerTextures: false,\n      viewportOrigin: ViewportOrigin.LOWER_LEFT,\n      clipSpaceNearZ: ClipSpaceNearZ.NEGATIVE_ONE,\n      supportMRT: false\n    };\n    var reglUniforms = {};\n    this.options = options;\n    if (uniforms) {\n      this.uniforms = this.extractUniforms(uniforms);\n      Object.keys(uniforms).forEach(function (uniformName) {\n        // use regl prop API\n        // @ts-ignore\n        reglUniforms[uniformName] = reGl.prop(uniformName);\n      });\n    }\n    var reglAttributes = {};\n    Object.keys(attributes).forEach(function (name) {\n      reglAttributes[name] = attributes[name].get();\n    });\n    var frag = removeDuplicateUniforms(preprocessShader_GLSL(vendorInfo, 'frag', fs, null, false));\n    var vert = removeDuplicateUniforms(preprocessShader_GLSL(vendorInfo, 'vert', vs, null, false));\n    var drawParams = {\n      attributes: reglAttributes,\n      frag: frag,\n      uniforms: reglUniforms,\n      vert: vert,\n      // @ts-ignore\n      colorMask: reGl.prop('colorMask'),\n      lineWidth: 1,\n      blend: {\n        // @ts-ignore\n        enable: reGl.prop('blend.enable'),\n        // @ts-ignore\n        func: reGl.prop('blend.func'),\n        // @ts-ignore\n        equation: reGl.prop('blend.equation'),\n        // @ts-ignore\n        color: reGl.prop('blend.color')\n      },\n      stencil: {\n        // @ts-ignore\n        enable: reGl.prop('stencil.enable'),\n        // @ts-ignore\n        mask: reGl.prop('stencil.mask'),\n        // @ts-ignore\n        func: reGl.prop('stencil.func'),\n        // @ts-ignore\n        opFront: reGl.prop('stencil.opFront'),\n        // @ts-ignore\n        opBack: reGl.prop('stencil.opBack')\n      },\n      primitive: primitiveMap[primitive === undefined ? gl.TRIANGLES : primitive]\n    };\n    if (instances) {\n      drawParams.instances = instances;\n    }\n\n    // Tip:\n    // elements 中可能包含 count，此时不应传入\n    // count 和 elements 相比、count 优先\n    if (count) {\n      drawParams.count = count;\n    } else if (elements) {\n      drawParams.elements = elements.get();\n    }\n    this.initDepthDrawParams({\n      depth: depth\n    }, drawParams);\n    // this.initBlendDrawParams({ blend }, drawParams);\n    // this.initStencilDrawParams({ stencil }, drawParams);\n    this.initCullDrawParams({\n      cull: cull\n    }, drawParams);\n    this.drawCommand = reGl(drawParams);\n    this.drawParams = drawParams;\n  }\n  _createClass(ReglModel, [{\n    key: \"updateAttributesAndElements\",\n    value: function updateAttributesAndElements(attributes, elements) {\n      var reglAttributes = {};\n      Object.keys(attributes).forEach(function (name) {\n        reglAttributes[name] = attributes[name].get();\n      });\n      this.drawParams.attributes = reglAttributes;\n      this.drawParams.elements = elements.get();\n      this.drawCommand = this.reGl(this.drawParams);\n    }\n  }, {\n    key: \"updateAttributes\",\n    value: function updateAttributes(attributes) {\n      var reglAttributes = {};\n      Object.keys(attributes).forEach(function (name) {\n        reglAttributes[name] = attributes[name].get();\n      });\n      this.drawParams.attributes = reglAttributes;\n      this.drawCommand = this.reGl(this.drawParams);\n    }\n  }, {\n    key: \"addUniforms\",\n    value: function addUniforms(uniforms) {\n      this.uniforms = _objectSpread(_objectSpread({}, this.uniforms), this.extractUniforms(uniforms));\n    }\n  }, {\n    key: \"draw\",\n    value: function draw(options, pick) {\n      if (this.drawParams.attributes && Object.keys(this.drawParams.attributes).length === 0) {\n        return;\n      }\n      var uniforms = _objectSpread(_objectSpread({}, this.uniforms), this.extractUniforms(options.uniforms || {}));\n      var reglDrawProps = {};\n      Object.keys(uniforms).forEach(function (uniformName) {\n        var type = _typeof(uniforms[uniformName]);\n        if (type === 'boolean' || type === 'number' || Array.isArray(uniforms[uniformName]) ||\n        // @ts-ignore\n        uniforms[uniformName].BYTES_PER_ELEMENT) {\n          reglDrawProps[uniformName] = uniforms[uniformName];\n        } else {\n          reglDrawProps[uniformName] = uniforms[uniformName].get();\n        }\n      });\n      // 更新 blend\n      // @ts-ignore\n      reglDrawProps.blend = pick // picking 操作不应该使用 blend\n      ? this.getBlendDrawParams({\n        blend: {\n          enable: false\n        }\n      }) : this.getBlendDrawParams(options);\n\n      // 更新stentil 配置\n      // @ts-ignore\n      reglDrawProps.stencil = this.getStencilDrawParams(options);\n      // @ts-ignore\n      reglDrawProps.colorMask = this.getColorMaskDrawParams(options, pick);\n\n      // 在进行拾取操作的绘制中，不应该使用叠加模式 - picking 根据拾取的颜色作为判断的输入，而叠加模式会产生新的，在 id 序列中不存在的颜色\n      this.drawCommand(reglDrawProps);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var _this$drawParams;\n      // @ts-ignore\n      (_this$drawParams = this.drawParams) === null || _this$drawParams === void 0 || (_this$drawParams = _this$drawParams.elements) === null || _this$drawParams === void 0 || _this$drawParams.destroy();\n      if (this.options.attributes) {\n        Object.values(this.options.attributes).forEach(function (attr) {\n          // @ts-ignore\n          attr === null || attr === void 0 || attr.destroy();\n        });\n      }\n      this.destroyed = true;\n    }\n\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#depth-buffer\n     */\n  }, {\n    key: \"initDepthDrawParams\",\n    value: function initDepthDrawParams(_ref, drawParams) {\n      var depth = _ref.depth;\n      if (depth) {\n        drawParams.depth = {\n          enable: depth.enable === undefined ? true : !!depth.enable,\n          mask: depth.mask === undefined ? true : !!depth.mask,\n          func: depthFuncMap[depth.func || gl.LESS],\n          range: depth.range || [0, 1]\n        };\n      }\n    }\n  }, {\n    key: \"getBlendDrawParams\",\n    value: function getBlendDrawParams(_ref2) {\n      var blend = _ref2.blend;\n      var _ref3 = blend || {},\n        enable = _ref3.enable,\n        func = _ref3.func,\n        equation = _ref3.equation,\n        _ref3$color = _ref3.color,\n        color = _ref3$color === void 0 ? [0, 0, 0, 0] : _ref3$color;\n      // @ts-ignore\n      return {\n        enable: !!enable,\n        func: {\n          srcRGB: blendFuncMap[func && func.srcRGB || gl.SRC_ALPHA],\n          srcAlpha: blendFuncMap[func && func.srcAlpha || gl.SRC_ALPHA],\n          dstRGB: blendFuncMap[func && func.dstRGB || gl.ONE_MINUS_SRC_ALPHA],\n          dstAlpha: blendFuncMap[func && func.dstAlpha || gl.ONE_MINUS_SRC_ALPHA]\n        },\n        equation: {\n          rgb: blendEquationMap[equation && equation.rgb || gl.FUNC_ADD],\n          alpha: blendEquationMap[equation && equation.alpha || gl.FUNC_ADD]\n        },\n        color: color\n      };\n    }\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#stencil\n     */\n  }, {\n    key: \"getStencilDrawParams\",\n    value: function getStencilDrawParams(_ref4) {\n      var stencil = _ref4.stencil;\n      var _ref5 = stencil || {},\n        enable = _ref5.enable,\n        _ref5$mask = _ref5.mask,\n        mask = _ref5$mask === void 0 ? -1 : _ref5$mask,\n        _ref5$func = _ref5.func,\n        func = _ref5$func === void 0 ? {\n          cmp: gl.ALWAYS,\n          ref: 0,\n          mask: -1\n        } : _ref5$func,\n        _ref5$opFront = _ref5.opFront,\n        opFront = _ref5$opFront === void 0 ? {\n          fail: gl.KEEP,\n          zfail: gl.KEEP,\n          zpass: gl.KEEP\n        } : _ref5$opFront,\n        _ref5$opBack = _ref5.opBack,\n        opBack = _ref5$opBack === void 0 ? {\n          fail: gl.KEEP,\n          zfail: gl.KEEP,\n          zpass: gl.KEEP\n        } : _ref5$opBack;\n      return {\n        enable: !!enable,\n        mask: mask,\n        func: _objectSpread(_objectSpread({}, func), {}, {\n          cmp: stencilFuncMap[func.cmp]\n        }),\n        opFront: {\n          fail: stencilOpMap[opFront.fail],\n          zfail: stencilOpMap[opFront.zfail],\n          zpass: stencilOpMap[opFront.zpass]\n        },\n        opBack: {\n          fail: stencilOpMap[opBack.fail],\n          zfail: stencilOpMap[opBack.zfail],\n          zpass: stencilOpMap[opBack.zpass]\n        }\n      };\n    }\n  }, {\n    key: \"getColorMaskDrawParams\",\n    value: function getColorMaskDrawParams(_ref6, pick) {\n      var stencil = _ref6.stencil;\n      // TODO: 重构相关参数\n      // 掩膜模式下，颜色通道全部关闭\n      var colorMask = stencil !== null && stencil !== void 0 && stencil.enable && stencil.opFront && !pick ? [false, false, false, false] : [true, true, true, true]; // 非掩码模式下，颜色通道全部开启\n      return colorMask;\n    }\n\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#culling\n     */\n  }, {\n    key: \"initCullDrawParams\",\n    value: function initCullDrawParams(_ref7, drawParams) {\n      var cull = _ref7.cull;\n      if (cull) {\n        var enable = cull.enable,\n          _cull$face = cull.face,\n          face = _cull$face === void 0 ? gl.BACK : _cull$face;\n        drawParams.cull = {\n          enable: !!enable,\n          face: cullFaceMap[face]\n        };\n      }\n    }\n\n    /**\n     * 考虑结构体命名, eg:\n     * a: { b: 1 }  ->  'a.b'\n     * a: [ { b: 1 } ] -> 'a[0].b'\n     */\n  }, {\n    key: \"extractUniforms\",\n    value: function extractUniforms(uniforms) {\n      var _this = this;\n      var extractedUniforms = {};\n      Object.keys(uniforms).forEach(function (uniformName) {\n        _this.extractUniformsRecursively(uniformName, uniforms[uniformName], extractedUniforms, '');\n      });\n      return extractedUniforms;\n    }\n  }, {\n    key: \"extractUniformsRecursively\",\n    value: function extractUniformsRecursively(uniformName, uniformValue, uniforms, prefix) {\n      var _this2 = this;\n      if (uniformValue === null || typeof uniformValue === 'number' ||\n      // u_A: 1\n      typeof uniformValue === 'boolean' ||\n      // u_A: false\n      Array.isArray(uniformValue) && typeof uniformValue[0] === 'number' ||\n      // u_A: [1, 2, 3]\n      isTypedArray(uniformValue) ||\n      // u_A: Float32Array\n      // @ts-ignore\n      uniformValue === '' || 'resize' in uniformValue) {\n        uniforms[\"\".concat(prefix && prefix + '.').concat(uniformName)] = uniformValue;\n        return;\n      }\n\n      // u_Struct.a.b.c\n      if (isPlainObject(uniformValue)) {\n        Object.keys(uniformValue).forEach(function (childName) {\n          _this2.extractUniformsRecursively(childName,\n          // @ts-ignore\n          uniformValue[childName], uniforms, \"\".concat(prefix && prefix + '.').concat(uniformName));\n        });\n      }\n\n      // u_Struct[0].a\n      if (Array.isArray(uniformValue)) {\n        uniformValue.forEach(function (child, idx) {\n          Object.keys(child).forEach(function (childName) {\n            _this2.extractUniformsRecursively(childName,\n            // @ts-ignore\n            child[childName], uniforms, \"\".concat(prefix && prefix + '.').concat(uniformName, \"[\").concat(idx, \"]\"));\n          });\n        });\n      }\n    }\n  }]);\n  return ReglModel;\n}();\nexport { ReglModel as default };","map":{"version":3,"names":["_typeof","_objectSpread","_classCallCheck","_createClass","_defineProperty","ClipSpaceNearZ","preprocessShader_GLSL","ViewportOrigin","gl","removeDuplicateUniforms","lodashUtil","blendEquationMap","blendFuncMap","cullFaceMap","depthFuncMap","primitiveMap","stencilFuncMap","stencilOpMap","isPlainObject","isTypedArray","ReglModel","reGl","options","vs","fs","attributes","uniforms","primitive","count","elements","depth","cull","instances","vendorInfo","platformString","glslVersion","explicitBindingLocations","separateSamplerTextures","viewportOrigin","LOWER_LEFT","clipSpaceNearZ","NEGATIVE_ONE","supportMRT","reglUniforms","extractUniforms","Object","keys","forEach","uniformName","prop","reglAttributes","name","get","frag","vert","drawParams","colorMask","lineWidth","blend","enable","func","equation","color","stencil","mask","opFront","opBack","undefined","TRIANGLES","initDepthDrawParams","initCullDrawParams","drawCommand","key","value","updateAttributesAndElements","updateAttributes","addUniforms","draw","pick","length","reglDrawProps","type","Array","isArray","BYTES_PER_ELEMENT","getBlendDrawParams","getStencilDrawParams","getColorMaskDrawParams","destroy","_this$drawParams","values","attr","destroyed","_ref","LESS","range","_ref2","_ref3","_ref3$color","srcRGB","SRC_ALPHA","srcAlpha","dstRGB","ONE_MINUS_SRC_ALPHA","dstAlpha","rgb","FUNC_ADD","alpha","_ref4","_ref5","_ref5$mask","_ref5$func","cmp","ALWAYS","ref","_ref5$opFront","fail","KEEP","zfail","zpass","_ref5$opBack","_ref6","_ref7","_cull$face","face","BACK","_this","extractedUniforms","extractUniformsRecursively","uniformValue","prefix","_this2","concat","childName","child","idx","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-renderer/es/regl/ReglModel.js"],"sourcesContent":["import _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { ClipSpaceNearZ, preprocessShader_GLSL, ViewportOrigin } from '@antv/g-device-api';\nimport { gl, removeDuplicateUniforms } from '@antv/l7-core';\nimport { lodashUtil } from '@antv/l7-utils';\nimport { blendEquationMap, blendFuncMap, cullFaceMap, depthFuncMap, primitiveMap, stencilFuncMap, stencilOpMap } from \"./constants\";\nvar isPlainObject = lodashUtil.isPlainObject,\n  isTypedArray = lodashUtil.isTypedArray;\n\n/**\n * adaptor for regl.DrawCommand\n */\nvar ReglModel = /*#__PURE__*/function () {\n  function ReglModel(reGl, options) {\n    _classCallCheck(this, ReglModel);\n    _defineProperty(this, \"destroyed\", false);\n    _defineProperty(this, \"uniforms\", {});\n    this.reGl = reGl;\n    var vs = options.vs,\n      fs = options.fs,\n      attributes = options.attributes,\n      uniforms = options.uniforms,\n      primitive = options.primitive,\n      count = options.count,\n      elements = options.elements,\n      depth = options.depth,\n      cull = options.cull,\n      instances = options.instances;\n\n    /**\n     * try to compile GLSL 300 to 100\n     */\n    var vendorInfo = {\n      platformString: 'WebGL1',\n      glslVersion: '#version 100',\n      explicitBindingLocations: false,\n      separateSamplerTextures: false,\n      viewportOrigin: ViewportOrigin.LOWER_LEFT,\n      clipSpaceNearZ: ClipSpaceNearZ.NEGATIVE_ONE,\n      supportMRT: false\n    };\n    var reglUniforms = {};\n    this.options = options;\n    if (uniforms) {\n      this.uniforms = this.extractUniforms(uniforms);\n      Object.keys(uniforms).forEach(function (uniformName) {\n        // use regl prop API\n        // @ts-ignore\n        reglUniforms[uniformName] = reGl.prop(uniformName);\n      });\n    }\n    var reglAttributes = {};\n    Object.keys(attributes).forEach(function (name) {\n      reglAttributes[name] = attributes[name].get();\n    });\n    var frag = removeDuplicateUniforms(preprocessShader_GLSL(vendorInfo, 'frag', fs, null, false));\n    var vert = removeDuplicateUniforms(preprocessShader_GLSL(vendorInfo, 'vert', vs, null, false));\n    var drawParams = {\n      attributes: reglAttributes,\n      frag: frag,\n      uniforms: reglUniforms,\n      vert: vert,\n      // @ts-ignore\n      colorMask: reGl.prop('colorMask'),\n      lineWidth: 1,\n      blend: {\n        // @ts-ignore\n        enable: reGl.prop('blend.enable'),\n        // @ts-ignore\n        func: reGl.prop('blend.func'),\n        // @ts-ignore\n        equation: reGl.prop('blend.equation'),\n        // @ts-ignore\n        color: reGl.prop('blend.color')\n      },\n      stencil: {\n        // @ts-ignore\n        enable: reGl.prop('stencil.enable'),\n        // @ts-ignore\n        mask: reGl.prop('stencil.mask'),\n        // @ts-ignore\n        func: reGl.prop('stencil.func'),\n        // @ts-ignore\n        opFront: reGl.prop('stencil.opFront'),\n        // @ts-ignore\n        opBack: reGl.prop('stencil.opBack')\n      },\n      primitive: primitiveMap[primitive === undefined ? gl.TRIANGLES : primitive]\n    };\n    if (instances) {\n      drawParams.instances = instances;\n    }\n\n    // Tip:\n    // elements 中可能包含 count，此时不应传入\n    // count 和 elements 相比、count 优先\n    if (count) {\n      drawParams.count = count;\n    } else if (elements) {\n      drawParams.elements = elements.get();\n    }\n    this.initDepthDrawParams({\n      depth: depth\n    }, drawParams);\n    // this.initBlendDrawParams({ blend }, drawParams);\n    // this.initStencilDrawParams({ stencil }, drawParams);\n    this.initCullDrawParams({\n      cull: cull\n    }, drawParams);\n    this.drawCommand = reGl(drawParams);\n    this.drawParams = drawParams;\n  }\n  _createClass(ReglModel, [{\n    key: \"updateAttributesAndElements\",\n    value: function updateAttributesAndElements(attributes, elements) {\n      var reglAttributes = {};\n      Object.keys(attributes).forEach(function (name) {\n        reglAttributes[name] = attributes[name].get();\n      });\n      this.drawParams.attributes = reglAttributes;\n      this.drawParams.elements = elements.get();\n      this.drawCommand = this.reGl(this.drawParams);\n    }\n  }, {\n    key: \"updateAttributes\",\n    value: function updateAttributes(attributes) {\n      var reglAttributes = {};\n      Object.keys(attributes).forEach(function (name) {\n        reglAttributes[name] = attributes[name].get();\n      });\n      this.drawParams.attributes = reglAttributes;\n      this.drawCommand = this.reGl(this.drawParams);\n    }\n  }, {\n    key: \"addUniforms\",\n    value: function addUniforms(uniforms) {\n      this.uniforms = _objectSpread(_objectSpread({}, this.uniforms), this.extractUniforms(uniforms));\n    }\n  }, {\n    key: \"draw\",\n    value: function draw(options, pick) {\n      if (this.drawParams.attributes && Object.keys(this.drawParams.attributes).length === 0) {\n        return;\n      }\n      var uniforms = _objectSpread(_objectSpread({}, this.uniforms), this.extractUniforms(options.uniforms || {}));\n      var reglDrawProps = {};\n      Object.keys(uniforms).forEach(function (uniformName) {\n        var type = _typeof(uniforms[uniformName]);\n        if (type === 'boolean' || type === 'number' || Array.isArray(uniforms[uniformName]) ||\n        // @ts-ignore\n        uniforms[uniformName].BYTES_PER_ELEMENT) {\n          reglDrawProps[uniformName] = uniforms[uniformName];\n        } else {\n          reglDrawProps[uniformName] = uniforms[uniformName].get();\n        }\n      });\n      // 更新 blend\n      // @ts-ignore\n      reglDrawProps.blend = pick // picking 操作不应该使用 blend\n      ? this.getBlendDrawParams({\n        blend: {\n          enable: false\n        }\n      }) : this.getBlendDrawParams(options);\n\n      // 更新stentil 配置\n      // @ts-ignore\n      reglDrawProps.stencil = this.getStencilDrawParams(options);\n      // @ts-ignore\n      reglDrawProps.colorMask = this.getColorMaskDrawParams(options, pick);\n\n      // 在进行拾取操作的绘制中，不应该使用叠加模式 - picking 根据拾取的颜色作为判断的输入，而叠加模式会产生新的，在 id 序列中不存在的颜色\n      this.drawCommand(reglDrawProps);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var _this$drawParams;\n      // @ts-ignore\n      (_this$drawParams = this.drawParams) === null || _this$drawParams === void 0 || (_this$drawParams = _this$drawParams.elements) === null || _this$drawParams === void 0 || _this$drawParams.destroy();\n      if (this.options.attributes) {\n        Object.values(this.options.attributes).forEach(function (attr) {\n          // @ts-ignore\n          attr === null || attr === void 0 || attr.destroy();\n        });\n      }\n      this.destroyed = true;\n    }\n\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#depth-buffer\n     */\n  }, {\n    key: \"initDepthDrawParams\",\n    value: function initDepthDrawParams(_ref, drawParams) {\n      var depth = _ref.depth;\n      if (depth) {\n        drawParams.depth = {\n          enable: depth.enable === undefined ? true : !!depth.enable,\n          mask: depth.mask === undefined ? true : !!depth.mask,\n          func: depthFuncMap[depth.func || gl.LESS],\n          range: depth.range || [0, 1]\n        };\n      }\n    }\n  }, {\n    key: \"getBlendDrawParams\",\n    value: function getBlendDrawParams(_ref2) {\n      var blend = _ref2.blend;\n      var _ref3 = blend || {},\n        enable = _ref3.enable,\n        func = _ref3.func,\n        equation = _ref3.equation,\n        _ref3$color = _ref3.color,\n        color = _ref3$color === void 0 ? [0, 0, 0, 0] : _ref3$color;\n      // @ts-ignore\n      return {\n        enable: !!enable,\n        func: {\n          srcRGB: blendFuncMap[func && func.srcRGB || gl.SRC_ALPHA],\n          srcAlpha: blendFuncMap[func && func.srcAlpha || gl.SRC_ALPHA],\n          dstRGB: blendFuncMap[func && func.dstRGB || gl.ONE_MINUS_SRC_ALPHA],\n          dstAlpha: blendFuncMap[func && func.dstAlpha || gl.ONE_MINUS_SRC_ALPHA]\n        },\n        equation: {\n          rgb: blendEquationMap[equation && equation.rgb || gl.FUNC_ADD],\n          alpha: blendEquationMap[equation && equation.alpha || gl.FUNC_ADD]\n        },\n        color: color\n      };\n    }\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#stencil\n     */\n  }, {\n    key: \"getStencilDrawParams\",\n    value: function getStencilDrawParams(_ref4) {\n      var stencil = _ref4.stencil;\n      var _ref5 = stencil || {},\n        enable = _ref5.enable,\n        _ref5$mask = _ref5.mask,\n        mask = _ref5$mask === void 0 ? -1 : _ref5$mask,\n        _ref5$func = _ref5.func,\n        func = _ref5$func === void 0 ? {\n          cmp: gl.ALWAYS,\n          ref: 0,\n          mask: -1\n        } : _ref5$func,\n        _ref5$opFront = _ref5.opFront,\n        opFront = _ref5$opFront === void 0 ? {\n          fail: gl.KEEP,\n          zfail: gl.KEEP,\n          zpass: gl.KEEP\n        } : _ref5$opFront,\n        _ref5$opBack = _ref5.opBack,\n        opBack = _ref5$opBack === void 0 ? {\n          fail: gl.KEEP,\n          zfail: gl.KEEP,\n          zpass: gl.KEEP\n        } : _ref5$opBack;\n      return {\n        enable: !!enable,\n        mask: mask,\n        func: _objectSpread(_objectSpread({}, func), {}, {\n          cmp: stencilFuncMap[func.cmp]\n        }),\n        opFront: {\n          fail: stencilOpMap[opFront.fail],\n          zfail: stencilOpMap[opFront.zfail],\n          zpass: stencilOpMap[opFront.zpass]\n        },\n        opBack: {\n          fail: stencilOpMap[opBack.fail],\n          zfail: stencilOpMap[opBack.zfail],\n          zpass: stencilOpMap[opBack.zpass]\n        }\n      };\n    }\n  }, {\n    key: \"getColorMaskDrawParams\",\n    value: function getColorMaskDrawParams(_ref6, pick) {\n      var stencil = _ref6.stencil;\n      // TODO: 重构相关参数\n      // 掩膜模式下，颜色通道全部关闭\n      var colorMask = stencil !== null && stencil !== void 0 && stencil.enable && stencil.opFront && !pick ? [false, false, false, false] : [true, true, true, true]; // 非掩码模式下，颜色通道全部开启\n      return colorMask;\n    }\n\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#culling\n     */\n  }, {\n    key: \"initCullDrawParams\",\n    value: function initCullDrawParams(_ref7, drawParams) {\n      var cull = _ref7.cull;\n      if (cull) {\n        var enable = cull.enable,\n          _cull$face = cull.face,\n          face = _cull$face === void 0 ? gl.BACK : _cull$face;\n        drawParams.cull = {\n          enable: !!enable,\n          face: cullFaceMap[face]\n        };\n      }\n    }\n\n    /**\n     * 考虑结构体命名, eg:\n     * a: { b: 1 }  ->  'a.b'\n     * a: [ { b: 1 } ] -> 'a[0].b'\n     */\n  }, {\n    key: \"extractUniforms\",\n    value: function extractUniforms(uniforms) {\n      var _this = this;\n      var extractedUniforms = {};\n      Object.keys(uniforms).forEach(function (uniformName) {\n        _this.extractUniformsRecursively(uniformName, uniforms[uniformName], extractedUniforms, '');\n      });\n      return extractedUniforms;\n    }\n  }, {\n    key: \"extractUniformsRecursively\",\n    value: function extractUniformsRecursively(uniformName, uniformValue, uniforms, prefix) {\n      var _this2 = this;\n      if (uniformValue === null || typeof uniformValue === 'number' ||\n      // u_A: 1\n      typeof uniformValue === 'boolean' ||\n      // u_A: false\n      Array.isArray(uniformValue) && typeof uniformValue[0] === 'number' ||\n      // u_A: [1, 2, 3]\n      isTypedArray(uniformValue) ||\n      // u_A: Float32Array\n      // @ts-ignore\n      uniformValue === '' || 'resize' in uniformValue) {\n        uniforms[\"\".concat(prefix && prefix + '.').concat(uniformName)] = uniformValue;\n        return;\n      }\n\n      // u_Struct.a.b.c\n      if (isPlainObject(uniformValue)) {\n        Object.keys(uniformValue).forEach(function (childName) {\n          _this2.extractUniformsRecursively(childName,\n          // @ts-ignore\n          uniformValue[childName], uniforms, \"\".concat(prefix && prefix + '.').concat(uniformName));\n        });\n      }\n\n      // u_Struct[0].a\n      if (Array.isArray(uniformValue)) {\n        uniformValue.forEach(function (child, idx) {\n          Object.keys(child).forEach(function (childName) {\n            _this2.extractUniformsRecursively(childName,\n            // @ts-ignore\n            child[childName], uniforms, \"\".concat(prefix && prefix + '.').concat(uniformName, \"[\").concat(idx, \"]\"));\n          });\n        });\n      }\n    }\n  }]);\n  return ReglModel;\n}();\nexport { ReglModel as default };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\nimport { deepMix, get, isArray, isEqual } from '@antv/util';\nimport { animation, interaction, scale, theme, tooltip } from '../../adaptor/common';\nimport { schema as schemaGeometry } from '../../adaptor/geometries';\nimport { deepAssign, findGeometry, flow, getAdjustAppendPadding, LEVEL, log, normalPadding, resolveAllPadding, transformLabel } from '../../utils';\nimport { ID_FIELD } from './constant';\nimport './interactions';\nimport './label';\nimport './shape';\nimport { getColorMap, islegalSets, layoutVennData } from './utils';\n/** 图例默认预留空间 */\nexport var LEGEND_SPACE = 40;\n/**\n * 获取 color 映射\n */\nfunction colorMap(params, data, colorPalette) {\n  var chart = params.chart,\n    options = params.options;\n  var blendMode = options.blendMode,\n    setsField = options.setsField;\n  var _a = chart.getTheme(),\n    colors10 = _a.colors10,\n    colors20 = _a.colors20;\n  var palette = colorPalette;\n  if (!isArray(palette)) {\n    palette = data.filter(function (d) {\n      return d[setsField].length === 1;\n    }).length <= 10 ? colors10 : colors20;\n  }\n  var map = getColorMap(palette, data, blendMode, setsField);\n  return function (id) {\n    return map.get(id) || palette[0];\n  };\n}\n/**\n * color options 转换\n */\nfunction transformColor(params, data) {\n  var options = params.options;\n  var color = options.color;\n  if (typeof color !== 'function') {\n    var colorPalette = typeof color === 'string' ? [color] : color;\n    var map_1 = colorMap(params, data, colorPalette);\n    return function (datum) {\n      return map_1(datum[ID_FIELD]);\n    };\n  }\n  return color;\n}\n/**\n * 处理 padding\n */\nfunction padding(params) {\n  var chart = params.chart,\n    options = params.options;\n  var legend = options.legend,\n    appendPadding = options.appendPadding,\n    padding = options.padding;\n  // 处理 legend 的位置. 默认预留 40px, 业务上可以通过 appendPadding 增加\n  var tempPadding = normalPadding(appendPadding);\n  if (legend !== false) {\n    tempPadding = getAdjustAppendPadding(appendPadding, get(legend, 'position'), LEGEND_SPACE);\n  }\n  chart.appendPadding = resolveAllPadding([tempPadding, padding]);\n  return params;\n}\n/**\n * 处理非法数据\n * @param params\n */\nfunction data(params) {\n  var options = params.options;\n  /* 如遇到 交集 中存在 非法元素 的情况，就过滤掉\n   * 如：\n   * data = [\n   *   { sets: ['A'], size: 3 }, // 集合\n   *   { sets: ['B'], size: 4 }, // 集合\n   *   { sets: ['A', 'B'], size: 2 }, // 交集\n   *   { sets: ['A', 'B', 'C'], size: 2 }, // 交集 (存在非法 C，过滤该条数据)\n   *   ...\n   * ]\n   */\n  var data = options['data'];\n  if (!data) {\n    log(LEVEL.WARN, false, 'warn: %s', '数据不能为空');\n    data = [];\n  }\n  // 合法元素的集合：['A', 'B']\n  var currSets = data.filter(function (datum) {\n    return datum.sets.length === 1;\n  }).map(function (datum) {\n    return datum.sets[0];\n  });\n  // 过滤 data\n  var filterSets = data.filter(function (datum) {\n    var sets = datum.sets;\n    // 存在非法元素，就过滤这条数据\n    return islegalSets(currSets, sets);\n  });\n  if (!isEqual(filterSets, data)) log(LEVEL.WARN, false, 'warn: %s', '交集中不能出现不存在的集合, 请输入合法数据');\n  return deepMix({}, params, {\n    options: {\n      data: filterSets\n    }\n  });\n}\n/**\n * geometry 处理\n * @param params\n */\nfunction geometry(params) {\n  var chart = params.chart,\n    options = params.options;\n  var pointStyle = options.pointStyle,\n    setsField = options.setsField,\n    sizeField = options.sizeField;\n  // 获取容器大小\n  var _a = normalPadding(chart.appendPadding),\n    t = _a[0],\n    r = _a[1],\n    b = _a[2],\n    l = _a[3];\n  // 处理 legend 的位置. 默认预留 40px, 业务上可以通过 appendPadding 增加\n  var customInfo = {\n    offsetX: l,\n    offsetY: t\n  };\n  // coordinateBBox + appendPadding = viewBBox, 不需要再计算 appendPadding 部分，因此直接使用 viewBBox\n  var _b = chart.viewBBox,\n    width = _b.width,\n    height = _b.height;\n  // 处理padding输入不合理的情况， w 和 h 不能为负数\n  var vennData = layoutVennData(options, Math.max(width - (r + l), 0), Math.max(height - (t + b), 0), 0);\n  chart.data(vennData);\n  var ext = schemaGeometry(deepAssign({}, params, {\n    options: {\n      xField: 'x',\n      yField: 'y',\n      sizeField: sizeField,\n      seriesField: ID_FIELD,\n      rawFields: [setsField, sizeField],\n      schema: {\n        shape: 'venn',\n        style: pointStyle\n      }\n    }\n  })).ext;\n  var geometry = ext.geometry;\n  geometry.customInfo(customInfo);\n  var colorOptions = transformColor(params, vennData);\n  // 韦恩图试点, color 通道只能映射一个字段. 通过外部查找获取 datum\n  if (typeof colorOptions === 'function') {\n    geometry.color(ID_FIELD, function (id) {\n      var datum = vennData.find(function (d) {\n        return d[ID_FIELD] === id;\n      });\n      var defaultColor = colorMap(params, vennData)(id);\n      return colorOptions(datum, defaultColor);\n    });\n  }\n  return params;\n}\n/**\n * 处理 label\n * @param params\n */\nfunction label(params) {\n  var chart = params.chart,\n    options = params.options;\n  var label = options.label;\n  // 获取容器大小\n  var _a = normalPadding(chart.appendPadding),\n    t = _a[0],\n    l = _a[3];\n  // 传入 label 布局函数所需的 自定义参数\n  var customLabelInfo = {\n    offsetX: l,\n    offsetY: t\n  };\n  var geometry = findGeometry(chart, 'schema');\n  if (!label) {\n    geometry.label(false);\n  } else {\n    var callback = label.callback,\n      cfg = __rest(label, [\"callback\"]);\n    geometry.label({\n      fields: ['id'],\n      callback: callback,\n      cfg: deepMix({}, transformLabel(cfg), {\n        // 使用 G2 的 自定义label 修改位置\n        type: 'venn',\n        customLabelInfo: customLabelInfo\n      })\n    });\n  }\n  return params;\n}\n/**\n * legend 配置\n * @param params\n */\nexport function legend(params) {\n  var chart = params.chart,\n    options = params.options;\n  var legend = options.legend,\n    sizeField = options.sizeField;\n  chart.legend(ID_FIELD, legend);\n  // 强制不开启 连续图例\n  chart.legend(sizeField, false);\n  return params;\n}\n/**\n * 默认关闭坐标轴\n * @param params\n */\nexport function axis(params) {\n  var chart = params.chart;\n  chart.axis(false);\n  return params;\n}\n/**\n * 韦恩图 interaction 交互适配器\n */\nfunction vennInteraction(params) {\n  var options = params.options,\n    chart = params.chart;\n  var interactions = options.interactions;\n  if (interactions) {\n    var MAP_1 = {\n      'legend-active': 'venn-legend-active',\n      'legend-highlight': 'venn-legend-highlight'\n    };\n    interaction(deepAssign({}, params, {\n      options: {\n        interactions: interactions.map(function (i) {\n          return __assign(__assign({}, i), {\n            type: MAP_1[i.type] || i.type\n          });\n        })\n      }\n    }));\n  }\n  chart.removeInteraction('legend-active');\n  chart.removeInteraction('legend-highlight');\n  return params;\n}\n/**\n * 图适配器\n * @param chart\n * @param options\n */\nexport function adaptor(params) {\n  // flow 的方式处理所有的配置到 G2 API\n  return flow(padding, theme, data, geometry, label, scale({}), legend, axis, tooltip, vennInteraction, animation\n  // ... 其他的 adaptor flow\n  )(params);\n}","map":{"version":3,"names":["deepMix","get","isArray","isEqual","animation","interaction","scale","theme","tooltip","schema","schemaGeometry","deepAssign","findGeometry","flow","getAdjustAppendPadding","LEVEL","log","normalPadding","resolveAllPadding","transformLabel","ID_FIELD","getColorMap","islegalSets","layoutVennData","LEGEND_SPACE","colorMap","params","data","colorPalette","chart","options","blendMode","setsField","_a","getTheme","colors10","colors20","palette","filter","d","length","map","id","transformColor","color","map_1","datum","padding","legend","appendPadding","tempPadding","WARN","currSets","sets","filterSets","geometry","pointStyle","sizeField","t","r","b","l","customInfo","offsetX","offsetY","_b","viewBBox","width","height","vennData","Math","max","ext","xField","yField","seriesField","rawFields","shape","style","colorOptions","find","defaultColor","label","customLabelInfo","callback","cfg","__rest","fields","type","axis","vennInteraction","interactions","MAP_1","i","__assign","removeInteraction","adaptor"],"sources":["../../../src/plots/venn/adaptor.ts"],"sourcesContent":["import { Geometry } from '@antv/g2';\nimport { deepMix, get, isArray, isEqual } from '@antv/util';\nimport { animation, interaction, scale, theme, tooltip } from '../../adaptor/common';\nimport { schema as schemaGeometry } from '../../adaptor/geometries';\nimport { Params } from '../../core/adaptor';\nimport { Datum } from '../../types';\nimport {\n  deepAssign,\n  findGeometry,\n  flow,\n  getAdjustAppendPadding,\n  LEVEL,\n  log,\n  normalPadding,\n  resolveAllPadding,\n  transformLabel,\n} from '../../utils';\nimport { ID_FIELD } from './constant';\nimport './interactions';\nimport './label';\nimport './shape';\nimport { CustomInfo, VennData, VennOptions } from './types';\nimport { getColorMap, islegalSets, layoutVennData } from './utils';\n\n/** 图例默认预留空间 */\nexport const LEGEND_SPACE = 40;\n\n/**\n * 获取 color 映射\n */\nfunction colorMap(params: Params<VennOptions>, data: VennData, colorPalette?: string[]) {\n  const { chart, options } = params;\n  const { blendMode, setsField } = options;\n  const { colors10, colors20 } = chart.getTheme();\n  let palette = colorPalette;\n  if (!isArray(palette)) {\n    palette = data.filter((d) => d[setsField].length === 1).length <= 10 ? colors10 : colors20;\n  }\n  const map = getColorMap(palette, data, blendMode, setsField);\n\n  return (id: string) => map.get(id) || palette[0];\n}\n\n/**\n * color options 转换\n */\nfunction transformColor(params: Params<VennOptions>, data: VennData): VennOptions['color'] {\n  const { options } = params;\n  const { color } = options;\n\n  if (typeof color !== 'function') {\n    const colorPalette = typeof color === 'string' ? [color] : color;\n    const map = colorMap(params, data, colorPalette);\n    return (datum: Datum) => map(datum[ID_FIELD]);\n  }\n  return color;\n}\n\n/**\n * 处理 padding\n */\nfunction padding(params: Params<VennOptions>): Params<VennOptions> {\n  const { chart, options } = params;\n  const { legend, appendPadding, padding } = options;\n\n  // 处理 legend 的位置. 默认预留 40px, 业务上可以通过 appendPadding 增加\n  let tempPadding: number[] = normalPadding(appendPadding);\n  if (legend !== false) {\n    tempPadding = getAdjustAppendPadding(appendPadding, get(legend, 'position'), LEGEND_SPACE);\n  }\n\n  chart.appendPadding = resolveAllPadding([tempPadding, padding]);\n\n  return params;\n}\n\n/**\n * 处理非法数据\n * @param params\n */\nfunction data(params: Params<VennOptions>): Params<VennOptions> {\n  const { options } = params;\n\n  /* 如遇到 交集 中存在 非法元素 的情况，就过滤掉\n   * 如：\n   * data = [\n   *   { sets: ['A'], size: 3 }, // 集合\n   *   { sets: ['B'], size: 4 }, // 集合\n   *   { sets: ['A', 'B'], size: 2 }, // 交集\n   *   { sets: ['A', 'B', 'C'], size: 2 }, // 交集 (存在非法 C，过滤该条数据)\n   *   ...\n   * ]\n   */\n\n  let data = options['data'];\n  if (!data) {\n    log(LEVEL.WARN, false, 'warn: %s', '数据不能为空');\n    data = [];\n  }\n\n  // 合法元素的集合：['A', 'B']\n  const currSets = data.filter((datum) => datum.sets.length === 1).map((datum) => datum.sets[0]);\n  // 过滤 data\n  const filterSets = data.filter((datum) => {\n    const sets = datum.sets;\n    // 存在非法元素，就过滤这条数据\n    return islegalSets(currSets, sets);\n  });\n\n  if (!isEqual(filterSets, data)) log(LEVEL.WARN, false, 'warn: %s', '交集中不能出现不存在的集合, 请输入合法数据');\n\n  return deepMix({}, params, {\n    options: {\n      data: filterSets,\n    },\n  });\n}\n\n/**\n * geometry 处理\n * @param params\n */\nfunction geometry(params: Params<VennOptions>): Params<VennOptions> {\n  const { chart, options } = params;\n  const { pointStyle, setsField, sizeField } = options;\n\n  // 获取容器大小\n  const [t, r, b, l] = normalPadding(chart.appendPadding);\n  // 处理 legend 的位置. 默认预留 40px, 业务上可以通过 appendPadding 增加\n  const customInfo: CustomInfo = { offsetX: l, offsetY: t };\n  // coordinateBBox + appendPadding = viewBBox, 不需要再计算 appendPadding 部分，因此直接使用 viewBBox\n  const { width, height } = chart.viewBBox;\n  // 处理padding输入不合理的情况， w 和 h 不能为负数\n  const vennData: VennData = layoutVennData(options, Math.max(width - (r + l), 0), Math.max(height - (t + b), 0), 0);\n  chart.data(vennData);\n\n  const { ext } = schemaGeometry(\n    deepAssign({}, params, {\n      options: {\n        xField: 'x',\n        yField: 'y',\n        sizeField: sizeField,\n        seriesField: ID_FIELD,\n        rawFields: [setsField, sizeField],\n        schema: {\n          shape: 'venn',\n          style: pointStyle,\n        },\n      },\n    })\n  );\n\n  const geometry = ext.geometry as Geometry;\n  geometry.customInfo(customInfo);\n\n  const colorOptions = transformColor(params, vennData);\n  // 韦恩图试点, color 通道只能映射一个字段. 通过外部查找获取 datum\n  if (typeof colorOptions === 'function') {\n    geometry.color(ID_FIELD, (id) => {\n      const datum = vennData.find((d) => d[ID_FIELD] === id);\n      const defaultColor = colorMap(params, vennData)(id);\n      return colorOptions(datum, defaultColor);\n    });\n  }\n\n  return params;\n}\n\n/**\n * 处理 label\n * @param params\n */\nfunction label(params: Params<VennOptions>): Params<VennOptions> {\n  const { chart, options } = params;\n  const { label } = options;\n\n  // 获取容器大小\n  const [t, , , l] = normalPadding(chart.appendPadding);\n  // 传入 label 布局函数所需的 自定义参数\n  const customLabelInfo = { offsetX: l, offsetY: t };\n\n  const geometry = findGeometry(chart, 'schema');\n\n  if (!label) {\n    geometry.label(false);\n  } else {\n    const { callback, ...cfg } = label;\n    geometry.label({\n      fields: ['id'],\n      callback,\n      cfg: deepMix({}, transformLabel(cfg), {\n        // 使用 G2 的 自定义label 修改位置\n        type: 'venn',\n        customLabelInfo,\n      }),\n    });\n  }\n\n  return params;\n}\n\n/**\n * legend 配置\n * @param params\n */\nexport function legend(params: Params<VennOptions>): Params<VennOptions> {\n  const { chart, options } = params;\n  const { legend, sizeField } = options;\n\n  chart.legend(ID_FIELD, legend);\n  // 强制不开启 连续图例\n  chart.legend(sizeField, false);\n\n  return params;\n}\n\n/**\n * 默认关闭坐标轴\n * @param params\n */\nexport function axis(params: Params<VennOptions>): Params<VennOptions> {\n  const { chart } = params;\n  chart.axis(false);\n\n  return params;\n}\n\n/**\n * 韦恩图 interaction 交互适配器\n */\nfunction vennInteraction(params: Params<VennOptions>): Params<VennOptions> {\n  const { options, chart } = params;\n  const { interactions } = options;\n\n  if (interactions) {\n    const MAP = {\n      'legend-active': 'venn-legend-active',\n      'legend-highlight': 'venn-legend-highlight',\n    };\n    interaction(\n      deepAssign({}, params, {\n        options: {\n          interactions: interactions.map((i) => ({\n            ...i,\n            type: MAP[i.type] || i.type,\n          })),\n        },\n      })\n    );\n  }\n\n  chart.removeInteraction('legend-active');\n  chart.removeInteraction('legend-highlight');\n  return params;\n}\n\n/**\n * 图适配器\n * @param chart\n * @param options\n */\nexport function adaptor(params: Params<VennOptions>) {\n  // flow 的方式处理所有的配置到 G2 API\n  return flow(\n    padding,\n    theme,\n    data,\n    geometry,\n    label,\n    scale({}),\n    legend,\n    axis,\n    tooltip,\n    vennInteraction,\n    animation\n    // ... 其他的 adaptor flow\n  )(params);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { filter, getRange, head, isNil, last } from '@antv/util';\nimport Base from '../base';\n/**\n * 连续度量的基类\n * @class\n */\nvar Continuous = /** @class */function (_super) {\n  __extends(Continuous, _super);\n  function Continuous() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.isContinuous = true;\n    return _this;\n  }\n  Continuous.prototype.scale = function (value) {\n    if (isNil(value)) {\n      return NaN;\n    }\n    var rangeMin = this.rangeMin();\n    var rangeMax = this.rangeMax();\n    var max = this.max;\n    var min = this.min;\n    if (max === min) {\n      return rangeMin;\n    }\n    var percent = this.getScalePercent(value);\n    return rangeMin + percent * (rangeMax - rangeMin);\n  };\n  Continuous.prototype.init = function () {\n    _super.prototype.init.call(this);\n    // init 完成后保证 min, max 包含 ticks 的范围\n    var ticks = this.ticks;\n    var firstTick = head(ticks);\n    var lastTick = last(ticks);\n    if (firstTick < this.min) {\n      this.min = firstTick;\n    }\n    if (lastTick > this.max) {\n      this.max = lastTick;\n    }\n    // strict-limit 方式\n    if (!isNil(this.minLimit)) {\n      this.min = firstTick;\n    }\n    if (!isNil(this.maxLimit)) {\n      this.max = lastTick;\n    }\n  };\n  Continuous.prototype.setDomain = function () {\n    var _a = getRange(this.values),\n      min = _a.min,\n      max = _a.max;\n    if (isNil(this.min)) {\n      this.min = min;\n    }\n    if (isNil(this.max)) {\n      this.max = max;\n    }\n    if (this.min > this.max) {\n      this.min = min;\n      this.max = max;\n    }\n  };\n  Continuous.prototype.calculateTicks = function () {\n    var _this = this;\n    var ticks = _super.prototype.calculateTicks.call(this);\n    if (!this.nice) {\n      ticks = filter(ticks, function (tick) {\n        return tick >= _this.min && tick <= _this.max;\n      });\n    }\n    return ticks;\n  };\n  // 计算原始值值占的百分比\n  Continuous.prototype.getScalePercent = function (value) {\n    var max = this.max;\n    var min = this.min;\n    return (value - min) / (max - min);\n  };\n  Continuous.prototype.getInvertPercent = function (value) {\n    return (value - this.rangeMin()) / (this.rangeMax() - this.rangeMin());\n  };\n  return Continuous;\n}(Base);\nexport default Continuous;","map":{"version":3,"names":["filter","getRange","head","isNil","last","Base","Continuous","_super","__extends","_this","apply","arguments","isContinuous","prototype","scale","value","NaN","rangeMin","rangeMax","max","min","percent","getScalePercent","init","call","ticks","firstTick","lastTick","minLimit","maxLimit","setDomain","_a","values","calculateTicks","nice","tick","getInvertPercent"],"sources":["../../src/continuous/base.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import { prettyNumber } from './pretty-number';\nexport default function pretty(min, max, m) {\n  if (m === void 0) {\n    m = 5;\n  }\n  if (min === max) {\n    return {\n      max: max,\n      min: min,\n      ticks: [min]\n    };\n  }\n  var n = m < 0 ? 0 : Math.round(m);\n  if (n === 0) return {\n    max: max,\n    min: min,\n    ticks: []\n  };\n  /*\n    R pretty:\n    https://svn.r-project.org/R/trunk/src/appl/pretty.c\n    https://www.rdocumentation.org/packages/base/versions/3.5.2/topics/pretty\n    */\n  var h = 1.5; // high.u.bias\n  var h5 = 0.5 + 1.5 * h; // u5.bias\n  // 反正我也不会调参，跳过所有判断步骤\n  var d = max - min;\n  var c = d / n;\n  // 当d非常小的时候触发，但似乎没什么用\n  // const min_n = Math.floor(n / 3);\n  // const shrink_sml = Math.pow(2, 5);\n  // if (Math.log10(d) < -2) {\n  //   c = (_.max([ Math.abs(max), Math.abs(min) ]) * shrink_sml) / min_n;\n  // }\n  var base = Math.pow(10, Math.floor(Math.log10(c)));\n  var unit = base;\n  if (2 * base - c < h * (c - unit)) {\n    unit = 2 * base;\n    if (5 * base - c < h5 * (c - unit)) {\n      unit = 5 * base;\n      if (10 * base - c < h * (c - unit)) {\n        unit = 10 * base;\n      }\n    }\n  }\n  var nu = Math.ceil(max / unit);\n  var ns = Math.floor(min / unit);\n  var hi = Math.max(nu * unit, max);\n  var lo = Math.min(ns * unit, min);\n  var size = Math.floor((hi - lo) / unit) + 1;\n  var ticks = new Array(size);\n  for (var i = 0; i < size; i++) {\n    ticks[i] = prettyNumber(lo + i * unit);\n  }\n  return {\n    min: lo,\n    max: hi,\n    ticks: ticks\n  };\n}","map":{"version":3,"names":["prettyNumber","pretty","min","max","m","ticks","n","Math","round","h","h5","d","c","base","pow","floor","log10","unit","nu","ceil","ns","hi","lo","size","Array","i"],"sources":["../../src/util/pretty.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,YAAY,QAAQ,iBAAiB;AAE9C,eAAc,SAAUC,MAAMA,CAACC,GAAW,EAAEC,GAAW,EAAEC,CAAa;EAAb,IAAAA,CAAA;IAAAA,CAAA,IAAa;EAAA;EACpE,IAAIF,GAAG,KAAKC,GAAG,EAAE;IACf,OAAO;MACLA,GAAG,EAAAA,GAAA;MACHD,GAAG,EAAAA,GAAA;MACHG,KAAK,EAAE,CAACH,GAAG;KACZ;;EAGH,IAAMI,CAAC,GAAGF,CAAC,GAAG,CAAC,GAAG,CAAC,GAAGG,IAAI,CAACC,KAAK,CAACJ,CAAC,CAAC;EACnC,IAAIE,CAAC,KAAK,CAAC,EAAE,OAAO;IAAEH,GAAG,EAAAA,GAAA;IAAED,GAAG,EAAAA,GAAA;IAAEG,KAAK,EAAE;EAAE,CAAE;EAE3C;;;;;EAKA,IAAMI,CAAC,GAAG,GAAG,CAAC,CAAC;EACf,IAAMC,EAAE,GAAG,GAAG,GAAG,GAAG,GAAGD,CAAC,CAAC,CAAC;EAC1B;EACA,IAAME,CAAC,GAAGR,GAAG,GAAGD,GAAG;EACnB,IAAMU,CAAC,GAAGD,CAAC,GAAGL,CAAC;EACf;EACA;EACA;EACA;EACA;EACA;EAEA,IAAMO,IAAI,GAAGN,IAAI,CAACO,GAAG,CAAC,EAAE,EAAEP,IAAI,CAACQ,KAAK,CAACR,IAAI,CAACS,KAAK,CAACJ,CAAC,CAAC,CAAC,CAAC;EACpD,IAAIK,IAAI,GAAGJ,IAAI;EACf,IAAI,CAAC,GAAGA,IAAI,GAAGD,CAAC,GAAGH,CAAC,IAAIG,CAAC,GAAGK,IAAI,CAAC,EAAE;IACjCA,IAAI,GAAG,CAAC,GAAGJ,IAAI;IACf,IAAI,CAAC,GAAGA,IAAI,GAAGD,CAAC,GAAGF,EAAE,IAAIE,CAAC,GAAGK,IAAI,CAAC,EAAE;MAClCA,IAAI,GAAG,CAAC,GAAGJ,IAAI;MACf,IAAI,EAAE,GAAGA,IAAI,GAAGD,CAAC,GAAGH,CAAC,IAAIG,CAAC,GAAGK,IAAI,CAAC,EAAE;QAClCA,IAAI,GAAG,EAAE,GAAGJ,IAAI;;;;EAItB,IAAMK,EAAE,GAAGX,IAAI,CAACY,IAAI,CAAChB,GAAG,GAAGc,IAAI,CAAC;EAChC,IAAMG,EAAE,GAAGb,IAAI,CAACQ,KAAK,CAACb,GAAG,GAAGe,IAAI,CAAC;EAEjC,IAAMI,EAAE,GAAGd,IAAI,CAACJ,GAAG,CAACe,EAAE,GAAGD,IAAI,EAAEd,GAAG,CAAC;EACnC,IAAMmB,EAAE,GAAGf,IAAI,CAACL,GAAG,CAACkB,EAAE,GAAGH,IAAI,EAAEf,GAAG,CAAC;EAEnC,IAAMqB,IAAI,GAAGhB,IAAI,CAACQ,KAAK,CAAC,CAACM,EAAE,GAAGC,EAAE,IAAIL,IAAI,CAAC,GAAG,CAAC;EAC7C,IAAMZ,KAAK,GAAG,IAAImB,KAAK,CAACD,IAAI,CAAC;EAC7B,KAAK,IAAIE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,IAAI,EAAEE,CAAC,EAAE,EAAE;IAC7BpB,KAAK,CAACoB,CAAC,CAAC,GAAGzB,YAAY,CAACsB,EAAE,GAAGG,CAAC,GAAGR,IAAI,CAAC;;EAGxC,OAAO;IACLf,GAAG,EAAEoB,EAAE;IACPnB,GAAG,EAAEkB,EAAE;IACPhB,KAAK,EAAAA;GACN;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}
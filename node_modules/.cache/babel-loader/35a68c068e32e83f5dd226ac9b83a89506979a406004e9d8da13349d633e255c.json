{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nvar lastFrameTime = null;\nvar frameTimes = [];\nvar minFramerateTarget = 30;\nvar frameTimeTarget = 1000 / minFramerateTarget;\nvar performance = window.performance;\nexport var PerformanceMarkers = {\n  create: 'create',\n  load: 'load',\n  fullLoad: 'fullLoad'\n};\nexport var PerformanceUtils = {\n  mark: function mark(marker) {\n    performance.mark(marker);\n  },\n  frame: function frame(timestamp) {\n    var currTimestamp = timestamp;\n    if (lastFrameTime != null) {\n      var frameTime = currTimestamp - lastFrameTime;\n      frameTimes.push(frameTime);\n    }\n    lastFrameTime = currTimestamp;\n  },\n  clearMetrics: function clearMetrics() {\n    lastFrameTime = null;\n    frameTimes = [];\n    performance.clearMeasures('loadTime');\n    performance.clearMeasures('fullLoadTime');\n    // @ts-ignore\n    // tslint:disable-next-line:forin\n    for (var marker in PerformanceMarkers) {\n      // @ts-ignore\n      performance.clearMarks(PerformanceMarkers[marker]);\n    }\n  },\n  getPerformanceMetrics: function getPerformanceMetrics() {\n    var loadTime = performance.measure('loadTime', PerformanceMarkers.create, PerformanceMarkers.load\n    // @ts-ignore\n    ).duration;\n    var fullLoadTime = performance.measure('fullLoadTime', PerformanceMarkers.create, PerformanceMarkers.fullLoad\n    // @ts-ignore\n    ).duration;\n    var totalFrames = frameTimes.length;\n    var avgFrameTime = frameTimes.reduce(function (prev, curr) {\n      return prev + curr;\n    }, 0) / totalFrames / 1000;\n    var fps = 1 / avgFrameTime;\n\n    // count frames that missed our framerate target\n    var droppedFrames = frameTimes.filter(function (frameTime) {\n      return frameTime > frameTimeTarget;\n    }).reduce(function (acc, curr) {\n      return acc + (curr - frameTimeTarget) / frameTimeTarget;\n    }, 0);\n    var percentDroppedFrames = droppedFrames / (totalFrames + droppedFrames) * 100;\n    return {\n      loadTime: loadTime,\n      fullLoadTime: fullLoadTime,\n      fps: fps,\n      percentDroppedFrames: percentDroppedFrames\n    };\n  }\n};","map":{"version":3,"names":["lastFrameTime","frameTimes","minFramerateTarget","frameTimeTarget","performance","window","PerformanceMarkers","create","load","fullLoad","PerformanceUtils","mark","marker","frame","timestamp","currTimestamp","frameTime","push","clearMetrics","clearMeasures","clearMarks","getPerformanceMetrics","loadTime","measure","duration","fullLoadTime","totalFrames","length","avgFrameTime","reduce","prev","curr","fps","droppedFrames","filter","acc","percentDroppedFrames"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-map/es/utils/performance.js"],"sourcesContent":["var lastFrameTime = null;\nvar frameTimes = [];\nvar minFramerateTarget = 30;\nvar frameTimeTarget = 1000 / minFramerateTarget;\nvar performance = window.performance;\nexport var PerformanceMarkers = {\n  create: 'create',\n  load: 'load',\n  fullLoad: 'fullLoad'\n};\nexport var PerformanceUtils = {\n  mark: function mark(marker) {\n    performance.mark(marker);\n  },\n  frame: function frame(timestamp) {\n    var currTimestamp = timestamp;\n    if (lastFrameTime != null) {\n      var frameTime = currTimestamp - lastFrameTime;\n      frameTimes.push(frameTime);\n    }\n    lastFrameTime = currTimestamp;\n  },\n  clearMetrics: function clearMetrics() {\n    lastFrameTime = null;\n    frameTimes = [];\n    performance.clearMeasures('loadTime');\n    performance.clearMeasures('fullLoadTime');\n    // @ts-ignore\n    // tslint:disable-next-line:forin\n    for (var marker in PerformanceMarkers) {\n      // @ts-ignore\n      performance.clearMarks(PerformanceMarkers[marker]);\n    }\n  },\n  getPerformanceMetrics: function getPerformanceMetrics() {\n    var loadTime = performance.measure('loadTime', PerformanceMarkers.create, PerformanceMarkers.load\n    // @ts-ignore\n    ).duration;\n    var fullLoadTime = performance.measure('fullLoadTime', PerformanceMarkers.create, PerformanceMarkers.fullLoad\n    // @ts-ignore\n    ).duration;\n    var totalFrames = frameTimes.length;\n    var avgFrameTime = frameTimes.reduce(function (prev, curr) {\n      return prev + curr;\n    }, 0) / totalFrames / 1000;\n    var fps = 1 / avgFrameTime;\n\n    // count frames that missed our framerate target\n    var droppedFrames = frameTimes.filter(function (frameTime) {\n      return frameTime > frameTimeTarget;\n    }).reduce(function (acc, curr) {\n      return acc + (curr - frameTimeTarget) / frameTimeTarget;\n    }, 0);\n    var percentDroppedFrames = droppedFrames / (totalFrames + droppedFrames) * 100;\n    return {\n      loadTime: loadTime,\n      fullLoadTime: fullLoadTime,\n      fps: fps,\n      percentDroppedFrames: percentDroppedFrames\n    };\n  }\n};"],"mappings":";AAAA,IAAIA,aAAa,GAAG,IAAI;AACxB,IAAIC,UAAU,GAAG,EAAE;AACnB,IAAIC,kBAAkB,GAAG,EAAE;AAC3B,IAAIC,eAAe,GAAG,IAAI,GAAGD,kBAAkB;AAC/C,IAAIE,WAAW,GAAGC,MAAM,CAACD,WAAW;AACpC,OAAO,IAAIE,kBAAkB,GAAG;EAC9BC,MAAM,EAAE,QAAQ;EAChBC,IAAI,EAAE,MAAM;EACZC,QAAQ,EAAE;AACZ,CAAC;AACD,OAAO,IAAIC,gBAAgB,GAAG;EAC5BC,IAAI,EAAE,SAASA,IAAIA,CAACC,MAAM,EAAE;IAC1BR,WAAW,CAACO,IAAI,CAACC,MAAM,CAAC;EAC1B,CAAC;EACDC,KAAK,EAAE,SAASA,KAAKA,CAACC,SAAS,EAAE;IAC/B,IAAIC,aAAa,GAAGD,SAAS;IAC7B,IAAId,aAAa,IAAI,IAAI,EAAE;MACzB,IAAIgB,SAAS,GAAGD,aAAa,GAAGf,aAAa;MAC7CC,UAAU,CAACgB,IAAI,CAACD,SAAS,CAAC;IAC5B;IACAhB,aAAa,GAAGe,aAAa;EAC/B,CAAC;EACDG,YAAY,EAAE,SAASA,YAAYA,CAAA,EAAG;IACpClB,aAAa,GAAG,IAAI;IACpBC,UAAU,GAAG,EAAE;IACfG,WAAW,CAACe,aAAa,CAAC,UAAU,CAAC;IACrCf,WAAW,CAACe,aAAa,CAAC,cAAc,CAAC;IACzC;IACA;IACA,KAAK,IAAIP,MAAM,IAAIN,kBAAkB,EAAE;MACrC;MACAF,WAAW,CAACgB,UAAU,CAACd,kBAAkB,CAACM,MAAM,CAAC,CAAC;IACpD;EACF,CAAC;EACDS,qBAAqB,EAAE,SAASA,qBAAqBA,CAAA,EAAG;IACtD,IAAIC,QAAQ,GAAGlB,WAAW,CAACmB,OAAO,CAAC,UAAU,EAAEjB,kBAAkB,CAACC,MAAM,EAAED,kBAAkB,CAACE;IAC7F;IACA,CAAC,CAACgB,QAAQ;IACV,IAAIC,YAAY,GAAGrB,WAAW,CAACmB,OAAO,CAAC,cAAc,EAAEjB,kBAAkB,CAACC,MAAM,EAAED,kBAAkB,CAACG;IACrG;IACA,CAAC,CAACe,QAAQ;IACV,IAAIE,WAAW,GAAGzB,UAAU,CAAC0B,MAAM;IACnC,IAAIC,YAAY,GAAG3B,UAAU,CAAC4B,MAAM,CAAC,UAAUC,IAAI,EAAEC,IAAI,EAAE;MACzD,OAAOD,IAAI,GAAGC,IAAI;IACpB,CAAC,EAAE,CAAC,CAAC,GAAGL,WAAW,GAAG,IAAI;IAC1B,IAAIM,GAAG,GAAG,CAAC,GAAGJ,YAAY;;IAE1B;IACA,IAAIK,aAAa,GAAGhC,UAAU,CAACiC,MAAM,CAAC,UAAUlB,SAAS,EAAE;MACzD,OAAOA,SAAS,GAAGb,eAAe;IACpC,CAAC,CAAC,CAAC0B,MAAM,CAAC,UAAUM,GAAG,EAAEJ,IAAI,EAAE;MAC7B,OAAOI,GAAG,GAAG,CAACJ,IAAI,GAAG5B,eAAe,IAAIA,eAAe;IACzD,CAAC,EAAE,CAAC,CAAC;IACL,IAAIiC,oBAAoB,GAAGH,aAAa,IAAIP,WAAW,GAAGO,aAAa,CAAC,GAAG,GAAG;IAC9E,OAAO;MACLX,QAAQ,EAAEA,QAAQ;MAClBG,YAAY,EAAEA,YAAY;MAC1BO,GAAG,EAAEA,GAAG;MACRI,oBAAoB,EAAEA;IACxB,CAAC;EACH;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
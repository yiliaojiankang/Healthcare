{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n  return to;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Container = void 0;\nvar binding_1 = require(\"../bindings/binding\");\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nvar literal_types_1 = require(\"../constants/literal_types\");\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\nvar metadata_reader_1 = require(\"../planning/metadata_reader\");\nvar planner_1 = require(\"../planning/planner\");\nvar resolver_1 = require(\"../resolution/resolver\");\nvar binding_to_syntax_1 = require(\"../syntax/binding_to_syntax\");\nvar id_1 = require(\"../utils/id\");\nvar serialization_1 = require(\"../utils/serialization\");\nvar container_snapshot_1 = require(\"./container_snapshot\");\nvar lookup_1 = require(\"./lookup\");\nvar Container = function () {\n  function Container(containerOptions) {\n    this._appliedMiddleware = [];\n    var options = containerOptions || {};\n    if (typeof options !== \"object\") {\n      throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);\n    }\n    if (options.defaultScope === undefined) {\n      options.defaultScope = literal_types_1.BindingScopeEnum.Transient;\n    } else if (options.defaultScope !== literal_types_1.BindingScopeEnum.Singleton && options.defaultScope !== literal_types_1.BindingScopeEnum.Transient && options.defaultScope !== literal_types_1.BindingScopeEnum.Request) {\n      throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);\n    }\n    if (options.autoBindInjectable === undefined) {\n      options.autoBindInjectable = false;\n    } else if (typeof options.autoBindInjectable !== \"boolean\") {\n      throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);\n    }\n    if (options.skipBaseClassChecks === undefined) {\n      options.skipBaseClassChecks = false;\n    } else if (typeof options.skipBaseClassChecks !== \"boolean\") {\n      throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);\n    }\n    this.options = {\n      autoBindInjectable: options.autoBindInjectable,\n      defaultScope: options.defaultScope,\n      skipBaseClassChecks: options.skipBaseClassChecks\n    };\n    this.id = id_1.id();\n    this._bindingDictionary = new lookup_1.Lookup();\n    this._snapshots = [];\n    this._middleware = null;\n    this.parent = null;\n    this._metadataReader = new metadata_reader_1.MetadataReader();\n  }\n  Container.merge = function (container1, container2) {\n    var container3 = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n      container3[_i - 2] = arguments[_i];\n    }\n    var container = new Container();\n    var targetContainers = __spreadArray([container1, container2], container3).map(function (targetContainer) {\n      return planner_1.getBindingDictionary(targetContainer);\n    });\n    var bindingDictionary = planner_1.getBindingDictionary(container);\n    function copyDictionary(origin, destination) {\n      origin.traverse(function (key, value) {\n        value.forEach(function (binding) {\n          destination.add(binding.serviceIdentifier, binding.clone());\n        });\n      });\n    }\n    targetContainers.forEach(function (targetBindingDictionary) {\n      copyDictionary(targetBindingDictionary, bindingDictionary);\n    });\n    return container;\n  };\n  Container.prototype.load = function () {\n    var modules = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      modules[_i] = arguments[_i];\n    }\n    var getHelpers = this._getContainerModuleHelpersFactory();\n    for (var _a = 0, modules_1 = modules; _a < modules_1.length; _a++) {\n      var currentModule = modules_1[_a];\n      var containerModuleHelpers = getHelpers(currentModule.id);\n      currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction);\n    }\n  };\n  Container.prototype.loadAsync = function () {\n    var modules = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      modules[_i] = arguments[_i];\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var getHelpers, _a, modules_2, currentModule, containerModuleHelpers;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            getHelpers = this._getContainerModuleHelpersFactory();\n            _a = 0, modules_2 = modules;\n            _b.label = 1;\n          case 1:\n            if (!(_a < modules_2.length)) return [3, 4];\n            currentModule = modules_2[_a];\n            containerModuleHelpers = getHelpers(currentModule.id);\n            return [4, currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction)];\n          case 2:\n            _b.sent();\n            _b.label = 3;\n          case 3:\n            _a++;\n            return [3, 1];\n          case 4:\n            return [2];\n        }\n      });\n    });\n  };\n  Container.prototype.unload = function () {\n    var _this = this;\n    var modules = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      modules[_i] = arguments[_i];\n    }\n    var conditionFactory = function (expected) {\n      return function (item) {\n        return item.moduleId === expected;\n      };\n    };\n    modules.forEach(function (module) {\n      var condition = conditionFactory(module.id);\n      _this._bindingDictionary.removeByCondition(condition);\n    });\n  };\n  Container.prototype.bind = function (serviceIdentifier) {\n    var scope = this.options.defaultScope || literal_types_1.BindingScopeEnum.Transient;\n    var binding = new binding_1.Binding(serviceIdentifier, scope);\n    this._bindingDictionary.add(serviceIdentifier, binding);\n    return new binding_to_syntax_1.BindingToSyntax(binding);\n  };\n  Container.prototype.rebind = function (serviceIdentifier) {\n    this.unbind(serviceIdentifier);\n    return this.bind(serviceIdentifier);\n  };\n  Container.prototype.unbind = function (serviceIdentifier) {\n    try {\n      this._bindingDictionary.remove(serviceIdentifier);\n    } catch (e) {\n      throw new Error(ERROR_MSGS.CANNOT_UNBIND + \" \" + serialization_1.getServiceIdentifierAsString(serviceIdentifier));\n    }\n  };\n  Container.prototype.unbindAll = function () {\n    this._bindingDictionary = new lookup_1.Lookup();\n  };\n  Container.prototype.isBound = function (serviceIdentifier) {\n    var bound = this._bindingDictionary.hasKey(serviceIdentifier);\n    if (!bound && this.parent) {\n      bound = this.parent.isBound(serviceIdentifier);\n    }\n    return bound;\n  };\n  Container.prototype.isBoundNamed = function (serviceIdentifier, named) {\n    return this.isBoundTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n  };\n  Container.prototype.isBoundTagged = function (serviceIdentifier, key, value) {\n    var bound = false;\n    if (this._bindingDictionary.hasKey(serviceIdentifier)) {\n      var bindings = this._bindingDictionary.get(serviceIdentifier);\n      var request_1 = planner_1.createMockRequest(this, serviceIdentifier, key, value);\n      bound = bindings.some(function (b) {\n        return b.constraint(request_1);\n      });\n    }\n    if (!bound && this.parent) {\n      bound = this.parent.isBoundTagged(serviceIdentifier, key, value);\n    }\n    return bound;\n  };\n  Container.prototype.snapshot = function () {\n    this._snapshots.push(container_snapshot_1.ContainerSnapshot.of(this._bindingDictionary.clone(), this._middleware));\n  };\n  Container.prototype.restore = function () {\n    var snapshot = this._snapshots.pop();\n    if (snapshot === undefined) {\n      throw new Error(ERROR_MSGS.NO_MORE_SNAPSHOTS_AVAILABLE);\n    }\n    this._bindingDictionary = snapshot.bindings;\n    this._middleware = snapshot.middleware;\n  };\n  Container.prototype.createChild = function (containerOptions) {\n    var child = new Container(containerOptions || this.options);\n    child.parent = this;\n    return child;\n  };\n  Container.prototype.applyMiddleware = function () {\n    var middlewares = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      middlewares[_i] = arguments[_i];\n    }\n    this._appliedMiddleware = this._appliedMiddleware.concat(middlewares);\n    var initial = this._middleware ? this._middleware : this._planAndResolve();\n    this._middleware = middlewares.reduce(function (prev, curr) {\n      return curr(prev);\n    }, initial);\n  };\n  Container.prototype.applyCustomMetadataReader = function (metadataReader) {\n    this._metadataReader = metadataReader;\n  };\n  Container.prototype.get = function (serviceIdentifier) {\n    return this._get(false, false, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier);\n  };\n  Container.prototype.getTagged = function (serviceIdentifier, key, value) {\n    return this._get(false, false, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier, key, value);\n  };\n  Container.prototype.getNamed = function (serviceIdentifier, named) {\n    return this.getTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n  };\n  Container.prototype.getAll = function (serviceIdentifier) {\n    return this._get(true, true, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier);\n  };\n  Container.prototype.getAllTagged = function (serviceIdentifier, key, value) {\n    return this._get(false, true, literal_types_1.TargetTypeEnum.Variable, serviceIdentifier, key, value);\n  };\n  Container.prototype.getAllNamed = function (serviceIdentifier, named) {\n    return this.getAllTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n  };\n  Container.prototype.resolve = function (constructorFunction) {\n    var tempContainer = this.createChild();\n    tempContainer.bind(constructorFunction).toSelf();\n    this._appliedMiddleware.forEach(function (m) {\n      tempContainer.applyMiddleware(m);\n    });\n    return tempContainer.get(constructorFunction);\n  };\n  Container.prototype._getContainerModuleHelpersFactory = function () {\n    var _this = this;\n    var setModuleId = function (bindingToSyntax, moduleId) {\n      bindingToSyntax._binding.moduleId = moduleId;\n    };\n    var getBindFunction = function (moduleId) {\n      return function (serviceIdentifier) {\n        var _bind = _this.bind.bind(_this);\n        var bindingToSyntax = _bind(serviceIdentifier);\n        setModuleId(bindingToSyntax, moduleId);\n        return bindingToSyntax;\n      };\n    };\n    var getUnbindFunction = function (moduleId) {\n      return function (serviceIdentifier) {\n        var _unbind = _this.unbind.bind(_this);\n        _unbind(serviceIdentifier);\n      };\n    };\n    var getIsboundFunction = function (moduleId) {\n      return function (serviceIdentifier) {\n        var _isBound = _this.isBound.bind(_this);\n        return _isBound(serviceIdentifier);\n      };\n    };\n    var getRebindFunction = function (moduleId) {\n      return function (serviceIdentifier) {\n        var _rebind = _this.rebind.bind(_this);\n        var bindingToSyntax = _rebind(serviceIdentifier);\n        setModuleId(bindingToSyntax, moduleId);\n        return bindingToSyntax;\n      };\n    };\n    return function (mId) {\n      return {\n        bindFunction: getBindFunction(mId),\n        isboundFunction: getIsboundFunction(mId),\n        rebindFunction: getRebindFunction(mId),\n        unbindFunction: getUnbindFunction(mId)\n      };\n    };\n  };\n  Container.prototype._get = function (avoidConstraints, isMultiInject, targetType, serviceIdentifier, key, value) {\n    var result = null;\n    var defaultArgs = {\n      avoidConstraints: avoidConstraints,\n      contextInterceptor: function (context) {\n        return context;\n      },\n      isMultiInject: isMultiInject,\n      key: key,\n      serviceIdentifier: serviceIdentifier,\n      targetType: targetType,\n      value: value\n    };\n    if (this._middleware) {\n      result = this._middleware(defaultArgs);\n      if (result === undefined || result === null) {\n        throw new Error(ERROR_MSGS.INVALID_MIDDLEWARE_RETURN);\n      }\n    } else {\n      result = this._planAndResolve()(defaultArgs);\n    }\n    return result;\n  };\n  Container.prototype._planAndResolve = function () {\n    var _this = this;\n    return function (args) {\n      var context = planner_1.plan(_this._metadataReader, _this, args.isMultiInject, args.targetType, args.serviceIdentifier, args.key, args.value, args.avoidConstraints);\n      context = args.contextInterceptor(context);\n      var result = resolver_1.resolve(context);\n      return result;\n    };\n  };\n  return Container;\n}();\nexports.Container = Container;","map":{"version":3,"names":["binding_1","require","ERROR_MSGS","literal_types_1","METADATA_KEY","metadata_reader_1","planner_1","resolver_1","binding_to_syntax_1","id_1","serialization_1","container_snapshot_1","lookup_1","Container","containerOptions","_appliedMiddleware","options","Error","CONTAINER_OPTIONS_MUST_BE_AN_OBJECT","defaultScope","undefined","BindingScopeEnum","Transient","Singleton","Request","CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE","autoBindInjectable","CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE","skipBaseClassChecks","CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK","id","_bindingDictionary","Lookup","_snapshots","_middleware","parent","_metadataReader","MetadataReader","merge","container1","container2","container3","_i","arguments","length","container","targetContainers","__spreadArray","map","targetContainer","getBindingDictionary","bindingDictionary","copyDictionary","origin","destination","traverse","key","value","forEach","binding","add","serviceIdentifier","clone","targetBindingDictionary","prototype","load","modules","getHelpers","_getContainerModuleHelpersFactory","_a","modules_1","currentModule","containerModuleHelpers","registry","bindFunction","unbindFunction","isboundFunction","rebindFunction","loadAsync","modules_2","_b","sent","unload","_this","conditionFactory","expected","item","moduleId","module","condition","removeByCondition","bind","scope","Binding","BindingToSyntax","rebind","unbind","remove","e","CANNOT_UNBIND","getServiceIdentifierAsString","unbindAll","isBound","bound","hasKey","isBoundNamed","named","isBoundTagged","NAMED_TAG","bindings","get","request_1","createMockRequest","some","b","constraint","snapshot","push","ContainerSnapshot","of","restore","pop","NO_MORE_SNAPSHOTS_AVAILABLE","middleware","createChild","child","applyMiddleware","middlewares","concat","initial","_planAndResolve","reduce","prev","curr","applyCustomMetadataReader","metadataReader","_get","TargetTypeEnum","Variable","getTagged","getNamed","getAll","getAllTagged","getAllNamed","resolve","constructorFunction","tempContainer","toSelf","m","setModuleId","bindingToSyntax","_binding","getBindFunction","_bind","getUnbindFunction","_unbind","getIsboundFunction","_isBound","getRebindFunction","_rebind","mId","avoidConstraints","isMultiInject","targetType","result","defaultArgs","contextInterceptor","context","INVALID_MIDDLEWARE_RETURN","args","plan","exports"],"sources":["../../src/container/container.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}
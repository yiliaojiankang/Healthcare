{"ast":null,"code":"import { animation, annotation, interaction, slider, theme } from '../../adaptor/common';\nimport { schema } from '../../adaptor/geometries';\nimport { AXIS_META_CONFIG_KEYS } from '../../constant';\nimport { deepAssign, flow, pick } from '../../utils';\nimport { TREND_DOWN, TREND_FIELD, TREND_UP, Y_FIELD } from './constant';\nimport { getStockData } from './utils';\n/**\n * 图表配置处理\n * @param params\n */\nfunction geometry(params) {\n  var chart = params.chart,\n    options = params.options;\n  var yField = options.yField;\n  var data = options.data,\n    risingFill = options.risingFill,\n    fallingFill = options.fallingFill,\n    tooltip = options.tooltip,\n    stockStyle = options.stockStyle;\n  chart.data(getStockData(data, yField));\n  var tooltipOptions = tooltip;\n  if (tooltipOptions !== false) {\n    tooltipOptions = deepAssign({}, {\n      fields: yField\n    }, tooltipOptions);\n  }\n  schema(deepAssign({}, params, {\n    options: {\n      schema: {\n        shape: 'candle',\n        color: [risingFill, fallingFill],\n        style: stockStyle\n      },\n      yField: Y_FIELD,\n      seriesField: TREND_FIELD,\n      rawFields: yField,\n      tooltip: tooltipOptions\n    }\n  }));\n  return params;\n}\n/**\n * meta 配置\n * @param params\n */\nexport function meta(params) {\n  var _a, _b;\n  var chart = params.chart,\n    options = params.options;\n  var meta = options.meta,\n    xAxis = options.xAxis,\n    yAxis = options.yAxis,\n    xField = options.xField;\n  var baseMeta = (_a = {}, _a[xField] = {\n    type: 'timeCat',\n    tickCount: 6\n  }, _a[TREND_FIELD] = {\n    values: [TREND_UP, TREND_DOWN]\n  }, _a);\n  var scales = deepAssign(baseMeta, meta, (_b = {}, _b[xField] = pick(xAxis, AXIS_META_CONFIG_KEYS), _b[Y_FIELD] = pick(yAxis, AXIS_META_CONFIG_KEYS), _b));\n  chart.scale(scales);\n  return params;\n}\n/**\n * axis 配置\n * @param params\n */\nexport function axis(params) {\n  var chart = params.chart,\n    options = params.options;\n  var xAxis = options.xAxis,\n    yAxis = options.yAxis,\n    xField = options.xField;\n  // 为 false 则是不显示轴\n  if (xAxis === false) {\n    chart.axis(xField, false);\n  } else {\n    chart.axis(xField, xAxis);\n  }\n  if (yAxis === false) {\n    chart.axis(Y_FIELD, false);\n  } else {\n    chart.axis(Y_FIELD, yAxis);\n  }\n  return params;\n}\n/**\n * tooltip 配置\n * @param params\n */\nexport function tooltip(params) {\n  var chart = params.chart,\n    options = params.options;\n  var tooltip = options.tooltip;\n  if (tooltip !== false) {\n    chart.tooltip(tooltip);\n  } else {\n    chart.tooltip(false);\n  }\n  return params;\n}\n/**\n * legend 配置\n * @param params\n */\nexport function legend(params) {\n  var chart = params.chart,\n    options = params.options;\n  var legend = options.legend;\n  if (legend) {\n    chart.legend(TREND_FIELD, legend);\n  } else if (legend === false) {\n    chart.legend(false);\n  }\n  return params;\n}\n/**\n * K线图适配器\n * @param chart\n * @param options\n */\nexport function adaptor(params) {\n  // flow 的方式处理所有的配置到 G2 API\n  flow(theme, geometry, meta, axis, tooltip, legend, interaction, animation, annotation(), slider)(params);\n}","map":{"version":3,"names":["animation","annotation","interaction","slider","theme","schema","AXIS_META_CONFIG_KEYS","deepAssign","flow","pick","TREND_DOWN","TREND_FIELD","TREND_UP","Y_FIELD","getStockData","geometry","params","chart","options","yField","data","risingFill","fallingFill","tooltip","stockStyle","tooltipOptions","fields","shape","color","style","seriesField","rawFields","meta","xAxis","yAxis","xField","baseMeta","_a","type","tickCount","values","scales","_b","scale","axis","legend","adaptor"],"sources":["../../../src/plots/stock/adaptor.ts"],"sourcesContent":["import { animation, annotation, interaction, slider, theme } from '../../adaptor/common';\nimport { schema } from '../../adaptor/geometries';\nimport { AXIS_META_CONFIG_KEYS } from '../../constant';\nimport { Params } from '../../core/adaptor';\nimport { deepAssign, flow, pick } from '../../utils';\nimport { TREND_DOWN, TREND_FIELD, TREND_UP, Y_FIELD } from './constant';\nimport { StockOptions } from './types';\nimport { getStockData } from './utils';\n\n/**\n * 图表配置处理\n * @param params\n */\nfunction geometry(params: Params<StockOptions>): Params<StockOptions> {\n  const { chart, options } = params;\n  const { yField } = options;\n\n  const { data, risingFill, fallingFill, tooltip, stockStyle } = options;\n\n  chart.data(getStockData(data, yField));\n\n  let tooltipOptions = tooltip;\n  if (tooltipOptions !== false) {\n    tooltipOptions = deepAssign({}, { fields: yField }, tooltipOptions);\n  }\n\n  schema(\n    deepAssign({}, params, {\n      options: {\n        schema: {\n          shape: 'candle',\n          color: [risingFill, fallingFill],\n          style: stockStyle,\n        },\n        yField: Y_FIELD,\n        seriesField: TREND_FIELD,\n        rawFields: yField,\n        tooltip: tooltipOptions,\n      },\n    })\n  );\n\n  return params;\n}\n\n/**\n * meta 配置\n * @param params\n */\nexport function meta(params: Params<StockOptions>): Params<StockOptions> {\n  const { chart, options } = params;\n  const { meta, xAxis, yAxis, xField } = options;\n\n  const baseMeta = {\n    [xField]: {\n      type: 'timeCat',\n      tickCount: 6,\n    },\n    [TREND_FIELD]: {\n      values: [TREND_UP, TREND_DOWN],\n    },\n  };\n\n  const scales = deepAssign(baseMeta, meta, {\n    [xField]: pick(xAxis, AXIS_META_CONFIG_KEYS),\n    [Y_FIELD]: pick(yAxis, AXIS_META_CONFIG_KEYS),\n  });\n\n  chart.scale(scales);\n\n  return params;\n}\n\n/**\n * axis 配置\n * @param params\n */\nexport function axis(params: Params<StockOptions>): Params<StockOptions> {\n  const { chart, options } = params;\n  const { xAxis, yAxis, xField } = options;\n\n  // 为 false 则是不显示轴\n  if (xAxis === false) {\n    chart.axis(xField, false);\n  } else {\n    chart.axis(xField, xAxis);\n  }\n\n  if (yAxis === false) {\n    chart.axis(Y_FIELD, false);\n  } else {\n    chart.axis(Y_FIELD, yAxis);\n  }\n\n  return params;\n}\n\n/**\n * tooltip 配置\n * @param params\n */\nexport function tooltip(params: Params<StockOptions>): Params<StockOptions> {\n  const { chart, options } = params;\n  const { tooltip } = options;\n\n  if (tooltip !== false) {\n    chart.tooltip(tooltip);\n  } else {\n    chart.tooltip(false);\n  }\n\n  return params;\n}\n\n/**\n * legend 配置\n * @param params\n */\nexport function legend(params: Params<StockOptions>): Params<StockOptions> {\n  const { chart, options } = params;\n  const { legend } = options;\n\n  if (legend) {\n    chart.legend(TREND_FIELD, legend);\n  } else if (legend === false) {\n    chart.legend(false);\n  }\n\n  return params;\n}\n\n/**\n * K线图适配器\n * @param chart\n * @param options\n */\nexport function adaptor(params: Params<StockOptions>) {\n  // flow 的方式处理所有的配置到 G2 API\n  flow(theme, geometry, meta, axis, tooltip, legend, interaction, animation, annotation(), slider)(params);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
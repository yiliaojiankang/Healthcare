{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n/**\n * render w/ regl\n * @see https://github.com/regl-project/regl/blob/gh-pages/API.md\n */\nimport { gl } from '@antv/g-webgpu-core';\nimport regl from 'regl';\nimport ReglAttribute from './ReglAttribute';\nimport ReglBuffer from './ReglBuffer';\nimport ReglComputeModel from './ReglComputeModel';\nimport ReglElements from './ReglElements';\nimport ReglFramebuffer from './ReglFramebuffer';\nimport ReglModel from './ReglModel';\nimport ReglTexture2D from './ReglTexture2D';\n\n/**\n * regl renderer\n */\nexport var WebGLEngine = /*#__PURE__*/function () {\n  function WebGLEngine() {\n    var _this = this;\n    _classCallCheck(this, WebGLEngine);\n    this.supportWebGPU = false;\n    this.useWGSL = false;\n    this.$canvas = void 0;\n    this.gl = void 0;\n    this.inited = void 0;\n    this.createModel = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(options) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!options.uniforms) {\n                  _context2.next = 3;\n                  break;\n                }\n                _context2.next = 3;\n                return Promise.all(Object.keys(options.uniforms).map( /*#__PURE__*/function () {\n                  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(name) {\n                    var texture;\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            if (!(options.uniforms[name] &&\n                            // @ts-ignore\n                            options.uniforms[name].load !== undefined)) {\n                              _context.next = 5;\n                              break;\n                            }\n                            _context.next = 3;\n                            return options.uniforms[name].load();\n                          case 3:\n                            texture = _context.sent;\n                            // @ts-ignore\n                            options.uniforms[name] = texture;\n                          case 5:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n                  return function (_x2) {\n                    return _ref2.apply(this, arguments);\n                  };\n                }()));\n              case 3:\n                return _context2.abrupt(\"return\", new ReglModel(_this.gl, options));\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    this.createAttribute = function (options) {\n      return new ReglAttribute(_this.gl, options);\n    };\n    this.createBuffer = function (options) {\n      return new ReglBuffer(_this.gl, options);\n    };\n    this.createElements = function (options) {\n      return new ReglElements(_this.gl, options);\n    };\n    this.createTexture2D = function (options) {\n      return new ReglTexture2D(_this.gl, options);\n    };\n    this.createFramebuffer = function (options) {\n      return new ReglFramebuffer(_this.gl, options);\n    };\n    this.useFramebuffer = function (framebuffer, drawCommands) {\n      _this.gl({\n        framebuffer: framebuffer ? framebuffer.get() : null\n      })(drawCommands);\n    };\n    this.createComputeModel = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(context) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                return _context3.abrupt(\"return\", new ReglComputeModel(_this.gl, context));\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    this.clear = function (options) {\n      // @see https://github.com/regl-project/regl/blob/gh-pages/API.md#clear-the-draw-buffer\n      var color = options.color,\n        depth = options.depth,\n        stencil = options.stencil,\n        _options$framebuffer = options.framebuffer,\n        framebuffer = _options$framebuffer === void 0 ? null : _options$framebuffer;\n      var reglClearOptions = {\n        color: color,\n        depth: depth,\n        stencil: stencil\n      };\n      reglClearOptions.framebuffer = framebuffer === null ? framebuffer : framebuffer.get();\n      _this.gl.clear(reglClearOptions);\n    };\n    this.setScissor = function (scissor) {\n      if (_this.gl && _this.gl._gl) {\n        // https://developer.mozilla.org/zh-CN/docs/Web/API/WebGLRenderingContext/scissor\n        if (scissor.enable && scissor.box) {\n          // console.log(scissor.box);\n          _this.gl._gl.enable(gl.SCISSOR_TEST);\n          _this.gl._gl.scissor(scissor.box.x, scissor.box.y, scissor.box.width, scissor.box.height);\n        } else {\n          _this.gl._gl.disable(gl.SCISSOR_TEST);\n        }\n        _this.gl._refresh();\n      }\n    };\n    this.viewport = function (_ref4) {\n      var x = _ref4.x,\n        y = _ref4.y,\n        width = _ref4.width,\n        height = _ref4.height;\n      if (_this.gl && _this.gl._gl) {\n        // use WebGL context directly\n        // @see https://github.com/regl-project/regl/blob/gh-pages/API.md#unsafe-escape-hatch\n        _this.gl._gl.viewport(x, y, width, height);\n        _this.gl._refresh();\n      }\n    };\n    this.readPixels = function (options) {\n      var framebuffer = options.framebuffer,\n        x = options.x,\n        y = options.y,\n        width = options.width,\n        height = options.height;\n      var readPixelsOptions = {\n        x: x,\n        y: y,\n        width: width,\n        height: height\n      };\n      if (framebuffer) {\n        readPixelsOptions.framebuffer = framebuffer.get();\n      }\n      return _this.gl.read(readPixelsOptions);\n    };\n    this.getCanvas = function () {\n      return _this.$canvas;\n    };\n    this.getGLContext = function () {\n      return _this.gl._gl;\n    };\n    this.destroy = function () {\n      if (_this.gl) {\n        // @see https://github.com/regl-project/regl/blob/gh-pages/API.md#clean-up\n        _this.gl.destroy();\n        _this.inited = false;\n      }\n    };\n  }\n  _createClass(WebGLEngine, [{\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(cfg) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!this.inited) {\n                  _context4.next = 2;\n                  break;\n                }\n                return _context4.abrupt(\"return\");\n              case 2:\n                this.$canvas = cfg.canvas;\n                // tslint:disable-next-line:typedef\n                _context4.next = 5;\n                return new Promise(function (resolve, reject) {\n                  regl({\n                    canvas: cfg.canvas,\n                    attributes: {\n                      alpha: true,\n                      // use TAA instead of MSAA\n                      // @see https://www.khronos.org/registry/webgl/specs/1.0/#5.2.1\n                      antialias: cfg.antialias,\n                      premultipliedAlpha: true\n                      // preserveDrawingBuffer: false,\n                    },\n\n                    pixelRatio: 1,\n                    // TODO: use extensions\n                    extensions: ['OES_element_index_uint', 'OES_texture_float', 'OES_standard_derivatives',\n                    // wireframe\n                    'angle_instanced_arrays' // VSM shadow map\n                    ],\n\n                    optionalExtensions: ['EXT_texture_filter_anisotropic', 'EXT_blend_minmax', 'WEBGL_depth_texture'],\n                    profile: true,\n                    onDone: function onDone(err, r) {\n                      if (err || !r) {\n                        reject(err);\n                      }\n                      // @ts-ignore\n                      resolve(r);\n                    }\n                  });\n                });\n              case 5:\n                this.gl = _context4.sent;\n                this.inited = true;\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n      function init(_x4) {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }, {\n    key: \"isFloatSupported\",\n    value: function isFloatSupported() {\n      // @see https://github.com/antvis/GWebGPUEngine/issues/26\n      // @ts-ignore\n      return this.gl.limits.readFloat;\n    }\n  }, {\n    key: \"beginFrame\",\n    value: function beginFrame() {\n      //\n    }\n  }, {\n    key: \"endFrame\",\n    value: function endFrame() {\n      //\n    }\n  }]);\n  return WebGLEngine;\n}();","map":{"version":3,"names":["gl","regl","ReglAttribute","ReglBuffer","ReglComputeModel","ReglElements","ReglFramebuffer","ReglModel","ReglTexture2D","WebGLEngine","_this","_classCallCheck","supportWebGPU","useWGSL","$canvas","inited","createModel","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","options","wrap","_callee2$","_context2","prev","next","uniforms","Promise","all","Object","keys","map","_ref2","_callee","name","texture","_callee$","_context","load","undefined","sent","stop","_x2","apply","arguments","abrupt","_x","createAttribute","createBuffer","createElements","createTexture2D","createFramebuffer","useFramebuffer","framebuffer","drawCommands","get","createComputeModel","_ref3","_callee3","context","_callee3$","_context3","_x3","clear","color","depth","stencil","_options$framebuffer","reglClearOptions","setScissor","scissor","_gl","enable","box","SCISSOR_TEST","x","y","width","height","disable","_refresh","viewport","_ref4","readPixels","readPixelsOptions","read","getCanvas","getGLContext","destroy","_createClass","key","value","_init","_callee4","cfg","_callee4$","_context4","canvas","resolve","reject","attributes","alpha","antialias","premultipliedAlpha","pixelRatio","extensions","optionalExtensions","profile","onDone","err","r","init","_x4","isFloatSupported","limits","readFloat","beginFrame","endFrame"],"sources":["../../src/webgl/index.ts"],"sourcesContent":["/**\n * render w/ regl\n * @see https://github.com/regl-project/regl/blob/gh-pages/API.md\n */\nimport {\n  gl,\n  GLSLContext,\n  IAttribute,\n  IAttributeInitializationOptions,\n  IBuffer,\n  IBufferInitializationOptions,\n  IClearOptions,\n  IComputeModel,\n  IElements,\n  IElementsInitializationOptions,\n  IFramebuffer,\n  IFramebufferInitializationOptions,\n  IModel,\n  IModelInitializationOptions,\n  IReadPixelsOptions,\n  IRendererConfig,\n  IRendererService,\n  ITexture2D,\n  ITexture2DInitializationOptions,\n} from '@antv/g-webgpu-core';\nimport regl from 'regl';\nimport ReglAttribute from './ReglAttribute';\nimport ReglBuffer from './ReglBuffer';\nimport ReglComputeModel from './ReglComputeModel';\nimport ReglElements from './ReglElements';\nimport ReglFramebuffer from './ReglFramebuffer';\nimport ReglModel from './ReglModel';\nimport ReglTexture2D from './ReglTexture2D';\n\n/**\n * regl renderer\n */\nexport class WebGLEngine implements IRendererService {\n  public supportWebGPU = false;\n  public useWGSL = false;\n  private $canvas: HTMLCanvasElement;\n  private gl: regl.Regl;\n  private inited: boolean;\n\n  public async init(cfg: IRendererConfig): Promise<void> {\n    if (this.inited) {\n      return;\n    }\n    this.$canvas = cfg.canvas;\n    // tslint:disable-next-line:typedef\n    this.gl = await new Promise((resolve, reject) => {\n      regl({\n        canvas: cfg.canvas,\n        attributes: {\n          alpha: true,\n          // use TAA instead of MSAA\n          // @see https://www.khronos.org/registry/webgl/specs/1.0/#5.2.1\n          antialias: cfg.antialias,\n          premultipliedAlpha: true,\n          // preserveDrawingBuffer: false,\n        },\n        pixelRatio: 1,\n        // TODO: use extensions\n        extensions: [\n          'OES_element_index_uint',\n          'OES_texture_float',\n          'OES_standard_derivatives', // wireframe\n          'angle_instanced_arrays', // VSM shadow map\n        ],\n        optionalExtensions: [\n          'EXT_texture_filter_anisotropic',\n          'EXT_blend_minmax',\n          'WEBGL_depth_texture',\n        ],\n        profile: true,\n        onDone: (err: Error | null, r?: regl.Regl | undefined): void => {\n          if (err || !r) {\n            reject(err);\n          }\n          // @ts-ignore\n          resolve(r);\n        },\n      });\n    });\n    this.inited = true;\n  }\n\n  public isFloatSupported() {\n    // @see https://github.com/antvis/GWebGPUEngine/issues/26\n    // @ts-ignore\n    return this.gl.limits.readFloat;\n  }\n\n  public createModel = async (\n    options: IModelInitializationOptions,\n  ): Promise<IModel> => {\n    if (options.uniforms) {\n      await Promise.all(\n        Object.keys(options.uniforms).map(async (name) => {\n          if (\n            options.uniforms![name] &&\n            // @ts-ignore\n            options.uniforms![name].load !== undefined\n          ) {\n            // @ts-ignore\n            const texture = await options.uniforms![name].load();\n            // @ts-ignore\n            options.uniforms[name] = texture;\n          }\n        }),\n      );\n    }\n    return new ReglModel(this.gl, options);\n  };\n\n  public createAttribute = (\n    options: IAttributeInitializationOptions,\n  ): IAttribute => new ReglAttribute(this.gl, options);\n\n  public createBuffer = (options: IBufferInitializationOptions): IBuffer =>\n    new ReglBuffer(this.gl, options);\n\n  public createElements = (\n    options: IElementsInitializationOptions,\n  ): IElements => new ReglElements(this.gl, options);\n\n  public createTexture2D = (\n    options: ITexture2DInitializationOptions,\n  ): ITexture2D => new ReglTexture2D(this.gl, options);\n\n  public createFramebuffer = (options: IFramebufferInitializationOptions) =>\n    new ReglFramebuffer(this.gl, options);\n\n  public useFramebuffer = (\n    framebuffer: IFramebuffer | null,\n    drawCommands: () => void,\n  ) => {\n    this.gl({\n      framebuffer: framebuffer ? (framebuffer as ReglFramebuffer).get() : null,\n    })(drawCommands);\n  };\n\n  public createComputeModel = async (\n    context: GLSLContext,\n  ): Promise<IComputeModel> => {\n    return new ReglComputeModel(this.gl, context);\n  };\n\n  public clear = (options: IClearOptions) => {\n    // @see https://github.com/regl-project/regl/blob/gh-pages/API.md#clear-the-draw-buffer\n    const { color, depth, stencil, framebuffer = null } = options;\n    const reglClearOptions: regl.ClearOptions = {\n      color,\n      depth,\n      stencil,\n    };\n\n    reglClearOptions.framebuffer =\n      framebuffer === null\n        ? framebuffer\n        : (framebuffer as ReglFramebuffer).get();\n\n    this.gl.clear(reglClearOptions);\n  };\n\n  public setScissor = (\n    scissor: Partial<{\n      enable: boolean;\n      box: { x: number; y: number; width: number; height: number };\n    }>,\n  ) => {\n    if (this.gl && this.gl._gl) {\n      // https://developer.mozilla.org/zh-CN/docs/Web/API/WebGLRenderingContext/scissor\n      if (scissor.enable && scissor.box) {\n        // console.log(scissor.box);\n        this.gl._gl.enable(gl.SCISSOR_TEST);\n        this.gl._gl.scissor(\n          scissor.box.x,\n          scissor.box.y,\n          scissor.box.width,\n          scissor.box.height,\n        );\n      } else {\n        this.gl._gl.disable(gl.SCISSOR_TEST);\n      }\n      this.gl._refresh();\n    }\n  };\n\n  public viewport = ({\n    x,\n    y,\n    width,\n    height,\n  }: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  }) => {\n    if (this.gl && this.gl._gl) {\n      // use WebGL context directly\n      // @see https://github.com/regl-project/regl/blob/gh-pages/API.md#unsafe-escape-hatch\n      this.gl._gl.viewport(x, y, width, height);\n      this.gl._refresh();\n    }\n  };\n\n  public readPixels = (options: IReadPixelsOptions) => {\n    const { framebuffer, x, y, width, height } = options;\n    const readPixelsOptions: regl.ReadOptions = {\n      x,\n      y,\n      width,\n      height,\n    };\n    if (framebuffer) {\n      readPixelsOptions.framebuffer = (framebuffer as ReglFramebuffer).get();\n    }\n    return this.gl.read(readPixelsOptions);\n  };\n\n  public getCanvas = () => {\n    return this.$canvas;\n  };\n\n  public getGLContext = () => {\n    return this.gl._gl;\n  };\n\n  public destroy = () => {\n    if (this.gl) {\n      // @see https://github.com/regl-project/regl/blob/gh-pages/API.md#clean-up\n      this.gl.destroy();\n      this.inited = false;\n    }\n  };\n\n  public beginFrame() {\n    //\n  }\n\n  public endFrame() {\n    //\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
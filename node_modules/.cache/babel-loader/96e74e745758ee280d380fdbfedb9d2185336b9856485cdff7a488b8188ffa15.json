{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport { substitute, hasKey } from '@antv/util';\nimport { toPx, getTextPoint } from '../util/util';\nimport HtmlComponent from '../abstract/html-component';\nimport * as CssConst from './css-const';\nimport HtmlTheme from './html-theme';\nvar HtmlCrosshair = /** @class */function (_super) {\n  __extends(HtmlCrosshair, _super);\n  function HtmlCrosshair() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  HtmlCrosshair.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n    return __assign(__assign({}, cfg), {\n      name: 'crosshair',\n      type: 'html',\n      locationType: 'region',\n      start: {\n        x: 0,\n        y: 0\n      },\n      end: {\n        x: 0,\n        y: 0\n      },\n      capture: false,\n      text: null,\n      containerTpl: \"<div class=\\\"\" + CssConst.CONTAINER_CLASS + \"\\\"></div>\",\n      crosshairTpl: \"<div class=\\\"\" + CssConst.CROSSHAIR_LINE + \"\\\"></div>\",\n      textTpl: \"<span class=\\\"\" + CssConst.CROSSHAIR_TEXT + \"\\\">{content}</span>\",\n      domStyles: null,\n      containerClassName: CssConst.CONTAINER_CLASS,\n      defaultStyles: HtmlTheme,\n      defaultCfg: {\n        text: {\n          position: 'start',\n          content: null,\n          align: 'center',\n          offset: 10\n        }\n      }\n    });\n  };\n  HtmlCrosshair.prototype.render = function () {\n    this.resetText();\n    this.resetPosition();\n  };\n  // 绘制 crosshair\n  HtmlCrosshair.prototype.initCrossHair = function () {\n    var container = this.getContainer();\n    var crosshairTpl = this.get('crosshairTpl');\n    var crosshairEl = createDom(crosshairTpl);\n    container.appendChild(crosshairEl);\n    this.applyStyle(CssConst.CROSSHAIR_LINE, crosshairEl);\n    this.set('crosshairEl', crosshairEl);\n  };\n  // 获取文本的位置\n  HtmlCrosshair.prototype.getTextPoint = function () {\n    var _a = this.getLocation(),\n      start = _a.start,\n      end = _a.end;\n    var _b = this.get('text'),\n      position = _b.position,\n      offset = _b.offset;\n    return getTextPoint(start, end, position, offset);\n  };\n  // 设置 text\n  HtmlCrosshair.prototype.resetText = function () {\n    var text = this.get('text');\n    var textEl = this.get('textEl');\n    if (text) {\n      var content = text.content;\n      if (!textEl) {\n        var container = this.getContainer();\n        var textTpl = substitute(this.get('textTpl'), text);\n        textEl = createDom(textTpl);\n        container.appendChild(textEl);\n        this.applyStyle(CssConst.CROSSHAIR_TEXT, textEl);\n        this.set('textEl', textEl);\n      }\n      textEl.innerHTML = content;\n    } else if (textEl) {\n      textEl.remove();\n    }\n  };\n  // 是否垂直\n  HtmlCrosshair.prototype.isVertical = function (start, end) {\n    return start.x === end.x;\n  };\n  // 重新调整位置\n  HtmlCrosshair.prototype.resetPosition = function () {\n    var crosshairEl = this.get('crosshairEl');\n    if (!crosshairEl) {\n      this.initCrossHair();\n      crosshairEl = this.get('crosshairEl');\n    }\n    var start = this.get('start');\n    var end = this.get('end');\n    var minX = Math.min(start.x, end.x);\n    var minY = Math.min(start.y, end.y);\n    if (this.isVertical(start, end)) {\n      modifyCSS(crosshairEl, {\n        width: '1px',\n        height: toPx(Math.abs(end.y - start.y))\n      });\n    } else {\n      modifyCSS(crosshairEl, {\n        height: '1px',\n        width: toPx(Math.abs(end.x - start.x))\n      });\n    }\n    modifyCSS(crosshairEl, {\n      top: toPx(minY),\n      left: toPx(minX)\n    });\n    this.alignText();\n  };\n  HtmlCrosshair.prototype.alignText = function () {\n    // 重新设置 text 位置\n    var textEl = this.get('textEl');\n    if (textEl) {\n      var align = this.get('text').align;\n      var clientWidth = textEl.clientWidth;\n      var point = this.getTextPoint();\n      switch (align) {\n        case 'center':\n          point.x = point.x - clientWidth / 2;\n          break;\n        case 'right':\n          point.x = point.x - clientWidth;\n        case 'left':\n          break;\n      }\n      modifyCSS(textEl, {\n        top: toPx(point.y),\n        left: toPx(point.x)\n      });\n    }\n  };\n  HtmlCrosshair.prototype.updateInner = function (cfg) {\n    if (hasKey(cfg, 'text')) {\n      this.resetText();\n    }\n    _super.prototype.updateInner.call(this, cfg);\n  };\n  return HtmlCrosshair;\n}(HtmlComponent);\nexport default HtmlCrosshair;","map":{"version":3,"names":["createDom","modifyCSS","substitute","hasKey","toPx","getTextPoint","HtmlComponent","CssConst","HtmlTheme","HtmlCrosshair","_super","__extends","prototype","getDefaultCfg","cfg","call","__assign","name","type","locationType","start","x","y","end","capture","text","containerTpl","CONTAINER_CLASS","crosshairTpl","CROSSHAIR_LINE","textTpl","CROSSHAIR_TEXT","domStyles","containerClassName","defaultStyles","defaultCfg","position","content","align","offset","render","resetText","resetPosition","initCrossHair","container","getContainer","get","crosshairEl","appendChild","applyStyle","set","_a","getLocation","_b","textEl","innerHTML","remove","isVertical","minX","Math","min","minY","width","height","abs","top","left","alignText","clientWidth","point","updateInner"],"sources":["../../src/crosshair/html.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
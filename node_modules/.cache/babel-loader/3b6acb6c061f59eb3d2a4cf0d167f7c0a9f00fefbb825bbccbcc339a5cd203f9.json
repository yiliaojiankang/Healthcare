{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar greedy_fas_1 = __importDefault(require(\"./greedy-fas\"));\nvar run = function (g) {\n  var weightFn = function (g) {\n    return function (e) {\n      var _a;\n      return ((_a = g.edge(e)) === null || _a === void 0 ? void 0 : _a.weight) || 1;\n    };\n  };\n  var fas = g.graph().acyclicer === \"greedy\" ? (0, greedy_fas_1.default)(g, weightFn(g)) : dfsFAS(g);\n  fas === null || fas === void 0 ? void 0 : fas.forEach(function (e) {\n    var label = g.edge(e);\n    g.removeEdgeObj(e);\n    label.forwardName = e.name;\n    label.reversed = true;\n    g.setEdge(e.w, e.v, label, \"rev-\".concat(Math.random()));\n  });\n};\nvar dfsFAS = function (g) {\n  var fas = [];\n  var stack = {};\n  var visited = {};\n  var dfs = function (v) {\n    var _a;\n    if (visited[v]) {\n      return;\n    }\n    visited[v] = true;\n    stack[v] = true;\n    (_a = g.outEdges(v)) === null || _a === void 0 ? void 0 : _a.forEach(function (e) {\n      if (stack[e.w]) {\n        fas.push(e);\n      } else {\n        dfs(e.w);\n      }\n    });\n    delete stack[v];\n  };\n  g.nodes().forEach(dfs);\n  return fas;\n};\nvar undo = function (g) {\n  g.edges().forEach(function (e) {\n    var label = g.edge(e);\n    if (label.reversed) {\n      g.removeEdgeObj(e);\n      var forwardName = label.forwardName;\n      delete label.reversed;\n      delete label.forwardName;\n      g.setEdge(e.w, e.v, label, forwardName);\n    }\n  });\n};\nexports.default = {\n  run: run,\n  undo: undo\n};","map":{"version":3,"names":["greedy_fas_1","__importDefault","require","run","g","weightFn","e","_a","edge","weight","fas","graph","acyclicer","default","dfsFAS","forEach","label","removeEdgeObj","forwardName","name","reversed","setEdge","w","v","concat","Math","random","stack","visited","dfs","outEdges","push","nodes","undo","edges","exports"],"sources":["../../../../src/layout/dagre/src/acyclic.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}
{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nvar _dec, _class;\nvar _excluded = [\"type\"];\nimport { injectable } from 'inversify';\nimport 'reflect-metadata';\nvar lightTypeUniformMap = {\n  directional: {\n    lights: 'u_DirectionalLights',\n    num: 'u_NumOfDirectionalLights'\n  },\n  spot: {\n    lights: 'u_SpotLights',\n    num: 'u_NumOfSpotLights'\n  }\n};\nvar DEFAULT_LIGHT = {\n  type: 'directional',\n  direction: [1, 10.5, 12],\n  ambient: [0.2, 0.2, 0.2],\n  diffuse: [0.6, 0.6, 0.6],\n  specular: [0.1, 0.1, 0.1]\n};\nvar DEFAULT_DIRECTIONAL_LIGHT = {\n  direction: [0, 0, 0],\n  ambient: [0, 0, 0],\n  diffuse: [0, 0, 0],\n  specular: [0, 0, 0]\n};\nvar DEFAULT_SPOT_LIGHT = {\n  position: [0, 0, 0],\n  direction: [0, 0, 0],\n  ambient: [0, 0, 0],\n  diffuse: [0, 0, 0],\n  specular: [0, 0, 0],\n  constant: 1,\n  linear: 0,\n  quadratic: 0,\n  angle: 14,\n  exponent: 40,\n  blur: 5\n};\nexport function generateLightingUniforms(lights) {\n  var lightsMap = {\n    u_DirectionalLights: new Array(3).fill(_objectSpread({}, DEFAULT_DIRECTIONAL_LIGHT)),\n    u_NumOfDirectionalLights: 0,\n    u_SpotLights: new Array(3).fill(_objectSpread({}, DEFAULT_SPOT_LIGHT)),\n    u_NumOfSpotLights: 0\n  };\n  if (!lights || !lights.length) {\n    lights = [DEFAULT_LIGHT];\n  }\n  lights.forEach(function (_ref) {\n    var _ref$type = _ref.type,\n      type = _ref$type === void 0 ? 'directional' : _ref$type,\n      rest = _objectWithoutProperties(_ref, _excluded);\n    var lightsUniformName = lightTypeUniformMap[type].lights;\n    var lightsNumUniformName = lightTypeUniformMap[type].num;\n\n    // @ts-ignore\n    var num = lightsMap[lightsNumUniformName];\n    // @ts-ignore\n    lightsMap[lightsUniformName][num] = _objectSpread(_objectSpread({}, lightsMap[lightsUniformName][num]), rest);\n    // @ts-ignore\n    lightsMap[lightsNumUniformName]++;\n  });\n  return lightsMap;\n}\n\n/**\n * 光照 & Shadow\n */\nvar LightingPlugin = (_dec = injectable(), _dec(_class = /*#__PURE__*/function () {\n  function LightingPlugin() {\n    _classCallCheck(this, LightingPlugin);\n  }\n  _createClass(LightingPlugin, [{\n    key: \"apply\",\n    value: function apply(layer) {\n      layer.hooks.beforeRender.tap('LightingPlugin', function () {\n        var _layer$getLayerConfig = layer.getLayerConfig(),\n          enableLighting = _layer$getLayerConfig.enableLighting;\n        if (enableLighting) {\n          layer.models.forEach(function (model) {\n            return (\n              // @ts-ignore\n              model.addUniforms(_objectSpread({}, generateLightingUniforms()))\n            );\n          });\n        }\n      });\n    }\n  }]);\n  return LightingPlugin;\n}()) || _class);\nexport { LightingPlugin as default };","map":{"version":3,"names":["_classCallCheck","_createClass","_objectWithoutProperties","_objectSpread","_dec","_class","_excluded","injectable","lightTypeUniformMap","directional","lights","num","spot","DEFAULT_LIGHT","type","direction","ambient","diffuse","specular","DEFAULT_DIRECTIONAL_LIGHT","DEFAULT_SPOT_LIGHT","position","constant","linear","quadratic","angle","exponent","blur","generateLightingUniforms","lightsMap","u_DirectionalLights","Array","fill","u_NumOfDirectionalLights","u_SpotLights","u_NumOfSpotLights","length","forEach","_ref","_ref$type","rest","lightsUniformName","lightsNumUniformName","LightingPlugin","key","value","apply","layer","hooks","beforeRender","tap","_layer$getLayerConfig","getLayerConfig","enableLighting","models","model","addUniforms","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-layers/es/plugins/LightingPlugin.js"],"sourcesContent":["import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nvar _dec, _class;\nvar _excluded = [\"type\"];\nimport { injectable } from 'inversify';\nimport 'reflect-metadata';\nvar lightTypeUniformMap = {\n  directional: {\n    lights: 'u_DirectionalLights',\n    num: 'u_NumOfDirectionalLights'\n  },\n  spot: {\n    lights: 'u_SpotLights',\n    num: 'u_NumOfSpotLights'\n  }\n};\nvar DEFAULT_LIGHT = {\n  type: 'directional',\n  direction: [1, 10.5, 12],\n  ambient: [0.2, 0.2, 0.2],\n  diffuse: [0.6, 0.6, 0.6],\n  specular: [0.1, 0.1, 0.1]\n};\nvar DEFAULT_DIRECTIONAL_LIGHT = {\n  direction: [0, 0, 0],\n  ambient: [0, 0, 0],\n  diffuse: [0, 0, 0],\n  specular: [0, 0, 0]\n};\nvar DEFAULT_SPOT_LIGHT = {\n  position: [0, 0, 0],\n  direction: [0, 0, 0],\n  ambient: [0, 0, 0],\n  diffuse: [0, 0, 0],\n  specular: [0, 0, 0],\n  constant: 1,\n  linear: 0,\n  quadratic: 0,\n  angle: 14,\n  exponent: 40,\n  blur: 5\n};\nexport function generateLightingUniforms(lights) {\n  var lightsMap = {\n    u_DirectionalLights: new Array(3).fill(_objectSpread({}, DEFAULT_DIRECTIONAL_LIGHT)),\n    u_NumOfDirectionalLights: 0,\n    u_SpotLights: new Array(3).fill(_objectSpread({}, DEFAULT_SPOT_LIGHT)),\n    u_NumOfSpotLights: 0\n  };\n  if (!lights || !lights.length) {\n    lights = [DEFAULT_LIGHT];\n  }\n  lights.forEach(function (_ref) {\n    var _ref$type = _ref.type,\n      type = _ref$type === void 0 ? 'directional' : _ref$type,\n      rest = _objectWithoutProperties(_ref, _excluded);\n    var lightsUniformName = lightTypeUniformMap[type].lights;\n    var lightsNumUniformName = lightTypeUniformMap[type].num;\n\n    // @ts-ignore\n    var num = lightsMap[lightsNumUniformName];\n    // @ts-ignore\n    lightsMap[lightsUniformName][num] = _objectSpread(_objectSpread({}, lightsMap[lightsUniformName][num]), rest);\n    // @ts-ignore\n    lightsMap[lightsNumUniformName]++;\n  });\n  return lightsMap;\n}\n\n/**\n * 光照 & Shadow\n */\nvar LightingPlugin = (_dec = injectable(), _dec(_class = /*#__PURE__*/function () {\n  function LightingPlugin() {\n    _classCallCheck(this, LightingPlugin);\n  }\n  _createClass(LightingPlugin, [{\n    key: \"apply\",\n    value: function apply(layer) {\n      layer.hooks.beforeRender.tap('LightingPlugin', function () {\n        var _layer$getLayerConfig = layer.getLayerConfig(),\n          enableLighting = _layer$getLayerConfig.enableLighting;\n        if (enableLighting) {\n          layer.models.forEach(function (model) {\n            return (\n              // @ts-ignore\n              model.addUniforms(_objectSpread({}, generateLightingUniforms()))\n            );\n          });\n        }\n      });\n    }\n  }]);\n  return LightingPlugin;\n}()) || _class);\nexport { LightingPlugin as default };"],"mappings":"AAAA,OAAOA,eAAe,MAAM,2CAA2C;AACvE,OAAOC,YAAY,MAAM,wCAAwC;AACjE,OAAOC,wBAAwB,MAAM,oDAAoD;AACzF,OAAOC,aAAa,MAAM,0CAA0C;AACpE,IAAIC,IAAI,EAAEC,MAAM;AAChB,IAAIC,SAAS,GAAG,CAAC,MAAM,CAAC;AACxB,SAASC,UAAU,QAAQ,WAAW;AACtC,OAAO,kBAAkB;AACzB,IAAIC,mBAAmB,GAAG;EACxBC,WAAW,EAAE;IACXC,MAAM,EAAE,qBAAqB;IAC7BC,GAAG,EAAE;EACP,CAAC;EACDC,IAAI,EAAE;IACJF,MAAM,EAAE,cAAc;IACtBC,GAAG,EAAE;EACP;AACF,CAAC;AACD,IAAIE,aAAa,GAAG;EAClBC,IAAI,EAAE,aAAa;EACnBC,SAAS,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,EAAE,CAAC;EACxBC,OAAO,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EACxBC,OAAO,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EACxBC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG;AAC1B,CAAC;AACD,IAAIC,yBAAyB,GAAG;EAC9BJ,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACpBC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClBC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClBC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;AACpB,CAAC;AACD,IAAIE,kBAAkB,GAAG;EACvBC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACnBN,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACpBC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClBC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAClBC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACnBI,QAAQ,EAAE,CAAC;EACXC,MAAM,EAAE,CAAC;EACTC,SAAS,EAAE,CAAC;EACZC,KAAK,EAAE,EAAE;EACTC,QAAQ,EAAE,EAAE;EACZC,IAAI,EAAE;AACR,CAAC;AACD,OAAO,SAASC,wBAAwBA,CAAClB,MAAM,EAAE;EAC/C,IAAImB,SAAS,GAAG;IACdC,mBAAmB,EAAE,IAAIC,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC7B,aAAa,CAAC,CAAC,CAAC,EAAEgB,yBAAyB,CAAC,CAAC;IACpFc,wBAAwB,EAAE,CAAC;IAC3BC,YAAY,EAAE,IAAIH,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC7B,aAAa,CAAC,CAAC,CAAC,EAAEiB,kBAAkB,CAAC,CAAC;IACtEe,iBAAiB,EAAE;EACrB,CAAC;EACD,IAAI,CAACzB,MAAM,IAAI,CAACA,MAAM,CAAC0B,MAAM,EAAE;IAC7B1B,MAAM,GAAG,CAACG,aAAa,CAAC;EAC1B;EACAH,MAAM,CAAC2B,OAAO,CAAC,UAAUC,IAAI,EAAE;IAC7B,IAAIC,SAAS,GAAGD,IAAI,CAACxB,IAAI;MACvBA,IAAI,GAAGyB,SAAS,KAAK,KAAK,CAAC,GAAG,aAAa,GAAGA,SAAS;MACvDC,IAAI,GAAGtC,wBAAwB,CAACoC,IAAI,EAAEhC,SAAS,CAAC;IAClD,IAAImC,iBAAiB,GAAGjC,mBAAmB,CAACM,IAAI,CAAC,CAACJ,MAAM;IACxD,IAAIgC,oBAAoB,GAAGlC,mBAAmB,CAACM,IAAI,CAAC,CAACH,GAAG;;IAExD;IACA,IAAIA,GAAG,GAAGkB,SAAS,CAACa,oBAAoB,CAAC;IACzC;IACAb,SAAS,CAACY,iBAAiB,CAAC,CAAC9B,GAAG,CAAC,GAAGR,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAE0B,SAAS,CAACY,iBAAiB,CAAC,CAAC9B,GAAG,CAAC,CAAC,EAAE6B,IAAI,CAAC;IAC7G;IACAX,SAAS,CAACa,oBAAoB,CAAC,EAAE;EACnC,CAAC,CAAC;EACF,OAAOb,SAAS;AAClB;;AAEA;AACA;AACA;AACA,IAAIc,cAAc,IAAIvC,IAAI,GAAGG,UAAU,CAAC,CAAC,EAAEH,IAAI,CAACC,MAAM,GAAG,aAAa,YAAY;EAChF,SAASsC,cAAcA,CAAA,EAAG;IACxB3C,eAAe,CAAC,IAAI,EAAE2C,cAAc,CAAC;EACvC;EACA1C,YAAY,CAAC0C,cAAc,EAAE,CAAC;IAC5BC,GAAG,EAAE,OAAO;IACZC,KAAK,EAAE,SAASC,KAAKA,CAACC,KAAK,EAAE;MAC3BA,KAAK,CAACC,KAAK,CAACC,YAAY,CAACC,GAAG,CAAC,gBAAgB,EAAE,YAAY;QACzD,IAAIC,qBAAqB,GAAGJ,KAAK,CAACK,cAAc,CAAC,CAAC;UAChDC,cAAc,GAAGF,qBAAqB,CAACE,cAAc;QACvD,IAAIA,cAAc,EAAE;UAClBN,KAAK,CAACO,MAAM,CAACjB,OAAO,CAAC,UAAUkB,KAAK,EAAE;YACpC;cACE;cACAA,KAAK,CAACC,WAAW,CAACrD,aAAa,CAAC,CAAC,CAAC,EAAEyB,wBAAwB,CAAC,CAAC,CAAC;YAAC;UAEpE,CAAC,CAAC;QACJ;MACF,CAAC,CAAC;IACJ;EACF,CAAC,CAAC,CAAC;EACH,OAAOe,cAAc;AACvB,CAAC,CAAC,CAAC,CAAC,IAAItC,MAAM,CAAC;AACf,SAASsC,cAAc,IAAIc,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}
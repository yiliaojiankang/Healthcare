{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { getArrayBuffer, getURLFromTemplate } from '@antv/l7-utils';\nimport VectorSource from \"../source/vector\";\nvar DEFAULT_CONFIG = {\n  tileSize: 256,\n  minZoom: 0,\n  maxZoom: Infinity,\n  zoomOffset: 0,\n  warp: true\n};\nvar getVectorTile = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(url, tileParams, tile, requestParameters, getCustomData) {\n    var tileUrl;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          tileUrl = getURLFromTemplate(url, tileParams);\n          return _context.abrupt(\"return\", new Promise(function (resolve) {\n            if (getCustomData) {\n              getCustomData({\n                x: tile.x,\n                y: tile.y,\n                z: tile.z\n              }, function (err, data) {\n                if (err || !data) {\n                  resolve(undefined);\n                } else {\n                  var vectorSource = new VectorSource(data, tile.x, tile.y, tile.z);\n                  resolve(vectorSource);\n                }\n              });\n            } else {\n              var xhr = getArrayBuffer(_objectSpread(_objectSpread({}, requestParameters), {}, {\n                url: tileUrl\n              }), function (err, data) {\n                if (err || !data) {\n                  resolve(undefined);\n                } else {\n                  var vectorSource = new VectorSource(data, tile.x, tile.y, tile.z);\n                  resolve(vectorSource);\n                }\n              });\n              tile.xhrCancel = function () {\n                return xhr.cancel();\n              };\n            }\n          }));\n        case 2:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function getVectorTile(_x, _x2, _x3, _x4, _x5) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport default function mapboxVectorTile(data, cfg) {\n  // TODO: 后续考虑支持多服务\n  var url = Array.isArray(data) ? data[0] : data;\n  var getTileData = function getTileData(tileParams, tile) {\n    return getVectorTile(url, tileParams, tile, cfg === null || cfg === void 0 ? void 0 : cfg.requestParameters, cfg === null || cfg === void 0 ? void 0 : cfg.getCustomData);\n  };\n  var tilesetOptions = _objectSpread(_objectSpread(_objectSpread({}, DEFAULT_CONFIG), cfg), {}, {\n    getTileData: getTileData\n  });\n  return {\n    data: url,\n    dataArray: [],\n    tilesetOptions: tilesetOptions,\n    isTile: true\n  };\n}","map":{"version":3,"names":["_objectSpread","_asyncToGenerator","_regeneratorRuntime","getArrayBuffer","getURLFromTemplate","VectorSource","DEFAULT_CONFIG","tileSize","minZoom","maxZoom","Infinity","zoomOffset","warp","getVectorTile","_ref","mark","_callee","url","tileParams","tile","requestParameters","getCustomData","tileUrl","wrap","_callee$","_context","prev","next","abrupt","Promise","resolve","x","y","z","err","data","undefined","vectorSource","xhr","xhrCancel","cancel","stop","_x","_x2","_x3","_x4","_x5","apply","arguments","mapboxVectorTile","cfg","Array","isArray","getTileData","tilesetOptions","dataArray","isTile"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-source/es/parser/mvt.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { getArrayBuffer, getURLFromTemplate } from '@antv/l7-utils';\nimport VectorSource from \"../source/vector\";\nvar DEFAULT_CONFIG = {\n  tileSize: 256,\n  minZoom: 0,\n  maxZoom: Infinity,\n  zoomOffset: 0,\n  warp: true\n};\nvar getVectorTile = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(url, tileParams, tile, requestParameters, getCustomData) {\n    var tileUrl;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          tileUrl = getURLFromTemplate(url, tileParams);\n          return _context.abrupt(\"return\", new Promise(function (resolve) {\n            if (getCustomData) {\n              getCustomData({\n                x: tile.x,\n                y: tile.y,\n                z: tile.z\n              }, function (err, data) {\n                if (err || !data) {\n                  resolve(undefined);\n                } else {\n                  var vectorSource = new VectorSource(data, tile.x, tile.y, tile.z);\n                  resolve(vectorSource);\n                }\n              });\n            } else {\n              var xhr = getArrayBuffer(_objectSpread(_objectSpread({}, requestParameters), {}, {\n                url: tileUrl\n              }), function (err, data) {\n                if (err || !data) {\n                  resolve(undefined);\n                } else {\n                  var vectorSource = new VectorSource(data, tile.x, tile.y, tile.z);\n                  resolve(vectorSource);\n                }\n              });\n              tile.xhrCancel = function () {\n                return xhr.cancel();\n              };\n            }\n          }));\n        case 2:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function getVectorTile(_x, _x2, _x3, _x4, _x5) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport default function mapboxVectorTile(data, cfg) {\n  // TODO: 后续考虑支持多服务\n  var url = Array.isArray(data) ? data[0] : data;\n  var getTileData = function getTileData(tileParams, tile) {\n    return getVectorTile(url, tileParams, tile, cfg === null || cfg === void 0 ? void 0 : cfg.requestParameters, cfg === null || cfg === void 0 ? void 0 : cfg.getCustomData);\n  };\n  var tilesetOptions = _objectSpread(_objectSpread(_objectSpread({}, DEFAULT_CONFIG), cfg), {}, {\n    getTileData: getTileData\n  });\n  return {\n    data: url,\n    dataArray: [],\n    tilesetOptions: tilesetOptions,\n    isTile: true\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
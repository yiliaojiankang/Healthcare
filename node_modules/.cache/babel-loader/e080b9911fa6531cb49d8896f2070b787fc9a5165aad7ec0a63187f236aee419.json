{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nvar _dec, _class;\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { IDebugLog, ILayerStage } from '@antv/l7-core';\nimport { injectable } from 'inversify';\nimport 'reflect-metadata';\nimport TileLayer from \"../tile/core/BaseLayer\";\n/**\n * Layer Model 初始化，更新，销毁\n */\nvar LayerModelPlugin = (_dec = injectable(), _dec(_class = /*#__PURE__*/function () {\n  function LayerModelPlugin() {\n    _classCallCheck(this, LayerModelPlugin);\n  }\n  _createClass(LayerModelPlugin, [{\n    key: \"build\",\n    value: function () {\n      var _build = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(layer) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              // 更新Model 配置项 style options\n              layer.prepareBuildModel();\n              // 初始化 Model\n              _context.next = 3;\n              return layer.buildModels();\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      function build(_x) {\n        return _build.apply(this, arguments);\n      }\n      return build;\n    }()\n  }, {\n    key: \"initLayerModel\",\n    value: function () {\n      var _initLayerModel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(layer) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return this.build(layer);\n            case 2:\n              layer.styleNeedUpdate = false;\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function initLayerModel(_x2) {\n        return _initLayerModel.apply(this, arguments);\n      }\n      return initLayerModel;\n    }()\n  }, {\n    key: \"prepareLayerModel\",\n    value: function () {\n      var _prepareLayerModel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(layer) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return this.build(layer);\n            case 2:\n              layer.styleNeedUpdate = false;\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function prepareLayerModel(_x3) {\n        return _prepareLayerModel.apply(this, arguments);\n      }\n      return prepareLayerModel;\n    }()\n  }, {\n    key: \"apply\",\n    value: function apply(layer) {\n      var _this = this;\n      layer.hooks.init.tapPromise('LayerModelPlugin', /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!layer.getSource().isTile) {\n                _context4.next = 4;\n                break;\n              }\n              layer.prepareBuildModel();\n              layer.tileLayer = new TileLayer(layer);\n              return _context4.abrupt(\"return\");\n            case 4:\n              layer.log(IDebugLog.BuildModelStart, ILayerStage.INIT);\n              _context4.next = 7;\n              return _this.initLayerModel(layer);\n            case 7:\n              layer.log(IDebugLog.BuildModelEnd, ILayerStage.INIT);\n            case 8:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      })));\n      layer.hooks.beforeRenderData.tapPromise('LayerModelPlugin', /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(flag) {\n          return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n            while (1) switch (_context5.prev = _context5.next) {\n              case 0:\n                if (flag) {\n                  _context5.next = 2;\n                  break;\n                }\n                return _context5.abrupt(\"return\", false);\n              case 2:\n                if (!layer.getSource().isTile) {\n                  _context5.next = 5;\n                  break;\n                }\n                layer.tileLayer = new TileLayer(layer);\n                return _context5.abrupt(\"return\", false);\n              case 5:\n                layer.log(IDebugLog.BuildModelStart, ILayerStage.UPDATE);\n                _context5.next = 8;\n                return _this.prepareLayerModel(layer);\n              case 8:\n                layer.log(IDebugLog.BuildModelEnd, ILayerStage.UPDATE);\n                return _context5.abrupt(\"return\", true);\n              case 10:\n              case \"end\":\n                return _context5.stop();\n            }\n          }, _callee5);\n        }));\n        return function (_x4) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    }\n  }]);\n  return LayerModelPlugin;\n}()) || _class);\nexport { LayerModelPlugin as default };","map":{"version":3,"names":["_asyncToGenerator","_classCallCheck","_createClass","_dec","_class","_regeneratorRuntime","IDebugLog","ILayerStage","injectable","TileLayer","LayerModelPlugin","key","value","_build","mark","_callee","layer","wrap","_callee$","_context","prev","next","prepareBuildModel","buildModels","stop","build","_x","apply","arguments","_initLayerModel","_callee2","_callee2$","_context2","styleNeedUpdate","initLayerModel","_x2","_prepareLayerModel","_callee3","_callee3$","_context3","prepareLayerModel","_x3","_this","hooks","init","tapPromise","_callee4","_callee4$","_context4","getSource","isTile","tileLayer","abrupt","log","BuildModelStart","INIT","BuildModelEnd","beforeRenderData","_ref2","_callee5","flag","_callee5$","_context5","UPDATE","_x4","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-layers/es/plugins/LayerModelPlugin.js"],"sourcesContent":["import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nvar _dec, _class;\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { IDebugLog, ILayerStage } from '@antv/l7-core';\nimport { injectable } from 'inversify';\nimport 'reflect-metadata';\nimport TileLayer from \"../tile/core/BaseLayer\";\n/**\n * Layer Model 初始化，更新，销毁\n */\nvar LayerModelPlugin = (_dec = injectable(), _dec(_class = /*#__PURE__*/function () {\n  function LayerModelPlugin() {\n    _classCallCheck(this, LayerModelPlugin);\n  }\n  _createClass(LayerModelPlugin, [{\n    key: \"build\",\n    value: function () {\n      var _build = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(layer) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              // 更新Model 配置项 style options\n              layer.prepareBuildModel();\n              // 初始化 Model\n              _context.next = 3;\n              return layer.buildModels();\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      function build(_x) {\n        return _build.apply(this, arguments);\n      }\n      return build;\n    }()\n  }, {\n    key: \"initLayerModel\",\n    value: function () {\n      var _initLayerModel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(layer) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return this.build(layer);\n            case 2:\n              layer.styleNeedUpdate = false;\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function initLayerModel(_x2) {\n        return _initLayerModel.apply(this, arguments);\n      }\n      return initLayerModel;\n    }()\n  }, {\n    key: \"prepareLayerModel\",\n    value: function () {\n      var _prepareLayerModel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(layer) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return this.build(layer);\n            case 2:\n              layer.styleNeedUpdate = false;\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function prepareLayerModel(_x3) {\n        return _prepareLayerModel.apply(this, arguments);\n      }\n      return prepareLayerModel;\n    }()\n  }, {\n    key: \"apply\",\n    value: function apply(layer) {\n      var _this = this;\n      layer.hooks.init.tapPromise('LayerModelPlugin', /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!layer.getSource().isTile) {\n                _context4.next = 4;\n                break;\n              }\n              layer.prepareBuildModel();\n              layer.tileLayer = new TileLayer(layer);\n              return _context4.abrupt(\"return\");\n            case 4:\n              layer.log(IDebugLog.BuildModelStart, ILayerStage.INIT);\n              _context4.next = 7;\n              return _this.initLayerModel(layer);\n            case 7:\n              layer.log(IDebugLog.BuildModelEnd, ILayerStage.INIT);\n            case 8:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      })));\n      layer.hooks.beforeRenderData.tapPromise('LayerModelPlugin', /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(flag) {\n          return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n            while (1) switch (_context5.prev = _context5.next) {\n              case 0:\n                if (flag) {\n                  _context5.next = 2;\n                  break;\n                }\n                return _context5.abrupt(\"return\", false);\n              case 2:\n                if (!layer.getSource().isTile) {\n                  _context5.next = 5;\n                  break;\n                }\n                layer.tileLayer = new TileLayer(layer);\n                return _context5.abrupt(\"return\", false);\n              case 5:\n                layer.log(IDebugLog.BuildModelStart, ILayerStage.UPDATE);\n                _context5.next = 8;\n                return _this.prepareLayerModel(layer);\n              case 8:\n                layer.log(IDebugLog.BuildModelEnd, ILayerStage.UPDATE);\n                return _context5.abrupt(\"return\", true);\n              case 10:\n              case \"end\":\n                return _context5.stop();\n            }\n          }, _callee5);\n        }));\n        return function (_x4) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    }\n  }]);\n  return LayerModelPlugin;\n}()) || _class);\nexport { LayerModelPlugin as default };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
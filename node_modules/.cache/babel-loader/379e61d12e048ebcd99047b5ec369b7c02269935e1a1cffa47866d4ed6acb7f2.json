{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nimport { TYPES } from '@antv/l7-core';\nimport { anchorTranslate, anchorType, applyAnchorClass, DOM } from '@antv/l7-utils';\nimport { EventEmitter } from 'eventemitter3';\nimport { createL7Icon } from \"../utils/icon\";\nexport { Popup };\nvar Popup = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(Popup, _EventEmitter);\n  var _super = _createSuper(Popup);\n  function Popup(cfg) {\n    var _this;\n    _classCallCheck(this, Popup);\n    _this = _super.call(this);\n    /**\n     * 配置\n     * @protected\n     */\n    /**\n     * 关闭按钮对应的 DOM\n     * @protected\n     */\n    /**\n     * Popup 的总容器 DOM，包含 content 和 tip\n     * @protected\n     */\n    /**\n     * popup 气泡容器\n     * @protected\n     */\n    /**\n     * popup 气泡标题\n     * @protected\n     */\n    /**\n     * popup 内容容器\n     * @protected\n     */\n    /**\n     * 气泡箭头对应的 DOM\n     * @protected\n     */\n    /**\n     * 当前是否展示\n     * @protected\n     */\n    _defineProperty(_assertThisInitialized(_this), \"isShow\", true);\n    _defineProperty(_assertThisInitialized(_this), \"onMouseMove\", function (e) {\n      var _container$getBoundin;\n      var container = _this.mapsService.getMapContainer();\n      var _ref = (_container$getBoundin = container === null || container === void 0 ? void 0 : container.getBoundingClientRect()) !== null && _container$getBoundin !== void 0 ? _container$getBoundin : {},\n        _ref$left = _ref.left,\n        left = _ref$left === void 0 ? 0 : _ref$left,\n        _ref$top = _ref.top,\n        top = _ref$top === void 0 ? 0 : _ref$top;\n      _this.setPopupPosition(e.clientX - left, e.clientY - top);\n    });\n    /**\n     * 将经纬度转换成对应的像素偏移位置\n     * @protected\n     */\n    _defineProperty(_assertThisInitialized(_this), \"updateLngLatPosition\", function () {\n      if (!_this.mapsService || _this.popupOption.followCursor) {\n        return;\n      }\n      var _this$lngLat = _this.lngLat,\n        lng = _this$lngLat.lng,\n        lat = _this$lngLat.lat;\n      var _this$mapsService$lng = _this.mapsService.lngLatToContainer([lng, lat]),\n        x = _this$mapsService$lng.x,\n        y = _this$mapsService$lng.y;\n      _this.setPopupPosition(x, y);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onKeyDown\", function (e) {\n      if (e.keyCode === 27) {\n        _this.remove();\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onCloseButtonClick\", function (e) {\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      }\n      _this.hide();\n    });\n    _defineProperty(_assertThisInitialized(_this), \"update\", function () {\n      var hasPosition = !!_this.lngLat;\n      var _this$popupOption = _this.popupOption,\n        className = _this$popupOption.className,\n        style = _this$popupOption.style,\n        maxWidth = _this$popupOption.maxWidth,\n        anchor = _this$popupOption.anchor,\n        stopPropagation = _this$popupOption.stopPropagation;\n      if (!_this.mapsService || !hasPosition || !_this.content) {\n        return;\n      }\n      var popupContainer = _this.mapsService.getMarkerContainer();\n      // 如果当前没有创建 Popup 容器则创建\n      if (!_this.container && popupContainer) {\n        _this.container = DOM.create('div', \"l7-popup \".concat(className !== null && className !== void 0 ? className : '', \" \").concat(!_this.isShow ? 'l7-popup-hide' : ''), popupContainer);\n        if (style) {\n          _this.container.setAttribute('style', style);\n        }\n        _this.tip = DOM.create('div', 'l7-popup-tip', _this.container);\n        _this.container.appendChild(_this.content);\n\n        // 高德地图需要阻止事件冒泡 // 测试mapbox 地图不需要添加\n        if (stopPropagation) {\n          ['mousemove', 'mousedown', 'mouseup', 'click', 'dblclick'].forEach(function (type) {\n            _this.container.addEventListener(type, function (e) {\n              e.stopPropagation();\n            });\n          });\n        }\n        _this.container.style.whiteSpace = 'nowrap';\n      }\n      _this.updateLngLatPosition();\n      DOM.setTransform(_this.container, \"\".concat(anchorTranslate[anchor]));\n      applyAnchorClass(_this.container, anchor, 'popup');\n      if (maxWidth) {\n        var _this$container$getBo = _this.container.getBoundingClientRect(),\n          width = _this$container$getBo.width;\n        if (width > parseFloat(maxWidth)) {\n          _this.container.style.width = maxWidth;\n        }\n      } else {\n        _this.container.style.removeProperty('width');\n      }\n    });\n    _this.popupOption = _objectSpread(_objectSpread({}, _this.getDefault(cfg !== null && cfg !== void 0 ? cfg : {})), cfg);\n    var lngLat = _this.popupOption.lngLat;\n    if (lngLat) {\n      _this.lngLat = lngLat;\n    }\n    return _this;\n  }\n  _createClass(Popup, [{\n    key: \"lngLat\",\n    get: function get() {\n      var _this$popupOption$lng;\n      return (_this$popupOption$lng = this.popupOption.lngLat) !== null && _this$popupOption$lng !== void 0 ? _this$popupOption$lng : {\n        lng: 0,\n        lat: 0\n      };\n    },\n    set: function set(newLngLat) {\n      this.popupOption.lngLat = newLngLat;\n    }\n  }, {\n    key: \"getIsShow\",\n    value: function getIsShow() {\n      return this.isShow;\n    }\n  }, {\n    key: \"addTo\",\n    value: function addTo(scene) {\n      this.mapsService = scene.get(TYPES.IMapService);\n      this.sceneService = scene.get(TYPES.ISceneService);\n      this.layerService = scene.get(TYPES.ILayerService);\n      this.mapsService.on('camerachange', this.update);\n      this.mapsService.on('viewchange', this.update);\n      this.scene = scene;\n      this.update();\n      // 临时关闭\n      this.updateCloseOnClick();\n      this.updateCloseOnEsc();\n      this.updateFollowCursor();\n      var _this$popupOption2 = this.popupOption,\n        html = _this$popupOption2.html,\n        text = _this$popupOption2.text,\n        title = _this$popupOption2.title;\n      if (html) {\n        this.setHTML(html);\n      } else if (text) {\n        this.setText(text);\n      }\n      if (title) {\n        this.setTitle(title);\n      }\n      this.emit('open');\n      return this;\n    }\n\n    // 移除popup\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      if (!(this !== null && this !== void 0 && this.isOpen())) {\n        return;\n      }\n      if (this.content) {\n        DOM.remove(this.content);\n      }\n      if (this.container) {\n        DOM.remove(this.container);\n        // @ts-ignore\n        delete this.container;\n      }\n      if (this.mapsService) {\n        // TODO: mapbox AMap 事件同步\n        this.mapsService.off('camerachange', this.update);\n        this.mapsService.off('viewchange', this.update);\n        this.updateCloseOnClick(true);\n        this.updateCloseOnEsc(true);\n        this.updateFollowCursor(true);\n        // @ts-ignore\n        delete this.mapsService;\n      }\n      this.emit('close');\n      return this;\n    }\n\n    /**\n     * 获取 option 配置\n     */\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      return this.popupOption;\n    }\n  }, {\n    key: \"setOptions\",\n    value: function setOptions(option) {\n      this.show();\n      this.popupOption = _objectSpread(_objectSpread({}, this.popupOption), option);\n      if (this.checkUpdateOption(option, ['html', 'text', 'title', 'closeButton', 'closeButtonOffsets', 'maxWidth', 'anchor', 'stopPropagation', 'className', 'style', 'lngLat', 'offsets'])) {\n        if (this.container) {\n          DOM.remove(this.container);\n          // @ts-ignore\n          this.container = undefined;\n        }\n        if (this.popupOption.html) {\n          this.setHTML(this.popupOption.html);\n        } else if (this.popupOption.text) {\n          this.setText(this.popupOption.text);\n        }\n        if (this.popupOption.title) {\n          this.setTitle(this.popupOption.title);\n        }\n      }\n      if (this.checkUpdateOption(option, ['closeOnEsc'])) {\n        this.updateCloseOnEsc();\n      }\n      if (this.checkUpdateOption(option, ['closeOnClick'])) {\n        this.updateCloseOnClick();\n      }\n      if (this.checkUpdateOption(option, ['followCursor'])) {\n        this.updateFollowCursor();\n      }\n      if (this.checkUpdateOption(option, ['html']) && option.html) {\n        this.setHTML(option.html);\n      } else if (this.checkUpdateOption(option, ['text']) && option.text) {\n        this.setText(option.text);\n      }\n      if (this.checkUpdateOption(option, ['lngLat']) && option.lngLat) {\n        this.setLnglat(option.lngLat);\n      }\n      return this;\n    }\n  }, {\n    key: \"open\",\n    value: function open() {\n      this.addTo(this.scene);\n      return this;\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.remove();\n      return this;\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      if (this.isShow) {\n        return;\n      }\n      if (this.container) {\n        DOM.removeClass(this.container, 'l7-popup-hide');\n      }\n      this.isShow = true;\n      this.emit('show');\n      return this;\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      if (!this.isShow) {\n        return;\n      }\n      if (this.container) {\n        DOM.addClass(this.container, 'l7-popup-hide');\n      }\n      this.isShow = false;\n      this.emit('hide');\n      return this;\n    }\n\n    /**\n     * 设置 HTML 内容\n     * @param html\n     */\n  }, {\n    key: \"setHTML\",\n    value: function setHTML(html) {\n      this.popupOption.html = html;\n      return this.setDOMContent(html);\n    }\n\n    /**\n     * 设置 Popup 展示文本\n     * @param text\n     */\n  }, {\n    key: \"setText\",\n    value: function setText(text) {\n      this.popupOption.text = text;\n      return this.setDOMContent(window.document.createTextNode(text));\n    }\n  }, {\n    key: \"setTitle\",\n    value: function setTitle(title) {\n      this.show();\n      this.popupOption.title = title;\n      if (title) {\n        if (!this.contentTitle) {\n          this.contentTitle = DOM.create('div', 'l7-popup-content__title');\n          if (this.content.firstChild) {\n            this.content.insertBefore(this.contentTitle, this.content.firstChild);\n          } else {\n            this.content.append(this.contentTitle);\n          }\n        }\n        DOM.clearChildren(this.contentTitle);\n        DOM.appendElementType(this.contentTitle, title);\n      } else if (this.contentTitle) {\n        DOM.remove(this.contentTitle);\n        this.contentTitle = undefined;\n      }\n    }\n\n    /**\n     * 将地图自动平移到气泡位置\n     */\n  }, {\n    key: \"panToPopup\",\n    value: function panToPopup() {\n      var _this$lngLat2 = this.lngLat,\n        lng = _this$lngLat2.lng,\n        lat = _this$lngLat2.lat;\n      if (this.popupOption.autoPan) {\n        this.mapsService.panTo([lng, lat]);\n      }\n      return this;\n    }\n  }, {\n    key: \"setLngLat\",\n    value: function setLngLat(lngLat) {\n      return this.setLnglat(lngLat);\n    }\n\n    /**\n     * 设置 Popup 所在经纬度\n     * @param lngLat\n     */\n  }, {\n    key: \"setLnglat\",\n    value: function setLnglat(lngLat) {\n      var _this2 = this;\n      this.show();\n      this.lngLat = lngLat;\n      if (Array.isArray(lngLat)) {\n        this.lngLat = {\n          lng: lngLat[0],\n          lat: lngLat[1]\n        };\n      }\n      if (this.mapsService) {\n        // 防止事件重复监听\n        this.mapsService.off('camerachange', this.update);\n        this.mapsService.off('viewchange', this.update);\n        this.mapsService.on('camerachange', this.update);\n        this.mapsService.on('viewchange', this.update);\n      }\n      this.update();\n      if (this.popupOption.autoPan) {\n        setTimeout(function () {\n          _this2.panToPopup();\n        }, 0);\n      }\n      return this;\n    }\n\n    /**\n     * 获取 Popup 所在经纬度\n     */\n  }, {\n    key: \"getLnglat\",\n    value: function getLnglat() {\n      return this.lngLat;\n    }\n\n    /**\n     * 设置 Popup 最大宽度\n     * @param maxWidth\n     */\n  }, {\n    key: \"setMaxWidth\",\n    value: function setMaxWidth(maxWidth) {\n      this.popupOption.maxWidth = maxWidth;\n      this.update();\n      return this;\n    }\n  }, {\n    key: \"isOpen\",\n    value: function isOpen() {\n      return !!this.mapsService;\n    }\n  }, {\n    key: \"getDefault\",\n    value:\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    function getDefault(option) {\n      // tslint:disable-next-line:no-object-literal-type-assertion\n      return {\n        closeButton: true,\n        closeOnClick: false,\n        maxWidth: '240px',\n        offsets: [0, 0],\n        anchor: anchorType.BOTTOM,\n        stopPropagation: true,\n        autoPan: false,\n        autoClose: true,\n        closeOnEsc: false,\n        followCursor: false\n      };\n    }\n\n    /**\n     * 设置 Popup 内容 HTML\n     * @param element\n     */\n  }, {\n    key: \"setDOMContent\",\n    value: function setDOMContent(element) {\n      this.show();\n      this.createContent();\n      DOM.appendElementType(this.contentPanel, element);\n      this.update();\n      return this;\n    }\n\n    /**\n     * 绑定地图点击事件触发销毁 Popup\n     * @protected\n     */\n  }, {\n    key: \"updateCloseOnClick\",\n    value: function updateCloseOnClick(onlyClear) {\n      var _this3 = this;\n      var mapsService = this.mapsService;\n      if (mapsService) {\n        mapsService === null || mapsService === void 0 || mapsService.off('click', this.onCloseButtonClick);\n        if (this.popupOption.closeOnClick && !onlyClear) {\n          requestAnimationFrame(function () {\n            mapsService === null || mapsService === void 0 || mapsService.on('click', _this3.onCloseButtonClick);\n          });\n        }\n      }\n    }\n  }, {\n    key: \"updateCloseOnEsc\",\n    value: function updateCloseOnEsc(onlyClear) {\n      window.removeEventListener('keydown', this.onKeyDown);\n      if (this.popupOption.closeOnEsc && !onlyClear) {\n        window.addEventListener('keydown', this.onKeyDown);\n      }\n    }\n  }, {\n    key: \"updateFollowCursor\",\n    value: function updateFollowCursor(onlyClear) {\n      var _this$mapsService;\n      var container = (_this$mapsService = this.mapsService) === null || _this$mapsService === void 0 ? void 0 : _this$mapsService.getContainer();\n      if (container) {\n        container === null || container === void 0 || container.removeEventListener('mousemove', this.onMouseMove);\n        if (this.popupOption.followCursor && !onlyClear) {\n          container === null || container === void 0 || container.addEventListener('mousemove', this.onMouseMove);\n        }\n      }\n    }\n  }, {\n    key: \"createContent\",\n    value:\n    /**\n     * 创建 Popup 内容容器的 DOM （在每次 setHTML 或 setText 时都会被调用）\n     * @protected\n     */\n    function createContent() {\n      var _this4 = this;\n      if (this.content) {\n        DOM.remove(this.content);\n      }\n      this.contentTitle = undefined;\n      this.content = DOM.create('div', 'l7-popup-content', this.container);\n      this.setTitle(this.popupOption.title);\n      if (this.popupOption.closeButton) {\n        var closeButton = createL7Icon('l7-icon-guanbi');\n        DOM.addClass(closeButton, 'l7-popup-close-button');\n        this.content.appendChild(closeButton);\n        if (this.popupOption.closeButtonOffsets) {\n          // 关闭按钮的偏移\n          closeButton.style.right = this.popupOption.closeButtonOffsets[0] + 'px';\n          closeButton.style.top = this.popupOption.closeButtonOffsets[1] + 'px';\n        }\n\n        // this.closeButton.type = 'button';\n        closeButton.setAttribute('aria-label', 'Close popup');\n        closeButton.addEventListener('click', function () {\n          _this4.hide();\n        });\n\n        // 防止点击 Popup 关闭按钮时，触发 Layer click 事件\n        closeButton.addEventListener('pointerup', function (e) {\n          e.stopPropagation();\n        });\n        closeButton.addEventListener('pointerdown', function (e) {\n          e.stopPropagation();\n        });\n        this.closeButton = closeButton;\n      } else {\n        this.closeButton = undefined;\n      }\n      this.contentPanel = DOM.create('div', 'l7-popup-content__panel', this.content);\n    }\n  }, {\n    key: \"setPopupPosition\",\n    value:\n    /**\n     * 设置 Popup 相对于地图容器的 Position\n     * @param left\n     * @param top\n     * @protected\n     */\n    function setPopupPosition(left, top) {\n      if (this.container) {\n        var offsets = this.popupOption.offsets;\n        this.container.style.left = left + offsets[0] + 'px';\n        this.container.style.top = top - offsets[1] + 'px';\n      }\n    }\n\n    /**\n     * 检查当前传入 option 是否包含 keys 字段\n     * @param option\n     * @param keys\n     * @protected\n     */\n  }, {\n    key: \"checkUpdateOption\",\n    value: function checkUpdateOption(option, keys) {\n      return keys.some(function (key) {\n        return key in option;\n      });\n    }\n  }]);\n  return Popup;\n}(EventEmitter);\nexport { Popup as default };","map":{"version":3,"names":["_objectSpread","_classCallCheck","_createClass","_assertThisInitialized","_inherits","_possibleConstructorReturn","_getPrototypeOf","_defineProperty","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","arguments","apply","sham","Proxy","Boolean","prototype","valueOf","call","e","TYPES","anchorTranslate","anchorType","applyAnchorClass","DOM","EventEmitter","createL7Icon","Popup","_EventEmitter","_super","cfg","_this","_container$getBoundin","container","mapsService","getMapContainer","_ref","getBoundingClientRect","_ref$left","left","_ref$top","top","setPopupPosition","clientX","clientY","popupOption","followCursor","_this$lngLat","lngLat","lng","lat","_this$mapsService$lng","lngLatToContainer","x","y","keyCode","remove","stopPropagation","hide","hasPosition","_this$popupOption","className","style","maxWidth","anchor","content","popupContainer","getMarkerContainer","create","concat","isShow","setAttribute","tip","appendChild","forEach","type","addEventListener","whiteSpace","updateLngLatPosition","setTransform","_this$container$getBo","width","parseFloat","removeProperty","getDefault","key","get","_this$popupOption$lng","set","newLngLat","value","getIsShow","addTo","scene","IMapService","sceneService","ISceneService","layerService","ILayerService","on","update","updateCloseOnClick","updateCloseOnEsc","updateFollowCursor","_this$popupOption2","html","text","title","setHTML","setText","setTitle","emit","isOpen","off","getOptions","setOptions","option","show","checkUpdateOption","undefined","setLnglat","open","close","removeClass","addClass","setDOMContent","window","document","createTextNode","contentTitle","firstChild","insertBefore","append","clearChildren","appendElementType","panToPopup","_this$lngLat2","autoPan","panTo","setLngLat","_this2","Array","isArray","setTimeout","getLnglat","setMaxWidth","closeButton","closeOnClick","offsets","BOTTOM","autoClose","closeOnEsc","element","createContent","contentPanel","onlyClear","_this3","onCloseButtonClick","requestAnimationFrame","removeEventListener","onKeyDown","_this$mapsService","getContainer","onMouseMove","_this4","closeButtonOffsets","right","keys","some","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-component/es/popup/popup.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport { TYPES } from '@antv/l7-core';\nimport { anchorTranslate, anchorType, applyAnchorClass, DOM } from '@antv/l7-utils';\nimport { EventEmitter } from 'eventemitter3';\nimport { createL7Icon } from \"../utils/icon\";\nexport { Popup };\nvar Popup = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(Popup, _EventEmitter);\n  var _super = _createSuper(Popup);\n  function Popup(cfg) {\n    var _this;\n    _classCallCheck(this, Popup);\n    _this = _super.call(this);\n    /**\n     * 配置\n     * @protected\n     */\n    /**\n     * 关闭按钮对应的 DOM\n     * @protected\n     */\n    /**\n     * Popup 的总容器 DOM，包含 content 和 tip\n     * @protected\n     */\n    /**\n     * popup 气泡容器\n     * @protected\n     */\n    /**\n     * popup 气泡标题\n     * @protected\n     */\n    /**\n     * popup 内容容器\n     * @protected\n     */\n    /**\n     * 气泡箭头对应的 DOM\n     * @protected\n     */\n    /**\n     * 当前是否展示\n     * @protected\n     */\n    _defineProperty(_assertThisInitialized(_this), \"isShow\", true);\n    _defineProperty(_assertThisInitialized(_this), \"onMouseMove\", function (e) {\n      var _container$getBoundin;\n      var container = _this.mapsService.getMapContainer();\n      var _ref = (_container$getBoundin = container === null || container === void 0 ? void 0 : container.getBoundingClientRect()) !== null && _container$getBoundin !== void 0 ? _container$getBoundin : {},\n        _ref$left = _ref.left,\n        left = _ref$left === void 0 ? 0 : _ref$left,\n        _ref$top = _ref.top,\n        top = _ref$top === void 0 ? 0 : _ref$top;\n      _this.setPopupPosition(e.clientX - left, e.clientY - top);\n    });\n    /**\n     * 将经纬度转换成对应的像素偏移位置\n     * @protected\n     */\n    _defineProperty(_assertThisInitialized(_this), \"updateLngLatPosition\", function () {\n      if (!_this.mapsService || _this.popupOption.followCursor) {\n        return;\n      }\n      var _this$lngLat = _this.lngLat,\n        lng = _this$lngLat.lng,\n        lat = _this$lngLat.lat;\n      var _this$mapsService$lng = _this.mapsService.lngLatToContainer([lng, lat]),\n        x = _this$mapsService$lng.x,\n        y = _this$mapsService$lng.y;\n      _this.setPopupPosition(x, y);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onKeyDown\", function (e) {\n      if (e.keyCode === 27) {\n        _this.remove();\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onCloseButtonClick\", function (e) {\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      }\n      _this.hide();\n    });\n    _defineProperty(_assertThisInitialized(_this), \"update\", function () {\n      var hasPosition = !!_this.lngLat;\n      var _this$popupOption = _this.popupOption,\n        className = _this$popupOption.className,\n        style = _this$popupOption.style,\n        maxWidth = _this$popupOption.maxWidth,\n        anchor = _this$popupOption.anchor,\n        stopPropagation = _this$popupOption.stopPropagation;\n      if (!_this.mapsService || !hasPosition || !_this.content) {\n        return;\n      }\n      var popupContainer = _this.mapsService.getMarkerContainer();\n      // 如果当前没有创建 Popup 容器则创建\n      if (!_this.container && popupContainer) {\n        _this.container = DOM.create('div', \"l7-popup \".concat(className !== null && className !== void 0 ? className : '', \" \").concat(!_this.isShow ? 'l7-popup-hide' : ''), popupContainer);\n        if (style) {\n          _this.container.setAttribute('style', style);\n        }\n        _this.tip = DOM.create('div', 'l7-popup-tip', _this.container);\n        _this.container.appendChild(_this.content);\n\n        // 高德地图需要阻止事件冒泡 // 测试mapbox 地图不需要添加\n        if (stopPropagation) {\n          ['mousemove', 'mousedown', 'mouseup', 'click', 'dblclick'].forEach(function (type) {\n            _this.container.addEventListener(type, function (e) {\n              e.stopPropagation();\n            });\n          });\n        }\n        _this.container.style.whiteSpace = 'nowrap';\n      }\n      _this.updateLngLatPosition();\n      DOM.setTransform(_this.container, \"\".concat(anchorTranslate[anchor]));\n      applyAnchorClass(_this.container, anchor, 'popup');\n      if (maxWidth) {\n        var _this$container$getBo = _this.container.getBoundingClientRect(),\n          width = _this$container$getBo.width;\n        if (width > parseFloat(maxWidth)) {\n          _this.container.style.width = maxWidth;\n        }\n      } else {\n        _this.container.style.removeProperty('width');\n      }\n    });\n    _this.popupOption = _objectSpread(_objectSpread({}, _this.getDefault(cfg !== null && cfg !== void 0 ? cfg : {})), cfg);\n    var lngLat = _this.popupOption.lngLat;\n    if (lngLat) {\n      _this.lngLat = lngLat;\n    }\n    return _this;\n  }\n  _createClass(Popup, [{\n    key: \"lngLat\",\n    get: function get() {\n      var _this$popupOption$lng;\n      return (_this$popupOption$lng = this.popupOption.lngLat) !== null && _this$popupOption$lng !== void 0 ? _this$popupOption$lng : {\n        lng: 0,\n        lat: 0\n      };\n    },\n    set: function set(newLngLat) {\n      this.popupOption.lngLat = newLngLat;\n    }\n  }, {\n    key: \"getIsShow\",\n    value: function getIsShow() {\n      return this.isShow;\n    }\n  }, {\n    key: \"addTo\",\n    value: function addTo(scene) {\n      this.mapsService = scene.get(TYPES.IMapService);\n      this.sceneService = scene.get(TYPES.ISceneService);\n      this.layerService = scene.get(TYPES.ILayerService);\n      this.mapsService.on('camerachange', this.update);\n      this.mapsService.on('viewchange', this.update);\n      this.scene = scene;\n      this.update();\n      // 临时关闭\n      this.updateCloseOnClick();\n      this.updateCloseOnEsc();\n      this.updateFollowCursor();\n      var _this$popupOption2 = this.popupOption,\n        html = _this$popupOption2.html,\n        text = _this$popupOption2.text,\n        title = _this$popupOption2.title;\n      if (html) {\n        this.setHTML(html);\n      } else if (text) {\n        this.setText(text);\n      }\n      if (title) {\n        this.setTitle(title);\n      }\n      this.emit('open');\n      return this;\n    }\n\n    // 移除popup\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      if (!(this !== null && this !== void 0 && this.isOpen())) {\n        return;\n      }\n      if (this.content) {\n        DOM.remove(this.content);\n      }\n      if (this.container) {\n        DOM.remove(this.container);\n        // @ts-ignore\n        delete this.container;\n      }\n      if (this.mapsService) {\n        // TODO: mapbox AMap 事件同步\n        this.mapsService.off('camerachange', this.update);\n        this.mapsService.off('viewchange', this.update);\n        this.updateCloseOnClick(true);\n        this.updateCloseOnEsc(true);\n        this.updateFollowCursor(true);\n        // @ts-ignore\n        delete this.mapsService;\n      }\n      this.emit('close');\n      return this;\n    }\n\n    /**\n     * 获取 option 配置\n     */\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      return this.popupOption;\n    }\n  }, {\n    key: \"setOptions\",\n    value: function setOptions(option) {\n      this.show();\n      this.popupOption = _objectSpread(_objectSpread({}, this.popupOption), option);\n      if (this.checkUpdateOption(option, ['html', 'text', 'title', 'closeButton', 'closeButtonOffsets', 'maxWidth', 'anchor', 'stopPropagation', 'className', 'style', 'lngLat', 'offsets'])) {\n        if (this.container) {\n          DOM.remove(this.container);\n          // @ts-ignore\n          this.container = undefined;\n        }\n        if (this.popupOption.html) {\n          this.setHTML(this.popupOption.html);\n        } else if (this.popupOption.text) {\n          this.setText(this.popupOption.text);\n        }\n        if (this.popupOption.title) {\n          this.setTitle(this.popupOption.title);\n        }\n      }\n      if (this.checkUpdateOption(option, ['closeOnEsc'])) {\n        this.updateCloseOnEsc();\n      }\n      if (this.checkUpdateOption(option, ['closeOnClick'])) {\n        this.updateCloseOnClick();\n      }\n      if (this.checkUpdateOption(option, ['followCursor'])) {\n        this.updateFollowCursor();\n      }\n      if (this.checkUpdateOption(option, ['html']) && option.html) {\n        this.setHTML(option.html);\n      } else if (this.checkUpdateOption(option, ['text']) && option.text) {\n        this.setText(option.text);\n      }\n      if (this.checkUpdateOption(option, ['lngLat']) && option.lngLat) {\n        this.setLnglat(option.lngLat);\n      }\n      return this;\n    }\n  }, {\n    key: \"open\",\n    value: function open() {\n      this.addTo(this.scene);\n      return this;\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.remove();\n      return this;\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      if (this.isShow) {\n        return;\n      }\n      if (this.container) {\n        DOM.removeClass(this.container, 'l7-popup-hide');\n      }\n      this.isShow = true;\n      this.emit('show');\n      return this;\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      if (!this.isShow) {\n        return;\n      }\n      if (this.container) {\n        DOM.addClass(this.container, 'l7-popup-hide');\n      }\n      this.isShow = false;\n      this.emit('hide');\n      return this;\n    }\n\n    /**\n     * 设置 HTML 内容\n     * @param html\n     */\n  }, {\n    key: \"setHTML\",\n    value: function setHTML(html) {\n      this.popupOption.html = html;\n      return this.setDOMContent(html);\n    }\n\n    /**\n     * 设置 Popup 展示文本\n     * @param text\n     */\n  }, {\n    key: \"setText\",\n    value: function setText(text) {\n      this.popupOption.text = text;\n      return this.setDOMContent(window.document.createTextNode(text));\n    }\n  }, {\n    key: \"setTitle\",\n    value: function setTitle(title) {\n      this.show();\n      this.popupOption.title = title;\n      if (title) {\n        if (!this.contentTitle) {\n          this.contentTitle = DOM.create('div', 'l7-popup-content__title');\n          if (this.content.firstChild) {\n            this.content.insertBefore(this.contentTitle, this.content.firstChild);\n          } else {\n            this.content.append(this.contentTitle);\n          }\n        }\n        DOM.clearChildren(this.contentTitle);\n        DOM.appendElementType(this.contentTitle, title);\n      } else if (this.contentTitle) {\n        DOM.remove(this.contentTitle);\n        this.contentTitle = undefined;\n      }\n    }\n\n    /**\n     * 将地图自动平移到气泡位置\n     */\n  }, {\n    key: \"panToPopup\",\n    value: function panToPopup() {\n      var _this$lngLat2 = this.lngLat,\n        lng = _this$lngLat2.lng,\n        lat = _this$lngLat2.lat;\n      if (this.popupOption.autoPan) {\n        this.mapsService.panTo([lng, lat]);\n      }\n      return this;\n    }\n  }, {\n    key: \"setLngLat\",\n    value: function setLngLat(lngLat) {\n      return this.setLnglat(lngLat);\n    }\n\n    /**\n     * 设置 Popup 所在经纬度\n     * @param lngLat\n     */\n  }, {\n    key: \"setLnglat\",\n    value: function setLnglat(lngLat) {\n      var _this2 = this;\n      this.show();\n      this.lngLat = lngLat;\n      if (Array.isArray(lngLat)) {\n        this.lngLat = {\n          lng: lngLat[0],\n          lat: lngLat[1]\n        };\n      }\n      if (this.mapsService) {\n        // 防止事件重复监听\n        this.mapsService.off('camerachange', this.update);\n        this.mapsService.off('viewchange', this.update);\n        this.mapsService.on('camerachange', this.update);\n        this.mapsService.on('viewchange', this.update);\n      }\n      this.update();\n      if (this.popupOption.autoPan) {\n        setTimeout(function () {\n          _this2.panToPopup();\n        }, 0);\n      }\n      return this;\n    }\n\n    /**\n     * 获取 Popup 所在经纬度\n     */\n  }, {\n    key: \"getLnglat\",\n    value: function getLnglat() {\n      return this.lngLat;\n    }\n\n    /**\n     * 设置 Popup 最大宽度\n     * @param maxWidth\n     */\n  }, {\n    key: \"setMaxWidth\",\n    value: function setMaxWidth(maxWidth) {\n      this.popupOption.maxWidth = maxWidth;\n      this.update();\n      return this;\n    }\n  }, {\n    key: \"isOpen\",\n    value: function isOpen() {\n      return !!this.mapsService;\n    }\n  }, {\n    key: \"getDefault\",\n    value:\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    function getDefault(option) {\n      // tslint:disable-next-line:no-object-literal-type-assertion\n      return {\n        closeButton: true,\n        closeOnClick: false,\n        maxWidth: '240px',\n        offsets: [0, 0],\n        anchor: anchorType.BOTTOM,\n        stopPropagation: true,\n        autoPan: false,\n        autoClose: true,\n        closeOnEsc: false,\n        followCursor: false\n      };\n    }\n\n    /**\n     * 设置 Popup 内容 HTML\n     * @param element\n     */\n  }, {\n    key: \"setDOMContent\",\n    value: function setDOMContent(element) {\n      this.show();\n      this.createContent();\n      DOM.appendElementType(this.contentPanel, element);\n      this.update();\n      return this;\n    }\n\n    /**\n     * 绑定地图点击事件触发销毁 Popup\n     * @protected\n     */\n  }, {\n    key: \"updateCloseOnClick\",\n    value: function updateCloseOnClick(onlyClear) {\n      var _this3 = this;\n      var mapsService = this.mapsService;\n      if (mapsService) {\n        mapsService === null || mapsService === void 0 || mapsService.off('click', this.onCloseButtonClick);\n        if (this.popupOption.closeOnClick && !onlyClear) {\n          requestAnimationFrame(function () {\n            mapsService === null || mapsService === void 0 || mapsService.on('click', _this3.onCloseButtonClick);\n          });\n        }\n      }\n    }\n  }, {\n    key: \"updateCloseOnEsc\",\n    value: function updateCloseOnEsc(onlyClear) {\n      window.removeEventListener('keydown', this.onKeyDown);\n      if (this.popupOption.closeOnEsc && !onlyClear) {\n        window.addEventListener('keydown', this.onKeyDown);\n      }\n    }\n  }, {\n    key: \"updateFollowCursor\",\n    value: function updateFollowCursor(onlyClear) {\n      var _this$mapsService;\n      var container = (_this$mapsService = this.mapsService) === null || _this$mapsService === void 0 ? void 0 : _this$mapsService.getContainer();\n      if (container) {\n        container === null || container === void 0 || container.removeEventListener('mousemove', this.onMouseMove);\n        if (this.popupOption.followCursor && !onlyClear) {\n          container === null || container === void 0 || container.addEventListener('mousemove', this.onMouseMove);\n        }\n      }\n    }\n  }, {\n    key: \"createContent\",\n    value:\n    /**\n     * 创建 Popup 内容容器的 DOM （在每次 setHTML 或 setText 时都会被调用）\n     * @protected\n     */\n    function createContent() {\n      var _this4 = this;\n      if (this.content) {\n        DOM.remove(this.content);\n      }\n      this.contentTitle = undefined;\n      this.content = DOM.create('div', 'l7-popup-content', this.container);\n      this.setTitle(this.popupOption.title);\n      if (this.popupOption.closeButton) {\n        var closeButton = createL7Icon('l7-icon-guanbi');\n        DOM.addClass(closeButton, 'l7-popup-close-button');\n        this.content.appendChild(closeButton);\n        if (this.popupOption.closeButtonOffsets) {\n          // 关闭按钮的偏移\n          closeButton.style.right = this.popupOption.closeButtonOffsets[0] + 'px';\n          closeButton.style.top = this.popupOption.closeButtonOffsets[1] + 'px';\n        }\n\n        // this.closeButton.type = 'button';\n        closeButton.setAttribute('aria-label', 'Close popup');\n        closeButton.addEventListener('click', function () {\n          _this4.hide();\n        });\n\n        // 防止点击 Popup 关闭按钮时，触发 Layer click 事件\n        closeButton.addEventListener('pointerup', function (e) {\n          e.stopPropagation();\n        });\n        closeButton.addEventListener('pointerdown', function (e) {\n          e.stopPropagation();\n        });\n        this.closeButton = closeButton;\n      } else {\n        this.closeButton = undefined;\n      }\n      this.contentPanel = DOM.create('div', 'l7-popup-content__panel', this.content);\n    }\n  }, {\n    key: \"setPopupPosition\",\n    value:\n    /**\n     * 设置 Popup 相对于地图容器的 Position\n     * @param left\n     * @param top\n     * @protected\n     */\n    function setPopupPosition(left, top) {\n      if (this.container) {\n        var offsets = this.popupOption.offsets;\n        this.container.style.left = left + offsets[0] + 'px';\n        this.container.style.top = top - offsets[1] + 'px';\n      }\n    }\n\n    /**\n     * 检查当前传入 option 是否包含 keys 字段\n     * @param option\n     * @param keys\n     * @protected\n     */\n  }, {\n    key: \"checkUpdateOption\",\n    value: function checkUpdateOption(option, keys) {\n      return keys.some(function (key) {\n        return key in option;\n      });\n    }\n  }]);\n  return Popup;\n}(EventEmitter);\nexport { Popup as default };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
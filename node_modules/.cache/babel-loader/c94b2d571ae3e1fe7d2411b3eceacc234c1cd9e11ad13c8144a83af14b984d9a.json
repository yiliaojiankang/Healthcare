{"ast":null,"code":"import { map, memoize, isString, each } from '@antv/util';\nvar RGB_REG = /rgba?\\(([\\s.,0-9]+)\\)/;\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^\\)]+\\))/gi;\nvar isGradientColor = function (val) {\n  return /^[r,R,L,l]{1}[\\s]*\\(/.test(val);\n};\n// 创建辅助 tag 取颜色\nvar createTmp = function () {\n  var i = document.createElement('i');\n  i.title = 'Web Colour Picker';\n  i.style.display = 'none';\n  document.body.appendChild(i);\n  return i;\n};\n// 获取颜色之间的插值\nvar getValue = function (start, end, percent, index) {\n  return start[index] + (end[index] - start[index]) * percent;\n};\n// 数组转换成颜色\nfunction arr2rgb(arr) {\n  return \"#\" + toHex(arr[0]) + toHex(arr[1]) + toHex(arr[2]);\n}\n// rgb 颜色转换成数组\nvar rgb2arr = function (str) {\n  return [parseInt(str.substr(1, 2), 16), parseInt(str.substr(3, 2), 16), parseInt(str.substr(5, 2), 16)];\n};\n// 将数值从 0-255 转换成16进制字符串\nvar toHex = function (value) {\n  var x16Value = Math.round(value).toString(16);\n  return x16Value.length === 1 ? \"0\" + x16Value : x16Value;\n};\n// 计算颜色\nvar calColor = function (points, percent) {\n  var fixedPercent = isNaN(Number(percent)) || percent < 0 ? 0 : percent > 1 ? 1 : Number(percent);\n  var steps = points.length - 1;\n  var step = Math.floor(steps * fixedPercent);\n  var left = steps * fixedPercent - step;\n  var start = points[step];\n  var end = step === steps ? start : points[step + 1];\n  return arr2rgb([getValue(start, end, left, 0), getValue(start, end, left, 1), getValue(start, end, left, 2)]);\n};\n// 用于给 toRGB 的缓存（使用 memoize 方法替换）\n// const colorCache = {};\nvar iEl;\n/**\n * 将颜色转换到 rgb 的格式\n * @param {color} color 颜色\n * @return 将颜色转换到 '#ffffff' 的格式\n */\nvar toRGB = function (color) {\n  // 如果已经是 rgb的格式\n  if (color[0] === '#' && color.length === 7) {\n    return color;\n  }\n  if (!iEl) {\n    // 防止防止在页头报错\n    iEl = createTmp();\n  }\n  iEl.style.color = color;\n  var rst = document.defaultView.getComputedStyle(iEl, '').getPropertyValue('color');\n  var matches = RGB_REG.exec(rst);\n  var cArray = matches[1].split(/\\s*,\\s*/).map(function (s) {\n    return Number(s);\n  });\n  rst = arr2rgb(cArray);\n  return rst;\n};\n/**\n * 获取渐变函数\n * @param colors 多个颜色\n * @return 颜色值\n */\nvar gradient = function (colors) {\n  var colorArray = isString(colors) ? colors.split('-') : colors;\n  var points = map(colorArray, function (color) {\n    return rgb2arr(color.indexOf('#') === -1 ? toRGB(color) : color);\n  });\n  // 返回一个函数\n  return function (percent) {\n    return calColor(points, percent);\n  };\n};\nvar toCSSGradient = function (gradientColor) {\n  if (isGradientColor(gradientColor)) {\n    var cssColor_1;\n    var steps = void 0;\n    if (gradientColor[0] === 'l') {\n      // 线性渐变\n      var arr = regexLG.exec(gradientColor);\n      var angle = +arr[1] + 90; // css 和 g 的渐变起始角度不同\n      steps = arr[2];\n      cssColor_1 = \"linear-gradient(\" + angle + \"deg, \";\n    } else if (gradientColor[0] === 'r') {\n      // 径向渐变\n      cssColor_1 = 'radial-gradient(';\n      var arr = regexRG.exec(gradientColor);\n      steps = arr[4];\n    }\n    var colorStops_1 = steps.match(regexColorStop);\n    each(colorStops_1, function (item, index) {\n      var itemArr = item.split(':');\n      cssColor_1 += itemArr[1] + \" \" + itemArr[0] * 100 + \"%\";\n      if (index !== colorStops_1.length - 1) {\n        cssColor_1 += ', ';\n      }\n    });\n    cssColor_1 += ')';\n    return cssColor_1;\n  }\n  return gradientColor;\n};\nexport default {\n  rgb2arr: rgb2arr,\n  gradient: gradient,\n  toRGB: memoize(toRGB),\n  toCSSGradient: toCSSGradient\n};","map":{"version":3,"names":["map","memoize","isString","each","RGB_REG","regexLG","regexRG","regexColorStop","isGradientColor","val","test","createTmp","i","document","createElement","title","style","display","body","appendChild","getValue","start","end","percent","index","arr2rgb","arr","toHex","rgb2arr","str","parseInt","substr","value","x16Value","Math","round","toString","length","calColor","points","fixedPercent","isNaN","Number","steps","step","floor","left","iEl","toRGB","color","rst","defaultView","getComputedStyle","getPropertyValue","matches","exec","cArray","split","s","gradient","colors","colorArray","indexOf","toCSSGradient","gradientColor","cssColor_1","angle","colorStops_1","match","item","itemArr"],"sources":["../src/index.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,GAAG,EAAEC,OAAO,EAAEC,QAAQ,EAAEC,IAAI,QAAQ,YAAY;AAEzD,IAAMC,OAAO,GAAG,uBAAuB;AACvC,IAAMC,OAAO,GAAG,iCAAiC;AACjD,IAAMC,OAAO,GAAG,+DAA+D;AAC/E,IAAMC,cAAc,GAAG,6BAA6B;AAEpD,IAAMC,eAAe,GAAG,SAAAA,CAACC,GAAG;EAAK,6BAAsB,CAACC,IAAI,CAACD,GAAG,CAAC;AAAhC,CAAgC;AAEjE;AACA,IAAME,SAAS,GAAG,SAAAA,CAAA;EAChB,IAAMC,CAAC,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;EACrCF,CAAC,CAACG,KAAK,GAAG,mBAAmB;EAC7BH,CAAC,CAACI,KAAK,CAACC,OAAO,GAAG,MAAM;EACxBJ,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACP,CAAC,CAAC;EAC5B,OAAOA,CAAC;AACV,CAAC;AAED;AACA,IAAMQ,QAAQ,GAAG,SAAAA,CAACC,KAAe,EAAEC,GAAa,EAAEC,OAAe,EAAEC,KAAa;EAC9E,OAAOH,KAAK,CAACG,KAAK,CAAC,GAAG,CAACF,GAAG,CAACE,KAAK,CAAC,GAAGH,KAAK,CAACG,KAAK,CAAC,IAAID,OAAO;AAC7D,CAAC;AAED;AACA,SAASE,OAAOA,CAACC,GAAa;EAC5B,OAAO,MAAIC,KAAK,CAACD,GAAG,CAAC,CAAC,CAAC,CAAC,GAAGC,KAAK,CAACD,GAAG,CAAC,CAAC,CAAC,CAAC,GAAGC,KAAK,CAACD,GAAG,CAAC,CAAC,CAAC,CAAG;AAC5D;AAEA;AACA,IAAME,OAAO,GAAG,SAAAA,CAACC,GAAW;EAC1B,OAAO,CACLC,QAAQ,CAACD,GAAG,CAACE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,EAC9BD,QAAQ,CAACD,GAAG,CAACE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,EAC9BD,QAAQ,CAACD,GAAG,CAACE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAC/B;AACH,CAAC;AAED;AACA,IAAMJ,KAAK,GAAG,SAAAA,CAACK,KAAa;EAC1B,IAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAAC,CAACI,QAAQ,CAAC,EAAE,CAAC;EAE/C,OAAOH,QAAQ,CAACI,MAAM,KAAK,CAAC,GAAG,MAAIJ,QAAU,GAAGA,QAAQ;AAC1D,CAAC;AAED;AACA,IAAMK,QAAQ,GAAG,SAAAA,CAACC,MAAkB,EAAEhB,OAAe;EACnD,IAAMiB,YAAY,GAAGC,KAAK,CAACC,MAAM,CAACnB,OAAO,CAAC,CAAC,IAAIA,OAAO,GAAG,CAAC,GAAG,CAAC,GAC5DA,OAAO,GAAG,CAAC,GAAG,CAAC,GACbmB,MAAM,CAACnB,OAAO,CAAC;EAEnB,IAAMoB,KAAK,GAAGJ,MAAM,CAACF,MAAM,GAAG,CAAC;EAE/B,IAAMO,IAAI,GAAGV,IAAI,CAACW,KAAK,CAACF,KAAK,GAAGH,YAAY,CAAC;EAE7C,IAAMM,IAAI,GAAGH,KAAK,GAAGH,YAAY,GAAGI,IAAI;EAExC,IAAMvB,KAAK,GAAGkB,MAAM,CAACK,IAAI,CAAC;EAE1B,IAAMtB,GAAG,GAAGsB,IAAI,KAAKD,KAAK,GAAGtB,KAAK,GAAGkB,MAAM,CAACK,IAAI,GAAG,CAAC,CAAC;EAErD,OAAOnB,OAAO,CAAC,CACbL,QAAQ,CAACC,KAAK,EAAEC,GAAG,EAAEwB,IAAI,EAAE,CAAC,CAAC,EAC7B1B,QAAQ,CAACC,KAAK,EAAEC,GAAG,EAAEwB,IAAI,EAAE,CAAC,CAAC,EAC7B1B,QAAQ,CAACC,KAAK,EAAEC,GAAG,EAAEwB,IAAI,EAAE,CAAC,CAAC,CAC9B,CAAC;AACJ,CAAC;AAED;AACA;AACA,IAAIC,GAAgB;AAEpB;;;;;AAKA,IAAMC,KAAK,GAAG,SAAAA,CAACC,KAAa;EAC1B;EACA,IAAIA,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,IAAIA,KAAK,CAACZ,MAAM,KAAK,CAAC,EAAE;IAC1C,OAAOY,KAAK;;EAGd,IAAI,CAACF,GAAG,EAAE;IACR;IACAA,GAAG,GAAGpC,SAAS,EAAE;;EAGnBoC,GAAG,CAAC/B,KAAK,CAACiC,KAAK,GAAGA,KAAK;EAEvB,IAAIC,GAAG,GAAGrC,QAAQ,CAACsC,WAAW,CAACC,gBAAgB,CAACL,GAAG,EAAE,EAAE,CAAC,CAACM,gBAAgB,CAAC,OAAO,CAAC;EAElF,IAAMC,OAAO,GAAGlD,OAAO,CAACmD,IAAI,CAACL,GAAG,CAAa;EAC7C,IAAMM,MAAM,GAAaF,OAAO,CAAC,CAAC,CAAC,CAACG,KAAK,CAAC,SAAS,CAAC,CAACzD,GAAG,CAAC,UAAC0D,CAAC;IAAK,OAAAhB,MAAM,CAACgB,CAAC,CAAC;EAAT,CAAS,CAAC;EAE1ER,GAAG,GAAGzB,OAAO,CAAC+B,MAAM,CAAC;EAErB,OAAON,GAAG;AACZ,CAAC;AAED;;;;;AAKA,IAAMS,QAAQ,GAAG,SAAAA,CAACC,MAAyB;EACzC,IAAMC,UAAU,GAAG3D,QAAQ,CAAC0D,MAAM,CAAC,GAAIA,MAAiB,CAACH,KAAK,CAAC,GAAG,CAAC,GAAGG,MAAM;EAE5E,IAAMrB,MAAM,GAAGvC,GAAG,CAAC6D,UAAU,EAAE,UAACZ,KAAK;IACnC,OAAOrB,OAAO,CAACqB,KAAK,CAACa,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,GAAGd,KAAK,CAACC,KAAK,CAAC,GAAGA,KAAK,CAAC;EAClE,CAAC,CAAC;EAEF;EACA,OAAO,UAAC1B,OAAe;IACrB,OAAOe,QAAQ,CAACC,MAAM,EAAEhB,OAAO,CAAC;EAClC,CAAC;AACH,CAAC;AAED,IAAMwC,aAAa,GAAG,SAAAA,CAACC,aAAa;EAClC,IAAIxD,eAAe,CAACwD,aAAa,CAAC,EAAE;IAClC,IAAIC,UAAQ;IACZ,IAAItB,KAAK;IACT,IAAIqB,aAAa,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;MAC5B;MACA,IAAMtC,GAAG,GAAGrB,OAAO,CAACkD,IAAI,CAACS,aAAa,CAAC;MACvC,IAAME,KAAK,GAAG,CAACxC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;MAC5BiB,KAAK,GAAGjB,GAAG,CAAC,CAAC,CAAC;MAEduC,UAAQ,GAAG,qBAAmBC,KAAK,UAAO;KAC3C,MAAM,IAAIF,aAAa,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;MACnC;MACAC,UAAQ,GAAG,kBAAkB;MAC7B,IAAMvC,GAAG,GAAGpB,OAAO,CAACiD,IAAI,CAACS,aAAa,CAAC;MACvCrB,KAAK,GAAGjB,GAAG,CAAC,CAAC,CAAC;;IAGhB,IAAMyC,YAAU,GAAaxB,KAAK,CAACyB,KAAK,CAAC7D,cAAc,CAAC;IACxDJ,IAAI,CAACgE,YAAU,EAAE,UAACE,IAAI,EAAE7C,KAAK;MAC3B,IAAM8C,OAAO,GAAGD,IAAI,CAACZ,KAAK,CAAC,GAAG,CAAC;MAC/BQ,UAAQ,IAAOK,OAAO,CAAC,CAAC,CAAC,SAAIA,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,MAAG;MAChD,IAAI9C,KAAK,KAAM2C,YAAU,CAAC9B,MAAM,GAAG,CAAE,EAAE;QACrC4B,UAAQ,IAAI,IAAI;;IAEpB,CAAC,CAAC;IAEFA,UAAQ,IAAI,GAAG;IAEf,OAAOA,UAAQ;;EAGjB,OAAOD,aAAa;AACtB,CAAC;AAED,eAAe;EACbpC,OAAO,EAAAA,OAAA;EACP+B,QAAQ,EAAAA,QAAA;EACRX,KAAK,EAAE/C,OAAO,CAAC+C,KAAK,CAAC;EACrBe,aAAa,EAAAA;CACd"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _construct from \"@babel/runtime/helpers/esm/construct\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _initializerDefineProperty from \"@babel/runtime/helpers/esm/initializerDefineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _applyDecoratedDescriptor from \"@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"@babel/runtime/helpers/esm/initializerWarningHelper\";\nvar _excluded = [\"id\", \"style\", \"minZoom\", \"maxZoom\", \"token\", \"mapInstance\", \"plugin\"];\nvar _dec, _dec2, _dec3, _dec4, _dec5, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4;\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n/**\n * AMapService\n */\nimport AMapLoader from '@amap/amap-jsapi-loader';\nimport { CoordinateSystem, MapServiceEvent, TYPES } from '@antv/l7-core';\nimport { DOM, MapType } from '@antv/l7-utils';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { inject, injectable } from 'inversify';\nimport 'reflect-metadata';\nimport Viewport from \"../Viewport\";\nimport { SimpleMapCoord } from \"../simpleMapCoord\";\nimport { toPaddingOptions } from \"../utils\";\nfunction loadStyles(css, doc) {\n  var isMiniAli = typeof my !== 'undefined' && !!my && typeof my.showToast === 'function' && my.isFRM !== true;\n  var isWeChatMiniProgram = typeof wx !== 'undefined' && wx !== null && (typeof wx.request !== 'undefined' || typeof wx.miniProgram !== 'undefined');\n  if (isMiniAli || isWeChatMiniProgram) {\n    return;\n  }\n  if (!doc) doc = document;\n  if (!doc) {\n    return;\n  }\n  var head = doc.head || doc.getElementsByTagName('head')[0];\n  if (!head) {\n    head = doc.createElement('head');\n    var body = doc.body || doc.getElementsByTagName('body')[0];\n    if (body) {\n      body.parentNode.insertBefore(head, body);\n    } else {\n      doc.documentElement.appendChild(head);\n    }\n  }\n  var style = doc.createElement('style');\n  style.type = 'text/css';\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(doc.createTextNode(css));\n  }\n  head.appendChild(style);\n  return style;\n}\nloadStyles(\".amap-logo{\\n display: none !important;\\n}\\n.amap-copyright {\\n  display: none !important;\\n}\\n\");\nimport { MapTheme } from \"./theme\";\nvar AMapEventMapV1 = {\n  contextmenu: 'rightclick'\n};\nvar AMapEventMapV2 = {\n  contextmenu: 'rightclick',\n  camerachange: 'viewchange'\n};\nvar MapEventProxyMap = {\n  'GAODE1.x': AMapEventMapV1,\n  'GAODE2.x': AMapEventMapV2\n};\nvar mapdivCount = 0;\n// @ts-ignore\nwindow.forceWebGL = true;\nvar AMAP_API_KEY = '15cd8a57710d40c9b7c0e3cc120f1200';\nvar AMAP_VERSION = '1.4.15';\n/**\n * 确保多个场景只引入一个高德地图脚本\n */\nvar AMAP_SCRIPT_ID = 'amap-script';\n/**\n * 高德地图脚本是否加载完毕\n */\nvar amapLoaded = false;\n/**\n * 高德地图脚本加载成功等待队列，成功之后依次触发\n */\nvar pendingResolveQueue = [];\nvar LNGLAT_OFFSET_ZOOM_THRESHOLD = 12; // 暂时关闭 fix 统一不同坐标系，不同底图的高度位置\n\n/**\n * AMapService\n */\nvar AMapBaseService = (_dec = injectable(), _dec2 = inject(TYPES.IGlobalConfigService), _dec3 = inject(TYPES.MapConfig), _dec4 = inject(TYPES.ICoordinateSystemService), _dec5 = inject(TYPES.IEventEmitter), _dec(_class = (_class2 = /*#__PURE__*/function () {\n  function AMapBaseService() {\n    var _this = this;\n    _classCallCheck(this, AMapBaseService);\n    _defineProperty(this, \"version\", MapType['GAODE1.x']);\n    _defineProperty(this, \"simpleMapCoord\", new SimpleMapCoord());\n    // 背景色\n    _defineProperty(this, \"bgColor\", 'rgba(0, 0, 0, 0)');\n    _initializerDefineProperty(this, \"configService\", _descriptor, this);\n    _initializerDefineProperty(this, \"config\", _descriptor2, this);\n    _initializerDefineProperty(this, \"coordinateSystemService\", _descriptor3, this);\n    _initializerDefineProperty(this, \"eventEmitter\", _descriptor4, this);\n    _defineProperty(this, \"handleCameraChanged\", function (e) {\n      var _e$camera = e.camera,\n        fov = _e$camera.fov,\n        near = _e$camera.near,\n        far = _e$camera.far,\n        height = _e$camera.height,\n        pitch = _e$camera.pitch,\n        rotation = _e$camera.rotation,\n        aspect = _e$camera.aspect,\n        position = _e$camera.position;\n      var _this$getCenter = _this.getCenter(),\n        lng = _this$getCenter.lng,\n        lat = _this$getCenter.lat;\n      // Tip: 触发地图变化事件\n      _this.emit('mapchange');\n      if (_this.cameraChangedCallback) {\n        // resync viewport\n        _this.viewport.syncWithMapCamera({\n          aspect: aspect,\n          // AMap 定义 rotation 为顺时针方向，而 Mapbox 为逆时针\n          // @see https://docs.mapbox.com/mapbox-gl-js/api/#map#getbearing\n          bearing: 360 - rotation,\n          far: far,\n          fov: fov,\n          cameraHeight: height,\n          near: near,\n          pitch: pitch,\n          // AMap 定义的缩放等级 与 Mapbox 相差 1\n          zoom: _this.map.getZoom() - 1,\n          center: [lng, lat],\n          offsetOrigin: [position.x, position.y]\n        });\n        var _this$config$offsetZo = _this.config.offsetZoom,\n          offsetZoom = _this$config$offsetZo === void 0 ? LNGLAT_OFFSET_ZOOM_THRESHOLD : _this$config$offsetZo;\n        // console.log('this.viewport', this.viewport)\n        // set coordinate system\n        if (_this.viewport.getZoom() > offsetZoom) {\n          _this.coordinateSystemService.setCoordinateSystem(CoordinateSystem.P20_OFFSET);\n        } else {\n          _this.coordinateSystemService.setCoordinateSystem(CoordinateSystem.P20);\n        }\n        _this.cameraChangedCallback(_this.viewport);\n      }\n    });\n  }\n  _createClass(AMapBaseService, [{\n    key: \"setBgColor\",\n    value: function setBgColor(color) {\n      this.bgColor = color;\n    }\n  }, {\n    key: \"addMarkerContainer\",\n    value: function addMarkerContainer() {\n      var mapContainer = this.map.getContainer();\n      if (mapContainer !== null) {\n        var amap = mapContainer.getElementsByClassName('amap-maps')[0];\n        this.markerContainer = DOM.create('div', 'l7-marker-container', amap);\n      }\n    }\n  }, {\n    key: \"getMarkerContainer\",\n    value: function getMarkerContainer() {\n      return this.markerContainer;\n    }\n\n    //  map event\n  }, {\n    key: \"on\",\n    value: function on(type, handler) {\n      if (MapServiceEvent.indexOf(type) !== -1) {\n        this.eventEmitter.on(type, handler);\n      } else {\n        this.map.on(MapEventProxyMap[this.version][type] || type, handler);\n      }\n    }\n  }, {\n    key: \"off\",\n    value: function off(type, handler) {\n      if (MapServiceEvent.indexOf(type) !== -1) {\n        this.eventEmitter.off(type, handler);\n      } else {\n        this.map.off(MapEventProxyMap[this.version][type] || type, handler);\n      }\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return this.map.getContainer();\n    }\n  }, {\n    key: \"getMapCanvasContainer\",\n    value: function getMapCanvasContainer() {\n      var _this$map$getContaine;\n      return (_this$map$getContaine = this.map.getContainer()) === null || _this$map$getContaine === void 0 ? void 0 : _this$map$getContaine.getElementsByClassName('amap-maps')[0];\n    }\n  }, {\n    key: \"getSize\",\n    value: function getSize() {\n      var size = this.map.getSize();\n      return [size.getWidth(), size.getHeight()];\n    }\n  }, {\n    key: \"getType\",\n    value: function getType() {\n      return 'amap';\n    }\n  }, {\n    key: \"getZoom\",\n    value: function getZoom() {\n      // 统一返回 Mapbox 缩放等级\n      return this.map.getZoom() - 1;\n    }\n  }, {\n    key: \"setZoom\",\n    value: function setZoom(zoom) {\n      // 统一设置 Mapbox 缩放等级\n      return this.map.setZoom(zoom + 1);\n    }\n  }, {\n    key: \"getCenter\",\n    value: function getCenter(options) {\n      if (options !== null && options !== void 0 && options.padding) {\n        var originCenter = this.getCenter();\n        var padding = toPaddingOptions(options.padding);\n        var px = this.lngLatToPixel([originCenter.lng, originCenter.lat]);\n        var offsetPx = [(padding.right - padding.left) / 2, (padding.bottom - padding.top) / 2];\n        var newCenter = this.pixelToLngLat([px.x - offsetPx[0], px.y - offsetPx[1]]);\n        return newCenter;\n      }\n      var center = this.map.getCenter();\n      return {\n        lng: center.getLng(),\n        lat: center.getLat()\n      };\n    }\n  }, {\n    key: \"setCenter\",\n    value: function setCenter(lnglat, options) {\n      if (options !== null && options !== void 0 && options.padding) {\n        var padding = toPaddingOptions(options.padding);\n        var px = this.lngLatToPixel(lnglat);\n        var offsetPx = [(padding.right - padding.left) / 2, (padding.bottom - padding.top) / 2];\n        var newCenter = this.pixelToLngLat([px.x + offsetPx[0], px.y + offsetPx[1]]);\n        this.map.setCenter([newCenter.lng, newCenter.lat]);\n      } else {\n        this.map.setCenter(lnglat);\n      }\n    }\n  }, {\n    key: \"getPitch\",\n    value: function getPitch() {\n      return this.map.getPitch();\n    }\n  }, {\n    key: \"getRotation\",\n    value: function getRotation() {\n      // 统一返回逆时针旋转角度\n      return 360 - this.map.getRotation();\n    }\n  }, {\n    key: \"getBounds\",\n    value: function getBounds() {\n      // @ts-ignore\n      var amapBound = this.map.getBounds().toBounds();\n      var NE = amapBound.getNorthEast();\n      var SW = amapBound.getSouthWest();\n      var center = this.getCenter();\n      var maxlng = center.lng > NE.getLng() || center.lng < SW.getLng() ? 180 - NE.getLng() : NE.getLng();\n      var minlng = center.lng < SW.getLng() ? SW.getLng() - 180 : SW.getLng();\n      // 兼容 Mapbox，统一返回西南、东北\n      return [[minlng, SW.getLat()], [maxlng, NE.getLat()]];\n    }\n  }, {\n    key: \"getMinZoom\",\n    value: function getMinZoom() {\n      var zooms = this.map.get('zooms');\n      return zooms[0] - 1;\n    }\n  }, {\n    key: \"getMaxZoom\",\n    value: function getMaxZoom() {\n      var zooms = this.map.get('zooms');\n      return zooms[1] - 1;\n    }\n  }, {\n    key: \"setRotation\",\n    value: function setRotation(rotation) {\n      return this.map.setRotation(rotation);\n    }\n  }, {\n    key: \"setPitch\",\n    value: function setPitch(pitch) {\n      return this.map.setPitch(pitch);\n    }\n  }, {\n    key: \"zoomIn\",\n    value: function zoomIn() {\n      this.map.zoomIn();\n    }\n  }, {\n    key: \"zoomOut\",\n    value: function zoomOut() {\n      this.map.zoomOut();\n    }\n  }, {\n    key: \"panTo\",\n    value: function panTo(p) {\n      this.map.panTo(p);\n    }\n  }, {\n    key: \"panBy\",\n    value: function panBy() {\n      var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      this.map.panBy(x, y);\n    }\n  }, {\n    key: \"fitBounds\",\n    value: function fitBounds(extent) {\n      this.map.setBounds(new AMap.Bounds([extent[0][0], extent[0][1], extent[1][0], extent[1][1]]));\n    }\n  }, {\n    key: \"setZoomAndCenter\",\n    value: function setZoomAndCenter(zoom, center) {\n      this.map.setZoomAndCenter(zoom + 1, center);\n    }\n  }, {\n    key: \"setMapStyle\",\n    value: function setMapStyle(style) {\n      this.map.setMapStyle(this.getMapStyleValue(style));\n    }\n  }, {\n    key: \"setMapStatus\",\n    value: function setMapStatus(option) {\n      this.map.setStatus(option);\n    }\n  }, {\n    key: \"getMapStyleConfig\",\n    value: function getMapStyleConfig() {\n      return MapTheme;\n    }\n  }, {\n    key: \"getMapStyleValue\",\n    value: function getMapStyleValue(name) {\n      return this.getMapStyleConfig()[name] || name;\n    }\n  }, {\n    key: \"getMapStyle\",\n    value: function getMapStyle() {\n      return this.map.getMapStyle();\n    }\n  }, {\n    key: \"pixelToLngLat\",\n    value: function pixelToLngLat(pixel) {\n      var lngLat = this.map.pixelToLngLat(new AMap.Pixel(pixel[0], pixel[1]));\n      return {\n        lng: lngLat.getLng(),\n        lat: lngLat.getLat()\n      };\n    }\n  }, {\n    key: \"lngLatToPixel\",\n    value: function lngLatToPixel(lnglat) {\n      var p = this.map.lnglatToPixel(new AMap.LngLat(lnglat[0], lnglat[1]));\n      // lngLatToPixel\n      return {\n        x: p.getX(),\n        y: p.getY()\n      };\n    }\n  }, {\n    key: \"containerToLngLat\",\n    value: function containerToLngLat(pixel) {\n      var ll = new AMap.Pixel(pixel[0], pixel[1]);\n      var lngLat = this.map.containerToLngLat(ll);\n      return {\n        lng: lngLat === null || lngLat === void 0 ? void 0 : lngLat.getLng(),\n        lat: lngLat === null || lngLat === void 0 ? void 0 : lngLat.getLat()\n      };\n    }\n  }, {\n    key: \"lngLatToContainer\",\n    value: function lngLatToContainer(lnglat) {\n      var ll = new AMap.LngLat(lnglat[0], lnglat[1]);\n      var pixel = this.map.lngLatToContainer(ll);\n      return {\n        x: pixel.getX(),\n        y: pixel.getY()\n      };\n    }\n  }, {\n    key: \"lngLatToCoord\",\n    value: function lngLatToCoord(lnglat) {\n      // @ts-ignore\n      var _this$map$lngLatToGeo = this.map.lngLatToGeodeticCoord(lnglat),\n        x = _this$map$lngLatToGeo.x,\n        y = _this$map$lngLatToGeo.y;\n      return [x, -y];\n    }\n  }, {\n    key: \"lngLatToMercator\",\n    value: function lngLatToMercator(\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    lnglat,\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    altitude) {\n      return {\n        x: 0,\n        y: 0,\n        z: 0\n      };\n    }\n  }, {\n    key: \"getModelMatrix\",\n    value: function getModelMatrix(lnglat, altitude, rotate) {\n      var scale = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [1, 1, 1];\n      var flat = this.viewport.projectFlat(lnglat);\n      // @ts-ignore\n      var modelMatrix = mat4.create();\n      mat4.translate(modelMatrix, modelMatrix, vec3.fromValues(flat[0], flat[1], altitude));\n      mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(scale[0], scale[1], scale[2]));\n      mat4.rotateX(modelMatrix, modelMatrix, rotate[0]);\n      mat4.rotateY(modelMatrix, modelMatrix, rotate[1]);\n      mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]);\n      return modelMatrix;\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n        var _this$config, id, _this$config$style, style, _this$config$minZoom, minZoom, _this$config$maxZoom, maxZoom, _this$config$token, token, mapInstance, _this$config$plugin, plugin, rest;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this$config = this.config, id = _this$config.id, _this$config$style = _this$config.style, style = _this$config$style === void 0 ? 'light' : _this$config$style, _this$config$minZoom = _this$config.minZoom, minZoom = _this$config$minZoom === void 0 ? 0 : _this$config$minZoom, _this$config$maxZoom = _this$config.maxZoom, maxZoom = _this$config$maxZoom === void 0 ? 18 : _this$config$maxZoom, _this$config$token = _this$config.token, token = _this$config$token === void 0 ? AMAP_API_KEY : _this$config$token, mapInstance = _this$config.mapInstance, _this$config$plugin = _this$config.plugin, plugin = _this$config$plugin === void 0 ? [] : _this$config$plugin, rest = _objectWithoutProperties(_this$config, _excluded); // 高德地图创建独立的container；\n              // tslint:disable-next-line:typedef\n              _context.next = 3;\n              return new Promise(function (resolve) {\n                var resolveMap = function resolveMap() {\n                  if (mapInstance) {\n                    _this2.map = mapInstance;\n                    _this2.$mapContainer = _this2.map.getContainer();\n                    setTimeout(function () {\n                      _this2.map.on('camerachange', _this2.handleCameraChanged);\n                      resolve();\n                    }, 30);\n                  } else {\n                    _this2.$mapContainer = _this2.creatMapContainer(id);\n                    var mapConstructorOptions = _objectSpread({\n                      mapStyle: _this2.getMapStyleValue(style),\n                      zooms: [minZoom, maxZoom],\n                      viewMode: '3D'\n                    }, rest);\n                    if (mapConstructorOptions.zoom) {\n                      // TODO: 高德地图在相同大小下需要比 MapBox 多一个 zoom 层级\n                      mapConstructorOptions.zoom += 1;\n                    }\n                    // @ts-ignore\n                    var map = new AMap.Map(_this2.$mapContainer, mapConstructorOptions);\n                    // 监听地图相机事件\n                    map.on('camerachange', _this2.handleCameraChanged);\n                    // Tip: 为了兼容开启 MultiPassRender 的情况\n                    // 修复 MultiPassRender 在高德地图 1.x 的情况下，缩放地图改变 zoom 时存在可视化层和底图不同步的现象\n                    map.on('camerachange', function () {\n                      setTimeout(function () {\n                        return _this2.handleAfterMapChange();\n                      });\n                    });\n\n                    // @ts-ignore\n                    _this2.map = map;\n                    setTimeout(function () {\n                      resolve();\n                    }, 10);\n                  }\n                };\n                if (!amapLoaded && !mapInstance) {\n                  if (token === AMAP_API_KEY) {\n                    console.warn(\"%c\".concat(_this2.configService.getSceneWarninfo('MapToken'), \"!\"), 'color: #873bf4;font-weigh:900;font-size: 16px;');\n                  }\n                  amapLoaded = true;\n                  plugin.push('Map3D');\n                  AMapLoader.load({\n                    key: token,\n                    // 申请好的Web端开发者Key，首次调用 load 时必填\n                    version: AMAP_VERSION,\n                    // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\n                    plugins: plugin // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n                  }).then(function () {\n                    resolveMap();\n                    if (pendingResolveQueue.length) {\n                      pendingResolveQueue.forEach(function (r) {\n                        return r();\n                      });\n                      pendingResolveQueue = [];\n                    }\n                  }).catch(function (e) {\n                    throw new Error(e);\n                  });\n                } else {\n                  if (amapLoaded && window.AMap || mapInstance) {\n                    resolveMap();\n                  } else {\n                    pendingResolveQueue.push(resolveMap);\n                  }\n                }\n              });\n            case 3:\n              this.viewport = new Viewport();\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function init() {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }, {\n    key: \"meterToCoord\",\n    value: function meterToCoord(center, outer) {\n      // 统一根据经纬度来转化\n      // Tip: 实际米距离 unit meter\n      var meterDis = AMap.GeometryUtil.distance(_construct(AMap.LngLat, _toConsumableArray(center)), _construct(AMap.LngLat, _toConsumableArray(outer)));\n\n      // Tip: 三维世界坐标距离\n      var _this$lngLatToCoord = this.lngLatToCoord(center),\n        _this$lngLatToCoord2 = _slicedToArray(_this$lngLatToCoord, 2),\n        x1 = _this$lngLatToCoord2[0],\n        y1 = _this$lngLatToCoord2[1];\n      var _this$lngLatToCoord3 = this.lngLatToCoord(outer),\n        _this$lngLatToCoord4 = _slicedToArray(_this$lngLatToCoord3, 2),\n        x2 = _this$lngLatToCoord4[0],\n        y2 = _this$lngLatToCoord4[1];\n      var coordDis = Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n      return coordDis / meterDis;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"updateView\",\n    value: function updateView(viewOption) {\n      return;\n    }\n  }, {\n    key: \"getOverlayContainer\",\n    value: function getOverlayContainer() {\n      return undefined;\n    }\n  }, {\n    key: \"exportMap\",\n    value: function exportMap(type) {\n      var _this$getContainer;\n      var renderCanvas = (_this$getContainer = this.getContainer()) === null || _this$getContainer === void 0 ? void 0 : _this$getContainer.getElementsByClassName('amap-layer')[0];\n      var layersPng = type === 'jpg' ? renderCanvas === null || renderCanvas === void 0 ? void 0 : renderCanvas.toDataURL('image/jpeg') : renderCanvas === null || renderCanvas === void 0 ? void 0 : renderCanvas.toDataURL('image/png');\n      return layersPng;\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(name) {\n      var _this$eventEmitter;\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n      (_this$eventEmitter = this.eventEmitter).emit.apply(_this$eventEmitter, [name].concat(args));\n    }\n  }, {\n    key: \"once\",\n    value: function once(name) {\n      var _this$eventEmitter2;\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n      (_this$eventEmitter2 = this.eventEmitter).once.apply(_this$eventEmitter2, [name].concat(args));\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var _this$$mapContainer;\n      // TODO: 销毁地图可视化层的容器\n      (_this$$mapContainer = this.$mapContainer) === null || _this$$mapContainer === void 0 || (_this$$mapContainer = _this$$mapContainer.parentNode) === null || _this$$mapContainer === void 0 || _this$$mapContainer.removeChild(this.$mapContainer);\n\n      // @ts-ignore\n      delete window.initAMap;\n      var $jsapi = document.getElementById(AMAP_SCRIPT_ID);\n      if ($jsapi) {\n        document.head.removeChild($jsapi);\n      }\n      this.map.destroy();\n    }\n  }, {\n    key: \"getMapContainer\",\n    value: function getMapContainer() {\n      return this.$mapContainer;\n    }\n  }, {\n    key: \"onCameraChanged\",\n    value: function onCameraChanged(callback) {\n      this.cameraChangedCallback = callback;\n    }\n  }, {\n    key: \"handleAfterMapChange\",\n    value: function handleAfterMapChange() {\n      this.emit('mapAfterFrameChange');\n    }\n  }, {\n    key: \"creatMapContainer\",\n    value: function creatMapContainer(id) {\n      var $wrapper = id;\n      if (typeof id === 'string') {\n        $wrapper = document.getElementById(id);\n      }\n      var $amapdiv = document.createElement('div');\n      $amapdiv.style.cssText += \"\\n       position: absolute;\\n       top: 0;\\n       height: 100%;\\n       width: 100%;\\n     \";\n      $amapdiv.id = 'l7_amap_div' + mapdivCount++;\n      $wrapper.appendChild($amapdiv);\n      return $amapdiv;\n    }\n  }]);\n  return AMapBaseService;\n}(), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, \"configService\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, \"config\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, \"coordinateSystemService\", [_dec4], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, \"eventEmitter\", [_dec5], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexport { AMapBaseService as default };","map":{"version":3,"names":["_slicedToArray","_construct","_toConsumableArray","_objectSpread","_objectWithoutProperties","_asyncToGenerator","_initializerDefineProperty","_classCallCheck","_createClass","_defineProperty","_applyDecoratedDescriptor","_initializerWarningHelper","_excluded","_dec","_dec2","_dec3","_dec4","_dec5","_class","_class2","_descriptor","_descriptor2","_descriptor3","_descriptor4","_regeneratorRuntime","AMapLoader","CoordinateSystem","MapServiceEvent","TYPES","DOM","MapType","mat4","vec3","inject","injectable","Viewport","SimpleMapCoord","toPaddingOptions","loadStyles","css","doc","isMiniAli","my","showToast","isFRM","isWeChatMiniProgram","wx","request","miniProgram","document","head","getElementsByTagName","createElement","body","parentNode","insertBefore","documentElement","appendChild","style","type","styleSheet","cssText","createTextNode","MapTheme","AMapEventMapV1","contextmenu","AMapEventMapV2","camerachange","MapEventProxyMap","mapdivCount","window","forceWebGL","AMAP_API_KEY","AMAP_VERSION","AMAP_SCRIPT_ID","amapLoaded","pendingResolveQueue","LNGLAT_OFFSET_ZOOM_THRESHOLD","AMapBaseService","IGlobalConfigService","MapConfig","ICoordinateSystemService","IEventEmitter","_this","e","_e$camera","camera","fov","near","far","height","pitch","rotation","aspect","position","_this$getCenter","getCenter","lng","lat","emit","cameraChangedCallback","viewport","syncWithMapCamera","bearing","cameraHeight","zoom","map","getZoom","center","offsetOrigin","x","y","_this$config$offsetZo","config","offsetZoom","coordinateSystemService","setCoordinateSystem","P20_OFFSET","P20","key","value","setBgColor","color","bgColor","addMarkerContainer","mapContainer","getContainer","amap","getElementsByClassName","markerContainer","create","getMarkerContainer","on","handler","indexOf","eventEmitter","version","off","getMapCanvasContainer","_this$map$getContaine","getSize","size","getWidth","getHeight","getType","setZoom","options","padding","originCenter","px","lngLatToPixel","offsetPx","right","left","bottom","top","newCenter","pixelToLngLat","getLng","getLat","setCenter","lnglat","getPitch","getRotation","getBounds","amapBound","toBounds","NE","getNorthEast","SW","getSouthWest","maxlng","minlng","getMinZoom","zooms","get","getMaxZoom","setRotation","setPitch","zoomIn","zoomOut","panTo","p","panBy","arguments","length","undefined","fitBounds","extent","setBounds","AMap","Bounds","setZoomAndCenter","setMapStyle","getMapStyleValue","setMapStatus","option","setStatus","getMapStyleConfig","name","getMapStyle","pixel","lngLat","Pixel","lnglatToPixel","LngLat","getX","getY","containerToLngLat","ll","lngLatToContainer","lngLatToCoord","_this$map$lngLatToGeo","lngLatToGeodeticCoord","lngLatToMercator","altitude","z","getModelMatrix","rotate","scale","flat","projectFlat","modelMatrix","translate","fromValues","rotateX","rotateY","rotateZ","_init","mark","_callee","_this2","_this$config","id","_this$config$style","_this$config$minZoom","minZoom","_this$config$maxZoom","maxZoom","_this$config$token","token","mapInstance","_this$config$plugin","plugin","rest","wrap","_callee$","_context","prev","next","Promise","resolve","resolveMap","$mapContainer","setTimeout","handleCameraChanged","creatMapContainer","mapConstructorOptions","mapStyle","viewMode","Map","handleAfterMapChange","console","warn","concat","configService","getSceneWarninfo","push","load","plugins","then","forEach","r","catch","Error","stop","init","apply","meterToCoord","outer","meterDis","GeometryUtil","distance","_this$lngLatToCoord","_this$lngLatToCoord2","x1","y1","_this$lngLatToCoord3","_this$lngLatToCoord4","x2","y2","coordDis","Math","sqrt","pow","updateView","viewOption","getOverlayContainer","exportMap","_this$getContainer","renderCanvas","layersPng","toDataURL","_this$eventEmitter","_len","args","Array","_key","once","_this$eventEmitter2","_len2","_key2","destroy","_this$$mapContainer","removeChild","initAMap","$jsapi","getElementById","getMapContainer","onCameraChanged","callback","$wrapper","$amapdiv","prototype","configurable","enumerable","writable","initializer","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-maps/es/utils/amap/AMapBaseService.js"],"sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _construct from \"@babel/runtime/helpers/esm/construct\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _initializerDefineProperty from \"@babel/runtime/helpers/esm/initializerDefineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _applyDecoratedDescriptor from \"@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"@babel/runtime/helpers/esm/initializerWarningHelper\";\nvar _excluded = [\"id\", \"style\", \"minZoom\", \"maxZoom\", \"token\", \"mapInstance\", \"plugin\"];\nvar _dec, _dec2, _dec3, _dec4, _dec5, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4;\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n/**\n * AMapService\n */\nimport AMapLoader from '@amap/amap-jsapi-loader';\nimport { CoordinateSystem, MapServiceEvent, TYPES } from '@antv/l7-core';\nimport { DOM, MapType } from '@antv/l7-utils';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { inject, injectable } from 'inversify';\nimport 'reflect-metadata';\nimport Viewport from \"../Viewport\";\nimport { SimpleMapCoord } from \"../simpleMapCoord\";\nimport { toPaddingOptions } from \"../utils\";\nfunction loadStyles(css, doc) {\n  var isMiniAli = typeof my !== 'undefined' && !!my && typeof my.showToast === 'function' && my.isFRM !== true;\n  var isWeChatMiniProgram = typeof wx !== 'undefined' && wx !== null && (typeof wx.request !== 'undefined' || typeof wx.miniProgram !== 'undefined');\n  if (isMiniAli || isWeChatMiniProgram) {\n    return;\n  }\n  if (!doc) doc = document;\n  if (!doc) {\n    return;\n  }\n  var head = doc.head || doc.getElementsByTagName('head')[0];\n  if (!head) {\n    head = doc.createElement('head');\n    var body = doc.body || doc.getElementsByTagName('body')[0];\n    if (body) {\n      body.parentNode.insertBefore(head, body);\n    } else {\n      doc.documentElement.appendChild(head);\n    }\n  }\n  var style = doc.createElement('style');\n  style.type = 'text/css';\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(doc.createTextNode(css));\n  }\n  head.appendChild(style);\n  return style;\n}\nloadStyles(\".amap-logo{\\n display: none !important;\\n}\\n.amap-copyright {\\n  display: none !important;\\n}\\n\");\nimport { MapTheme } from \"./theme\";\nvar AMapEventMapV1 = {\n  contextmenu: 'rightclick'\n};\nvar AMapEventMapV2 = {\n  contextmenu: 'rightclick',\n  camerachange: 'viewchange'\n};\nvar MapEventProxyMap = {\n  'GAODE1.x': AMapEventMapV1,\n  'GAODE2.x': AMapEventMapV2\n};\nvar mapdivCount = 0;\n// @ts-ignore\nwindow.forceWebGL = true;\nvar AMAP_API_KEY = '15cd8a57710d40c9b7c0e3cc120f1200';\nvar AMAP_VERSION = '1.4.15';\n/**\n * 确保多个场景只引入一个高德地图脚本\n */\nvar AMAP_SCRIPT_ID = 'amap-script';\n/**\n * 高德地图脚本是否加载完毕\n */\nvar amapLoaded = false;\n/**\n * 高德地图脚本加载成功等待队列，成功之后依次触发\n */\nvar pendingResolveQueue = [];\nvar LNGLAT_OFFSET_ZOOM_THRESHOLD = 12; // 暂时关闭 fix 统一不同坐标系，不同底图的高度位置\n\n/**\n * AMapService\n */\nvar AMapBaseService = (_dec = injectable(), _dec2 = inject(TYPES.IGlobalConfigService), _dec3 = inject(TYPES.MapConfig), _dec4 = inject(TYPES.ICoordinateSystemService), _dec5 = inject(TYPES.IEventEmitter), _dec(_class = (_class2 = /*#__PURE__*/function () {\n  function AMapBaseService() {\n    var _this = this;\n    _classCallCheck(this, AMapBaseService);\n    _defineProperty(this, \"version\", MapType['GAODE1.x']);\n    _defineProperty(this, \"simpleMapCoord\", new SimpleMapCoord());\n    // 背景色\n    _defineProperty(this, \"bgColor\", 'rgba(0, 0, 0, 0)');\n    _initializerDefineProperty(this, \"configService\", _descriptor, this);\n    _initializerDefineProperty(this, \"config\", _descriptor2, this);\n    _initializerDefineProperty(this, \"coordinateSystemService\", _descriptor3, this);\n    _initializerDefineProperty(this, \"eventEmitter\", _descriptor4, this);\n    _defineProperty(this, \"handleCameraChanged\", function (e) {\n      var _e$camera = e.camera,\n        fov = _e$camera.fov,\n        near = _e$camera.near,\n        far = _e$camera.far,\n        height = _e$camera.height,\n        pitch = _e$camera.pitch,\n        rotation = _e$camera.rotation,\n        aspect = _e$camera.aspect,\n        position = _e$camera.position;\n      var _this$getCenter = _this.getCenter(),\n        lng = _this$getCenter.lng,\n        lat = _this$getCenter.lat;\n      // Tip: 触发地图变化事件\n      _this.emit('mapchange');\n      if (_this.cameraChangedCallback) {\n        // resync viewport\n        _this.viewport.syncWithMapCamera({\n          aspect: aspect,\n          // AMap 定义 rotation 为顺时针方向，而 Mapbox 为逆时针\n          // @see https://docs.mapbox.com/mapbox-gl-js/api/#map#getbearing\n          bearing: 360 - rotation,\n          far: far,\n          fov: fov,\n          cameraHeight: height,\n          near: near,\n          pitch: pitch,\n          // AMap 定义的缩放等级 与 Mapbox 相差 1\n          zoom: _this.map.getZoom() - 1,\n          center: [lng, lat],\n          offsetOrigin: [position.x, position.y]\n        });\n        var _this$config$offsetZo = _this.config.offsetZoom,\n          offsetZoom = _this$config$offsetZo === void 0 ? LNGLAT_OFFSET_ZOOM_THRESHOLD : _this$config$offsetZo;\n        // console.log('this.viewport', this.viewport)\n        // set coordinate system\n        if (_this.viewport.getZoom() > offsetZoom) {\n          _this.coordinateSystemService.setCoordinateSystem(CoordinateSystem.P20_OFFSET);\n        } else {\n          _this.coordinateSystemService.setCoordinateSystem(CoordinateSystem.P20);\n        }\n        _this.cameraChangedCallback(_this.viewport);\n      }\n    });\n  }\n  _createClass(AMapBaseService, [{\n    key: \"setBgColor\",\n    value: function setBgColor(color) {\n      this.bgColor = color;\n    }\n  }, {\n    key: \"addMarkerContainer\",\n    value: function addMarkerContainer() {\n      var mapContainer = this.map.getContainer();\n      if (mapContainer !== null) {\n        var amap = mapContainer.getElementsByClassName('amap-maps')[0];\n        this.markerContainer = DOM.create('div', 'l7-marker-container', amap);\n      }\n    }\n  }, {\n    key: \"getMarkerContainer\",\n    value: function getMarkerContainer() {\n      return this.markerContainer;\n    }\n\n    //  map event\n  }, {\n    key: \"on\",\n    value: function on(type, handler) {\n      if (MapServiceEvent.indexOf(type) !== -1) {\n        this.eventEmitter.on(type, handler);\n      } else {\n        this.map.on(MapEventProxyMap[this.version][type] || type, handler);\n      }\n    }\n  }, {\n    key: \"off\",\n    value: function off(type, handler) {\n      if (MapServiceEvent.indexOf(type) !== -1) {\n        this.eventEmitter.off(type, handler);\n      } else {\n        this.map.off(MapEventProxyMap[this.version][type] || type, handler);\n      }\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return this.map.getContainer();\n    }\n  }, {\n    key: \"getMapCanvasContainer\",\n    value: function getMapCanvasContainer() {\n      var _this$map$getContaine;\n      return (_this$map$getContaine = this.map.getContainer()) === null || _this$map$getContaine === void 0 ? void 0 : _this$map$getContaine.getElementsByClassName('amap-maps')[0];\n    }\n  }, {\n    key: \"getSize\",\n    value: function getSize() {\n      var size = this.map.getSize();\n      return [size.getWidth(), size.getHeight()];\n    }\n  }, {\n    key: \"getType\",\n    value: function getType() {\n      return 'amap';\n    }\n  }, {\n    key: \"getZoom\",\n    value: function getZoom() {\n      // 统一返回 Mapbox 缩放等级\n      return this.map.getZoom() - 1;\n    }\n  }, {\n    key: \"setZoom\",\n    value: function setZoom(zoom) {\n      // 统一设置 Mapbox 缩放等级\n      return this.map.setZoom(zoom + 1);\n    }\n  }, {\n    key: \"getCenter\",\n    value: function getCenter(options) {\n      if (options !== null && options !== void 0 && options.padding) {\n        var originCenter = this.getCenter();\n        var padding = toPaddingOptions(options.padding);\n        var px = this.lngLatToPixel([originCenter.lng, originCenter.lat]);\n        var offsetPx = [(padding.right - padding.left) / 2, (padding.bottom - padding.top) / 2];\n        var newCenter = this.pixelToLngLat([px.x - offsetPx[0], px.y - offsetPx[1]]);\n        return newCenter;\n      }\n      var center = this.map.getCenter();\n      return {\n        lng: center.getLng(),\n        lat: center.getLat()\n      };\n    }\n  }, {\n    key: \"setCenter\",\n    value: function setCenter(lnglat, options) {\n      if (options !== null && options !== void 0 && options.padding) {\n        var padding = toPaddingOptions(options.padding);\n        var px = this.lngLatToPixel(lnglat);\n        var offsetPx = [(padding.right - padding.left) / 2, (padding.bottom - padding.top) / 2];\n        var newCenter = this.pixelToLngLat([px.x + offsetPx[0], px.y + offsetPx[1]]);\n        this.map.setCenter([newCenter.lng, newCenter.lat]);\n      } else {\n        this.map.setCenter(lnglat);\n      }\n    }\n  }, {\n    key: \"getPitch\",\n    value: function getPitch() {\n      return this.map.getPitch();\n    }\n  }, {\n    key: \"getRotation\",\n    value: function getRotation() {\n      // 统一返回逆时针旋转角度\n      return 360 - this.map.getRotation();\n    }\n  }, {\n    key: \"getBounds\",\n    value: function getBounds() {\n      // @ts-ignore\n      var amapBound = this.map.getBounds().toBounds();\n      var NE = amapBound.getNorthEast();\n      var SW = amapBound.getSouthWest();\n      var center = this.getCenter();\n      var maxlng = center.lng > NE.getLng() || center.lng < SW.getLng() ? 180 - NE.getLng() : NE.getLng();\n      var minlng = center.lng < SW.getLng() ? SW.getLng() - 180 : SW.getLng();\n      // 兼容 Mapbox，统一返回西南、东北\n      return [[minlng, SW.getLat()], [maxlng, NE.getLat()]];\n    }\n  }, {\n    key: \"getMinZoom\",\n    value: function getMinZoom() {\n      var zooms = this.map.get('zooms');\n      return zooms[0] - 1;\n    }\n  }, {\n    key: \"getMaxZoom\",\n    value: function getMaxZoom() {\n      var zooms = this.map.get('zooms');\n      return zooms[1] - 1;\n    }\n  }, {\n    key: \"setRotation\",\n    value: function setRotation(rotation) {\n      return this.map.setRotation(rotation);\n    }\n  }, {\n    key: \"setPitch\",\n    value: function setPitch(pitch) {\n      return this.map.setPitch(pitch);\n    }\n  }, {\n    key: \"zoomIn\",\n    value: function zoomIn() {\n      this.map.zoomIn();\n    }\n  }, {\n    key: \"zoomOut\",\n    value: function zoomOut() {\n      this.map.zoomOut();\n    }\n  }, {\n    key: \"panTo\",\n    value: function panTo(p) {\n      this.map.panTo(p);\n    }\n  }, {\n    key: \"panBy\",\n    value: function panBy() {\n      var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      this.map.panBy(x, y);\n    }\n  }, {\n    key: \"fitBounds\",\n    value: function fitBounds(extent) {\n      this.map.setBounds(new AMap.Bounds([extent[0][0], extent[0][1], extent[1][0], extent[1][1]]));\n    }\n  }, {\n    key: \"setZoomAndCenter\",\n    value: function setZoomAndCenter(zoom, center) {\n      this.map.setZoomAndCenter(zoom + 1, center);\n    }\n  }, {\n    key: \"setMapStyle\",\n    value: function setMapStyle(style) {\n      this.map.setMapStyle(this.getMapStyleValue(style));\n    }\n  }, {\n    key: \"setMapStatus\",\n    value: function setMapStatus(option) {\n      this.map.setStatus(option);\n    }\n  }, {\n    key: \"getMapStyleConfig\",\n    value: function getMapStyleConfig() {\n      return MapTheme;\n    }\n  }, {\n    key: \"getMapStyleValue\",\n    value: function getMapStyleValue(name) {\n      return this.getMapStyleConfig()[name] || name;\n    }\n  }, {\n    key: \"getMapStyle\",\n    value: function getMapStyle() {\n      return this.map.getMapStyle();\n    }\n  }, {\n    key: \"pixelToLngLat\",\n    value: function pixelToLngLat(pixel) {\n      var lngLat = this.map.pixelToLngLat(new AMap.Pixel(pixel[0], pixel[1]));\n      return {\n        lng: lngLat.getLng(),\n        lat: lngLat.getLat()\n      };\n    }\n  }, {\n    key: \"lngLatToPixel\",\n    value: function lngLatToPixel(lnglat) {\n      var p = this.map.lnglatToPixel(new AMap.LngLat(lnglat[0], lnglat[1]));\n      // lngLatToPixel\n      return {\n        x: p.getX(),\n        y: p.getY()\n      };\n    }\n  }, {\n    key: \"containerToLngLat\",\n    value: function containerToLngLat(pixel) {\n      var ll = new AMap.Pixel(pixel[0], pixel[1]);\n      var lngLat = this.map.containerToLngLat(ll);\n      return {\n        lng: lngLat === null || lngLat === void 0 ? void 0 : lngLat.getLng(),\n        lat: lngLat === null || lngLat === void 0 ? void 0 : lngLat.getLat()\n      };\n    }\n  }, {\n    key: \"lngLatToContainer\",\n    value: function lngLatToContainer(lnglat) {\n      var ll = new AMap.LngLat(lnglat[0], lnglat[1]);\n      var pixel = this.map.lngLatToContainer(ll);\n      return {\n        x: pixel.getX(),\n        y: pixel.getY()\n      };\n    }\n  }, {\n    key: \"lngLatToCoord\",\n    value: function lngLatToCoord(lnglat) {\n      // @ts-ignore\n      var _this$map$lngLatToGeo = this.map.lngLatToGeodeticCoord(lnglat),\n        x = _this$map$lngLatToGeo.x,\n        y = _this$map$lngLatToGeo.y;\n      return [x, -y];\n    }\n  }, {\n    key: \"lngLatToMercator\",\n    value: function lngLatToMercator(\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    lnglat,\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    altitude) {\n      return {\n        x: 0,\n        y: 0,\n        z: 0\n      };\n    }\n  }, {\n    key: \"getModelMatrix\",\n    value: function getModelMatrix(lnglat, altitude, rotate) {\n      var scale = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [1, 1, 1];\n      var flat = this.viewport.projectFlat(lnglat);\n      // @ts-ignore\n      var modelMatrix = mat4.create();\n      mat4.translate(modelMatrix, modelMatrix, vec3.fromValues(flat[0], flat[1], altitude));\n      mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(scale[0], scale[1], scale[2]));\n      mat4.rotateX(modelMatrix, modelMatrix, rotate[0]);\n      mat4.rotateY(modelMatrix, modelMatrix, rotate[1]);\n      mat4.rotateZ(modelMatrix, modelMatrix, rotate[2]);\n      return modelMatrix;\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n        var _this$config, id, _this$config$style, style, _this$config$minZoom, minZoom, _this$config$maxZoom, maxZoom, _this$config$token, token, mapInstance, _this$config$plugin, plugin, rest;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this$config = this.config, id = _this$config.id, _this$config$style = _this$config.style, style = _this$config$style === void 0 ? 'light' : _this$config$style, _this$config$minZoom = _this$config.minZoom, minZoom = _this$config$minZoom === void 0 ? 0 : _this$config$minZoom, _this$config$maxZoom = _this$config.maxZoom, maxZoom = _this$config$maxZoom === void 0 ? 18 : _this$config$maxZoom, _this$config$token = _this$config.token, token = _this$config$token === void 0 ? AMAP_API_KEY : _this$config$token, mapInstance = _this$config.mapInstance, _this$config$plugin = _this$config.plugin, plugin = _this$config$plugin === void 0 ? [] : _this$config$plugin, rest = _objectWithoutProperties(_this$config, _excluded); // 高德地图创建独立的container；\n              // tslint:disable-next-line:typedef\n              _context.next = 3;\n              return new Promise(function (resolve) {\n                var resolveMap = function resolveMap() {\n                  if (mapInstance) {\n                    _this2.map = mapInstance;\n                    _this2.$mapContainer = _this2.map.getContainer();\n                    setTimeout(function () {\n                      _this2.map.on('camerachange', _this2.handleCameraChanged);\n                      resolve();\n                    }, 30);\n                  } else {\n                    _this2.$mapContainer = _this2.creatMapContainer(id);\n                    var mapConstructorOptions = _objectSpread({\n                      mapStyle: _this2.getMapStyleValue(style),\n                      zooms: [minZoom, maxZoom],\n                      viewMode: '3D'\n                    }, rest);\n                    if (mapConstructorOptions.zoom) {\n                      // TODO: 高德地图在相同大小下需要比 MapBox 多一个 zoom 层级\n                      mapConstructorOptions.zoom += 1;\n                    }\n                    // @ts-ignore\n                    var map = new AMap.Map(_this2.$mapContainer, mapConstructorOptions);\n                    // 监听地图相机事件\n                    map.on('camerachange', _this2.handleCameraChanged);\n                    // Tip: 为了兼容开启 MultiPassRender 的情况\n                    // 修复 MultiPassRender 在高德地图 1.x 的情况下，缩放地图改变 zoom 时存在可视化层和底图不同步的现象\n                    map.on('camerachange', function () {\n                      setTimeout(function () {\n                        return _this2.handleAfterMapChange();\n                      });\n                    });\n\n                    // @ts-ignore\n                    _this2.map = map;\n                    setTimeout(function () {\n                      resolve();\n                    }, 10);\n                  }\n                };\n                if (!amapLoaded && !mapInstance) {\n                  if (token === AMAP_API_KEY) {\n                    console.warn(\"%c\".concat(_this2.configService.getSceneWarninfo('MapToken'), \"!\"), 'color: #873bf4;font-weigh:900;font-size: 16px;');\n                  }\n                  amapLoaded = true;\n                  plugin.push('Map3D');\n                  AMapLoader.load({\n                    key: token,\n                    // 申请好的Web端开发者Key，首次调用 load 时必填\n                    version: AMAP_VERSION,\n                    // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\n                    plugins: plugin // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n                  }).then(function () {\n                    resolveMap();\n                    if (pendingResolveQueue.length) {\n                      pendingResolveQueue.forEach(function (r) {\n                        return r();\n                      });\n                      pendingResolveQueue = [];\n                    }\n                  }).catch(function (e) {\n                    throw new Error(e);\n                  });\n                } else {\n                  if (amapLoaded && window.AMap || mapInstance) {\n                    resolveMap();\n                  } else {\n                    pendingResolveQueue.push(resolveMap);\n                  }\n                }\n              });\n            case 3:\n              this.viewport = new Viewport();\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function init() {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }, {\n    key: \"meterToCoord\",\n    value: function meterToCoord(center, outer) {\n      // 统一根据经纬度来转化\n      // Tip: 实际米距离 unit meter\n      var meterDis = AMap.GeometryUtil.distance(_construct(AMap.LngLat, _toConsumableArray(center)), _construct(AMap.LngLat, _toConsumableArray(outer)));\n\n      // Tip: 三维世界坐标距离\n      var _this$lngLatToCoord = this.lngLatToCoord(center),\n        _this$lngLatToCoord2 = _slicedToArray(_this$lngLatToCoord, 2),\n        x1 = _this$lngLatToCoord2[0],\n        y1 = _this$lngLatToCoord2[1];\n      var _this$lngLatToCoord3 = this.lngLatToCoord(outer),\n        _this$lngLatToCoord4 = _slicedToArray(_this$lngLatToCoord3, 2),\n        x2 = _this$lngLatToCoord4[0],\n        y2 = _this$lngLatToCoord4[1];\n      var coordDis = Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n      return coordDis / meterDis;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"updateView\",\n    value: function updateView(viewOption) {\n      return;\n    }\n  }, {\n    key: \"getOverlayContainer\",\n    value: function getOverlayContainer() {\n      return undefined;\n    }\n  }, {\n    key: \"exportMap\",\n    value: function exportMap(type) {\n      var _this$getContainer;\n      var renderCanvas = (_this$getContainer = this.getContainer()) === null || _this$getContainer === void 0 ? void 0 : _this$getContainer.getElementsByClassName('amap-layer')[0];\n      var layersPng = type === 'jpg' ? renderCanvas === null || renderCanvas === void 0 ? void 0 : renderCanvas.toDataURL('image/jpeg') : renderCanvas === null || renderCanvas === void 0 ? void 0 : renderCanvas.toDataURL('image/png');\n      return layersPng;\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(name) {\n      var _this$eventEmitter;\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n      (_this$eventEmitter = this.eventEmitter).emit.apply(_this$eventEmitter, [name].concat(args));\n    }\n  }, {\n    key: \"once\",\n    value: function once(name) {\n      var _this$eventEmitter2;\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n      (_this$eventEmitter2 = this.eventEmitter).once.apply(_this$eventEmitter2, [name].concat(args));\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var _this$$mapContainer;\n      // TODO: 销毁地图可视化层的容器\n      (_this$$mapContainer = this.$mapContainer) === null || _this$$mapContainer === void 0 || (_this$$mapContainer = _this$$mapContainer.parentNode) === null || _this$$mapContainer === void 0 || _this$$mapContainer.removeChild(this.$mapContainer);\n\n      // @ts-ignore\n      delete window.initAMap;\n      var $jsapi = document.getElementById(AMAP_SCRIPT_ID);\n      if ($jsapi) {\n        document.head.removeChild($jsapi);\n      }\n      this.map.destroy();\n    }\n  }, {\n    key: \"getMapContainer\",\n    value: function getMapContainer() {\n      return this.$mapContainer;\n    }\n  }, {\n    key: \"onCameraChanged\",\n    value: function onCameraChanged(callback) {\n      this.cameraChangedCallback = callback;\n    }\n  }, {\n    key: \"handleAfterMapChange\",\n    value: function handleAfterMapChange() {\n      this.emit('mapAfterFrameChange');\n    }\n  }, {\n    key: \"creatMapContainer\",\n    value: function creatMapContainer(id) {\n      var $wrapper = id;\n      if (typeof id === 'string') {\n        $wrapper = document.getElementById(id);\n      }\n      var $amapdiv = document.createElement('div');\n      $amapdiv.style.cssText += \"\\n       position: absolute;\\n       top: 0;\\n       height: 100%;\\n       width: 100%;\\n     \";\n      $amapdiv.id = 'l7_amap_div' + mapdivCount++;\n      $wrapper.appendChild($amapdiv);\n      return $amapdiv;\n    }\n  }]);\n  return AMapBaseService;\n}(), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, \"configService\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, \"config\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, \"coordinateSystemService\", [_dec4], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, \"eventEmitter\", [_dec5], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexport { AMapBaseService as default };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
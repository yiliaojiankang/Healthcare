{"ast":null,"code":"import { midPoint } from './mid-point';\nimport { segmentCubicFactory } from './segment-cubic-factory';\nfunction splitCubic(pts, t) {\n  if (t === void 0) {\n    t = 0.5;\n  }\n  var p0 = pts.slice(0, 2);\n  var p1 = pts.slice(2, 4);\n  var p2 = pts.slice(4, 6);\n  var p3 = pts.slice(6, 8);\n  var p4 = midPoint(p0, p1, t);\n  var p5 = midPoint(p1, p2, t);\n  var p6 = midPoint(p2, p3, t);\n  var p7 = midPoint(p4, p5, t);\n  var p8 = midPoint(p5, p6, t);\n  var p9 = midPoint(p7, p8, t);\n  return [\n  // @ts-ignore\n  ['C'].concat(p4, p7, p9),\n  // @ts-ignore\n  ['C'].concat(p8, p6, p3)];\n}\nfunction getCurveArray(segments) {\n  return segments.map(function (segment, i, pathArray) {\n    // @ts-ignore\n    var segmentData = i && pathArray[i - 1].slice(-2).concat(segment.slice(1));\n    // @ts-ignore\n    var curveLength = i ? segmentCubicFactory(segmentData[0], segmentData[1], segmentData[2], segmentData[3], segmentData[4], segmentData[5], segmentData[6], segmentData[7], segmentData[8], {\n      bbox: false\n    }).length : 0;\n    var subsegs;\n    if (i) {\n      // must be [segment,segment]\n      subsegs = curveLength ? splitCubic(segmentData) : [segment, segment];\n    } else {\n      subsegs = [segment];\n    }\n    return {\n      s: segment,\n      ss: subsegs,\n      l: curveLength\n    };\n  });\n}\nexport function equalizeSegments(path1, path2, TL) {\n  var c1 = getCurveArray(path1);\n  var c2 = getCurveArray(path2);\n  var L1 = c1.length;\n  var L2 = c2.length;\n  var l1 = c1.filter(function (x) {\n    return x.l;\n  }).length;\n  var l2 = c2.filter(function (x) {\n    return x.l;\n  }).length;\n  var m1 = c1.filter(function (x) {\n    return x.l;\n  }).reduce(function (a, _a) {\n    var l = _a.l;\n    return a + l;\n  }, 0) / l1 || 0;\n  var m2 = c2.filter(function (x) {\n    return x.l;\n  }).reduce(function (a, _a) {\n    var l = _a.l;\n    return a + l;\n  }, 0) / l2 || 0;\n  var tl = TL || Math.max(L1, L2);\n  var mm = [m1, m2];\n  var dif = [tl - L1, tl - L2];\n  var canSplit = 0;\n  var result = [c1, c2].map(function (x, i) {\n    // @ts-ignore\n    return x.l === tl ? x.map(function (y) {\n      return y.s;\n    }) : x.map(function (y, j) {\n      canSplit = j && dif[i] && y.l >= mm[i];\n      dif[i] -= canSplit ? 1 : 0;\n      return canSplit ? y.ss : [y.s];\n    }).flat();\n  });\n  return result[0].length === result[1].length ? result : equalizeSegments(result[0], result[1], tl);\n}","map":{"version":3,"names":["midPoint","segmentCubicFactory","splitCubic","pts","t","p0","slice","p1","p2","p3","p4","p5","p6","p7","p8","p9","concat","getCurveArray","segments","map","segment","i","pathArray","segmentData","curveLength","bbox","length","subsegs","s","ss","l","equalizeSegments","path1","path2","TL","c1","c2","L1","L2","l1","filter","x","l2","m1","reduce","a","_a","m2","tl","Math","max","mm","dif","canSplit","result","y","j","flat"],"sources":["src/path/util/equalize-segments.ts"],"sourcesContent":[null],"mappings":"AACA,SAASA,QAAQ,QAAQ,aAAa;AACtC,SAASC,mBAAmB,QAAQ,yBAAyB;AAE7D,SAASC,UAAUA,CACjBC,GAAqE,EACrEC,CAAO;EAAP,IAAAA,CAAA;IAAAA,CAAA,MAAO;EAAA;EAEP,IAAMC,EAAE,GAAGF,GAAG,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAqB;EAC9C,IAAMC,EAAE,GAAGJ,GAAG,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAqB;EAC9C,IAAME,EAAE,GAAGL,GAAG,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAqB;EAC9C,IAAMG,EAAE,GAAGN,GAAG,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAqB;EAC9C,IAAMI,EAAE,GAAGV,QAAQ,CAACK,EAAE,EAAEE,EAAE,EAAEH,CAAC,CAAC;EAC9B,IAAMO,EAAE,GAAGX,QAAQ,CAACO,EAAE,EAAEC,EAAE,EAAEJ,CAAC,CAAC;EAC9B,IAAMQ,EAAE,GAAGZ,QAAQ,CAACQ,EAAE,EAAEC,EAAE,EAAEL,CAAC,CAAC;EAC9B,IAAMS,EAAE,GAAGb,QAAQ,CAACU,EAAE,EAAEC,EAAE,EAAEP,CAAC,CAAC;EAC9B,IAAMU,EAAE,GAAGd,QAAQ,CAACW,EAAE,EAAEC,EAAE,EAAER,CAAC,CAAC;EAC9B,IAAMW,EAAE,GAAGf,QAAQ,CAACa,EAAE,EAAEC,EAAE,EAAEV,CAAC,CAAC;EAE9B,OAAO;EACL;EACA,CAAC,GAAG,CAAC,CAACY,MAAM,CAACN,EAAE,EAAEG,EAAE,EAAEE,EAAE,CAAC;EACxB;EACA,CAAC,GAAG,CAAC,CAACC,MAAM,CAACF,EAAE,EAAEF,EAAE,EAAEH,EAAE,CAAC,CACzB;AACH;AAEA,SAASQ,aAAaA,CAACC,QAAmB;EACxC,OAAOA,QAAQ,CAACC,GAAG,CAAC,UAACC,OAAO,EAAEC,CAAC,EAAEC,SAAS;IACxC;IACA,IAAMC,WAAW,GAAGF,CAAC,IAAIC,SAAS,CAACD,CAAC,GAAG,CAAC,CAAC,CAACf,KAAK,CAAC,CAAC,CAAC,CAAC,CAACU,MAAM,CAACI,OAAO,CAACd,KAAK,CAAC,CAAC,CAAC,CAAC;IAE5E;IACA,IAAMkB,WAAW,GAAGH,CAAC,GACjBpB,mBAAmB,CACjBsB,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACdA,WAAW,CAAC,CAAC,CAAC,EACd;MAAEE,IAAI,EAAE;IAAK,CAAE,CAChB,CAACC,MAAM,GACR,CAAC;IAEL,IAAIC,OAAO;IACX,IAAIN,CAAC,EAAE;MACL;MACAM,OAAO,GAAGH,WAAW,GAAGtB,UAAU,CAACqB,WAAW,CAAC,GAAG,CAACH,OAAO,EAAEA,OAAO,CAAC;KACrE,MAAM;MACLO,OAAO,GAAG,CAACP,OAAO,CAAC;;IAGrB,OAAO;MACLQ,CAAC,EAAER,OAAO;MACVS,EAAE,EAAEF,OAAO;MACXG,CAAC,EAAEN;KACJ;EACH,CAAC,CAAC;AACJ;AAEA,OAAM,SAAUO,gBAAgBA,CAACC,KAAgB,EAAEC,KAAgB,EAAEC,EAAW;EAC9E,IAAMC,EAAE,GAAGlB,aAAa,CAACe,KAAK,CAAC;EAC/B,IAAMI,EAAE,GAAGnB,aAAa,CAACgB,KAAK,CAAC;EAC/B,IAAMI,EAAE,GAAGF,EAAE,CAACT,MAAM;EACpB,IAAMY,EAAE,GAAGF,EAAE,CAACV,MAAM;EACpB,IAAMa,EAAE,GAAGJ,EAAE,CAACK,MAAM,CAAC,UAACC,CAAC;IAAK,OAAAA,CAAC,CAACX,CAAC;EAAH,CAAG,CAAC,CAACJ,MAAM;EACvC,IAAMgB,EAAE,GAAGN,EAAE,CAACI,MAAM,CAAC,UAACC,CAAC;IAAK,OAAAA,CAAC,CAACX,CAAC;EAAH,CAAG,CAAC,CAACJ,MAAM;EACvC,IAAMiB,EAAE,GAAGR,EAAE,CAACK,MAAM,CAAC,UAACC,CAAC;IAAK,OAAAA,CAAC,CAACX,CAAC;EAAH,CAAG,CAAC,CAACc,MAAM,CAAC,UAACC,CAAC,EAAEC,EAAK;QAAHhB,CAAC,GAAAgB,EAAA,CAAAhB,CAAA;IAAO,OAAAe,CAAC,GAAGf,CAAC;EAAL,CAAK,EAAE,CAAC,CAAC,GAAGS,EAAE,IAAI,CAAC;EACzE,IAAMQ,EAAE,GAAGX,EAAE,CAACI,MAAM,CAAC,UAACC,CAAC;IAAK,OAAAA,CAAC,CAACX,CAAC;EAAH,CAAG,CAAC,CAACc,MAAM,CAAC,UAACC,CAAC,EAAEC,EAAK;QAAHhB,CAAC,GAAAgB,EAAA,CAAAhB,CAAA;IAAO,OAAAe,CAAC,GAAGf,CAAC;EAAL,CAAK,EAAE,CAAC,CAAC,GAAGY,EAAE,IAAI,CAAC;EACzE,IAAMM,EAAE,GAAGd,EAAE,IAAIe,IAAI,CAACC,GAAG,CAACb,EAAE,EAAEC,EAAE,CAAC;EACjC,IAAMa,EAAE,GAAG,CAACR,EAAE,EAAEI,EAAE,CAAC;EACnB,IAAMK,GAAG,GAAG,CAACJ,EAAE,GAAGX,EAAE,EAAEW,EAAE,GAAGV,EAAE,CAAC;EAC9B,IAAIe,QAAQ,GAAqB,CAAC;EAClC,IAAMC,MAAM,GAAG,CAACnB,EAAE,EAAEC,EAAE,CAAC,CAACjB,GAAG,CAAC,UAACsB,CAAC,EAAEpB,CAAC;IAC/B;IACA,OAAAoB,CAAC,CAACX,CAAC,KAAKkB,EAAE,GACNP,CAAC,CAACtB,GAAG,CAAC,UAACoC,CAAC;MAAK,OAAAA,CAAC,CAAC3B,CAAC;IAAH,CAAG,CAAC,GACjBa,CAAC,CACEtB,GAAG,CAAC,UAACoC,CAAC,EAAEC,CAAC;MACRH,QAAQ,GAAGG,CAAC,IAAIJ,GAAG,CAAC/B,CAAC,CAAC,IAAIkC,CAAC,CAACzB,CAAC,IAAIqB,EAAE,CAAC9B,CAAC,CAAC;MACtC+B,GAAG,CAAC/B,CAAC,CAAC,IAAIgC,QAAQ,GAAG,CAAC,GAAG,CAAC;MAC1B,OAAOA,QAAQ,GAAGE,CAAC,CAAC1B,EAAE,GAAG,CAAC0B,CAAC,CAAC3B,CAAC,CAAC;IAChC,CAAC,CAAC,CACD6B,IAAI,EAAE;EARb,CAQa,CACE;EAEjB,OAAOH,MAAM,CAAC,CAAC,CAAC,CAAC5B,MAAM,KAAK4B,MAAM,CAAC,CAAC,CAAC,CAAC5B,MAAM,GAAG4B,MAAM,GAAGvB,gBAAgB,CAACuB,MAAM,CAAC,CAAC,CAAC,EAAEA,MAAM,CAAC,CAAC,CAAC,EAAEN,EAAE,CAAC;AACpG"},"metadata":{},"sourceType":"module","externalDependencies":[]}
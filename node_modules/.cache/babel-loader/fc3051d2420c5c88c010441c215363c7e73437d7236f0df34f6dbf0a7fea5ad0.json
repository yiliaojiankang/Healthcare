{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { each, some } from '@antv/util';\nimport ListState from './list-state';\nvar STATUS_UNCHECKED = 'unchecked';\nvar STATUS_CHECKED = 'checked';\n/**\n * checked Action\n * 提供三个对外方法\n * 1. toggle 切换状态\n * 2. checked 选中\n * 3. reset 清除重置\n */\nvar ListChecked = /** @class */function (_super) {\n  __extends(ListChecked, _super);\n  function ListChecked() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.stateName = STATUS_CHECKED;\n    return _this;\n  }\n  // 单个 item 设置状态\n  ListChecked.prototype.setItemState = function (list, item, enable) {\n    this.setCheckedBy(list, function (el) {\n      return el === item;\n    }, enable);\n  };\n  // 根据条件设置 checked\n  ListChecked.prototype.setCheckedBy = function (list, callback, enable) {\n    var items = list.getItems();\n    if (enable) {\n      // 设置 checked 时，保留之前已经 checked 的项\n      each(items, function (item) {\n        if (callback(item)) {\n          if (list.hasState(item, STATUS_UNCHECKED)) {\n            list.setItemState(item, STATUS_UNCHECKED, false);\n          }\n          list.setItemState(item, STATUS_CHECKED, true);\n        } else if (!list.hasState(item, STATUS_CHECKED)) {\n          list.setItemState(item, STATUS_UNCHECKED, true);\n        }\n      });\n    }\n  };\n  /**\n   * 切换状态.\n   * 1. 当全部选中的时候 或者 当前 item 未选中时，进行激活操作\n   * 2. 否则，重置\n   * @override\n   */\n  ListChecked.prototype.toggle = function () {\n    var triggerInfo = this.getTriggerListInfo();\n    if (triggerInfo && triggerInfo.item) {\n      var list_1 = triggerInfo.list,\n        item = triggerInfo.item;\n      // 不知道 🤷‍♀️ 只认 unchecked status\n      var allChecked = !some(list_1.getItems(), function (t) {\n        return list_1.hasState(t, STATUS_UNCHECKED);\n      });\n      //\n      if (allChecked || list_1.hasState(item, STATUS_UNCHECKED)) {\n        this.setItemState(list_1, item, true);\n      } else {\n        this.reset();\n      }\n    }\n  };\n  /**\n   * checked 图例项\n   */\n  ListChecked.prototype.checked = function () {\n    this.setState();\n  };\n  /**\n   * 重置，需要全部清理 checked 和 unchecked\n   */\n  ListChecked.prototype.reset = function () {\n    var components = this.getAllowComponents();\n    each(components, function (component) {\n      component.clearItemsState(STATUS_CHECKED);\n      component.clearItemsState(STATUS_UNCHECKED);\n    });\n  };\n  return ListChecked;\n}(ListState);\nexport default ListChecked;","map":{"version":3,"names":["each","some","ListState","STATUS_UNCHECKED","STATUS_CHECKED","ListChecked","_super","__extends","_this","apply","arguments","stateName","prototype","setItemState","list","item","enable","setCheckedBy","el","callback","items","getItems","hasState","toggle","triggerInfo","getTriggerListInfo","list_1","allChecked","t","reset","checked","setState","components","getAllowComponents","component","clearItemsState"],"sources":["../../../../src/interaction/action/component/list-checked.ts"],"sourcesContent":["import { each, some } from '@antv/util';\nimport { IList, ListItem } from '../../../dependents';\nimport ListState from './list-state';\n\nconst STATUS_UNCHECKED = 'unchecked';\nconst STATUS_CHECKED = 'checked';\ntype MatchCallback = (item: ListItem) => boolean;\n\n/**\n * checked Action\n * 提供三个对外方法\n * 1. toggle 切换状态\n * 2. checked 选中\n * 3. reset 清除重置\n */\nclass ListChecked extends ListState {\n  protected stateName: string = STATUS_CHECKED;\n\n  // 单个 item 设置状态\n  protected setItemState(list: IList, item: ListItem, enable: boolean) {\n    this.setCheckedBy(list, (el) => el === item, enable);\n  }\n\n  // 根据条件设置 checked\n  private setCheckedBy(list: IList, callback: MatchCallback, enable: boolean) {\n    const items = list.getItems();\n    if (enable) {\n      // 设置 checked 时，保留之前已经 checked 的项\n      each(items, (item) => {\n        if (callback(item)) {\n          if (list.hasState(item, STATUS_UNCHECKED)) {\n            list.setItemState(item, STATUS_UNCHECKED, false);\n          }\n          list.setItemState(item, STATUS_CHECKED, true);\n        } else if (!list.hasState(item, STATUS_CHECKED)) {\n          list.setItemState(item, STATUS_UNCHECKED, true);\n        }\n      });\n    }\n  }\n\n  /**\n   * 切换状态.\n   * 1. 当全部选中的时候 或者 当前 item 未选中时，进行激活操作\n   * 2. 否则，重置\n   * @override\n   */\n  public toggle() {\n    const triggerInfo = this.getTriggerListInfo();\n    if (triggerInfo && triggerInfo.item) {\n      const { list, item } = triggerInfo;\n\n      // 不知道 🤷‍♀️ 只认 unchecked status\n      const allChecked = !some(list.getItems(), (t) => list.hasState(t, STATUS_UNCHECKED));\n\n      //\n      if (allChecked || list.hasState(item, STATUS_UNCHECKED)) {\n        this.setItemState(list, item, true);\n      } else {\n        this.reset();\n      }\n    }\n  }\n\n  /**\n   * checked 图例项\n   */\n  public checked() {\n    this.setState();\n  }\n\n  /**\n   * 重置，需要全部清理 checked 和 unchecked\n   */\n  public reset() {\n    const components = this.getAllowComponents();\n    each(components, (component) => {\n      component.clearItemsState(STATUS_CHECKED);\n      component.clearItemsState(STATUS_UNCHECKED);\n    });\n  }\n}\n\nexport default ListChecked;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
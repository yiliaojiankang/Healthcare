{"ast":null,"code":"/**\n * @fileoverview gradient\n * @author dengfuping_develop@163.com\n */\nimport { each, mod, toRadian, uniqueId } from '@antv/util';\nimport { createSVGElement } from '../util/dom';\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^)]+\\))/gi;\nfunction addStop(steps) {\n  var arr = steps.match(regexColorStop);\n  if (!arr) {\n    return '';\n  }\n  var stops = '';\n  arr.sort(function (a, b) {\n    a = a.split(':');\n    b = b.split(':');\n    return Number(a[0]) - Number(b[0]);\n  });\n  each(arr, function (item) {\n    item = item.split(':');\n    stops += \"<stop offset=\\\"\" + item[0] + \"\\\" stop-color=\\\"\" + item[1] + \"\\\"></stop>\";\n  });\n  return stops;\n}\nfunction parseLineGradient(color, el) {\n  var arr = regexLG.exec(color);\n  var angle = mod(toRadian(parseFloat(arr[1])), Math.PI * 2);\n  var steps = arr[2];\n  var start;\n  var end;\n  if (angle >= 0 && angle < 0.5 * Math.PI) {\n    start = {\n      x: 0,\n      y: 0\n    };\n    end = {\n      x: 1,\n      y: 1\n    };\n  } else if (0.5 * Math.PI <= angle && angle < Math.PI) {\n    start = {\n      x: 1,\n      y: 0\n    };\n    end = {\n      x: 0,\n      y: 1\n    };\n  } else if (Math.PI <= angle && angle < 1.5 * Math.PI) {\n    start = {\n      x: 1,\n      y: 1\n    };\n    end = {\n      x: 0,\n      y: 0\n    };\n  } else {\n    start = {\n      x: 0,\n      y: 1\n    };\n    end = {\n      x: 1,\n      y: 0\n    };\n  }\n  var tanTheta = Math.tan(angle);\n  var tanTheta2 = tanTheta * tanTheta;\n  var x = (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.x;\n  var y = tanTheta * (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.y;\n  el.setAttribute('x1', start.x);\n  el.setAttribute('y1', start.y);\n  el.setAttribute('x2', x);\n  el.setAttribute('y2', y);\n  el.innerHTML = addStop(steps);\n}\nfunction parseRadialGradient(color, self) {\n  var arr = regexRG.exec(color);\n  var cx = parseFloat(arr[1]);\n  var cy = parseFloat(arr[2]);\n  var r = parseFloat(arr[3]);\n  var steps = arr[4];\n  self.setAttribute('cx', cx);\n  self.setAttribute('cy', cy);\n  self.setAttribute('r', r);\n  self.innerHTML = addStop(steps);\n}\nvar Gradient = /** @class */function () {\n  function Gradient(cfg) {\n    this.cfg = {};\n    var el = null;\n    var id = uniqueId('gradient_');\n    if (cfg.toLowerCase()[0] === 'l') {\n      el = createSVGElement('linearGradient');\n      parseLineGradient(cfg, el);\n    } else {\n      el = createSVGElement('radialGradient');\n      parseRadialGradient(cfg, el);\n    }\n    el.setAttribute('id', id);\n    this.el = el;\n    this.id = id;\n    this.cfg = cfg;\n    return this;\n  }\n  Gradient.prototype.match = function (type, attr) {\n    return this.cfg === attr;\n  };\n  return Gradient;\n}();\nexport default Gradient;","map":{"version":3,"names":["each","mod","toRadian","uniqueId","createSVGElement","regexLG","regexRG","regexColorStop","addStop","steps","arr","match","stops","sort","a","b","split","Number","item","parseLineGradient","color","el","exec","angle","parseFloat","Math","PI","start","end","x","y","tanTheta","tan","tanTheta2","setAttribute","innerHTML","parseRadialGradient","self","cx","cy","r","Gradient","cfg","id","toLowerCase","prototype","type","attr"],"sources":["../../src/defs/gradient.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nimport { AttributeType, gl } from '@antv/l7-core';\nimport { FrequencyController } from '@antv/l7-utils';\nimport BaseModel from \"../../core/BaseModel\";\nimport { RasterImageTriangulation } from \"../../core/triangulation\";\n/* babel-plugin-inline-import '../shaders/wind_frag.glsl' */\nvar WindFrag = \"precision mediump float;\\nuniform float u_opacity: 1.0;\\nuniform sampler2D u_texture;\\nvarying vec2 v_texCoord;\\nvoid main() {\\n  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));\\n  gl_FragColor = color;\\n  gl_FragColor.a *= u_opacity;\\n}\\n\";\n/* babel-plugin-inline-import '../shaders/wind_vert.glsl' */\nvar WindVert = \"precision highp float;\\nuniform mat4 u_ModelMatrix;\\n\\nattribute vec3 a_Position;\\nattribute vec2 a_Uv;\\nvarying vec2 v_texCoord;\\n#pragma include \\\"projection\\\"\\nvoid main() {\\n   v_texCoord = a_Uv;\\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\\n\\n    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));\\n}\\n\";\nimport { Wind } from \"./windRender\";\nvar defaultRampColors = {\n  0.0: '#3288bd',\n  0.1: '#66c2a5',\n  0.2: '#abdda4',\n  0.3: '#e6f598',\n  0.4: '#fee08b',\n  0.5: '#fdae61',\n  0.6: '#f46d43',\n  1.0: '#d53e4f'\n};\nvar WindModel = /*#__PURE__*/function (_BaseModel) {\n  _inherits(WindModel, _BaseModel);\n  var _super = _createSuper(WindModel);\n  function WindModel() {\n    var _this;\n    _classCallCheck(this, WindModel);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"sizeScale\", 0.5);\n    // https://mapbox.github.io/webgl-wind/demo/\n    // source: 'http://nomads.ncep.noaa.gov',\n    _defineProperty(_assertThisInitialized(_this), \"frequency\", new FrequencyController(7.2));\n    return _this;\n  }\n  _createClass(WindModel, [{\n    key: \"render\",\n    value: function render(options) {\n      var _this2 = this;\n      this.drawColorMode(options);\n      // Tip: 控制风场的平均更新频率\n      this.frequency.run(function () {\n        _this2.drawWind();\n      });\n    }\n  }, {\n    key: \"getUninforms\",\n    value: function getUninforms() {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"initModels\",\n    value: function () {\n      var _initModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _source$data,\n          _source$data2,\n          _this3 = this;\n        var _ref, _ref$uMin, uMin, _ref$uMax, uMax, _ref$vMin, vMin, _ref$vMax, vMax, _ref$fadeOpacity, fadeOpacity, _ref$speedFactor, speedFactor, _ref$dropRate, dropRate, _ref$dropRateBump, dropRateBump, _ref$rampColors, rampColors, _ref$sizeScale, sizeScale, createTexture2D, source, glContext, model;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _ref = this.layer.getLayerConfig(), _ref$uMin = _ref.uMin, uMin = _ref$uMin === void 0 ? -21.32 : _ref$uMin, _ref$uMax = _ref.uMax, uMax = _ref$uMax === void 0 ? 26.8 : _ref$uMax, _ref$vMin = _ref.vMin, vMin = _ref$vMin === void 0 ? -21.57 : _ref$vMin, _ref$vMax = _ref.vMax, vMax = _ref$vMax === void 0 ? 21.42 : _ref$vMax, _ref$fadeOpacity = _ref.fadeOpacity, fadeOpacity = _ref$fadeOpacity === void 0 ? 0.996 : _ref$fadeOpacity, _ref$speedFactor = _ref.speedFactor, speedFactor = _ref$speedFactor === void 0 ? 0.25 : _ref$speedFactor, _ref$dropRate = _ref.dropRate, dropRate = _ref$dropRate === void 0 ? 0.003 : _ref$dropRate, _ref$dropRateBump = _ref.dropRateBump, dropRateBump = _ref$dropRateBump === void 0 ? 0.01 : _ref$dropRateBump, _ref$rampColors = _ref.rampColors, rampColors = _ref$rampColors === void 0 ? defaultRampColors : _ref$rampColors, _ref$sizeScale = _ref.sizeScale, sizeScale = _ref$sizeScale === void 0 ? 0.5 : _ref$sizeScale;\n              createTexture2D = this.rendererService.createTexture2D;\n              source = this.layer.getSource();\n              this.texture = createTexture2D({\n                height: 0,\n                width: 0\n              });\n              this.cacheZoom = Math.floor(this.mapService.getZoom());\n              glContext = this.rendererService.getGLContext();\n              this.imageCoords = (_source$data = source.data) === null || _source$data === void 0 ? void 0 : _source$data.dataArray[0].coordinates;\n              (_source$data2 = source.data) === null || _source$data2 === void 0 || (_source$data2 = _source$data2.images) === null || _source$data2 === void 0 || _source$data2.then(function (imageData) {\n                var _this3$texture;\n                _this3.sizeScale = sizeScale * _this3.getZoomScale();\n                var _this3$getWindSize = _this3.getWindSize(),\n                  imageWidth = _this3$getWindSize.imageWidth,\n                  imageHeight = _this3$getWindSize.imageHeight;\n                var options = {\n                  glContext: glContext,\n                  imageWidth: imageWidth,\n                  imageHeight: imageHeight,\n                  fadeOpacity: fadeOpacity,\n                  speedFactor: speedFactor,\n                  dropRate: dropRate,\n                  dropRateBump: dropRateBump,\n                  rampColors: rampColors\n                };\n                _this3.wind = new Wind(options);\n\n                // imageData[0] 风场图\n                _this3.wind.setWind({\n                  uMin: uMin,\n                  uMax: uMax,\n                  vMin: vMin,\n                  vMax: vMax,\n                  image: imageData[0]\n                });\n                (_this3$texture = _this3.texture) === null || _this3$texture === void 0 || _this3$texture.destroy();\n                _this3.texture = createTexture2D({\n                  width: imageWidth,\n                  height: imageHeight\n                });\n                _this3.layerService.reRender();\n              });\n              _context.next = 10;\n              return this.layer.buildLayerModel({\n                moduleName: 'wind',\n                vertexShader: WindVert,\n                fragmentShader: WindFrag,\n                triangulation: RasterImageTriangulation,\n                primitive: gl.TRIANGLES,\n                depth: {\n                  enable: false\n                }\n              });\n            case 10:\n              model = _context.sent;\n              this.colorModel = model;\n              return _context.abrupt(\"return\", [model]);\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function initModels() {\n        return _initModels.apply(this, arguments);\n      }\n      return initModels;\n    }()\n  }, {\n    key: \"getWindSize\",\n    value: function getWindSize() {\n      var p1 = this.mapService.lngLatToPixel(this.imageCoords[0]);\n      var p2 = this.mapService.lngLatToPixel(this.imageCoords[1]);\n      var imageWidth = Math.min(Math.floor((p2.x - p1.x) * this.sizeScale), 2048);\n      var imageHeight = Math.min(Math.floor((p1.y - p2.y) * this.sizeScale), 2048);\n      return {\n        imageWidth: imageWidth,\n        imageHeight: imageHeight\n      };\n    }\n  }, {\n    key: \"buildModels\",\n    value: function () {\n      var _buildModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt(\"return\", this.initModels());\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function buildModels() {\n        return _buildModels.apply(this, arguments);\n      }\n      return buildModels;\n    }()\n  }, {\n    key: \"clearModels\",\n    value: function clearModels() {\n      var _this$texture, _this$wind;\n      (_this$texture = this.texture) === null || _this$texture === void 0 || _this$texture.destroy();\n      (_this$wind = this.wind) === null || _this$wind === void 0 || _this$wind.destroy();\n    }\n  }, {\n    key: \"registerBuiltinAttributes\",\n    value: function registerBuiltinAttributes() {\n      // point layer size;\n      this.styleAttributeService.registerStyleAttribute({\n        name: 'uv',\n        type: AttributeType.Attribute,\n        descriptor: {\n          name: 'a_Uv',\n          buffer: {\n            // give the WebGL driver a hint that this buffer may change\n            usage: gl.DYNAMIC_DRAW,\n            data: [],\n            type: gl.FLOAT\n          },\n          size: 2,\n          update: function update(feature, featureIdx, vertex) {\n            return [vertex[3], vertex[4]];\n          }\n        }\n      });\n    }\n  }, {\n    key: \"getZoomScale\",\n    value: function getZoomScale() {\n      return Math.min((this.cacheZoom + 4) / 30 * 2, 2);\n    }\n  }, {\n    key: \"drawWind\",\n    value: function drawWind() {\n      if (this.wind) {\n        var _ref2 = this.layer.getLayerConfig(),\n          _ref2$uMin = _ref2.uMin,\n          uMin = _ref2$uMin === void 0 ? -21.32 : _ref2$uMin,\n          _ref2$uMax = _ref2.uMax,\n          uMax = _ref2$uMax === void 0 ? 26.8 : _ref2$uMax,\n          _ref2$vMin = _ref2.vMin,\n          vMin = _ref2$vMin === void 0 ? -21.57 : _ref2$vMin,\n          _ref2$vMax = _ref2.vMax,\n          vMax = _ref2$vMax === void 0 ? 21.42 : _ref2$vMax,\n          _ref2$numParticles = _ref2.numParticles,\n          numParticles = _ref2$numParticles === void 0 ? 65535 : _ref2$numParticles,\n          _ref2$fadeOpacity = _ref2.fadeOpacity,\n          fadeOpacity = _ref2$fadeOpacity === void 0 ? 0.996 : _ref2$fadeOpacity,\n          _ref2$speedFactor = _ref2.speedFactor,\n          speedFactor = _ref2$speedFactor === void 0 ? 0.25 : _ref2$speedFactor,\n          _ref2$dropRate = _ref2.dropRate,\n          dropRate = _ref2$dropRate === void 0 ? 0.003 : _ref2$dropRate,\n          _ref2$dropRateBump = _ref2.dropRateBump,\n          dropRateBump = _ref2$dropRateBump === void 0 ? 0.01 : _ref2$dropRateBump,\n          _ref2$rampColors = _ref2.rampColors,\n          rampColors = _ref2$rampColors === void 0 ? defaultRampColors : _ref2$rampColors,\n          _ref2$sizeScale = _ref2.sizeScale,\n          sizeScale = _ref2$sizeScale === void 0 ? 0.5 : _ref2$sizeScale;\n        var newNumParticles = numParticles;\n        var currentZoom = Math.floor(this.mapService.getZoom());\n        if (typeof sizeScale === 'number' && sizeScale !== this.sizeScale || currentZoom !== this.cacheZoom) {\n          var zoomScale = this.getZoomScale();\n          this.sizeScale = sizeScale;\n          newNumParticles *= zoomScale;\n          var _this$getWindSize = this.getWindSize(),\n            imageWidth = _this$getWindSize.imageWidth,\n            imageHeight = _this$getWindSize.imageHeight;\n          this.wind.reSize(imageWidth, imageHeight);\n          this.cacheZoom = currentZoom;\n        }\n        this.wind.updateWindDir(uMin, uMax, vMin, vMax);\n        this.wind.updateParticelNum(newNumParticles);\n        this.wind.updateColorRampTexture(rampColors);\n        this.wind.fadeOpacity = fadeOpacity;\n        this.wind.speedFactor = speedFactor;\n        this.wind.dropRate = dropRate;\n        this.wind.dropRateBump = dropRateBump;\n        var _this$wind$draw = this.wind.draw(),\n          d = _this$wind$draw.d,\n          w = _this$wind$draw.w,\n          h = _this$wind$draw.h;\n        // 恢复 L7 渲染流程中 gl 状态\n        this.rendererService.setBaseState();\n        this.texture.update({\n          data: d,\n          width: w,\n          height: h\n        });\n      }\n    }\n  }, {\n    key: \"drawColorMode\",\n    value: function drawColorMode() {\n      var _this$colorModel;\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _ref3 = this.layer.getLayerConfig(),\n        opacity = _ref3.opacity;\n      this.layerService.beforeRenderData(this.layer);\n      this.layer.hooks.beforeRender.call();\n      this.layerService.renderMask(this.layer.masks);\n      (_this$colorModel = this.colorModel) === null || _this$colorModel === void 0 || _this$colorModel.draw({\n        uniforms: {\n          u_opacity: opacity || 1.0,\n          u_texture: this.texture\n        },\n        blend: this.getBlend(),\n        stencil: this.getStencil(options)\n      });\n      this.layer.hooks.afterRender.call();\n    }\n  }]);\n  return WindModel;\n}(BaseModel);\nexport { WindModel as default };","map":{"version":3,"names":["_asyncToGenerator","_classCallCheck","_createClass","_assertThisInitialized","_inherits","_possibleConstructorReturn","_getPrototypeOf","_defineProperty","_regeneratorRuntime","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","arguments","apply","sham","Proxy","Boolean","prototype","valueOf","call","e","AttributeType","gl","FrequencyController","BaseModel","RasterImageTriangulation","WindFrag","WindVert","Wind","defaultRampColors","WindModel","_BaseModel","_super","_this","_len","length","args","Array","_key","concat","key","value","render","options","_this2","drawColorMode","frequency","run","drawWind","getUninforms","Error","_initModels","mark","_callee","_source$data","_source$data2","_this3","_ref","_ref$uMin","uMin","_ref$uMax","uMax","_ref$vMin","vMin","_ref$vMax","vMax","_ref$fadeOpacity","fadeOpacity","_ref$speedFactor","speedFactor","_ref$dropRate","dropRate","_ref$dropRateBump","dropRateBump","_ref$rampColors","rampColors","_ref$sizeScale","sizeScale","createTexture2D","source","glContext","model","wrap","_callee$","_context","prev","next","layer","getLayerConfig","rendererService","getSource","texture","height","width","cacheZoom","Math","floor","mapService","getZoom","getGLContext","imageCoords","data","dataArray","coordinates","images","then","imageData","_this3$texture","getZoomScale","_this3$getWindSize","getWindSize","imageWidth","imageHeight","wind","setWind","image","destroy","layerService","reRender","buildLayerModel","moduleName","vertexShader","fragmentShader","triangulation","primitive","TRIANGLES","depth","enable","sent","colorModel","abrupt","stop","initModels","p1","lngLatToPixel","p2","min","x","y","_buildModels","_callee2","_callee2$","_context2","buildModels","clearModels","_this$texture","_this$wind","registerBuiltinAttributes","styleAttributeService","registerStyleAttribute","name","type","Attribute","descriptor","buffer","usage","DYNAMIC_DRAW","FLOAT","size","update","feature","featureIdx","vertex","_ref2","_ref2$uMin","_ref2$uMax","_ref2$vMin","_ref2$vMax","_ref2$numParticles","numParticles","_ref2$fadeOpacity","_ref2$speedFactor","_ref2$dropRate","_ref2$dropRateBump","_ref2$rampColors","_ref2$sizeScale","newNumParticles","currentZoom","zoomScale","_this$getWindSize","reSize","updateWindDir","updateParticelNum","updateColorRampTexture","_this$wind$draw","draw","d","w","h","setBaseState","_this$colorModel","undefined","_ref3","opacity","beforeRenderData","hooks","beforeRender","renderMask","masks","uniforms","u_opacity","u_texture","blend","getBlend","stencil","getStencil","afterRender","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-layers/es/wind/models/wind.js"],"sourcesContent":["import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport { AttributeType, gl } from '@antv/l7-core';\nimport { FrequencyController } from '@antv/l7-utils';\nimport BaseModel from \"../../core/BaseModel\";\nimport { RasterImageTriangulation } from \"../../core/triangulation\";\n/* babel-plugin-inline-import '../shaders/wind_frag.glsl' */\nvar WindFrag = \"precision mediump float;\\nuniform float u_opacity: 1.0;\\nuniform sampler2D u_texture;\\nvarying vec2 v_texCoord;\\nvoid main() {\\n  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));\\n  gl_FragColor = color;\\n  gl_FragColor.a *= u_opacity;\\n}\\n\";\n/* babel-plugin-inline-import '../shaders/wind_vert.glsl' */\nvar WindVert = \"precision highp float;\\nuniform mat4 u_ModelMatrix;\\n\\nattribute vec3 a_Position;\\nattribute vec2 a_Uv;\\nvarying vec2 v_texCoord;\\n#pragma include \\\"projection\\\"\\nvoid main() {\\n   v_texCoord = a_Uv;\\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\\n\\n    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));\\n}\\n\";\nimport { Wind } from \"./windRender\";\nvar defaultRampColors = {\n  0.0: '#3288bd',\n  0.1: '#66c2a5',\n  0.2: '#abdda4',\n  0.3: '#e6f598',\n  0.4: '#fee08b',\n  0.5: '#fdae61',\n  0.6: '#f46d43',\n  1.0: '#d53e4f'\n};\nvar WindModel = /*#__PURE__*/function (_BaseModel) {\n  _inherits(WindModel, _BaseModel);\n  var _super = _createSuper(WindModel);\n  function WindModel() {\n    var _this;\n    _classCallCheck(this, WindModel);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"sizeScale\", 0.5);\n    // https://mapbox.github.io/webgl-wind/demo/\n    // source: 'http://nomads.ncep.noaa.gov',\n    _defineProperty(_assertThisInitialized(_this), \"frequency\", new FrequencyController(7.2));\n    return _this;\n  }\n  _createClass(WindModel, [{\n    key: \"render\",\n    value: function render(options) {\n      var _this2 = this;\n      this.drawColorMode(options);\n      // Tip: 控制风场的平均更新频率\n      this.frequency.run(function () {\n        _this2.drawWind();\n      });\n    }\n  }, {\n    key: \"getUninforms\",\n    value: function getUninforms() {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"initModels\",\n    value: function () {\n      var _initModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _source$data,\n          _source$data2,\n          _this3 = this;\n        var _ref, _ref$uMin, uMin, _ref$uMax, uMax, _ref$vMin, vMin, _ref$vMax, vMax, _ref$fadeOpacity, fadeOpacity, _ref$speedFactor, speedFactor, _ref$dropRate, dropRate, _ref$dropRateBump, dropRateBump, _ref$rampColors, rampColors, _ref$sizeScale, sizeScale, createTexture2D, source, glContext, model;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _ref = this.layer.getLayerConfig(), _ref$uMin = _ref.uMin, uMin = _ref$uMin === void 0 ? -21.32 : _ref$uMin, _ref$uMax = _ref.uMax, uMax = _ref$uMax === void 0 ? 26.8 : _ref$uMax, _ref$vMin = _ref.vMin, vMin = _ref$vMin === void 0 ? -21.57 : _ref$vMin, _ref$vMax = _ref.vMax, vMax = _ref$vMax === void 0 ? 21.42 : _ref$vMax, _ref$fadeOpacity = _ref.fadeOpacity, fadeOpacity = _ref$fadeOpacity === void 0 ? 0.996 : _ref$fadeOpacity, _ref$speedFactor = _ref.speedFactor, speedFactor = _ref$speedFactor === void 0 ? 0.25 : _ref$speedFactor, _ref$dropRate = _ref.dropRate, dropRate = _ref$dropRate === void 0 ? 0.003 : _ref$dropRate, _ref$dropRateBump = _ref.dropRateBump, dropRateBump = _ref$dropRateBump === void 0 ? 0.01 : _ref$dropRateBump, _ref$rampColors = _ref.rampColors, rampColors = _ref$rampColors === void 0 ? defaultRampColors : _ref$rampColors, _ref$sizeScale = _ref.sizeScale, sizeScale = _ref$sizeScale === void 0 ? 0.5 : _ref$sizeScale;\n              createTexture2D = this.rendererService.createTexture2D;\n              source = this.layer.getSource();\n              this.texture = createTexture2D({\n                height: 0,\n                width: 0\n              });\n              this.cacheZoom = Math.floor(this.mapService.getZoom());\n              glContext = this.rendererService.getGLContext();\n              this.imageCoords = (_source$data = source.data) === null || _source$data === void 0 ? void 0 : _source$data.dataArray[0].coordinates;\n              (_source$data2 = source.data) === null || _source$data2 === void 0 || (_source$data2 = _source$data2.images) === null || _source$data2 === void 0 || _source$data2.then(function (imageData) {\n                var _this3$texture;\n                _this3.sizeScale = sizeScale * _this3.getZoomScale();\n                var _this3$getWindSize = _this3.getWindSize(),\n                  imageWidth = _this3$getWindSize.imageWidth,\n                  imageHeight = _this3$getWindSize.imageHeight;\n                var options = {\n                  glContext: glContext,\n                  imageWidth: imageWidth,\n                  imageHeight: imageHeight,\n                  fadeOpacity: fadeOpacity,\n                  speedFactor: speedFactor,\n                  dropRate: dropRate,\n                  dropRateBump: dropRateBump,\n                  rampColors: rampColors\n                };\n                _this3.wind = new Wind(options);\n\n                // imageData[0] 风场图\n                _this3.wind.setWind({\n                  uMin: uMin,\n                  uMax: uMax,\n                  vMin: vMin,\n                  vMax: vMax,\n                  image: imageData[0]\n                });\n                (_this3$texture = _this3.texture) === null || _this3$texture === void 0 || _this3$texture.destroy();\n                _this3.texture = createTexture2D({\n                  width: imageWidth,\n                  height: imageHeight\n                });\n                _this3.layerService.reRender();\n              });\n              _context.next = 10;\n              return this.layer.buildLayerModel({\n                moduleName: 'wind',\n                vertexShader: WindVert,\n                fragmentShader: WindFrag,\n                triangulation: RasterImageTriangulation,\n                primitive: gl.TRIANGLES,\n                depth: {\n                  enable: false\n                }\n              });\n            case 10:\n              model = _context.sent;\n              this.colorModel = model;\n              return _context.abrupt(\"return\", [model]);\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function initModels() {\n        return _initModels.apply(this, arguments);\n      }\n      return initModels;\n    }()\n  }, {\n    key: \"getWindSize\",\n    value: function getWindSize() {\n      var p1 = this.mapService.lngLatToPixel(this.imageCoords[0]);\n      var p2 = this.mapService.lngLatToPixel(this.imageCoords[1]);\n      var imageWidth = Math.min(Math.floor((p2.x - p1.x) * this.sizeScale), 2048);\n      var imageHeight = Math.min(Math.floor((p1.y - p2.y) * this.sizeScale), 2048);\n      return {\n        imageWidth: imageWidth,\n        imageHeight: imageHeight\n      };\n    }\n  }, {\n    key: \"buildModels\",\n    value: function () {\n      var _buildModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt(\"return\", this.initModels());\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function buildModels() {\n        return _buildModels.apply(this, arguments);\n      }\n      return buildModels;\n    }()\n  }, {\n    key: \"clearModels\",\n    value: function clearModels() {\n      var _this$texture, _this$wind;\n      (_this$texture = this.texture) === null || _this$texture === void 0 || _this$texture.destroy();\n      (_this$wind = this.wind) === null || _this$wind === void 0 || _this$wind.destroy();\n    }\n  }, {\n    key: \"registerBuiltinAttributes\",\n    value: function registerBuiltinAttributes() {\n      // point layer size;\n      this.styleAttributeService.registerStyleAttribute({\n        name: 'uv',\n        type: AttributeType.Attribute,\n        descriptor: {\n          name: 'a_Uv',\n          buffer: {\n            // give the WebGL driver a hint that this buffer may change\n            usage: gl.DYNAMIC_DRAW,\n            data: [],\n            type: gl.FLOAT\n          },\n          size: 2,\n          update: function update(feature, featureIdx, vertex) {\n            return [vertex[3], vertex[4]];\n          }\n        }\n      });\n    }\n  }, {\n    key: \"getZoomScale\",\n    value: function getZoomScale() {\n      return Math.min((this.cacheZoom + 4) / 30 * 2, 2);\n    }\n  }, {\n    key: \"drawWind\",\n    value: function drawWind() {\n      if (this.wind) {\n        var _ref2 = this.layer.getLayerConfig(),\n          _ref2$uMin = _ref2.uMin,\n          uMin = _ref2$uMin === void 0 ? -21.32 : _ref2$uMin,\n          _ref2$uMax = _ref2.uMax,\n          uMax = _ref2$uMax === void 0 ? 26.8 : _ref2$uMax,\n          _ref2$vMin = _ref2.vMin,\n          vMin = _ref2$vMin === void 0 ? -21.57 : _ref2$vMin,\n          _ref2$vMax = _ref2.vMax,\n          vMax = _ref2$vMax === void 0 ? 21.42 : _ref2$vMax,\n          _ref2$numParticles = _ref2.numParticles,\n          numParticles = _ref2$numParticles === void 0 ? 65535 : _ref2$numParticles,\n          _ref2$fadeOpacity = _ref2.fadeOpacity,\n          fadeOpacity = _ref2$fadeOpacity === void 0 ? 0.996 : _ref2$fadeOpacity,\n          _ref2$speedFactor = _ref2.speedFactor,\n          speedFactor = _ref2$speedFactor === void 0 ? 0.25 : _ref2$speedFactor,\n          _ref2$dropRate = _ref2.dropRate,\n          dropRate = _ref2$dropRate === void 0 ? 0.003 : _ref2$dropRate,\n          _ref2$dropRateBump = _ref2.dropRateBump,\n          dropRateBump = _ref2$dropRateBump === void 0 ? 0.01 : _ref2$dropRateBump,\n          _ref2$rampColors = _ref2.rampColors,\n          rampColors = _ref2$rampColors === void 0 ? defaultRampColors : _ref2$rampColors,\n          _ref2$sizeScale = _ref2.sizeScale,\n          sizeScale = _ref2$sizeScale === void 0 ? 0.5 : _ref2$sizeScale;\n        var newNumParticles = numParticles;\n        var currentZoom = Math.floor(this.mapService.getZoom());\n        if (typeof sizeScale === 'number' && sizeScale !== this.sizeScale || currentZoom !== this.cacheZoom) {\n          var zoomScale = this.getZoomScale();\n          this.sizeScale = sizeScale;\n          newNumParticles *= zoomScale;\n          var _this$getWindSize = this.getWindSize(),\n            imageWidth = _this$getWindSize.imageWidth,\n            imageHeight = _this$getWindSize.imageHeight;\n          this.wind.reSize(imageWidth, imageHeight);\n          this.cacheZoom = currentZoom;\n        }\n        this.wind.updateWindDir(uMin, uMax, vMin, vMax);\n        this.wind.updateParticelNum(newNumParticles);\n        this.wind.updateColorRampTexture(rampColors);\n        this.wind.fadeOpacity = fadeOpacity;\n        this.wind.speedFactor = speedFactor;\n        this.wind.dropRate = dropRate;\n        this.wind.dropRateBump = dropRateBump;\n        var _this$wind$draw = this.wind.draw(),\n          d = _this$wind$draw.d,\n          w = _this$wind$draw.w,\n          h = _this$wind$draw.h;\n        // 恢复 L7 渲染流程中 gl 状态\n        this.rendererService.setBaseState();\n        this.texture.update({\n          data: d,\n          width: w,\n          height: h\n        });\n      }\n    }\n  }, {\n    key: \"drawColorMode\",\n    value: function drawColorMode() {\n      var _this$colorModel;\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _ref3 = this.layer.getLayerConfig(),\n        opacity = _ref3.opacity;\n      this.layerService.beforeRenderData(this.layer);\n      this.layer.hooks.beforeRender.call();\n      this.layerService.renderMask(this.layer.masks);\n      (_this$colorModel = this.colorModel) === null || _this$colorModel === void 0 || _this$colorModel.draw({\n        uniforms: {\n          u_opacity: opacity || 1.0,\n          u_texture: this.texture\n        },\n        blend: this.getBlend(),\n        stencil: this.getStencil(options)\n      });\n      this.layer.hooks.afterRender.call();\n    }\n  }]);\n  return WindModel;\n}(BaseModel);\nexport { WindModel as default };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
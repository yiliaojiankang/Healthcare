{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { __extends } from \"tslib\";\nimport { each, isDate, isNil, isNumber, isString } from '@antv/util';\nimport { timeFormat, toTimeStamp } from '../util/time';\nimport Linear from './linear';\n/**\n * 时间度量\n * @class\n */\nvar Time = /** @class */function (_super) {\n  __extends(Time, _super);\n  function Time() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.type = 'time';\n    return _this;\n  }\n  /**\n   * @override\n   */\n  Time.prototype.getText = function (value, index) {\n    var numberValue = this.translate(value);\n    var formatter = this.formatter;\n    return formatter ? formatter(numberValue, index) : timeFormat(numberValue, this.mask);\n  };\n  /**\n   * @override\n   */\n  Time.prototype.scale = function (value) {\n    var v = value;\n    if (isString(v) || isDate(v)) {\n      v = this.translate(v);\n    }\n    return _super.prototype.scale.call(this, v);\n  };\n  /**\n   * 将时间转换成数字\n   * @override\n   */\n  Time.prototype.translate = function (v) {\n    return toTimeStamp(v);\n  };\n  Time.prototype.initCfg = function () {\n    this.tickMethod = 'time-pretty';\n    this.mask = 'YYYY-MM-DD';\n    this.tickCount = 7;\n    this.nice = false;\n  };\n  Time.prototype.setDomain = function () {\n    var values = this.values;\n    // 是否设置了 min, max，而不是直接取 this.min, this.max\n    var minConfig = this.getConfig('min');\n    var maxConfig = this.getConfig('max');\n    // 如果设置了 min,max 则转换成时间戳\n    if (!isNil(minConfig) || !isNumber(minConfig)) {\n      this.min = this.translate(this.min);\n    }\n    if (!isNil(maxConfig) || !isNumber(maxConfig)) {\n      this.max = this.translate(this.max);\n    }\n    // 没有设置 min, max 时\n    if (values && values.length) {\n      // 重新计算最大最小值\n      var timeStamps_1 = [];\n      var min_1 = Infinity; // 最小值\n      var secondMin_1 = min_1; // 次小值\n      var max_1 = 0;\n      // 使用一个循环，计算min,max,secondMin\n      each(values, function (v) {\n        var timeStamp = toTimeStamp(v);\n        if (isNaN(timeStamp)) {\n          throw new TypeError(\"Invalid Time: \" + v + \" in time scale!\");\n        }\n        if (min_1 > timeStamp) {\n          secondMin_1 = min_1;\n          min_1 = timeStamp;\n        } else if (secondMin_1 > timeStamp) {\n          secondMin_1 = timeStamp;\n        }\n        if (max_1 < timeStamp) {\n          max_1 = timeStamp;\n        }\n        timeStamps_1.push(timeStamp);\n      });\n      // 存在多个值时，设置最小间距\n      if (values.length > 1) {\n        this.minTickInterval = secondMin_1 - min_1;\n      }\n      if (isNil(minConfig)) {\n        this.min = min_1;\n      }\n      if (isNil(maxConfig)) {\n        this.max = max_1;\n      }\n    }\n  };\n  return Time;\n}(Linear);\nexport default Time;","map":{"version":3,"names":["each","isDate","isNil","isNumber","isString","timeFormat","toTimeStamp","Linear","Time","_super","__extends","_this","apply","arguments","type","prototype","getText","value","index","numberValue","translate","formatter","mask","scale","v","call","initCfg","tickMethod","tickCount","nice","setDomain","values","minConfig","getConfig","maxConfig","min","max","length","timeStamps_1","min_1","Infinity","secondMin_1","max_1","timeStamp","isNaN","TypeError","push","minTickInterval"],"sources":["../../src/continuous/time.ts"],"sourcesContent":[null],"mappings":";;AAAA,SAASA,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,QAAQ,QAAQ,YAAY;AACpE,SAASC,UAAU,EAAEC,WAAW,QAAQ,cAAc;AACtD,OAAOC,MAAM,MAAM,UAAU;AAE7B;;;;AAIA,IAAAC,IAAA,0BAAAC,MAAA;EAAmBC,SAAA,CAAAF,IAAA,EAAAC,MAAA;EAAnB,SAAAD,KAAA;IAAA,IAAAG,KAAA,GAAAF,MAAA,aAAAA,MAAA,CAAAG,KAAA,OAAAC,SAAA;IACkBF,KAAA,CAAAG,IAAI,GAAW,MAAM;;EAmFvC;EAhFE;;;EAGON,IAAA,CAAAO,SAAA,CAAAC,OAAO,GAAd,UAAeC,KAA6B,EAAEC,KAAc;IAC1D,IAAMC,WAAW,GAAG,IAAI,CAACC,SAAS,CAACH,KAAK,CAAC;IACzC,IAAMI,SAAS,GAAG,IAAI,CAACA,SAAS;IAChC,OAAOA,SAAS,GAAGA,SAAS,CAACF,WAAW,EAAED,KAAK,CAAC,GAAGb,UAAU,CAACc,WAAW,EAAE,IAAI,CAACG,IAAI,CAAC;EACvF,CAAC;EACD;;;EAGOd,IAAA,CAAAO,SAAA,CAAAQ,KAAK,GAAZ,UAAaN,KAAK;IAChB,IAAIO,CAAC,GAAGP,KAAK;IACb,IAAIb,QAAQ,CAACoB,CAAC,CAAC,IAAIvB,MAAM,CAACuB,CAAC,CAAC,EAAE;MAC5BA,CAAC,GAAG,IAAI,CAACJ,SAAS,CAACI,CAAC,CAAC;;IAEvB,OAAOf,MAAA,CAAAM,SAAA,CAAMQ,KAAK,CAAAE,IAAA,OAACD,CAAC,CAAC;EACvB,CAAC;EACD;;;;EAIOhB,IAAA,CAAAO,SAAA,CAAAK,SAAS,GAAhB,UAAiBI,CAAC;IAChB,OAAOlB,WAAW,CAACkB,CAAC,CAAC;EACvB,CAAC;EACShB,IAAA,CAAAO,SAAA,CAAAW,OAAO,GAAjB;IACE,IAAI,CAACC,UAAU,GAAG,aAAa;IAC/B,IAAI,CAACL,IAAI,GAAG,YAAY;IACxB,IAAI,CAACM,SAAS,GAAG,CAAC;IAClB,IAAI,CAACC,IAAI,GAAG,KAAK;EACnB,CAAC;EAESrB,IAAA,CAAAO,SAAA,CAAAe,SAAS,GAAnB;IACE,IAAMC,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B;IACA,IAAMC,SAAS,GAAG,IAAI,CAACC,SAAS,CAAC,KAAK,CAAC;IACvC,IAAMC,SAAS,GAAG,IAAI,CAACD,SAAS,CAAC,KAAK,CAAC;IACvC;IACA,IAAI,CAAC/B,KAAK,CAAC8B,SAAS,CAAC,IAAI,CAAC7B,QAAQ,CAAC6B,SAAS,CAAC,EAAE;MAC7C,IAAI,CAACG,GAAG,GAAG,IAAI,CAACf,SAAS,CAAC,IAAI,CAACe,GAAG,CAAC;;IAErC,IAAI,CAACjC,KAAK,CAACgC,SAAS,CAAC,IAAI,CAAC/B,QAAQ,CAAC+B,SAAS,CAAC,EAAE;MAC7C,IAAI,CAACE,GAAG,GAAG,IAAI,CAAChB,SAAS,CAAC,IAAI,CAACgB,GAAG,CAAC;;IAErC;IACA,IAAIL,MAAM,IAAIA,MAAM,CAACM,MAAM,EAAE;MAC3B;MACA,IAAMC,YAAU,GAAG,EAAE;MACrB,IAAIC,KAAG,GAAGC,QAAQ,CAAC,CAAC;MACpB,IAAIC,WAAS,GAAGF,KAAG,CAAC,CAAC;MACrB,IAAIG,KAAG,GAAG,CAAC;MACX;MACA1C,IAAI,CAAC+B,MAAM,EAAE,UAACP,CAAC;QACb,IAAMmB,SAAS,GAAGrC,WAAW,CAACkB,CAAC,CAAC;QAChC,IAAIoB,KAAK,CAACD,SAAS,CAAC,EAAE;UACpB,MAAM,IAAIE,SAAS,CAAC,mBAAiBrB,CAAC,oBAAiB,CAAC;;QAE1D,IAAIe,KAAG,GAAGI,SAAS,EAAE;UACnBF,WAAS,GAAGF,KAAG;UACfA,KAAG,GAAGI,SAAS;SAChB,MAAM,IAAIF,WAAS,GAAGE,SAAS,EAAE;UAChCF,WAAS,GAAGE,SAAS;;QAEvB,IAAID,KAAG,GAAGC,SAAS,EAAE;UACnBD,KAAG,GAAGC,SAAS;;QAEjBL,YAAU,CAACQ,IAAI,CAACH,SAAS,CAAC;MAC5B,CAAC,CAAC;MACF;MACA,IAAIZ,MAAM,CAACM,MAAM,GAAG,CAAC,EAAE;QACrB,IAAI,CAACU,eAAe,GAAGN,WAAS,GAAGF,KAAG;;MAExC,IAAIrC,KAAK,CAAC8B,SAAS,CAAC,EAAE;QACpB,IAAI,CAACG,GAAG,GAAGI,KAAG;;MAEhB,IAAIrC,KAAK,CAACgC,SAAS,CAAC,EAAE;QACpB,IAAI,CAACE,GAAG,GAAGM,KAAG;;;EAGpB,CAAC;EACH,OAAAlC,IAAC;AAAD,CAAC,CApFkBD,MAAM;AAqFzB,eAAeC,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}
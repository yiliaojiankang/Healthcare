{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n// import { bindCancel } from './request';\n\nimport { formatImage } from '@antv/l7-utils';\nimport { processRasterData } from \"../bandOperation/bands\";\nexport var getCustomData = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(tile, getCustomDataFunc, rasterFormat, operation) {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n            getCustomDataFunc({\n              x: tile.x,\n              y: tile.y,\n              z: tile.z\n            }, function (err, data) {\n              if (err || data.length === 0) {\n                reject(err);\n                return;\n              }\n              if (data) {\n                processRasterData([{\n                  data: data,\n                  bands: [0]\n                }], rasterFormat, operation, function (error, img) {\n                  if (error) {\n                    reject(error);\n                  } else if (img) {\n                    resolve(img);\n                  }\n                });\n              }\n            });\n          }));\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function getCustomData(_x, _x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getCustomImageData = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(tile, getCustomDataFunc) {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n            getCustomDataFunc({\n              x: tile.x,\n              y: tile.y,\n              z: tile.z\n            }, function (err, data) {\n              if (err || !data) {\n                reject(err);\n                return;\n              }\n              if (data instanceof ArrayBuffer) {\n                formatImage(data, function (error, image) {\n                  if (error) {\n                    reject(error);\n                  }\n                  resolve(image);\n                });\n              } else if (data instanceof HTMLImageElement) {\n                resolve(data);\n              } else {\n                reject(err);\n              }\n            });\n          }));\n        case 1:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return function getCustomImageData(_x5, _x6) {\n    return _ref2.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["_asyncToGenerator","_regeneratorRuntime","formatImage","processRasterData","getCustomData","_ref","mark","_callee","tile","getCustomDataFunc","rasterFormat","operation","wrap","_callee$","_context","prev","next","abrupt","Promise","resolve","reject","x","y","z","err","data","length","bands","error","img","stop","_x","_x2","_x3","_x4","apply","arguments","getCustomImageData","_ref2","_callee2","_callee2$","_context2","ArrayBuffer","image","HTMLImageElement","_x5","_x6"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-source/es/utils/tile/getCustomData.js"],"sourcesContent":["import _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n// import { bindCancel } from './request';\n\nimport { formatImage } from '@antv/l7-utils';\nimport { processRasterData } from \"../bandOperation/bands\";\nexport var getCustomData = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(tile, getCustomDataFunc, rasterFormat, operation) {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n            getCustomDataFunc({\n              x: tile.x,\n              y: tile.y,\n              z: tile.z\n            }, function (err, data) {\n              if (err || data.length === 0) {\n                reject(err);\n                return;\n              }\n              if (data) {\n                processRasterData([{\n                  data: data,\n                  bands: [0]\n                }], rasterFormat, operation, function (error, img) {\n                  if (error) {\n                    reject(error);\n                  } else if (img) {\n                    resolve(img);\n                  }\n                });\n              }\n            });\n          }));\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function getCustomData(_x, _x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getCustomImageData = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(tile, getCustomDataFunc) {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n            getCustomDataFunc({\n              x: tile.x,\n              y: tile.y,\n              z: tile.z\n            }, function (err, data) {\n              if (err || !data) {\n                reject(err);\n                return;\n              }\n              if (data instanceof ArrayBuffer) {\n                formatImage(data, function (error, image) {\n                  if (error) {\n                    reject(error);\n                  }\n                  resolve(image);\n                });\n              } else if (data instanceof HTMLImageElement) {\n                resolve(data);\n              } else {\n                reject(err);\n              }\n            });\n          }));\n        case 1:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return function getCustomImageData(_x5, _x6) {\n    return _ref2.apply(this, arguments);\n  };\n}();"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
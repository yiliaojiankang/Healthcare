{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { __extends } from \"tslib\";\nimport Element from './element';\nimport { isFunction, isObject, each, removeFromArray, upperFirst, isAllowCapture } from '../util/util';\nvar SHAPE_MAP = {};\nvar INDEX = '_INDEX';\n/**\n * 设置 canvas\n * @param {IElement} element 元素\n * @param {ICanvas}  canvas  画布\n */\nfunction setCanvas(element, canvas) {\n  element.set('canvas', canvas);\n  if (element.isGroup()) {\n    var children = element.get('children');\n    if (children.length) {\n      children.forEach(function (child) {\n        setCanvas(child, canvas);\n      });\n    }\n  }\n}\n/**\n * 设置 timeline\n * @param {IElement} element  元素\n * @param {Timeline} timeline 时间轴\n */\nfunction setTimeline(element, timeline) {\n  element.set('timeline', timeline);\n  if (element.isGroup()) {\n    var children = element.get('children');\n    if (children.length) {\n      children.forEach(function (child) {\n        setTimeline(child, timeline);\n      });\n    }\n  }\n}\nfunction contains(container, element) {\n  var children = container.getChildren();\n  return children.indexOf(element) >= 0;\n}\nfunction removeChild(container, element, destroy) {\n  if (destroy === void 0) {\n    destroy = true;\n  }\n  // 不再调用 element.remove() 方法，会出现循环调用\n  if (destroy) {\n    element.destroy();\n  } else {\n    element.set('parent', null);\n    element.set('canvas', null);\n  }\n  removeFromArray(container.getChildren(), element);\n}\nfunction getComparer(compare) {\n  return function (left, right) {\n    var result = compare(left, right);\n    return result === 0 ? left[INDEX] - right[INDEX] : result;\n  };\n}\nvar Container = /** @class */function (_super) {\n  __extends(Container, _super);\n  function Container() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  Container.prototype.isCanvas = function () {\n    return false;\n  };\n  // 根据子节点确定 BBox\n  Container.prototype.getBBox = function () {\n    // 所有的值可能在画布的可视区外\n    var minX = Infinity;\n    var maxX = -Infinity;\n    var minY = Infinity;\n    var maxY = -Infinity;\n    // 将可见元素、图形以及不为空的图形分组筛选出来，用于包围盒合并\n    var children = this.getChildren().filter(function (child) {\n      return child.get('visible') && (!child.isGroup() || child.isGroup() && child.getChildren().length > 0);\n    });\n    if (children.length > 0) {\n      each(children, function (child) {\n        var _a = child.getBBox(),\n          childMinX = _a.minX,\n          childMaxX = _a.maxX,\n          childMinY = _a.minY,\n          childMaxY = _a.maxY;\n        if (childMinX < minX) {\n          minX = childMinX;\n        }\n        if (childMaxX > maxX) {\n          maxX = childMaxX;\n        }\n        if (childMinY < minY) {\n          minY = childMinY;\n        }\n        if (childMaxY > maxY) {\n          maxY = childMaxY;\n        }\n      });\n    } else {\n      minX = 0;\n      maxX = 0;\n      minY = 0;\n      maxY = 0;\n    }\n    var box = {\n      x: minX,\n      y: minY,\n      minX: minX,\n      minY: minY,\n      maxX: maxX,\n      maxY: maxY,\n      width: maxX - minX,\n      height: maxY - minY\n    };\n    return box;\n  };\n  // 获取画布的包围盒\n  Container.prototype.getCanvasBBox = function () {\n    var minX = Infinity;\n    var maxX = -Infinity;\n    var minY = Infinity;\n    var maxY = -Infinity;\n    // 将可见元素、图形以及不为空的图形分组筛选出来，用于包围盒合并\n    var children = this.getChildren().filter(function (child) {\n      return child.get('visible') && (!child.isGroup() || child.isGroup() && child.getChildren().length > 0);\n    });\n    if (children.length > 0) {\n      each(children, function (child) {\n        var _a = child.getCanvasBBox(),\n          childMinX = _a.minX,\n          childMaxX = _a.maxX,\n          childMinY = _a.minY,\n          childMaxY = _a.maxY;\n        if (childMinX < minX) {\n          minX = childMinX;\n        }\n        if (childMaxX > maxX) {\n          maxX = childMaxX;\n        }\n        if (childMinY < minY) {\n          minY = childMinY;\n        }\n        if (childMaxY > maxY) {\n          maxY = childMaxY;\n        }\n      });\n    } else {\n      minX = 0;\n      maxX = 0;\n      minY = 0;\n      maxY = 0;\n    }\n    var box = {\n      x: minX,\n      y: minY,\n      minX: minX,\n      minY: minY,\n      maxX: maxX,\n      maxY: maxY,\n      width: maxX - minX,\n      height: maxY - minY\n    };\n    return box;\n  };\n  Container.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n    cfg['children'] = [];\n    return cfg;\n  };\n  Container.prototype.onAttrChange = function (name, value, originValue) {\n    _super.prototype.onAttrChange.call(this, name, value, originValue);\n    if (name === 'matrix') {\n      var totalMatrix = this.getTotalMatrix();\n      this._applyChildrenMarix(totalMatrix);\n    }\n  };\n  // 不但应用到自己身上还要应用于子元素\n  Container.prototype.applyMatrix = function (matrix) {\n    var preTotalMatrix = this.getTotalMatrix();\n    _super.prototype.applyMatrix.call(this, matrix);\n    var totalMatrix = this.getTotalMatrix();\n    // totalMatrix 没有发生变化时，这里仅考虑两者都为 null 时\n    // 不继续向下传递矩阵\n    if (totalMatrix === preTotalMatrix) {\n      return;\n    }\n    this._applyChildrenMarix(totalMatrix);\n  };\n  // 在子元素上设置矩阵\n  Container.prototype._applyChildrenMarix = function (totalMatrix) {\n    var children = this.getChildren();\n    each(children, function (child) {\n      child.applyMatrix(totalMatrix);\n    });\n  };\n  // 兼容老版本的接口\n  Container.prototype.addShape = function () {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    var type = args[0];\n    var cfg = args[1];\n    if (isObject(type)) {\n      cfg = type;\n    } else {\n      cfg['type'] = type;\n    }\n    var shapeType = SHAPE_MAP[cfg.type];\n    if (!shapeType) {\n      shapeType = upperFirst(cfg.type);\n      SHAPE_MAP[cfg.type] = shapeType;\n    }\n    var ShapeBase = this.getShapeBase();\n    var shape = new ShapeBase[shapeType](cfg);\n    this.add(shape);\n    return shape;\n  };\n  Container.prototype.addGroup = function () {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    var groupClass = args[0],\n      cfg = args[1];\n    var group;\n    if (isFunction(groupClass)) {\n      if (cfg) {\n        group = new groupClass(cfg);\n      } else {\n        group = new groupClass({\n          // canvas,\n          parent: this\n        });\n      }\n    } else {\n      var tmpCfg = groupClass || {};\n      var TmpGroupClass = this.getGroupBase();\n      group = new TmpGroupClass(tmpCfg);\n    }\n    this.add(group);\n    return group;\n  };\n  Container.prototype.getCanvas = function () {\n    var canvas;\n    if (this.isCanvas()) {\n      canvas = this;\n    } else {\n      canvas = this.get('canvas');\n    }\n    return canvas;\n  };\n  Container.prototype.getShape = function (x, y, ev) {\n    // 如果不支持拾取，则直接返回\n    if (!isAllowCapture(this)) {\n      return null;\n    }\n    var children = this.getChildren();\n    var shape;\n    // 如果容器是 group\n    if (!this.isCanvas()) {\n      var v = [x, y, 1];\n      // 将 x, y 转换成对应于 group 的局部坐标\n      v = this.invertFromMatrix(v);\n      if (!this.isClipped(v[0], v[1])) {\n        shape = this._findShape(children, v[0], v[1], ev);\n      }\n    } else {\n      shape = this._findShape(children, x, y, ev);\n    }\n    return shape;\n  };\n  Container.prototype._findShape = function (children, x, y, ev) {\n    var shape = null;\n    for (var i = children.length - 1; i >= 0; i--) {\n      var child = children[i];\n      if (isAllowCapture(child)) {\n        if (child.isGroup()) {\n          shape = child.getShape(x, y, ev);\n        } else if (child.isHit(x, y)) {\n          shape = child;\n        }\n      }\n      if (shape) {\n        break;\n      }\n    }\n    return shape;\n  };\n  Container.prototype.add = function (element) {\n    var canvas = this.getCanvas();\n    var children = this.getChildren();\n    var timeline = this.get('timeline');\n    var preParent = element.getParent();\n    if (preParent) {\n      removeChild(preParent, element, false);\n    }\n    element.set('parent', this);\n    if (canvas) {\n      setCanvas(element, canvas);\n    }\n    if (timeline) {\n      setTimeline(element, timeline);\n    }\n    children.push(element);\n    element.onCanvasChange('add');\n    this._applyElementMatrix(element);\n  };\n  // 将当前容器的矩阵应用到子元素\n  Container.prototype._applyElementMatrix = function (element) {\n    var totalMatrix = this.getTotalMatrix();\n    // 添加图形或者分组时，需要把当前图元的矩阵设置进去\n    if (totalMatrix) {\n      element.applyMatrix(totalMatrix);\n    }\n  };\n  Container.prototype.getChildren = function () {\n    return this.get('children');\n  };\n  Container.prototype.sort = function () {\n    var children = this.getChildren();\n    // 稳定排序\n    each(children, function (child, index) {\n      child[INDEX] = index;\n      return child;\n    });\n    children.sort(getComparer(function (obj1, obj2) {\n      return obj1.get('zIndex') - obj2.get('zIndex');\n    }));\n    this.onCanvasChange('sort');\n  };\n  Container.prototype.clear = function () {\n    this.set('clearing', true);\n    if (this.destroyed) {\n      return;\n    }\n    var children = this.getChildren();\n    for (var i = children.length - 1; i >= 0; i--) {\n      children[i].destroy(); // 销毁子元素\n    }\n\n    this.set('children', []);\n    this.onCanvasChange('clear');\n    this.set('clearing', false);\n  };\n  Container.prototype.destroy = function () {\n    if (this.get('destroyed')) {\n      return;\n    }\n    this.clear();\n    _super.prototype.destroy.call(this);\n  };\n  /**\n   * 获取第一个子元素\n   * @return {IElement} 第一个元素\n   */\n  Container.prototype.getFirst = function () {\n    return this.getChildByIndex(0);\n  };\n  /**\n   * 获取最后一个子元素\n   * @return {IElement} 元素\n   */\n  Container.prototype.getLast = function () {\n    var children = this.getChildren();\n    return this.getChildByIndex(children.length - 1);\n  };\n  /**\n   * 根据索引获取子元素\n   * @return {IElement} 第一个元素\n   */\n  Container.prototype.getChildByIndex = function (index) {\n    var children = this.getChildren();\n    return children[index];\n  };\n  /**\n   * 子元素的数量\n   * @return {number} 子元素数量\n   */\n  Container.prototype.getCount = function () {\n    var children = this.getChildren();\n    return children.length;\n  };\n  /**\n   * 是否包含对应元素\n   * @param {IElement} element 元素\n   * @return {boolean}\n   */\n  Container.prototype.contain = function (element) {\n    var children = this.getChildren();\n    return children.indexOf(element) > -1;\n  };\n  /**\n   * 移除对应子元素\n   * @param {IElement} element 子元素\n   * @param {boolean} destroy 是否销毁子元素，默认为 true\n   */\n  Container.prototype.removeChild = function (element, destroy) {\n    if (destroy === void 0) {\n      destroy = true;\n    }\n    if (this.contain(element)) {\n      element.remove(destroy);\n    }\n  };\n  /**\n   * 查找所有匹配的元素\n   * @param  {ElementFilterFn}   fn  匹配函数\n   * @return {IElement[]} 元素数组\n   */\n  Container.prototype.findAll = function (fn) {\n    var rst = [];\n    var children = this.getChildren();\n    each(children, function (element) {\n      if (fn(element)) {\n        rst.push(element);\n      }\n      if (element.isGroup()) {\n        rst = rst.concat(element.findAll(fn));\n      }\n    });\n    return rst;\n  };\n  /**\n   * 查找元素，找到第一个返回\n   * @param  {ElementFilterFn} fn    匹配函数\n   * @return {IElement|null} 元素，可以为空\n   */\n  Container.prototype.find = function (fn) {\n    var rst = null;\n    var children = this.getChildren();\n    each(children, function (element) {\n      if (fn(element)) {\n        rst = element;\n      } else if (element.isGroup()) {\n        rst = element.find(fn);\n      }\n      if (rst) {\n        return false;\n      }\n    });\n    return rst;\n  };\n  /**\n   * 根据 ID 查找元素\n   * @param {string} id 元素 id\n   * @return {IElement|null} 元素\n   */\n  Container.prototype.findById = function (id) {\n    return this.find(function (element) {\n      return element.get('id') === id;\n    });\n  };\n  /**\n   * 该方法即将废弃，不建议使用\n   * 根据 className 查找元素\n   * TODO: 该方式定义暂时只给 G6 3.3 以后的版本使用，待 G6 中的 findByClassName 方法移除后，G 也需要同步移除\n   * @param {string} className 元素 className\n   * @return {IElement | null} 元素\n   */\n  Container.prototype.findByClassName = function (className) {\n    return this.find(function (element) {\n      return element.get('className') === className;\n    });\n  };\n  /**\n   * 根据 name 查找元素列表\n   * @param {string}      name 元素名称\n   * @return {IElement[]} 元素\n   */\n  Container.prototype.findAllByName = function (name) {\n    return this.findAll(function (element) {\n      return element.get('name') === name;\n    });\n  };\n  return Container;\n}(Element);\nexport default Container;","map":{"version":3,"names":["Element","isFunction","isObject","each","removeFromArray","upperFirst","isAllowCapture","SHAPE_MAP","INDEX","setCanvas","element","canvas","set","isGroup","children","get","length","forEach","child","setTimeline","timeline","contains","container","getChildren","indexOf","removeChild","destroy","getComparer","compare","left","right","result","Container","_super","__extends","prototype","isCanvas","getBBox","minX","Infinity","maxX","minY","maxY","filter","_a","childMinX","childMaxX","childMinY","childMaxY","box","x","y","width","height","getCanvasBBox","getDefaultCfg","cfg","call","onAttrChange","name","value","originValue","totalMatrix","getTotalMatrix","_applyChildrenMarix","applyMatrix","matrix","preTotalMatrix","addShape","args","_i","arguments","type","shapeType","ShapeBase","getShapeBase","shape","add","addGroup","groupClass","group","parent","tmpCfg","TmpGroupClass","getGroupBase","getCanvas","getShape","ev","v","invertFromMatrix","isClipped","_findShape","i","isHit","preParent","getParent","push","onCanvasChange","_applyElementMatrix","sort","index","obj1","obj2","clear","destroyed","getFirst","getChildByIndex","getLast","getCount","contain","remove","findAll","fn","rst","concat","find","findById","id","findByClassName","className","findAllByName"],"sources":["../../src/abstract/container.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
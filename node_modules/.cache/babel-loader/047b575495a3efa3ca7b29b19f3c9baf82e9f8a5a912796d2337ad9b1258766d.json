{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { encodePickingColor } from \"../color\";\nimport { a_Color, a_filter, a_Position, a_vertexId } from \"./commonFeatureFunc\";\nimport { polygonFillTriangulation as triangulation } from \"./triangulation\";\nexport var polygonFillModel = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n    var descriptors, features, enablePicking, updateFuncs, featureLayout, verticesNum, indices, size;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          descriptors = _ref.descriptors, features = _ref.features, enablePicking = _ref.enablePicking;\n          updateFuncs = {\n            // fixed feature func\n            a_Color: a_Color,\n            a_Position: a_Position,\n            filter: a_filter,\n            a_vertexId: a_vertexId,\n            a_PickingColor: function a_PickingColor(feature) {\n              var id = feature.id;\n              return enablePicking ? encodePickingColor(id) : [0, 0, 0];\n            }\n\n            // polygonFill feature func\n            // empty\n          };\n\n          featureLayout = {\n            sizePerElement: 0,\n            elements: []\n          };\n          verticesNum = 0;\n          indices = [];\n          size = 3;\n          features.forEach(function (feature, featureIdx) {\n            var _triangulation = triangulation(feature),\n              indicesForCurrentFeature = _triangulation.indices,\n              verticesForCurrentFeature = _triangulation.vertices,\n              normalsForCurrentFeature = _triangulation.normals,\n              vertexSize = _triangulation.size,\n              indexes = _triangulation.indexes;\n            indicesForCurrentFeature.forEach(function (i) {\n              indices.push(i + verticesNum);\n            });\n            size = vertexSize;\n            var verticesNumForCurrentFeature = verticesForCurrentFeature.length / vertexSize;\n            featureLayout.sizePerElement = size;\n            featureLayout.elements.push({\n              featureIdx: featureIdx,\n              vertices: verticesForCurrentFeature,\n              normals: normalsForCurrentFeature,\n              offset: verticesNum\n            });\n            verticesNum += verticesNumForCurrentFeature;\n            var _loop = function _loop(vertexIdx) {\n              var normal = (normalsForCurrentFeature === null || normalsForCurrentFeature === void 0 ? void 0 : normalsForCurrentFeature.slice(vertexIdx * 3, vertexIdx * 3 + 3)) || [];\n              var vertice = verticesForCurrentFeature.slice(vertexIdx * vertexSize, vertexIdx * vertexSize + vertexSize);\n              var vertexIndex = 0;\n              if (indexes && indexes[vertexIdx] !== undefined) {\n                vertexIndex = indexes[vertexIdx];\n              }\n              descriptors.forEach(function (descriptor) {\n                // @ts-ignore\n                if (descriptor && updateFuncs[descriptor.name]) {\n                  var _descriptor$buffer$da;\n                  // @ts-ignore\n                  (_descriptor$buffer$da = descriptor.buffer.data).push.apply(_descriptor$buffer$da, _toConsumableArray(updateFuncs[descriptor.name](feature, featureIdx, vertice, vertexIdx, normal, vertexIndex)));\n                }\n              });\n            };\n            for (var vertexIdx = 0; vertexIdx < verticesNumForCurrentFeature; vertexIdx++) {\n              _loop(vertexIdx);\n            }\n          });\n          return _context.abrupt(\"return\", {\n            descriptors: descriptors,\n            featureLayout: featureLayout,\n            indices: indices\n          });\n        case 8:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function polygonFillModel(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["_toConsumableArray","_asyncToGenerator","_regeneratorRuntime","encodePickingColor","a_Color","a_filter","a_Position","a_vertexId","polygonFillTriangulation","triangulation","polygonFillModel","_ref2","mark","_callee","_ref","descriptors","features","enablePicking","updateFuncs","featureLayout","verticesNum","indices","size","wrap","_callee$","_context","prev","next","filter","a_PickingColor","feature","id","sizePerElement","elements","forEach","featureIdx","_triangulation","indicesForCurrentFeature","verticesForCurrentFeature","vertices","normalsForCurrentFeature","normals","vertexSize","indexes","i","push","verticesNumForCurrentFeature","length","offset","_loop","vertexIdx","normal","slice","vertice","vertexIndex","undefined","descriptor","name","_descriptor$buffer$da","buffer","data","apply","abrupt","stop","_x","arguments"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-utils/es/workers/polygonFillModel.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { encodePickingColor } from \"../color\";\nimport { a_Color, a_filter, a_Position, a_vertexId } from \"./commonFeatureFunc\";\nimport { polygonFillTriangulation as triangulation } from \"./triangulation\";\nexport var polygonFillModel = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n    var descriptors, features, enablePicking, updateFuncs, featureLayout, verticesNum, indices, size;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          descriptors = _ref.descriptors, features = _ref.features, enablePicking = _ref.enablePicking;\n          updateFuncs = {\n            // fixed feature func\n            a_Color: a_Color,\n            a_Position: a_Position,\n            filter: a_filter,\n            a_vertexId: a_vertexId,\n            a_PickingColor: function a_PickingColor(feature) {\n              var id = feature.id;\n              return enablePicking ? encodePickingColor(id) : [0, 0, 0];\n            }\n\n            // polygonFill feature func\n            // empty\n          };\n          featureLayout = {\n            sizePerElement: 0,\n            elements: []\n          };\n          verticesNum = 0;\n          indices = [];\n          size = 3;\n          features.forEach(function (feature, featureIdx) {\n            var _triangulation = triangulation(feature),\n              indicesForCurrentFeature = _triangulation.indices,\n              verticesForCurrentFeature = _triangulation.vertices,\n              normalsForCurrentFeature = _triangulation.normals,\n              vertexSize = _triangulation.size,\n              indexes = _triangulation.indexes;\n            indicesForCurrentFeature.forEach(function (i) {\n              indices.push(i + verticesNum);\n            });\n            size = vertexSize;\n            var verticesNumForCurrentFeature = verticesForCurrentFeature.length / vertexSize;\n            featureLayout.sizePerElement = size;\n            featureLayout.elements.push({\n              featureIdx: featureIdx,\n              vertices: verticesForCurrentFeature,\n              normals: normalsForCurrentFeature,\n              offset: verticesNum\n            });\n            verticesNum += verticesNumForCurrentFeature;\n            var _loop = function _loop(vertexIdx) {\n              var normal = (normalsForCurrentFeature === null || normalsForCurrentFeature === void 0 ? void 0 : normalsForCurrentFeature.slice(vertexIdx * 3, vertexIdx * 3 + 3)) || [];\n              var vertice = verticesForCurrentFeature.slice(vertexIdx * vertexSize, vertexIdx * vertexSize + vertexSize);\n              var vertexIndex = 0;\n              if (indexes && indexes[vertexIdx] !== undefined) {\n                vertexIndex = indexes[vertexIdx];\n              }\n              descriptors.forEach(function (descriptor) {\n                // @ts-ignore\n                if (descriptor && updateFuncs[descriptor.name]) {\n                  var _descriptor$buffer$da;\n                  // @ts-ignore\n                  (_descriptor$buffer$da = descriptor.buffer.data).push.apply(_descriptor$buffer$da, _toConsumableArray(updateFuncs[descriptor.name](feature, featureIdx, vertice, vertexIdx, normal, vertexIndex)));\n                }\n              });\n            };\n            for (var vertexIdx = 0; vertexIdx < verticesNumForCurrentFeature; vertexIdx++) {\n              _loop(vertexIdx);\n            }\n          });\n          return _context.abrupt(\"return\", {\n            descriptors: descriptors,\n            featureLayout: featureLayout,\n            indices: indices\n          });\n        case 8:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function polygonFillModel(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
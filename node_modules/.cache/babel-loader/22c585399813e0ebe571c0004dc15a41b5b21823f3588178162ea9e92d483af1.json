{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _dec, _class;\nimport { injectable } from 'inversify';\nimport 'reflect-metadata';\nimport { TYPES } from \"../../types\";\nvar PopupService = (_dec = injectable(), _dec(_class = /*#__PURE__*/function () {\n  function PopupService() {\n    _classCallCheck(this, PopupService);\n    _defineProperty(this, \"scene\", void 0);\n    _defineProperty(this, \"mapsService\", void 0);\n    _defineProperty(this, \"popups\", []);\n    _defineProperty(this, \"unAddPopups\", []);\n  }\n  _createClass(PopupService, [{\n    key: \"isMarkerReady\",\n    get: function get() {\n      return this.mapsService.map && this.mapsService.getMarkerContainer();\n    }\n  }, {\n    key: \"removePopup\",\n    value: function removePopup(popup) {\n      if (popup !== null && popup !== void 0 && popup.isOpen()) {\n        popup.remove();\n      }\n      var targetIndex = this.popups.indexOf(popup);\n      if (targetIndex > -1) {\n        this.popups.splice(targetIndex, 1);\n      }\n      var targetUnAddIndex = this.unAddPopups.indexOf(popup);\n      if (targetUnAddIndex > -1) {\n        this.unAddPopups.splice(targetUnAddIndex, 1);\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.popups.forEach(function (popup) {\n        return popup.remove();\n      });\n    }\n  }, {\n    key: \"addPopup\",\n    value: function addPopup(popup) {\n      var _this = this;\n      if (popup && popup.getOptions().autoClose) {\n        [].concat(_toConsumableArray(this.popups), _toConsumableArray(this.unAddPopups)).forEach(function (otherPopup) {\n          if (otherPopup.getOptions().autoClose) {\n            _this.removePopup(otherPopup);\n          }\n        });\n      }\n      if (this.isMarkerReady) {\n        popup.addTo(this.scene);\n        this.popups.push(popup);\n      } else {\n        this.unAddPopups.push(popup);\n      }\n      popup.on('close', function () {\n        _this.removePopup(popup);\n      });\n    }\n  }, {\n    key: \"initPopup\",\n    value: function initPopup() {\n      var _this2 = this;\n      if (this.unAddPopups.length) {\n        this.unAddPopups.forEach(function (popup) {\n          _this2.addPopup(popup);\n          _this2.unAddPopups = [];\n        });\n      }\n    }\n  }, {\n    key: \"init\",\n    value: function init(scene) {\n      this.scene = scene;\n      this.mapsService = scene.get(TYPES.IMapService);\n    }\n  }]);\n  return PopupService;\n}()) || _class);\nexport { PopupService as default };","map":{"version":3,"names":["_toConsumableArray","_classCallCheck","_createClass","_defineProperty","_dec","_class","injectable","TYPES","PopupService","key","get","mapsService","map","getMarkerContainer","value","removePopup","popup","isOpen","remove","targetIndex","popups","indexOf","splice","targetUnAddIndex","unAddPopups","destroy","forEach","addPopup","_this","getOptions","autoClose","concat","otherPopup","isMarkerReady","addTo","scene","push","on","initPopup","_this2","length","init","IMapService","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-core/es/services/component/PopupService.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _dec, _class;\nimport { injectable } from 'inversify';\nimport 'reflect-metadata';\nimport { TYPES } from \"../../types\";\nvar PopupService = (_dec = injectable(), _dec(_class = /*#__PURE__*/function () {\n  function PopupService() {\n    _classCallCheck(this, PopupService);\n    _defineProperty(this, \"scene\", void 0);\n    _defineProperty(this, \"mapsService\", void 0);\n    _defineProperty(this, \"popups\", []);\n    _defineProperty(this, \"unAddPopups\", []);\n  }\n  _createClass(PopupService, [{\n    key: \"isMarkerReady\",\n    get: function get() {\n      return this.mapsService.map && this.mapsService.getMarkerContainer();\n    }\n  }, {\n    key: \"removePopup\",\n    value: function removePopup(popup) {\n      if (popup !== null && popup !== void 0 && popup.isOpen()) {\n        popup.remove();\n      }\n      var targetIndex = this.popups.indexOf(popup);\n      if (targetIndex > -1) {\n        this.popups.splice(targetIndex, 1);\n      }\n      var targetUnAddIndex = this.unAddPopups.indexOf(popup);\n      if (targetUnAddIndex > -1) {\n        this.unAddPopups.splice(targetUnAddIndex, 1);\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.popups.forEach(function (popup) {\n        return popup.remove();\n      });\n    }\n  }, {\n    key: \"addPopup\",\n    value: function addPopup(popup) {\n      var _this = this;\n      if (popup && popup.getOptions().autoClose) {\n        [].concat(_toConsumableArray(this.popups), _toConsumableArray(this.unAddPopups)).forEach(function (otherPopup) {\n          if (otherPopup.getOptions().autoClose) {\n            _this.removePopup(otherPopup);\n          }\n        });\n      }\n      if (this.isMarkerReady) {\n        popup.addTo(this.scene);\n        this.popups.push(popup);\n      } else {\n        this.unAddPopups.push(popup);\n      }\n      popup.on('close', function () {\n        _this.removePopup(popup);\n      });\n    }\n  }, {\n    key: \"initPopup\",\n    value: function initPopup() {\n      var _this2 = this;\n      if (this.unAddPopups.length) {\n        this.unAddPopups.forEach(function (popup) {\n          _this2.addPopup(popup);\n          _this2.unAddPopups = [];\n        });\n      }\n    }\n  }, {\n    key: \"init\",\n    value: function init(scene) {\n      this.scene = scene;\n      this.mapsService = scene.get(TYPES.IMapService);\n    }\n  }]);\n  return PopupService;\n}()) || _class);\nexport { PopupService as default };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
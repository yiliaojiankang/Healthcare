{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { vec2 } from '@antv/matrix-util';\nfunction smoothBezier(points, smooth, isLoop, constraint) {\n  var cps = [];\n  var hasConstraint = !!constraint;\n  var prevPoint;\n  var nextPoint;\n  var min;\n  var max;\n  var nextCp0;\n  var cp1;\n  var cp0;\n  if (hasConstraint) {\n    min = constraint[0], max = constraint[1];\n    for (var i = 0, l = points.length; i < l; i += 1) {\n      var point = points[i];\n      min = vec2.min([0, 0], min, point);\n      max = vec2.max([0, 0], max, point);\n    }\n  }\n  for (var i = 0, len = points.length; i < len; i += 1) {\n    var point = points[i];\n    if (i === 0 && !isLoop) {\n      cp0 = point;\n    } else if (i === len - 1 && !isLoop) {\n      cp1 = point;\n      cps.push(cp0);\n      cps.push(cp1);\n    } else {\n      var prevIdx = [i ? i - 1 : len - 1, i - 1][isLoop ? 0 : 1];\n      prevPoint = points[prevIdx];\n      nextPoint = points[isLoop ? (i + 1) % len : i + 1];\n      var v = [0, 0];\n      v = vec2.sub(v, nextPoint, prevPoint);\n      v = vec2.scale(v, v, smooth);\n      var d0 = vec2.distance(point, prevPoint);\n      var d1 = vec2.distance(point, nextPoint);\n      var sum = d0 + d1;\n      if (sum !== 0) {\n        d0 /= sum;\n        d1 /= sum;\n      }\n      var v1 = vec2.scale([0, 0], v, -d0);\n      var v2 = vec2.scale([0, 0], v, d1);\n      cp1 = vec2.add([0, 0], point, v1);\n      nextCp0 = vec2.add([0, 0], point, v2);\n      // 下一个控制点必须在这个点和下一个点之间\n      nextCp0 = vec2.min([0, 0], nextCp0, vec2.max([0, 0], nextPoint, point));\n      nextCp0 = vec2.max([0, 0], nextCp0, vec2.min([0, 0], nextPoint, point));\n      // 重新计算 cp1 的值\n      v1 = vec2.sub([0, 0], nextCp0, point);\n      v1 = vec2.scale([0, 0], v1, -d0 / d1);\n      cp1 = vec2.add([0, 0], point, v1);\n      // 上一个控制点必须要在上一个点和这一个点之间\n      cp1 = vec2.min([0, 0], cp1, vec2.max([0, 0], prevPoint, point));\n      cp1 = vec2.max([0, 0], cp1, vec2.min([0, 0], prevPoint, point));\n      // 重新计算 nextCp0 的值\n      v2 = vec2.sub([0, 0], point, cp1);\n      v2 = vec2.scale([0, 0], v2, d1 / d0);\n      nextCp0 = vec2.add([0, 0], point, v2);\n      if (hasConstraint) {\n        cp1 = vec2.max([0, 0], cp1, min);\n        cp1 = vec2.min([0, 0], cp1, max);\n        nextCp0 = vec2.max([0, 0], nextCp0, min);\n        nextCp0 = vec2.min([0, 0], nextCp0, max);\n      }\n      cps.push(cp0);\n      cps.push(cp1);\n      cp0 = nextCp0;\n    }\n  }\n  if (isLoop) {\n    cps.push(cps.shift());\n  }\n  return cps;\n}\n/**\n * create bezier spline from catmull rom spline\n * @param {Array} crp Catmull Rom Points\n * @param {boolean} z Spline is loop\n * @param {Array} constraint Constraint\n */\nfunction catmullRom2Bezier(crp, z, constraint) {\n  if (z === void 0) {\n    z = false;\n  }\n  if (constraint === void 0) {\n    constraint = [[0, 0], [1, 1]];\n  }\n  var isLoop = !!z;\n  var pointList = [];\n  for (var i = 0, l = crp.length; i < l; i += 2) {\n    pointList.push([crp[i], crp[i + 1]]);\n  }\n  var controlPointList = smoothBezier(pointList, 0.4, isLoop, constraint);\n  var len = pointList.length;\n  var d1 = [];\n  var cp1;\n  var cp2;\n  var p;\n  for (var i = 0; i < len - 1; i += 1) {\n    cp1 = controlPointList[i * 2];\n    cp2 = controlPointList[i * 2 + 1];\n    p = pointList[i + 1];\n    d1.push(['C', cp1[0], cp1[1], cp2[0], cp2[1], p[0], p[1]]);\n  }\n  if (isLoop) {\n    cp1 = controlPointList[len];\n    cp2 = controlPointList[len + 1];\n    p = pointList[0];\n    d1.push(['C', cp1[0], cp1[1], cp2[0], cp2[1], p[0], p[1]]);\n  }\n  return d1;\n}\nexport default catmullRom2Bezier;","map":{"version":3,"names":["vec2","smoothBezier","points","smooth","isLoop","constraint","cps","hasConstraint","prevPoint","nextPoint","min","max","nextCp0","cp1","cp0","i","l","length","point","len","push","prevIdx","v","sub","scale","d0","distance","d1","sum","v1","v2","add","shift","catmullRom2Bezier","crp","z","pointList","controlPointList","cp2","p"],"sources":["../src/catmull-rom-2-bezier.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
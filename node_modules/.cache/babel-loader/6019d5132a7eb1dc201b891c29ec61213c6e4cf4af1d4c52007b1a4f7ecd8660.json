{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nfunction _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\n/**\n * @fileOverview 从xml建立自定义Node，包含update\n * @author xuzhi.mxz@antfin.com\n */\nimport { __assign, __rest } from \"tslib\";\nimport { get } from '@antv/util';\nimport { getTextSize } from '../util/graphic';\n/**\n * 一种更宽松的JSON 解析，如果遇到不符合规范的字段会直接转为字符串\n * @param text json 内容\n */\nfunction looseJSONParse(text) {\n  if (typeof text !== 'string') {\n    return text;\n  }\n  var safeParse = function safeParse(str) {\n    if (typeof str !== 'string') {\n      return str;\n    }\n    try {\n      return JSON.parse(str.trim());\n    } catch (e) {\n      return str.trim();\n    }\n  };\n  var firstAttempt = safeParse(text);\n  if (typeof firstAttempt !== 'string') {\n    return firstAttempt;\n  }\n  var tail = function tail(arr) {\n    return arr[arr.length - 1];\n  };\n  var str = text.trim();\n  var objectStack = [];\n  var syntaxStack = [];\n  var isLastPair = function isLastPair() {\n    var syntaxes = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      syntaxes[_i] = arguments[_i];\n    }\n    return syntaxes.some(function (syntax) {\n      return tail(syntaxStack) === syntax;\n    });\n  };\n  var getValueStore = function getValueStore() {\n    return tail(objectStack);\n  };\n  var rst = null;\n  var i = 0;\n  var temp = '';\n  while (i < str.length) {\n    var nowChar = str[i];\n    var isInString = isLastPair('\"', \"'\");\n    if (!isInString && !nowChar.trim()) {\n      i += 1;\n      continue;\n    }\n    var isLastTranslate = str[i - 1] === '\\\\';\n    var isInObject = isLastPair('}');\n    var isInArray = isLastPair(']');\n    var isWaitingValue = isLastPair(',');\n    var tempArr = getValueStore();\n    if (isInString) {\n      if (tail(syntaxStack) === nowChar && !isLastTranslate) {\n        syntaxStack.pop();\n        var value = safeParse(temp);\n        tempArr.push(value);\n        rst = value;\n        temp = '';\n      } else {\n        temp += nowChar;\n      }\n    } else if (isInArray && nowChar === ',') {\n      if (temp) {\n        tempArr.push(safeParse(temp));\n        temp = '';\n      }\n    } else if (isInObject && nowChar === ':') {\n      syntaxStack.push(',');\n      if (temp) {\n        tempArr.push(temp);\n        temp = '';\n      }\n    } else if (isWaitingValue && nowChar === ',') {\n      if (temp) {\n        tempArr.push(safeParse(temp));\n        temp = '';\n      }\n      syntaxStack.pop();\n    } else if (nowChar === '}' && (isInObject || isWaitingValue)) {\n      if (temp) {\n        tempArr.push(safeParse(temp));\n        temp = '';\n      }\n      if (isWaitingValue) {\n        syntaxStack.pop();\n      }\n      var obj = {};\n      for (var c = 1; c < tempArr.length; c += 2) {\n        obj[tempArr[c - 1]] = tempArr[c];\n      }\n      objectStack.pop();\n      if (objectStack.length) {\n        tail(objectStack).push(obj);\n      }\n      syntaxStack.pop();\n      rst = obj;\n    } else if (nowChar === ']' && isInArray) {\n      if (temp) {\n        tempArr.push(safeParse(temp));\n        temp = '';\n      }\n      objectStack.pop();\n      if (objectStack.length) {\n        tail(objectStack).push(tempArr);\n      }\n      syntaxStack.pop();\n      rst = tempArr;\n    } else if (nowChar === '{') {\n      objectStack.push([]);\n      syntaxStack.push('}');\n    } else if (nowChar === '[') {\n      objectStack.push([]);\n      syntaxStack.push(']');\n    } else if (nowChar === '\"') {\n      syntaxStack.push('\"');\n    } else if (nowChar === \"'\") {\n      syntaxStack.push(\"'\");\n    } else {\n      temp += nowChar;\n    }\n    i += 1;\n  }\n  return rst || temp;\n}\nvar keyConvert = function keyConvert(str) {\n  return str.split('-').reduce(function (a, b) {\n    return a + b.charAt(0).toUpperCase() + b.slice(1);\n  });\n};\n/**\n * 简单的一个{{}}模板渲染，不包含任何复杂语法\n * @param xml\n */\nexport var xmlDataRenderer = function xmlDataRenderer(xml) {\n  return function (data) {\n    var len = xml.length;\n    var arr = [];\n    var i = 0;\n    var tmp = '';\n    while (i < len) {\n      if (xml[i] === '{' && xml[i + 1] === '{') {\n        arr.push(tmp);\n        tmp = '';\n        i += 2;\n      } else if (xml[i] === '}' && xml[i + 1] === '}') {\n        if (arr.length) {\n          var last = arr.pop();\n          tmp = get(data, tmp, last.endsWith('=') ? \"\\\"{\".concat(tmp, \"}\\\"\") : tmp);\n          arr.push(last + tmp);\n        }\n        i += 2;\n        tmp = '';\n      } else {\n        tmp += xml[i];\n        i += 1;\n      }\n    }\n    arr.push(tmp);\n    return arr.map(function (e, index) {\n      return arr[index - 1] && arr[index - 1].endsWith('=') ? \"\\\"{\".concat(e, \"}\\\"\") : e;\n    }).join('');\n  };\n};\n/**\n * 解析XML，并转化为相应的JSON结构\n * @param xml xml解析后的节点\n */\nexport function parseXML(xml, cfg) {\n  var attrs = {};\n  var keys = xml.getAttributeNames && xml.getAttributeNames() || [];\n  var children = xml.children && Array.from(xml.children).map(function (e) {\n    return parseXML(e, cfg);\n  });\n  var rst = {};\n  var tagName = xml.tagName ? xml.tagName.toLowerCase() : 'group';\n  if (tagName === 'text') {\n    attrs.text = xml.innerText;\n  }\n  rst.type = tagName;\n  if (tagName === 'img') {\n    rst.type = 'image';\n  }\n  Array.from(keys).forEach(function (k) {\n    var key = keyConvert(k);\n    var val = xml.getAttribute(k);\n    try {\n      if (key === 'style' || key === 'attrs') {\n        var style = looseJSONParse(val);\n        attrs = __assign(__assign({}, attrs), style);\n      } else {\n        rst[key] = looseJSONParse(val);\n      }\n    } catch (e) {\n      if (key === 'style') {\n        throw e;\n      }\n      rst[key] = val;\n    }\n  });\n  rst.attrs = attrs;\n  if (cfg && cfg.style && rst.name && _typeof(cfg.style[rst.name]) === 'object') {\n    rst.attrs = __assign(__assign({}, rst.attrs), cfg.style[rst.name]);\n  }\n  if (cfg && cfg.style && rst.keyshape) {\n    rst.attrs = __assign(__assign({}, rst.attrs), cfg.style);\n  }\n  if (children.length) {\n    rst.children = children;\n  }\n  return rst;\n}\n/**\n * 根据偏移量和内部节点最终的bounding box来得出该shape最终的bbox\n */\nexport function getBBox(node, offset, childrenBBox) {\n  var _a = node.attrs,\n    attrs = _a === void 0 ? {} : _a;\n  var bbox = {\n    x: offset.x || 0,\n    y: offset.y || 0,\n    width: childrenBBox.width || 0,\n    height: childrenBBox.height || 0\n  };\n  var shapeHeight, shapeWidth;\n  switch (node.type) {\n    case 'maker':\n    case 'circle':\n      if (attrs.r) {\n        shapeWidth = 2 * attrs.r;\n        shapeHeight = 2 * attrs.r;\n      }\n      break;\n    case 'text':\n      if (attrs.text) {\n        shapeWidth = getTextSize(attrs.text, attrs.fontSize || 12)[0];\n        shapeHeight = 16;\n        bbox.y += shapeHeight;\n        bbox.height = shapeHeight;\n        bbox.width = shapeWidth;\n        node.attrs = __assign({\n          fontSize: 12,\n          fill: '#000'\n        }, attrs);\n      }\n      break;\n    default:\n      if (attrs.width) {\n        shapeWidth = attrs.width;\n      }\n      if (attrs.height) {\n        shapeHeight = attrs.height;\n      }\n  }\n  if (shapeHeight >= 0) {\n    bbox.height = shapeHeight;\n  }\n  if (shapeWidth >= 0) {\n    bbox.width = shapeWidth;\n  }\n  if (attrs.marginTop) {\n    bbox.y += attrs.marginTop;\n  }\n  if (attrs.marginLeft) {\n    bbox.x += attrs.marginLeft;\n  }\n  return bbox;\n}\n/**\n * 把从xml计算出的结构填上位置信息，补全attrs\n * @param target\n * @param lastOffset\n */\nexport function generateTarget(target, lastOffset) {\n  var _a;\n  if (lastOffset === void 0) {\n    lastOffset = {\n      x: 0,\n      y: 0\n    };\n  }\n  var defaultBbox = __assign({\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  }, lastOffset);\n  if ((_a = target.children) === null || _a === void 0 ? void 0 : _a.length) {\n    var _b = target.attrs,\n      attrs = _b === void 0 ? {} : _b;\n    var marginTop = attrs.marginTop;\n    var offset = __assign({}, lastOffset);\n    if (marginTop) {\n      offset.y += marginTop;\n    }\n    for (var index = 0; index < target.children.length; index++) {\n      target.children[index].attrs.key = \"\".concat(attrs.key || 'root', \" -\").concat(index, \" \");\n      var node = generateTarget(target.children[index], offset);\n      if (node.bbox) {\n        var bbox = node.bbox;\n        if (node.attrs.next === 'inline') {\n          offset.x += node.bbox.width;\n        } else {\n          offset.y += node.bbox.height;\n        }\n        if (bbox.width + bbox.x > defaultBbox.width) {\n          defaultBbox.width = bbox.width + bbox.x;\n        }\n        if (bbox.height + bbox.y > defaultBbox.height) {\n          defaultBbox.height = bbox.height + bbox.y;\n        }\n      }\n    }\n  }\n  target.bbox = getBBox(target, lastOffset, defaultBbox);\n  target.attrs = __assign(__assign({}, target.attrs), target.bbox);\n  return target;\n}\n/**\n * 对比前后两个最终计算出来的node，并对比出最小改动,\n * 动作： 'add' 添加节点 ｜ ’delete‘ 删除节点 ｜ ’change‘ 改变节点attrs ｜ 'restructure' 重构节点\n * @param nowTarget\n * @param formerTarget\n */\nexport function compareTwoTarget(nowTarget, formerTarget) {\n  var _a, _b, _c, _d;\n  var type = (nowTarget || {}).type;\n  var key = ((formerTarget === null || formerTarget === void 0 ? void 0 : formerTarget.attrs) || {}).key;\n  if (key && nowTarget) {\n    nowTarget.attrs.key = key;\n  }\n  if (!nowTarget && formerTarget) {\n    return {\n      action: 'delete',\n      val: formerTarget,\n      type: type,\n      key: key\n    };\n  }\n  if (nowTarget && !formerTarget) {\n    return {\n      action: 'add',\n      val: nowTarget,\n      type: type\n    };\n  }\n  if (!nowTarget && !formerTarget) {\n    return {\n      action: 'same',\n      type: type\n    };\n  }\n  var children = [];\n  if (((_a = nowTarget.children) === null || _a === void 0 ? void 0 : _a.length) > 0 || ((_b = formerTarget.children) === null || _b === void 0 ? void 0 : _b.length) > 0) {\n    var length_1 = Math.max((_c = nowTarget.children) === null || _c === void 0 ? void 0 : _c.length, (_d = formerTarget.children) === null || _d === void 0 ? void 0 : _d.length);\n    var formerChildren = formerTarget.children || [];\n    var nowChildren = nowTarget.children || [];\n    for (var index = 0; index < length_1; index += 1) {\n      children.push(compareTwoTarget(nowChildren[index], formerChildren[index]));\n    }\n  }\n  var formerKeys = Object.keys(formerTarget.attrs);\n  var nowKeys = Object.keys(nowTarget.attrs);\n  if (formerTarget.type !== nowTarget.type) {\n    return {\n      action: 'restructure',\n      nowTarget: nowTarget,\n      formerTarget: formerTarget,\n      key: key,\n      children: children\n    };\n  }\n  if (formerKeys.filter(function (e) {\n    return e !== 'children';\n  }).some(function (e) {\n    return nowTarget.attrs[e] !== formerTarget.attrs[e] || !nowKeys.includes(e);\n  })) {\n    return {\n      action: 'change',\n      val: nowTarget,\n      children: children,\n      type: type,\n      key: key\n    };\n  }\n  return {\n    action: 'same',\n    children: children,\n    type: type,\n    key: key\n  };\n}\n/**\n * 根据xml或者返回xml的函数构建自定义节点的结构\n * @param gen\n */\nexport function createNodeFromXML(gen) {\n  var structures = {};\n  var compileXML = function compileXML(cfg) {\n    var rawStr = typeof gen === 'function' ? gen(cfg) : gen;\n    var target = xmlDataRenderer(rawStr)(cfg);\n    var xmlParser = document.createElement('div');\n    xmlParser.innerHTML = target;\n    var xml = xmlParser.children[0];\n    var result = generateTarget(parseXML(xml, cfg));\n    xmlParser.remove();\n    return result;\n  };\n  return {\n    draw: function draw(cfg, group) {\n      var resultTarget = compileXML(cfg);\n      var keyshape = group;\n      var renderTarget = function renderTarget(target) {\n        var _a = target.attrs,\n          attrs = _a === void 0 ? {} : _a,\n          bbox = target.bbox,\n          type = target.type,\n          children = target.children,\n          rest = __rest(target, [\"attrs\", \"bbox\", \"type\", \"children\"]);\n        if (target.type !== 'group') {\n          var shape = group.addShape(target.type, __assign({\n            attrs: attrs,\n            origin: {\n              bbox: bbox,\n              type: type,\n              children: children\n            }\n          }, rest));\n          if (target.keyshape) {\n            keyshape = shape;\n          }\n        }\n        if (target.children) {\n          target.children.forEach(function (n) {\n            return renderTarget(n);\n          });\n        }\n      };\n      renderTarget(resultTarget);\n      structures[cfg.id] = [resultTarget];\n      return keyshape;\n    },\n    update: function update(cfg, node) {\n      if (!structures[cfg.id]) {\n        structures[cfg.id] = [];\n      }\n      var container = node.getContainer();\n      var children = container.get('children');\n      var newTarget = compileXML(cfg);\n      var lastTarget = structures[cfg.id].pop();\n      var diffResult = compareTwoTarget(newTarget, lastTarget);\n      var addShape = function addShape(shape) {\n        var _a;\n        if (shape.type !== 'group') {\n          container.addShape(shape.type, {\n            attrs: shape.attrs\n          });\n        }\n        if ((_a = shape.children) === null || _a === void 0 ? void 0 : _a.length) {\n          shape.children.map(function (e) {\n            return addShape(e);\n          });\n        }\n      };\n      var delShape = function delShape(shape) {\n        var _a;\n        var targetShape = children.find(function (e) {\n          return e.attrs.key === shape.attrs.key;\n        });\n        if (targetShape) {\n          container.removeChild(targetShape);\n        }\n        if ((_a = shape.children) === null || _a === void 0 ? void 0 : _a.length) {\n          shape.children.map(function (e) {\n            return delShape(e);\n          });\n        }\n      };\n      var updateTarget = function updateTarget(target) {\n        var key = target.key;\n        if (target.type !== 'group') {\n          var targetShape = children.find(function (e) {\n            return e.attrs.key === key;\n          });\n          switch (target.action) {\n            case 'change':\n              if (targetShape) {\n                var originAttr = target.val.keyshape ? node.getOriginStyle() : {};\n                targetShape.attr(__assign(__assign({}, originAttr), target.val.attrs));\n              }\n              break;\n            case 'add':\n              addShape(target.val);\n              break;\n            case 'delete':\n              delShape(target.val);\n              break;\n            case 'restructure':\n              delShape(target.formerTarget);\n              addShape(target.nowTarget);\n              break;\n            default:\n              break;\n          }\n        }\n        if (target.children) {\n          target.children.forEach(function (n) {\n            return updateTarget(n);\n          });\n        }\n      };\n      updateTarget(diffResult);\n      structures[cfg.id].push(newTarget);\n    },\n    getAnchorPoints: function getAnchorPoints() {\n      return [[0, 0.5], [1, 0.5], [0.5, 1], [0.5, 0]];\n    }\n  };\n}","map":{"version":3,"names":["_typeof","o","Symbol","iterator","constructor","prototype","__assign","__rest","get","getTextSize","looseJSONParse","text","safeParse","str","JSON","parse","trim","e","firstAttempt","tail","arr","length","objectStack","syntaxStack","isLastPair","syntaxes","_i","arguments","some","syntax","getValueStore","rst","i","temp","nowChar","isInString","isLastTranslate","isInObject","isInArray","isWaitingValue","tempArr","pop","value","push","obj","c","keyConvert","split","reduce","a","b","charAt","toUpperCase","slice","xmlDataRenderer","xml","data","len","tmp","last","endsWith","concat","map","index","join","parseXML","cfg","attrs","keys","getAttributeNames","children","Array","from","tagName","toLowerCase","innerText","type","forEach","k","key","val","getAttribute","style","name","keyshape","getBBox","node","offset","childrenBBox","_a","bbox","x","y","width","height","shapeHeight","shapeWidth","r","fontSize","fill","marginTop","marginLeft","generateTarget","target","lastOffset","defaultBbox","_b","next","compareTwoTarget","nowTarget","formerTarget","_c","_d","action","length_1","Math","max","formerChildren","nowChildren","formerKeys","Object","nowKeys","filter","includes","createNodeFromXML","gen","structures","compileXML","rawStr","xmlParser","document","createElement","innerHTML","result","remove","draw","group","resultTarget","renderTarget","rest","shape","addShape","origin","n","id","update","container","getContainer","newTarget","lastTarget","diffResult","delShape","targetShape","find","removeChild","updateTarget","originAttr","getOriginStyle","attr","getAnchorPoints"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/g6-core/es/element/xml.js"],"sourcesContent":["function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n/**\n * @fileOverview 从xml建立自定义Node，包含update\n * @author xuzhi.mxz@antfin.com\n */\nimport { __assign, __rest } from \"tslib\";\nimport { get } from '@antv/util';\nimport { getTextSize } from '../util/graphic';\n/**\n * 一种更宽松的JSON 解析，如果遇到不符合规范的字段会直接转为字符串\n * @param text json 内容\n */\nfunction looseJSONParse(text) {\n  if (typeof text !== 'string') {\n    return text;\n  }\n  var safeParse = function safeParse(str) {\n    if (typeof str !== 'string') {\n      return str;\n    }\n    try {\n      return JSON.parse(str.trim());\n    } catch (e) {\n      return str.trim();\n    }\n  };\n  var firstAttempt = safeParse(text);\n  if (typeof firstAttempt !== 'string') {\n    return firstAttempt;\n  }\n  var tail = function tail(arr) {\n    return arr[arr.length - 1];\n  };\n  var str = text.trim();\n  var objectStack = [];\n  var syntaxStack = [];\n  var isLastPair = function isLastPair() {\n    var syntaxes = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      syntaxes[_i] = arguments[_i];\n    }\n    return syntaxes.some(function (syntax) {\n      return tail(syntaxStack) === syntax;\n    });\n  };\n  var getValueStore = function getValueStore() {\n    return tail(objectStack);\n  };\n  var rst = null;\n  var i = 0;\n  var temp = '';\n  while (i < str.length) {\n    var nowChar = str[i];\n    var isInString = isLastPair('\"', \"'\");\n    if (!isInString && !nowChar.trim()) {\n      i += 1;\n      continue;\n    }\n    var isLastTranslate = str[i - 1] === '\\\\';\n    var isInObject = isLastPair('}');\n    var isInArray = isLastPair(']');\n    var isWaitingValue = isLastPair(',');\n    var tempArr = getValueStore();\n    if (isInString) {\n      if (tail(syntaxStack) === nowChar && !isLastTranslate) {\n        syntaxStack.pop();\n        var value = safeParse(temp);\n        tempArr.push(value);\n        rst = value;\n        temp = '';\n      } else {\n        temp += nowChar;\n      }\n    } else if (isInArray && nowChar === ',') {\n      if (temp) {\n        tempArr.push(safeParse(temp));\n        temp = '';\n      }\n    } else if (isInObject && nowChar === ':') {\n      syntaxStack.push(',');\n      if (temp) {\n        tempArr.push(temp);\n        temp = '';\n      }\n    } else if (isWaitingValue && nowChar === ',') {\n      if (temp) {\n        tempArr.push(safeParse(temp));\n        temp = '';\n      }\n      syntaxStack.pop();\n    } else if (nowChar === '}' && (isInObject || isWaitingValue)) {\n      if (temp) {\n        tempArr.push(safeParse(temp));\n        temp = '';\n      }\n      if (isWaitingValue) {\n        syntaxStack.pop();\n      }\n      var obj = {};\n      for (var c = 1; c < tempArr.length; c += 2) {\n        obj[tempArr[c - 1]] = tempArr[c];\n      }\n      objectStack.pop();\n      if (objectStack.length) {\n        tail(objectStack).push(obj);\n      }\n      syntaxStack.pop();\n      rst = obj;\n    } else if (nowChar === ']' && isInArray) {\n      if (temp) {\n        tempArr.push(safeParse(temp));\n        temp = '';\n      }\n      objectStack.pop();\n      if (objectStack.length) {\n        tail(objectStack).push(tempArr);\n      }\n      syntaxStack.pop();\n      rst = tempArr;\n    } else if (nowChar === '{') {\n      objectStack.push([]);\n      syntaxStack.push('}');\n    } else if (nowChar === '[') {\n      objectStack.push([]);\n      syntaxStack.push(']');\n    } else if (nowChar === '\"') {\n      syntaxStack.push('\"');\n    } else if (nowChar === \"'\") {\n      syntaxStack.push(\"'\");\n    } else {\n      temp += nowChar;\n    }\n    i += 1;\n  }\n  return rst || temp;\n}\nvar keyConvert = function keyConvert(str) {\n  return str.split('-').reduce(function (a, b) {\n    return a + b.charAt(0).toUpperCase() + b.slice(1);\n  });\n};\n/**\n * 简单的一个{{}}模板渲染，不包含任何复杂语法\n * @param xml\n */\nexport var xmlDataRenderer = function xmlDataRenderer(xml) {\n  return function (data) {\n    var len = xml.length;\n    var arr = [];\n    var i = 0;\n    var tmp = '';\n    while (i < len) {\n      if (xml[i] === '{' && xml[i + 1] === '{') {\n        arr.push(tmp);\n        tmp = '';\n        i += 2;\n      } else if (xml[i] === '}' && xml[i + 1] === '}') {\n        if (arr.length) {\n          var last = arr.pop();\n          tmp = get(data, tmp, last.endsWith('=') ? \"\\\"{\".concat(tmp, \"}\\\"\") : tmp);\n          arr.push(last + tmp);\n        }\n        i += 2;\n        tmp = '';\n      } else {\n        tmp += xml[i];\n        i += 1;\n      }\n    }\n    arr.push(tmp);\n    return arr.map(function (e, index) {\n      return arr[index - 1] && arr[index - 1].endsWith('=') ? \"\\\"{\".concat(e, \"}\\\"\") : e;\n    }).join('');\n  };\n};\n/**\n * 解析XML，并转化为相应的JSON结构\n * @param xml xml解析后的节点\n */\nexport function parseXML(xml, cfg) {\n  var attrs = {};\n  var keys = xml.getAttributeNames && xml.getAttributeNames() || [];\n  var children = xml.children && Array.from(xml.children).map(function (e) {\n    return parseXML(e, cfg);\n  });\n  var rst = {};\n  var tagName = xml.tagName ? xml.tagName.toLowerCase() : 'group';\n  if (tagName === 'text') {\n    attrs.text = xml.innerText;\n  }\n  rst.type = tagName;\n  if (tagName === 'img') {\n    rst.type = 'image';\n  }\n  Array.from(keys).forEach(function (k) {\n    var key = keyConvert(k);\n    var val = xml.getAttribute(k);\n    try {\n      if (key === 'style' || key === 'attrs') {\n        var style = looseJSONParse(val);\n        attrs = __assign(__assign({}, attrs), style);\n      } else {\n        rst[key] = looseJSONParse(val);\n      }\n    } catch (e) {\n      if (key === 'style') {\n        throw e;\n      }\n      rst[key] = val;\n    }\n  });\n  rst.attrs = attrs;\n  if (cfg && cfg.style && rst.name && _typeof(cfg.style[rst.name]) === 'object') {\n    rst.attrs = __assign(__assign({}, rst.attrs), cfg.style[rst.name]);\n  }\n  if (cfg && cfg.style && rst.keyshape) {\n    rst.attrs = __assign(__assign({}, rst.attrs), cfg.style);\n  }\n  if (children.length) {\n    rst.children = children;\n  }\n  return rst;\n}\n/**\n * 根据偏移量和内部节点最终的bounding box来得出该shape最终的bbox\n */\nexport function getBBox(node, offset, childrenBBox) {\n  var _a = node.attrs,\n    attrs = _a === void 0 ? {} : _a;\n  var bbox = {\n    x: offset.x || 0,\n    y: offset.y || 0,\n    width: childrenBBox.width || 0,\n    height: childrenBBox.height || 0\n  };\n  var shapeHeight, shapeWidth;\n  switch (node.type) {\n    case 'maker':\n    case 'circle':\n      if (attrs.r) {\n        shapeWidth = 2 * attrs.r;\n        shapeHeight = 2 * attrs.r;\n      }\n      break;\n    case 'text':\n      if (attrs.text) {\n        shapeWidth = getTextSize(attrs.text, attrs.fontSize || 12)[0];\n        shapeHeight = 16;\n        bbox.y += shapeHeight;\n        bbox.height = shapeHeight;\n        bbox.width = shapeWidth;\n        node.attrs = __assign({\n          fontSize: 12,\n          fill: '#000'\n        }, attrs);\n      }\n      break;\n    default:\n      if (attrs.width) {\n        shapeWidth = attrs.width;\n      }\n      if (attrs.height) {\n        shapeHeight = attrs.height;\n      }\n  }\n  if (shapeHeight >= 0) {\n    bbox.height = shapeHeight;\n  }\n  if (shapeWidth >= 0) {\n    bbox.width = shapeWidth;\n  }\n  if (attrs.marginTop) {\n    bbox.y += attrs.marginTop;\n  }\n  if (attrs.marginLeft) {\n    bbox.x += attrs.marginLeft;\n  }\n  return bbox;\n}\n/**\n * 把从xml计算出的结构填上位置信息，补全attrs\n * @param target\n * @param lastOffset\n */\nexport function generateTarget(target, lastOffset) {\n  var _a;\n  if (lastOffset === void 0) {\n    lastOffset = {\n      x: 0,\n      y: 0\n    };\n  }\n  var defaultBbox = __assign({\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  }, lastOffset);\n  if ((_a = target.children) === null || _a === void 0 ? void 0 : _a.length) {\n    var _b = target.attrs,\n      attrs = _b === void 0 ? {} : _b;\n    var marginTop = attrs.marginTop;\n    var offset = __assign({}, lastOffset);\n    if (marginTop) {\n      offset.y += marginTop;\n    }\n    for (var index = 0; index < target.children.length; index++) {\n      target.children[index].attrs.key = \"\".concat(attrs.key || 'root', \" -\").concat(index, \" \");\n      var node = generateTarget(target.children[index], offset);\n      if (node.bbox) {\n        var bbox = node.bbox;\n        if (node.attrs.next === 'inline') {\n          offset.x += node.bbox.width;\n        } else {\n          offset.y += node.bbox.height;\n        }\n        if (bbox.width + bbox.x > defaultBbox.width) {\n          defaultBbox.width = bbox.width + bbox.x;\n        }\n        if (bbox.height + bbox.y > defaultBbox.height) {\n          defaultBbox.height = bbox.height + bbox.y;\n        }\n      }\n    }\n  }\n  target.bbox = getBBox(target, lastOffset, defaultBbox);\n  target.attrs = __assign(__assign({}, target.attrs), target.bbox);\n  return target;\n}\n/**\n * 对比前后两个最终计算出来的node，并对比出最小改动,\n * 动作： 'add' 添加节点 ｜ ’delete‘ 删除节点 ｜ ’change‘ 改变节点attrs ｜ 'restructure' 重构节点\n * @param nowTarget\n * @param formerTarget\n */\nexport function compareTwoTarget(nowTarget, formerTarget) {\n  var _a, _b, _c, _d;\n  var type = (nowTarget || {}).type;\n  var key = ((formerTarget === null || formerTarget === void 0 ? void 0 : formerTarget.attrs) || {}).key;\n  if (key && nowTarget) {\n    nowTarget.attrs.key = key;\n  }\n  if (!nowTarget && formerTarget) {\n    return {\n      action: 'delete',\n      val: formerTarget,\n      type: type,\n      key: key\n    };\n  }\n  if (nowTarget && !formerTarget) {\n    return {\n      action: 'add',\n      val: nowTarget,\n      type: type\n    };\n  }\n  if (!nowTarget && !formerTarget) {\n    return {\n      action: 'same',\n      type: type\n    };\n  }\n  var children = [];\n  if (((_a = nowTarget.children) === null || _a === void 0 ? void 0 : _a.length) > 0 || ((_b = formerTarget.children) === null || _b === void 0 ? void 0 : _b.length) > 0) {\n    var length_1 = Math.max((_c = nowTarget.children) === null || _c === void 0 ? void 0 : _c.length, (_d = formerTarget.children) === null || _d === void 0 ? void 0 : _d.length);\n    var formerChildren = formerTarget.children || [];\n    var nowChildren = nowTarget.children || [];\n    for (var index = 0; index < length_1; index += 1) {\n      children.push(compareTwoTarget(nowChildren[index], formerChildren[index]));\n    }\n  }\n  var formerKeys = Object.keys(formerTarget.attrs);\n  var nowKeys = Object.keys(nowTarget.attrs);\n  if (formerTarget.type !== nowTarget.type) {\n    return {\n      action: 'restructure',\n      nowTarget: nowTarget,\n      formerTarget: formerTarget,\n      key: key,\n      children: children\n    };\n  }\n  if (formerKeys.filter(function (e) {\n    return e !== 'children';\n  }).some(function (e) {\n    return nowTarget.attrs[e] !== formerTarget.attrs[e] || !nowKeys.includes(e);\n  })) {\n    return {\n      action: 'change',\n      val: nowTarget,\n      children: children,\n      type: type,\n      key: key\n    };\n  }\n  return {\n    action: 'same',\n    children: children,\n    type: type,\n    key: key\n  };\n}\n/**\n * 根据xml或者返回xml的函数构建自定义节点的结构\n * @param gen\n */\nexport function createNodeFromXML(gen) {\n  var structures = {};\n  var compileXML = function compileXML(cfg) {\n    var rawStr = typeof gen === 'function' ? gen(cfg) : gen;\n    var target = xmlDataRenderer(rawStr)(cfg);\n    var xmlParser = document.createElement('div');\n    xmlParser.innerHTML = target;\n    var xml = xmlParser.children[0];\n    var result = generateTarget(parseXML(xml, cfg));\n    xmlParser.remove();\n    return result;\n  };\n  return {\n    draw: function draw(cfg, group) {\n      var resultTarget = compileXML(cfg);\n      var keyshape = group;\n      var renderTarget = function renderTarget(target) {\n        var _a = target.attrs,\n          attrs = _a === void 0 ? {} : _a,\n          bbox = target.bbox,\n          type = target.type,\n          children = target.children,\n          rest = __rest(target, [\"attrs\", \"bbox\", \"type\", \"children\"]);\n        if (target.type !== 'group') {\n          var shape = group.addShape(target.type, __assign({\n            attrs: attrs,\n            origin: {\n              bbox: bbox,\n              type: type,\n              children: children\n            }\n          }, rest));\n          if (target.keyshape) {\n            keyshape = shape;\n          }\n        }\n        if (target.children) {\n          target.children.forEach(function (n) {\n            return renderTarget(n);\n          });\n        }\n      };\n      renderTarget(resultTarget);\n      structures[cfg.id] = [resultTarget];\n      return keyshape;\n    },\n    update: function update(cfg, node) {\n      if (!structures[cfg.id]) {\n        structures[cfg.id] = [];\n      }\n      var container = node.getContainer();\n      var children = container.get('children');\n      var newTarget = compileXML(cfg);\n      var lastTarget = structures[cfg.id].pop();\n      var diffResult = compareTwoTarget(newTarget, lastTarget);\n      var addShape = function addShape(shape) {\n        var _a;\n        if (shape.type !== 'group') {\n          container.addShape(shape.type, {\n            attrs: shape.attrs\n          });\n        }\n        if ((_a = shape.children) === null || _a === void 0 ? void 0 : _a.length) {\n          shape.children.map(function (e) {\n            return addShape(e);\n          });\n        }\n      };\n      var delShape = function delShape(shape) {\n        var _a;\n        var targetShape = children.find(function (e) {\n          return e.attrs.key === shape.attrs.key;\n        });\n        if (targetShape) {\n          container.removeChild(targetShape);\n        }\n        if ((_a = shape.children) === null || _a === void 0 ? void 0 : _a.length) {\n          shape.children.map(function (e) {\n            return delShape(e);\n          });\n        }\n      };\n      var updateTarget = function updateTarget(target) {\n        var key = target.key;\n        if (target.type !== 'group') {\n          var targetShape = children.find(function (e) {\n            return e.attrs.key === key;\n          });\n          switch (target.action) {\n            case 'change':\n              if (targetShape) {\n                var originAttr = target.val.keyshape ? node.getOriginStyle() : {};\n                targetShape.attr(__assign(__assign({}, originAttr), target.val.attrs));\n              }\n              break;\n            case 'add':\n              addShape(target.val);\n              break;\n            case 'delete':\n              delShape(target.val);\n              break;\n            case 'restructure':\n              delShape(target.formerTarget);\n              addShape(target.nowTarget);\n              break;\n            default:\n              break;\n          }\n        }\n        if (target.children) {\n          target.children.forEach(function (n) {\n            return updateTarget(n);\n          });\n        }\n      };\n      updateTarget(diffResult);\n      structures[cfg.id].push(newTarget);\n    },\n    getAnchorPoints: function getAnchorPoints() {\n      return [[0, 0.5], [1, 0.5], [0.5, 1], [0.5, 0]];\n    }\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
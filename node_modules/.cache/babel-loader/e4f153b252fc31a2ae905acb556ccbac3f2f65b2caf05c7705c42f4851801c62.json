{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.circularDependencyToException = exports.listMetadataForTarget = exports.listRegisteredBindingsForServiceIdentifier = exports.getServiceIdentifierAsString = exports.getFunctionName = void 0;\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nfunction getServiceIdentifierAsString(serviceIdentifier) {\n  if (typeof serviceIdentifier === \"function\") {\n    var _serviceIdentifier = serviceIdentifier;\n    return _serviceIdentifier.name;\n  } else if (typeof serviceIdentifier === \"symbol\") {\n    return serviceIdentifier.toString();\n  } else {\n    var _serviceIdentifier = serviceIdentifier;\n    return _serviceIdentifier;\n  }\n}\nexports.getServiceIdentifierAsString = getServiceIdentifierAsString;\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\n  var registeredBindingsList = \"\";\n  var registeredBindings = getBindings(container, serviceIdentifier);\n  if (registeredBindings.length !== 0) {\n    registeredBindingsList = \"\\nRegistered bindings:\";\n    registeredBindings.forEach(function (binding) {\n      var name = \"Object\";\n      if (binding.implementationType !== null) {\n        name = getFunctionName(binding.implementationType);\n      }\n      registeredBindingsList = registeredBindingsList + \"\\n \" + name;\n      if (binding.constraint.metaData) {\n        registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\n      }\n    });\n  }\n  return registeredBindingsList;\n}\nexports.listRegisteredBindingsForServiceIdentifier = listRegisteredBindingsForServiceIdentifier;\nfunction alreadyDependencyChain(request, serviceIdentifier) {\n  if (request.parentRequest === null) {\n    return false;\n  } else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\n    return true;\n  } else {\n    return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\n  }\n}\nfunction dependencyChainToString(request) {\n  function _createStringArr(req, result) {\n    if (result === void 0) {\n      result = [];\n    }\n    var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\n    result.push(serviceIdentifier);\n    if (req.parentRequest !== null) {\n      return _createStringArr(req.parentRequest, result);\n    }\n    return result;\n  }\n  var stringArr = _createStringArr(request);\n  return stringArr.reverse().join(\" --> \");\n}\nfunction circularDependencyToException(request) {\n  request.childRequests.forEach(function (childRequest) {\n    if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\n      var services = dependencyChainToString(childRequest);\n      throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\n    } else {\n      circularDependencyToException(childRequest);\n    }\n  });\n}\nexports.circularDependencyToException = circularDependencyToException;\nfunction listMetadataForTarget(serviceIdentifierString, target) {\n  if (target.isTagged() || target.isNamed()) {\n    var m_1 = \"\";\n    var namedTag = target.getNamedTag();\n    var otherTags = target.getCustomTags();\n    if (namedTag !== null) {\n      m_1 += namedTag.toString() + \"\\n\";\n    }\n    if (otherTags !== null) {\n      otherTags.forEach(function (tag) {\n        m_1 += tag.toString() + \"\\n\";\n      });\n    }\n    return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\n  } else {\n    return \" \" + serviceIdentifierString;\n  }\n}\nexports.listMetadataForTarget = listMetadataForTarget;\nfunction getFunctionName(v) {\n  if (v.name) {\n    return v.name;\n  } else {\n    var name_1 = v.toString();\n    var match = name_1.match(/^function\\s*([^\\s(]+)/);\n    return match ? match[1] : \"Anonymous function: \" + name_1;\n  }\n}\nexports.getFunctionName = getFunctionName;","map":{"version":3,"names":["ERROR_MSGS","require","getServiceIdentifierAsString","serviceIdentifier","_serviceIdentifier","name","toString","exports","listRegisteredBindingsForServiceIdentifier","container","getBindings","registeredBindingsList","registeredBindings","length","forEach","binding","implementationType","getFunctionName","constraint","metaData","alreadyDependencyChain","request","parentRequest","dependencyChainToString","_createStringArr","req","result","push","stringArr","reverse","join","circularDependencyToException","childRequests","childRequest","services","Error","CIRCULAR_DEPENDENCY","listMetadataForTarget","serviceIdentifierString","target","isTagged","isNamed","m_1","namedTag","getNamedTag","otherTags","getCustomTags","tag","v","name_1","match"],"sources":["../../src/utils/serialization.ts"],"sourcesContent":[null],"mappings":";;;;;;;AAAA,IAAAA,UAAA,GAAAC,OAAA;AAGA,SAASC,4BAA4BA,CAACC,iBAAoD;EACtF,IAAI,OAAOA,iBAAiB,KAAK,UAAU,EAAE;IACzC,IAAMC,kBAAkB,GAAQD,iBAAiB;IACjD,OAAOC,kBAAkB,CAACC,IAAI;GACjC,MAAM,IAAI,OAAOF,iBAAiB,KAAK,QAAQ,EAAE;IAC9C,OAAOA,iBAAiB,CAACG,QAAQ,EAAE;GACtC,MAAM;IACH,IAAMF,kBAAkB,GAAQD,iBAAiB;IACjD,OAAOC,kBAAkB;;AAEjC;AA6HIG,OAAA,CAAAL,4BAAA,GAAAA,4BAAA;AA3HJ,SAASM,0CAA0CA,CAC/CC,SAA+B,EAC/BN,iBAAyB,EACzBO,WAG4B;EAG5B,IAAIC,sBAAsB,GAAG,EAAE;EAC/B,IAAMC,kBAAkB,GAAGF,WAAW,CAACD,SAAS,EAAEN,iBAAiB,CAAC;EAEpE,IAAIS,kBAAkB,CAACC,MAAM,KAAK,CAAC,EAAE;IAEjCF,sBAAsB,GAAG,wBAAwB;IAEjDC,kBAAkB,CAACE,OAAO,CAAC,UAACC,OAAgC;MAGxD,IAAIV,IAAI,GAAG,QAAQ;MAGnB,IAAIU,OAAO,CAACC,kBAAkB,KAAK,IAAI,EAAE;QACrCX,IAAI,GAAGY,eAAe,CAACF,OAAO,CAACC,kBAAkB,CAAC;;MAGtDL,sBAAsB,GAAMA,sBAAsB,WAAMN,IAAM;MAE9D,IAAIU,OAAO,CAACG,UAAU,CAACC,QAAQ,EAAE;QAC7BR,sBAAsB,GAAMA,sBAAsB,WAAMI,OAAO,CAACG,UAAU,CAACC,QAAU;;IAG7F,CAAC,CAAC;;EAIN,OAAOR,sBAAsB;AACjC;AAuFIJ,OAAA,CAAAC,0CAAA,GAAAA,0CAAA;AArFJ,SAASY,sBAAsBA,CAC3BC,OAA2B,EAC3BlB,iBAAoD;EAEpD,IAAIkB,OAAO,CAACC,aAAa,KAAK,IAAI,EAAE;IAChC,OAAO,KAAK;GACf,MAAM,IAAID,OAAO,CAACC,aAAa,CAACnB,iBAAiB,KAAKA,iBAAiB,EAAE;IACtE,OAAO,IAAI;GACd,MAAM;IACH,OAAOiB,sBAAsB,CAACC,OAAO,CAACC,aAAa,EAAEnB,iBAAiB,CAAC;;AAE/E;AAEA,SAASoB,uBAAuBA,CAC5BF,OAA2B;EAG3B,SAASG,gBAAgBA,CACrBC,GAAuB,EACvBC,MAAqB;IAArB,IAAAA,MAAA;MAAAA,MAAA,KAAqB;IAAA;IAErB,IAAMvB,iBAAiB,GAAGD,4BAA4B,CAACuB,GAAG,CAACtB,iBAAiB,CAAC;IAC7EuB,MAAM,CAACC,IAAI,CAACxB,iBAAiB,CAAC;IAC9B,IAAIsB,GAAG,CAACH,aAAa,KAAK,IAAI,EAAE;MAC5B,OAAOE,gBAAgB,CAACC,GAAG,CAACH,aAAa,EAAEI,MAAM,CAAC;;IAEtD,OAAOA,MAAM;EACjB;EAEA,IAAME,SAAS,GAAGJ,gBAAgB,CAACH,OAAO,CAAC;EAC3C,OAAOO,SAAS,CAACC,OAAO,EAAE,CAACC,IAAI,CAAC,OAAO,CAAC;AAE5C;AAEA,SAASC,6BAA6BA,CAClCV,OAA2B;EAE3BA,OAAO,CAACW,aAAa,CAAClB,OAAO,CAAC,UAACmB,YAAY;IACvC,IAAIb,sBAAsB,CAACa,YAAY,EAAEA,YAAY,CAAC9B,iBAAiB,CAAC,EAAE;MACtE,IAAM+B,QAAQ,GAAGX,uBAAuB,CAACU,YAAY,CAAC;MACtD,MAAM,IAAIE,KAAK,CAAInC,UAAU,CAACoC,mBAAmB,SAAIF,QAAU,CAAC;KACnE,MAAM;MACHH,6BAA6B,CAACE,YAAY,CAAC;;EAEnD,CAAC,CAAC;AACN;AA0CI1B,OAAA,CAAAwB,6BAAA,GAAAA,6BAAA;AAxCJ,SAASM,qBAAqBA,CAACC,uBAA+B,EAAEC,MAAyB;EACrF,IAAIA,MAAM,CAACC,QAAQ,EAAE,IAAID,MAAM,CAACE,OAAO,EAAE,EAAE;IAEvC,IAAIC,GAAC,GAAG,EAAE;IAEV,IAAMC,QAAQ,GAAGJ,MAAM,CAACK,WAAW,EAAE;IACrC,IAAMC,SAAS,GAAGN,MAAM,CAACO,aAAa,EAAE;IAExC,IAAIH,QAAQ,KAAK,IAAI,EAAE;MACnBD,GAAC,IAAIC,QAAQ,CAACrC,QAAQ,EAAE,GAAG,IAAI;;IAGnC,IAAIuC,SAAS,KAAK,IAAI,EAAE;MACpBA,SAAS,CAAC/B,OAAO,CAAC,UAACiC,GAAG;QAClBL,GAAC,IAAIK,GAAG,CAACzC,QAAQ,EAAE,GAAG,IAAI;MAC9B,CAAC,CAAC;;IAGN,OAAO,MAAIgC,uBAAuB,WAAMA,uBAAuB,WAAMI,GAAG;GAE3E,MAAM;IACH,OAAO,MAAIJ,uBAAyB;;AAE5C;AAgBI/B,OAAA,CAAA8B,qBAAA,GAAAA,qBAAA;AAdJ,SAASpB,eAAeA,CAAC+B,CAAM;EAC3B,IAAIA,CAAC,CAAC3C,IAAI,EAAE;IACR,OAAO2C,CAAC,CAAC3C,IAAI;GAChB,MAAM;IACH,IAAM4C,MAAI,GAAGD,CAAC,CAAC1C,QAAQ,EAAE;IACzB,IAAM4C,KAAK,GAAGD,MAAI,CAACC,KAAK,CAAC,uBAAuB,CAAC;IACjD,OAAOA,KAAK,GAAGA,KAAK,CAAC,CAAC,CAAC,GAAG,yBAAuBD,MAAM;;AAE/D;AAGI1C,OAAA,CAAAU,eAAA,GAAAA,eAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}
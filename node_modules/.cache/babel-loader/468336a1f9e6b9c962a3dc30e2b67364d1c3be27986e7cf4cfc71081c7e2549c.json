{"ast":null,"code":"import { getTextWidth, getTextHeight, assembleFont } from '../util/text';\nexport default function (shape) {\n  var attrs = shape.attr();\n  var x = attrs.x,\n    y = attrs.y,\n    text = attrs.text,\n    fontSize = attrs.fontSize,\n    lineHeight = attrs.lineHeight;\n  var font = attrs.font;\n  if (!font) {\n    // 如果未组装 font\n    font = assembleFont(attrs);\n  }\n  var width = getTextWidth(text, font);\n  var bbox;\n  if (!width) {\n    // 如果width不存在，四点共其实点\n    bbox = {\n      x: x,\n      y: y,\n      width: 0,\n      height: 0\n    };\n  } else {\n    var textAlign = attrs.textAlign,\n      textBaseline = attrs.textBaseline;\n    var height = getTextHeight(text, fontSize, lineHeight); // attrs.height\n    // 默认左右对齐：left, 默认上下对齐 bottom\n    var point = {\n      x: x,\n      y: y - height\n    };\n    if (textAlign) {\n      if (textAlign === 'end' || textAlign === 'right') {\n        point.x -= width;\n      } else if (textAlign === 'center') {\n        point.x -= width / 2;\n      }\n    }\n    if (textBaseline) {\n      if (textBaseline === 'top') {\n        point.y += height;\n      } else if (textBaseline === 'middle') {\n        point.y += height / 2;\n      }\n    }\n    bbox = {\n      x: point.x,\n      y: point.y,\n      width: width,\n      height: height\n    };\n  }\n  return bbox;\n}","map":{"version":3,"names":["getTextWidth","getTextHeight","assembleFont","shape","attrs","attr","x","y","text","fontSize","lineHeight","font","width","bbox","height","textAlign","textBaseline","point"],"sources":["../../src/bbox/text.ts"],"sourcesContent":[null],"mappings":"AAEA,SAASA,YAAY,EAAEC,aAAa,EAAEC,YAAY,QAAQ,cAAc;AAExE,eAAc,UAAWC,KAAa;EACpC,IAAMC,KAAK,GAAGD,KAAK,CAACE,IAAI,EAAE;EAClB,IAAAC,CAAC,GAAoCF,KAAK,CAAAE,CAAzC;IAAEC,CAAC,GAAiCH,KAAK,CAAAG,CAAtC;IAAEC,IAAI,GAA2BJ,KAAK,CAAAI,IAAhC;IAAEC,QAAQ,GAAiBL,KAAK,CAAAK,QAAtB;IAAEC,UAAU,GAAKN,KAAK,CAAAM,UAAV;EACxC,IAAIC,IAAI,GAAGP,KAAK,CAACO,IAAI;EACrB,IAAI,CAACA,IAAI,EAAE;IACT;IACAA,IAAI,GAAGT,YAAY,CAACE,KAAK,CAAC;;EAE5B,IAAMQ,KAAK,GAAGZ,YAAY,CAACQ,IAAI,EAAEG,IAAI,CAAC;EACtC,IAAIE,IAAI;EACR,IAAI,CAACD,KAAK,EAAE;IACV;IACAC,IAAI,GAAG;MACLP,CAAC,EAAAA,CAAA;MACDC,CAAC,EAAAA,CAAA;MACDK,KAAK,EAAE,CAAC;MACRE,MAAM,EAAE;KACT;GACF,MAAM;IACG,IAAAC,SAAS,GAAmBX,KAAK,CAAAW,SAAxB;MAAEC,YAAY,GAAKZ,KAAK,CAAAY,YAAV;IAC/B,IAAMF,MAAM,GAAGb,aAAa,CAACO,IAAI,EAAEC,QAAQ,EAAEC,UAAU,CAAC,CAAC,CAAC;IAC1D;IACA,IAAMO,KAAK,GAAG;MACZX,CAAC,EAAAA,CAAA;MACDC,CAAC,EAAEA,CAAC,GAAGO;KACR;IACD,IAAIC,SAAS,EAAE;MACb,IAAIA,SAAS,KAAK,KAAK,IAAIA,SAAS,KAAK,OAAO,EAAE;QAChDE,KAAK,CAACX,CAAC,IAAIM,KAAK;OACjB,MAAM,IAAIG,SAAS,KAAK,QAAQ,EAAE;QACjCE,KAAK,CAACX,CAAC,IAAIM,KAAK,GAAG,CAAC;;;IAGxB,IAAII,YAAY,EAAE;MAChB,IAAIA,YAAY,KAAK,KAAK,EAAE;QAC1BC,KAAK,CAACV,CAAC,IAAIO,MAAM;OAClB,MAAM,IAAIE,YAAY,KAAK,QAAQ,EAAE;QACpCC,KAAK,CAACV,CAAC,IAAIO,MAAM,GAAG,CAAC;;;IAIzBD,IAAI,GAAG;MACLP,CAAC,EAAEW,KAAK,CAACX,CAAC;MACVC,CAAC,EAAEU,KAAK,CAACV,CAAC;MACVK,KAAK,EAAEA,KAAK;MACZE,MAAM,EAAEA;KACT;;EAEH,OAAOD,IAAI;AACb"},"metadata":{},"sourceType":"module","externalDependencies":[]}
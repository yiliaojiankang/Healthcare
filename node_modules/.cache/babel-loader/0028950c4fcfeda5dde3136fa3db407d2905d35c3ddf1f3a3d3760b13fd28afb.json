{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { __awaiter, __extends, __generator } from \"tslib\";\nimport { Canvas as GCanvas } from '@antv/g-canvas';\nimport { Canvas as GSVGCanvas } from '@antv/g-svg';\nimport { AbstractGraph } from '@antv/g6-core';\nimport { ext } from '@antv/matrix-util';\nimport { clone, deepMix, each, isNumber, isString } from '@antv/util';\nimport { createDom } from '@antv/dom-util';\nimport Global from '../global';\nimport { cloneGElement } from '../util/image';\nimport { EventController, LayoutController } from './controller';\nvar transform = ext.transform;\nvar SVG = 'svg';\nvar Graph = /** @class */function (_super) {\n  __extends(Graph, _super);\n  function Graph(cfg) {\n    var _this = _super.call(this, cfg) || this;\n    var defaultNode = _this.get('defaultNode');\n    if (!defaultNode) {\n      _this.set('defaultNode', {\n        type: 'circle'\n      });\n    }\n    if (!defaultNode.type) {\n      defaultNode.type = 'circle';\n      _this.set('defaultNode', defaultNode);\n    }\n    _this.destroyed = false;\n    return _this;\n  }\n  Graph.prototype.initLayoutController = function () {\n    var layoutController = new LayoutController(this);\n    this.set({\n      layoutController: layoutController\n    });\n  };\n  Graph.prototype.initEventController = function () {\n    var eventController = new EventController(this);\n    this.set({\n      eventController: eventController\n    });\n  };\n  Graph.prototype.initCanvas = function () {\n    var container = this.get('container');\n    if (typeof container === 'string') {\n      container = document.getElementById(container);\n      this.set('container', container);\n    }\n    if (!container) {\n      throw new Error('invalid container');\n    }\n    var clientWidth = container.clientWidth,\n      clientHeight = container.clientHeight;\n    var width = this.get('width') || clientWidth;\n    var height = this.get('height') || clientHeight;\n    if (!this.get('width') && !this.get('height')) {\n      this.set('width', clientWidth);\n      this.set('height', clientHeight);\n    }\n    var renderer = this.get('renderer');\n    var canvas;\n    if (renderer === SVG) {\n      canvas = new GSVGCanvas({\n        container: container,\n        width: width,\n        height: height\n      });\n    } else {\n      var canvasCfg = {\n        container: container,\n        width: width,\n        height: height\n      };\n      var pixelRatio = this.get('pixelRatio');\n      if (pixelRatio) {\n        canvasCfg.pixelRatio = pixelRatio;\n        window.devicePixelRatio = pixelRatio;\n      }\n      canvas = new GCanvas(canvasCfg);\n    }\n    this.set('canvas', canvas);\n  };\n  Graph.prototype.initPlugins = function () {\n    var self = this;\n    each(self.get('plugins'), function (plugin) {\n      if (!plugin.destroyed && plugin.initPlugin) {\n        plugin.initPlugin(self);\n      }\n    });\n  };\n  /**\n   * 增加图片下载水印功能\n   */\n  Graph.prototype.downloadImageWatermark = function (watermarker, context, width, height) {\n    return __awaiter(this, void 0, void 0, function () {\n      var watermarkStr, watermarkbase64, img;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            watermarkStr = watermarker.style.backgroundImage;\n            watermarkbase64 = watermarkStr.slice(5, watermarkStr.length - 2);\n            img = new Image();\n            img.src = watermarkbase64;\n            return [4 /*yield*/, new Promise(function (resolve) {\n              img.onload = function () {\n                var pat = context.createPattern(img, 'repeat');\n                context.rect(0, 0, width, height);\n                context.fillStyle = pat;\n                context.fill();\n                resolve('');\n              };\n            })];\n          case 1:\n            _a.sent();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  /**\n   * 用于生成图片 (异步callback)\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {string} backgroundColor 图片背景色\n   * @return {string} 图片 dataURL\n   */\n  Graph.prototype.asyncToDataUrl = function (type, backgroundColor, callback, widths, heights, vCanvasEl) {\n    var _this = this;\n    var watermarker = document.querySelector('.g6-graph-watermarker');\n    var canvas = this.get('canvas');\n    var renderer = canvas.getRenderer();\n    var canvasDom = vCanvasEl || canvas.get('el');\n    var dataURL = '';\n    if (!type) type = 'image/png';\n    setTimeout(function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var cloneNode, svgDocType, svgDoc, svgData, imageData, context, width, height, compositeOperation, pixelRatio;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!(renderer === 'svg')) return [3 /*break*/, 1];\n              cloneNode = canvasDom.cloneNode(true);\n              svgDocType = document.implementation.createDocumentType('svg', '-//W3C//DTD SVG 1.1//EN', 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd');\n              svgDoc = document.implementation.createDocument('http://www.w3.org/2000/svg', 'svg', svgDocType);\n              svgDoc.replaceChild(cloneNode, svgDoc.documentElement);\n              svgData = new XMLSerializer().serializeToString(svgDoc);\n              dataURL = \"data:image/svg+xml;charset=utf8,\".concat(encodeURIComponent(svgData));\n              return [3 /*break*/, 4];\n            case 1:\n              imageData = void 0;\n              context = canvasDom.getContext('2d');\n              width = widths || this.get('width');\n              height = heights || this.get('height');\n              compositeOperation = void 0;\n              if (!watermarker) return [3 /*break*/, 3];\n              return [4 /*yield*/, this.downloadImageWatermark(watermarker, context, width, height)];\n            case 2:\n              _a.sent();\n              _a.label = 3;\n            case 3:\n              if (backgroundColor) {\n                pixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio : 1;\n                try {\n                  imageData = context.getImageData(0, 0, width * pixelRatio, height * pixelRatio);\n                  compositeOperation = context.globalCompositeOperation;\n                  context.globalCompositeOperation = 'destination-over';\n                  context.fillStyle = backgroundColor;\n                  context.fillRect(0, 0, width, height);\n                } catch (error) {\n                  console.error('Download image failed. Out of memory at ImageData creation');\n                }\n              }\n              dataURL = canvasDom.toDataURL(type);\n              if (backgroundColor) {\n                context.clearRect(0, 0, width, height);\n                context.putImageData(imageData, 0, 0);\n                context.globalCompositeOperation = compositeOperation;\n              }\n              _a.label = 4;\n            case 4:\n              if (callback) callback(dataURL);\n              return [2 /*return*/];\n          }\n        });\n      });\n    }, 16);\n  };\n  /**\n   * 返回可见区域的图的 dataUrl，用于生成图片\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {string} backgroundColor 图片背景色\n   * @return {string} 图片 dataURL\n   */\n  Graph.prototype.toDataURL = function (type, backgroundColor) {\n    var canvas = this.get('canvas');\n    var renderer = canvas.getRenderer();\n    var canvasDom = canvas.get('el');\n    if (!type) type = 'image/png';\n    var dataURL = '';\n    if (renderer === 'svg') {\n      var cloneNode = canvasDom.cloneNode(true);\n      var svgDocType = document.implementation.createDocumentType('svg', '-//W3C//DTD SVG 1.1//EN', 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd');\n      var svgDoc = document.implementation.createDocument('http://www.w3.org/2000/svg', 'svg', svgDocType);\n      svgDoc.replaceChild(cloneNode, svgDoc.documentElement);\n      var svgData = new XMLSerializer().serializeToString(svgDoc);\n      dataURL = \"data:image/svg+xml;charset=utf8,\".concat(encodeURIComponent(svgData));\n    } else {\n      var imageData = void 0;\n      var context = canvasDom.getContext('2d');\n      var width = Math.max(this.get('width'), 500);\n      var height = Math.max(this.get('height'), 500);\n      var compositeOperation = void 0;\n      if (backgroundColor) {\n        var pixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio || 1 : 1;\n        try {\n          imageData = context.getImageData(0, 0, width * pixelRatio, height * pixelRatio);\n          compositeOperation = context.globalCompositeOperation;\n          context.globalCompositeOperation = 'destination-over';\n          context.fillStyle = backgroundColor;\n          context.fillRect(0, 0, width, height);\n        } catch (error) {\n          console.error('Download image failed. Out of memory at ImageData creation');\n        }\n      }\n      dataURL = canvasDom.toDataURL(type);\n      if (backgroundColor) {\n        context.clearRect(0, 0, width, height);\n        context.putImageData(imageData, 0, 0);\n        context.globalCompositeOperation = compositeOperation;\n      }\n    }\n    return dataURL;\n  };\n  /**\n   * 返回整个图（包括超出可见区域的部分）的 dataUrl，用于生成图片\n   * @param {Function} callback 异步生成 dataUrl 完成后的回调函数，在这里处理生成的 dataUrl 字符串\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {Object} imageConfig 图片配置项，包括背景色和上下左右的 padding\n   */\n  Graph.prototype.toFullDataURL = function (callback, type, imageConfig) {\n    var bbox = this.get('group').getCanvasBBox();\n    var height = bbox.height;\n    var width = bbox.width;\n    var renderer = this.get('renderer');\n    var vContainerDOM = createDom('<div id=\"virtual-image\"></div>');\n    var backgroundColor = imageConfig ? imageConfig.backgroundColor : undefined;\n    var padding = imageConfig ? imageConfig.padding : undefined;\n    if (!padding) padding = [0, 0, 0, 0];else if (isNumber(padding)) padding = [padding, padding, padding, padding];\n    var vHeight = height + padding[0] + padding[2];\n    var vWidth = width + padding[1] + padding[3];\n    var canvasOptions = {\n      container: vContainerDOM,\n      height: vHeight,\n      width: vWidth,\n      quickHit: true\n    };\n    var vCanvas = renderer === 'svg' ? new GSVGCanvas(canvasOptions) : new GCanvas(canvasOptions);\n    var group = this.get('group');\n    var vGroup = group.clone();\n    var matrix = clone(vGroup.getMatrix());\n    if (!matrix) matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    var centerX = (bbox.maxX + bbox.minX) / 2;\n    var centerY = (bbox.maxY + bbox.minY) / 2;\n    matrix = transform(matrix, [['t', -centerX, -centerY], ['t', width / 2 + padding[3], height / 2 + padding[0]]]);\n    vGroup.resetMatrix();\n    vGroup.setMatrix(matrix);\n    vCanvas.add(vGroup);\n    var vCanvasEl = vCanvas.get('el');\n    var dataURL = '';\n    if (!type) type = 'image/png';\n    setTimeout(function () {\n      if (renderer === 'svg') {\n        var cloneNode = vCanvasEl.cloneNode(true);\n        var svgDocType = document.implementation.createDocumentType('svg', '-//W3C//DTD SVG 1.1//EN', 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd');\n        var svgDoc = document.implementation.createDocument('http://www.w3.org/2000/svg', 'svg', svgDocType);\n        svgDoc.replaceChild(cloneNode, svgDoc.documentElement);\n        var svgData = new XMLSerializer().serializeToString(svgDoc);\n        dataURL = \"data:image/svg+xml;charset=utf8,\".concat(encodeURIComponent(svgData));\n      } else {\n        var imageData = void 0;\n        var context = vCanvasEl.getContext('2d');\n        var compositeOperation = void 0;\n        if (backgroundColor) {\n          var pixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio : 1;\n          try {\n            imageData = context.getImageData(0, 0, vWidth * pixelRatio, vHeight * pixelRatio);\n            compositeOperation = context.globalCompositeOperation;\n            context.globalCompositeOperation = 'destination-over';\n            context.fillStyle = backgroundColor;\n            context.fillRect(0, 0, vWidth, vHeight);\n          } catch (error) {\n            console.error('Download image failed. Out of memory at ImageData creation');\n          }\n        }\n        dataURL = vCanvasEl.toDataURL(type);\n        if (backgroundColor) {\n          context.clearRect(0, 0, vWidth, vHeight);\n          context.putImageData(imageData, 0, 0);\n          context.globalCompositeOperation = compositeOperation;\n        }\n      }\n      if (callback) callback(dataURL);\n    }, 16);\n  };\n  /**\n   * 导出包含全图的图片\n   * @param {String} name 图片的名称\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {Object} imageConfig 图片配置项，包括背景色和上下左右的 padding\n   */\n  Graph.prototype.downloadFullImage = function (name, type, imageConfig) {\n    var _this = this;\n    var bbox = this.get('group').getCanvasBBox();\n    var height = bbox.height;\n    var width = bbox.width;\n    var renderer = this.get('renderer');\n    var vContainerDOM = createDom('<div id=\"virtual-image\"></div>');\n    var watermarker = document.querySelector('.g6-graph-watermarker');\n    var backgroundColor = imageConfig ? imageConfig.backgroundColor : undefined;\n    var padding = imageConfig ? imageConfig.padding : undefined;\n    if (!padding) padding = [0, 0, 0, 0];else if (isNumber(padding)) padding = [padding, padding, padding, padding];\n    var vHeight = height + padding[0] + padding[2];\n    var vWidth = width + padding[1] + padding[3];\n    if (watermarker) {\n      var _a = this.get('graphWaterMarker').cfg || {},\n        wmWidth = _a.width,\n        wmHeight = _a.height;\n      vHeight = Math.ceil(vHeight / wmHeight) * wmHeight;\n      vWidth = Math.ceil(vWidth / wmWidth) * wmWidth;\n    }\n    var canvasOptions = {\n      container: vContainerDOM,\n      height: vHeight,\n      width: vWidth\n    };\n    var vCanvas = renderer === 'svg' ? new GSVGCanvas(canvasOptions) : new GCanvas(canvasOptions);\n    var group = this.get('group');\n    // clone group and clone image shape's clip\n    var vGroup = cloneGElement(group);\n    var matrix = clone(vGroup.getMatrix());\n    if (!matrix) matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    var centerX = (bbox.maxX + bbox.minX) / 2;\n    var centerY = (bbox.maxY + bbox.minY) / 2;\n    matrix = transform(matrix, [['t', -centerX, -centerY], ['t', width / 2 + padding[3], height / 2 + padding[0]]]);\n    vGroup.resetMatrix();\n    vGroup.setMatrix(matrix);\n    vCanvas.add(vGroup);\n    var vCanvasEl = vCanvas.get('el');\n    if (!type) type = 'image/png';\n    this.asyncToDataUrl(type, backgroundColor, function (dataURL) {\n      var link = document.createElement('a');\n      var fileName = (name || 'graph') + (renderer === 'svg' ? '.svg' : \".\".concat(type.split('/')[1]));\n      _this.dataURLToImage(dataURL, renderer, link, fileName);\n      var e = document.createEvent('MouseEvents');\n      e.initEvent('click', false, false);\n      link.dispatchEvent(e);\n    }, vWidth, vHeight, vCanvasEl);\n  };\n  /**\n   * 画布导出图片，图片仅包含画布可见区域部分内容\n   * @param {String} name 图片的名称\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {string} backgroundColor 图片背景色\n   */\n  Graph.prototype.downloadImage = function (name, type, backgroundColor) {\n    var _this = this;\n    var self = this;\n    self.stopAnimate();\n    var canvas = self.get('canvas');\n    var renderer = canvas.getRenderer();\n    if (!type) type = 'image/png';\n    var fileName = (name || 'graph') + (renderer === 'svg' ? '.svg' : \".\".concat(type.split('/')[1]));\n    var link = document.createElement('a');\n    self.asyncToDataUrl(type, backgroundColor, function (dataURL) {\n      _this.dataURLToImage(dataURL, renderer, link, fileName);\n      var e = document.createEvent('MouseEvents');\n      e.initEvent('click', false, false);\n      link.dispatchEvent(e);\n    });\n  };\n  Graph.prototype.dataURLToImage = function (dataURL, renderer, link, fileName) {\n    if (!dataURL || dataURL === 'data:') {\n      console.error('Download image failed. The graph is too large or there is invalid attribute values in graph items');\n      return;\n    }\n    if (typeof window !== 'undefined') {\n      if (window.Blob && window.URL && renderer !== 'svg') {\n        var arr = dataURL.split(',');\n        var mime = '';\n        if (arr && arr.length > 0) {\n          var match = arr[0].match(/:(.*?);/);\n          // eslint-disable-next-line prefer-destructuring\n          if (match && match.length >= 2) mime = match[1];\n        }\n        var bstr = atob(arr[1]);\n        var n = bstr.length;\n        var u8arr = new Uint8Array(n);\n        while (n--) {\n          u8arr[n] = bstr.charCodeAt(n);\n        }\n        var blobObj_1 = new Blob([u8arr], {\n          type: mime\n        });\n        if (window.navigator.msSaveBlob) {\n          window.navigator.msSaveBlob(blobObj_1, fileName);\n        } else {\n          link.addEventListener('click', function () {\n            link.download = fileName;\n            link.href = window.URL.createObjectURL(blobObj_1);\n          });\n        }\n      } else {\n        link.addEventListener('click', function () {\n          link.download = fileName;\n          link.href = dataURL;\n        });\n      }\n    }\n  };\n  /**\n   * 添加插件\n   * @param {object} plugin 插件实例\n   */\n  Graph.prototype.addPlugin = function (plugin) {\n    var self = this;\n    if (plugin.destroyed) {\n      return;\n    }\n    self.get('plugins').push(plugin);\n    plugin.initPlugin(self);\n  };\n  /**\n   * 添加插件\n   * @param {object} plugin 插件实例\n   */\n  Graph.prototype.removePlugin = function (plugin) {\n    var plugins = this.get('plugins');\n    var index = plugins.indexOf(plugin);\n    if (index >= 0) {\n      plugin.destroyPlugin();\n      plugins.splice(index, 1);\n    }\n  };\n  /**\n   * 设置图片水印\n   * @param {string} imgURL 图片水印的url地址\n   * @param {WaterMarkerConfig} config 文本水印的配置项\n   */\n  Graph.prototype.setImageWaterMarker = function (imgURL, config) {\n    if (imgURL === void 0) {\n      imgURL = Global.waterMarkerImage;\n    }\n    var container = this.get('container');\n    if (isString(container)) {\n      container = document.getElementById(container);\n    }\n    if (!container.style.position) {\n      container.style.position = 'relative';\n    }\n    var canvas = this.get('graphWaterMarker');\n    var waterMarkerConfig = deepMix({}, Global.imageWaterMarkerConfig, config);\n    var width = waterMarkerConfig.width,\n      height = waterMarkerConfig.height,\n      compatible = waterMarkerConfig.compatible,\n      image = waterMarkerConfig.image;\n    if (!imgURL) {\n      var dom = compatible ? container : document.querySelector('.g6-graph-watermarker');\n      if (dom) dom.style.cssText = undefined;\n      if (canvas) canvas.clear();\n      return;\n    }\n    if (!canvas) {\n      var canvasCfg = {\n        container: container,\n        width: width,\n        height: height,\n        capture: false\n      };\n      var pixelRatio = this.get('pixelRatio');\n      if (pixelRatio) {\n        canvasCfg.pixelRatio = pixelRatio;\n        window.devicePixelRatio = pixelRatio;\n      }\n      canvas = new GCanvas(canvasCfg);\n      this.set('graphWaterMarker', canvas);\n    } else {\n      canvas.clear();\n    }\n    canvas.get('el').style.display = 'none';\n    var ctx = canvas.get('context');\n    var rotate = image.rotate,\n      x = image.x,\n      y = image.y;\n    // 旋转20度\n    ctx.rotate(-rotate * Math.PI / 180);\n    var img = new Image();\n    img.crossOrigin = 'anonymous';\n    img.src = imgURL;\n    img.onload = function () {\n      ctx.drawImage(img, x, y, image.width, image.height);\n      // 恢复旋转角度\n      ctx.rotate(rotate * Math.PI / 180);\n      // 默认按照现代浏览器处理\n      if (!compatible) {\n        var box = document.querySelector('.g6-graph-watermarker');\n        if (!box) {\n          box = document.createElement('div');\n          box.className = 'g6-graph-watermarker';\n        }\n        box.className = 'g6-graph-watermarker';\n        if (!canvas.destroyed) {\n          box.style.cssText = \"background-image: url(\".concat(canvas.get('el').toDataURL('image/png'), \");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;\");\n          container.appendChild(box);\n        }\n      } else {\n        // 当需要兼容不支持 pointer-events属性的浏览器时，将 compatible 设置为 true\n        container.style.cssText = \"background-image: url(\".concat(canvas.get('el').toDataURL('image/png'), \");background-repeat:repeat;\");\n      }\n    };\n  };\n  /**\n   * 设置文本水印\n   * @param {string[]} texts 水印的文本内容\n   * @param {WaterMarkerConfig} config 文本水印的配置项\n   */\n  Graph.prototype.setTextWaterMarker = function (texts, config) {\n    var container = this.get('container');\n    if (isString(container)) {\n      container = document.getElementById(container);\n    }\n    if (!container.style.position) {\n      container.style.position = 'relative';\n    }\n    var canvas = this.get('graphWaterMarker');\n    var waterMarkerConfig = deepMix({}, Global.textWaterMarkerConfig, config);\n    var width = waterMarkerConfig.width,\n      height = waterMarkerConfig.height,\n      compatible = waterMarkerConfig.compatible,\n      text = waterMarkerConfig.text;\n    if (!(texts === null || texts === void 0 ? void 0 : texts.length)) {\n      var dom = compatible ? container : document.querySelector('.g6-graph-watermarker');\n      if (dom) dom.style.cssText = undefined;\n      if (canvas) canvas.clear();\n      return;\n    }\n    if (!canvas) {\n      var canvasCfg = {\n        container: container,\n        width: width,\n        height: height,\n        capture: false\n      };\n      var pixelRatio = this.get('pixelRatio');\n      if (pixelRatio) {\n        canvasCfg.pixelRatio = pixelRatio;\n        window.devicePixelRatio = pixelRatio;\n      }\n      canvas = new GCanvas(canvasCfg);\n      this.set('graphWaterMarker', canvas);\n    } else {\n      canvas.clear();\n    }\n    canvas.get('el').style.display = 'none';\n    var ctx = canvas.get('context');\n    var rotate = text.rotate,\n      fill = text.fill,\n      fontFamily = text.fontFamily,\n      fontSize = text.fontSize,\n      baseline = text.baseline,\n      x = text.x,\n      y = text.y,\n      lineHeight = text.lineHeight;\n    // 旋转20度\n    ctx.rotate(-rotate * Math.PI / 180);\n    // 设置文字样式\n    ctx.font = \"\".concat(fontSize, \"px \").concat(fontFamily);\n    // 设置文字颜色\n    ctx.fillStyle = fill;\n    ctx.textBaseline = baseline;\n    var displayTexts = isString(texts) ? [texts] : texts;\n    for (var i = displayTexts.length - 1; i >= 0; i--) {\n      // 将文字绘制到画布\n      ctx.fillText(displayTexts[i], x, y + i * lineHeight);\n    }\n    // 恢复旋转角度\n    ctx.rotate(rotate * Math.PI / 180);\n    // 默认按照现代浏览器处理\n    if (!compatible) {\n      var box = document.querySelector('.g6-graph-watermarker');\n      if (!box) {\n        box = document.createElement('div');\n        box.className = 'g6-graph-watermarker';\n      }\n      box.style.cssText = \"background-image: url(\".concat(canvas.get('el').toDataURL('image/png'), \");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;\");\n      container.appendChild(box);\n    } else {\n      // 当需要兼容不支持 pointer-events属性的浏览器时，将 compatible 设置为 true\n      container.style.cssText = \"background-image: url(\".concat(canvas.get('el').toDataURL('image/png'), \");background-repeat:repeat;\");\n    }\n  };\n  /**\n   * 销毁画布\n   */\n  Graph.prototype.destroy = function () {\n    var _a, _b, _c, _d;\n    each(this.get('plugins'), function (plugin) {\n      plugin.destroyPlugin();\n    });\n    // destroy tooltip doms, removed when upgrade G6 4.0\n    var tooltipDOMs = this.get('tooltips');\n    if (tooltipDOMs) {\n      for (var i = 0; i < tooltipDOMs.length; i++) {\n        var container = tooltipDOMs[i];\n        if (!container) continue;\n        var parent_1 = container.parentElement;\n        if (!parent_1) continue;\n        parent_1.removeChild(container);\n      }\n    }\n    (_a = this.get('eventController')) === null || _a === void 0 ? void 0 : _a.destroy();\n    (_b = this.get('layoutController')) === null || _b === void 0 ? void 0 : _b.destroy();\n    // this.get('eventController').destroy();\n    // this.get('itemController').destroy();\n    // this.get('modeController').destroy();\n    // this.get('viewController').destroy();\n    // this.get('stateController').destroy();\n    // this.get('canvas').destroy();\n    (_c = this.get('graphWaterMarker')) === null || _c === void 0 ? void 0 : _c.destroy();\n    (_d = document.querySelector('.g6-graph-watermarker')) === null || _d === void 0 ? void 0 : _d.remove();\n    _super.prototype.destroy.call(this);\n  };\n  return Graph;\n}(AbstractGraph);\nexport default Graph;","map":{"version":3,"names":["__awaiter","__extends","__generator","Canvas","GCanvas","GSVGCanvas","AbstractGraph","ext","clone","deepMix","each","isNumber","isString","createDom","Global","cloneGElement","EventController","LayoutController","transform","SVG","Graph","_super","cfg","_this","call","defaultNode","get","set","type","destroyed","prototype","initLayoutController","layoutController","initEventController","eventController","initCanvas","container","document","getElementById","Error","clientWidth","clientHeight","width","height","renderer","canvas","canvasCfg","pixelRatio","window","devicePixelRatio","initPlugins","self","plugin","initPlugin","downloadImageWatermark","watermarker","context","watermarkStr","watermarkbase64","img","_a","label","style","backgroundImage","slice","length","Image","src","Promise","resolve","onload","pat","createPattern","rect","fillStyle","fill","sent","asyncToDataUrl","backgroundColor","callback","widths","heights","vCanvasEl","querySelector","getRenderer","canvasDom","dataURL","setTimeout","cloneNode","svgDocType","svgDoc","svgData","imageData","compositeOperation","implementation","createDocumentType","createDocument","replaceChild","documentElement","XMLSerializer","serializeToString","concat","encodeURIComponent","getContext","getImageData","globalCompositeOperation","fillRect","error","console","toDataURL","clearRect","putImageData","Math","max","toFullDataURL","imageConfig","bbox","getCanvasBBox","vContainerDOM","undefined","padding","vHeight","vWidth","canvasOptions","quickHit","vCanvas","group","vGroup","matrix","getMatrix","centerX","maxX","minX","centerY","maxY","minY","resetMatrix","setMatrix","add","downloadFullImage","name","wmWidth","wmHeight","ceil","link","createElement","fileName","split","dataURLToImage","e","createEvent","initEvent","dispatchEvent","downloadImage","stopAnimate","Blob","URL","arr","mime","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","blobObj_1","navigator","msSaveBlob","addEventListener","download","href","createObjectURL","addPlugin","push","removePlugin","plugins","index","indexOf","destroyPlugin","splice","setImageWaterMarker","imgURL","config","waterMarkerImage","position","waterMarkerConfig","imageWaterMarkerConfig","compatible","image","dom","cssText","clear","capture","display","ctx","rotate","x","y","PI","crossOrigin","drawImage","box","className","appendChild","setTextWaterMarker","texts","textWaterMarkerConfig","text","fontFamily","fontSize","baseline","lineHeight","font","textBaseline","displayTexts","i","fillText","destroy","_b","_c","_d","tooltipDOMs","parent_1","parentElement","removeChild","remove"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/g6-pc/es/graph/graph.js"],"sourcesContent":["import { __awaiter, __extends, __generator } from \"tslib\";\nimport { Canvas as GCanvas } from '@antv/g-canvas';\nimport { Canvas as GSVGCanvas } from '@antv/g-svg';\nimport { AbstractGraph } from '@antv/g6-core';\nimport { ext } from '@antv/matrix-util';\nimport { clone, deepMix, each, isNumber, isString } from '@antv/util';\nimport { createDom } from '@antv/dom-util';\nimport Global from '../global';\nimport { cloneGElement } from '../util/image';\nimport { EventController, LayoutController } from './controller';\nvar transform = ext.transform;\nvar SVG = 'svg';\nvar Graph = /** @class */function (_super) {\n  __extends(Graph, _super);\n  function Graph(cfg) {\n    var _this = _super.call(this, cfg) || this;\n    var defaultNode = _this.get('defaultNode');\n    if (!defaultNode) {\n      _this.set('defaultNode', {\n        type: 'circle'\n      });\n    }\n    if (!defaultNode.type) {\n      defaultNode.type = 'circle';\n      _this.set('defaultNode', defaultNode);\n    }\n    _this.destroyed = false;\n    return _this;\n  }\n  Graph.prototype.initLayoutController = function () {\n    var layoutController = new LayoutController(this);\n    this.set({\n      layoutController: layoutController\n    });\n  };\n  Graph.prototype.initEventController = function () {\n    var eventController = new EventController(this);\n    this.set({\n      eventController: eventController\n    });\n  };\n  Graph.prototype.initCanvas = function () {\n    var container = this.get('container');\n    if (typeof container === 'string') {\n      container = document.getElementById(container);\n      this.set('container', container);\n    }\n    if (!container) {\n      throw new Error('invalid container');\n    }\n    var clientWidth = container.clientWidth,\n      clientHeight = container.clientHeight;\n    var width = this.get('width') || clientWidth;\n    var height = this.get('height') || clientHeight;\n    if (!this.get('width') && !this.get('height')) {\n      this.set('width', clientWidth);\n      this.set('height', clientHeight);\n    }\n    var renderer = this.get('renderer');\n    var canvas;\n    if (renderer === SVG) {\n      canvas = new GSVGCanvas({\n        container: container,\n        width: width,\n        height: height\n      });\n    } else {\n      var canvasCfg = {\n        container: container,\n        width: width,\n        height: height\n      };\n      var pixelRatio = this.get('pixelRatio');\n      if (pixelRatio) {\n        canvasCfg.pixelRatio = pixelRatio;\n        window.devicePixelRatio = pixelRatio;\n      }\n      canvas = new GCanvas(canvasCfg);\n    }\n    this.set('canvas', canvas);\n  };\n  Graph.prototype.initPlugins = function () {\n    var self = this;\n    each(self.get('plugins'), function (plugin) {\n      if (!plugin.destroyed && plugin.initPlugin) {\n        plugin.initPlugin(self);\n      }\n    });\n  };\n  /**\n   * 增加图片下载水印功能\n   */\n  Graph.prototype.downloadImageWatermark = function (watermarker, context, width, height) {\n    return __awaiter(this, void 0, void 0, function () {\n      var watermarkStr, watermarkbase64, img;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            watermarkStr = watermarker.style.backgroundImage;\n            watermarkbase64 = watermarkStr.slice(5, watermarkStr.length - 2);\n            img = new Image();\n            img.src = watermarkbase64;\n            return [4 /*yield*/, new Promise(function (resolve) {\n              img.onload = function () {\n                var pat = context.createPattern(img, 'repeat');\n                context.rect(0, 0, width, height);\n                context.fillStyle = pat;\n                context.fill();\n                resolve('');\n              };\n            })];\n          case 1:\n            _a.sent();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  /**\n   * 用于生成图片 (异步callback)\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {string} backgroundColor 图片背景色\n   * @return {string} 图片 dataURL\n   */\n  Graph.prototype.asyncToDataUrl = function (type, backgroundColor, callback, widths, heights, vCanvasEl) {\n    var _this = this;\n    var watermarker = document.querySelector('.g6-graph-watermarker');\n    var canvas = this.get('canvas');\n    var renderer = canvas.getRenderer();\n    var canvasDom = vCanvasEl || canvas.get('el');\n    var dataURL = '';\n    if (!type) type = 'image/png';\n    setTimeout(function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var cloneNode, svgDocType, svgDoc, svgData, imageData, context, width, height, compositeOperation, pixelRatio;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!(renderer === 'svg')) return [3 /*break*/, 1];\n              cloneNode = canvasDom.cloneNode(true);\n              svgDocType = document.implementation.createDocumentType('svg', '-//W3C//DTD SVG 1.1//EN', 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd');\n              svgDoc = document.implementation.createDocument('http://www.w3.org/2000/svg', 'svg', svgDocType);\n              svgDoc.replaceChild(cloneNode, svgDoc.documentElement);\n              svgData = new XMLSerializer().serializeToString(svgDoc);\n              dataURL = \"data:image/svg+xml;charset=utf8,\".concat(encodeURIComponent(svgData));\n              return [3 /*break*/, 4];\n            case 1:\n              imageData = void 0;\n              context = canvasDom.getContext('2d');\n              width = widths || this.get('width');\n              height = heights || this.get('height');\n              compositeOperation = void 0;\n              if (!watermarker) return [3 /*break*/, 3];\n              return [4 /*yield*/, this.downloadImageWatermark(watermarker, context, width, height)];\n            case 2:\n              _a.sent();\n              _a.label = 3;\n            case 3:\n              if (backgroundColor) {\n                pixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio : 1;\n                try {\n                  imageData = context.getImageData(0, 0, width * pixelRatio, height * pixelRatio);\n                  compositeOperation = context.globalCompositeOperation;\n                  context.globalCompositeOperation = 'destination-over';\n                  context.fillStyle = backgroundColor;\n                  context.fillRect(0, 0, width, height);\n                } catch (error) {\n                  console.error('Download image failed. Out of memory at ImageData creation');\n                }\n              }\n              dataURL = canvasDom.toDataURL(type);\n              if (backgroundColor) {\n                context.clearRect(0, 0, width, height);\n                context.putImageData(imageData, 0, 0);\n                context.globalCompositeOperation = compositeOperation;\n              }\n              _a.label = 4;\n            case 4:\n              if (callback) callback(dataURL);\n              return [2 /*return*/];\n          }\n        });\n      });\n    }, 16);\n  };\n  /**\n   * 返回可见区域的图的 dataUrl，用于生成图片\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {string} backgroundColor 图片背景色\n   * @return {string} 图片 dataURL\n   */\n  Graph.prototype.toDataURL = function (type, backgroundColor) {\n    var canvas = this.get('canvas');\n    var renderer = canvas.getRenderer();\n    var canvasDom = canvas.get('el');\n    if (!type) type = 'image/png';\n    var dataURL = '';\n    if (renderer === 'svg') {\n      var cloneNode = canvasDom.cloneNode(true);\n      var svgDocType = document.implementation.createDocumentType('svg', '-//W3C//DTD SVG 1.1//EN', 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd');\n      var svgDoc = document.implementation.createDocument('http://www.w3.org/2000/svg', 'svg', svgDocType);\n      svgDoc.replaceChild(cloneNode, svgDoc.documentElement);\n      var svgData = new XMLSerializer().serializeToString(svgDoc);\n      dataURL = \"data:image/svg+xml;charset=utf8,\".concat(encodeURIComponent(svgData));\n    } else {\n      var imageData = void 0;\n      var context = canvasDom.getContext('2d');\n      var width = Math.max(this.get('width'), 500);\n      var height = Math.max(this.get('height'), 500);\n      var compositeOperation = void 0;\n      if (backgroundColor) {\n        var pixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio || 1 : 1;\n        try {\n          imageData = context.getImageData(0, 0, width * pixelRatio, height * pixelRatio);\n          compositeOperation = context.globalCompositeOperation;\n          context.globalCompositeOperation = 'destination-over';\n          context.fillStyle = backgroundColor;\n          context.fillRect(0, 0, width, height);\n        } catch (error) {\n          console.error('Download image failed. Out of memory at ImageData creation');\n        }\n      }\n      dataURL = canvasDom.toDataURL(type);\n      if (backgroundColor) {\n        context.clearRect(0, 0, width, height);\n        context.putImageData(imageData, 0, 0);\n        context.globalCompositeOperation = compositeOperation;\n      }\n    }\n    return dataURL;\n  };\n  /**\n   * 返回整个图（包括超出可见区域的部分）的 dataUrl，用于生成图片\n   * @param {Function} callback 异步生成 dataUrl 完成后的回调函数，在这里处理生成的 dataUrl 字符串\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {Object} imageConfig 图片配置项，包括背景色和上下左右的 padding\n   */\n  Graph.prototype.toFullDataURL = function (callback, type, imageConfig) {\n    var bbox = this.get('group').getCanvasBBox();\n    var height = bbox.height;\n    var width = bbox.width;\n    var renderer = this.get('renderer');\n    var vContainerDOM = createDom('<div id=\"virtual-image\"></div>');\n    var backgroundColor = imageConfig ? imageConfig.backgroundColor : undefined;\n    var padding = imageConfig ? imageConfig.padding : undefined;\n    if (!padding) padding = [0, 0, 0, 0];else if (isNumber(padding)) padding = [padding, padding, padding, padding];\n    var vHeight = height + padding[0] + padding[2];\n    var vWidth = width + padding[1] + padding[3];\n    var canvasOptions = {\n      container: vContainerDOM,\n      height: vHeight,\n      width: vWidth,\n      quickHit: true\n    };\n    var vCanvas = renderer === 'svg' ? new GSVGCanvas(canvasOptions) : new GCanvas(canvasOptions);\n    var group = this.get('group');\n    var vGroup = group.clone();\n    var matrix = clone(vGroup.getMatrix());\n    if (!matrix) matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    var centerX = (bbox.maxX + bbox.minX) / 2;\n    var centerY = (bbox.maxY + bbox.minY) / 2;\n    matrix = transform(matrix, [['t', -centerX, -centerY], ['t', width / 2 + padding[3], height / 2 + padding[0]]]);\n    vGroup.resetMatrix();\n    vGroup.setMatrix(matrix);\n    vCanvas.add(vGroup);\n    var vCanvasEl = vCanvas.get('el');\n    var dataURL = '';\n    if (!type) type = 'image/png';\n    setTimeout(function () {\n      if (renderer === 'svg') {\n        var cloneNode = vCanvasEl.cloneNode(true);\n        var svgDocType = document.implementation.createDocumentType('svg', '-//W3C//DTD SVG 1.1//EN', 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd');\n        var svgDoc = document.implementation.createDocument('http://www.w3.org/2000/svg', 'svg', svgDocType);\n        svgDoc.replaceChild(cloneNode, svgDoc.documentElement);\n        var svgData = new XMLSerializer().serializeToString(svgDoc);\n        dataURL = \"data:image/svg+xml;charset=utf8,\".concat(encodeURIComponent(svgData));\n      } else {\n        var imageData = void 0;\n        var context = vCanvasEl.getContext('2d');\n        var compositeOperation = void 0;\n        if (backgroundColor) {\n          var pixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio : 1;\n          try {\n            imageData = context.getImageData(0, 0, vWidth * pixelRatio, vHeight * pixelRatio);\n            compositeOperation = context.globalCompositeOperation;\n            context.globalCompositeOperation = 'destination-over';\n            context.fillStyle = backgroundColor;\n            context.fillRect(0, 0, vWidth, vHeight);\n          } catch (error) {\n            console.error('Download image failed. Out of memory at ImageData creation');\n          }\n        }\n        dataURL = vCanvasEl.toDataURL(type);\n        if (backgroundColor) {\n          context.clearRect(0, 0, vWidth, vHeight);\n          context.putImageData(imageData, 0, 0);\n          context.globalCompositeOperation = compositeOperation;\n        }\n      }\n      if (callback) callback(dataURL);\n    }, 16);\n  };\n  /**\n   * 导出包含全图的图片\n   * @param {String} name 图片的名称\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {Object} imageConfig 图片配置项，包括背景色和上下左右的 padding\n   */\n  Graph.prototype.downloadFullImage = function (name, type, imageConfig) {\n    var _this = this;\n    var bbox = this.get('group').getCanvasBBox();\n    var height = bbox.height;\n    var width = bbox.width;\n    var renderer = this.get('renderer');\n    var vContainerDOM = createDom('<div id=\"virtual-image\"></div>');\n    var watermarker = document.querySelector('.g6-graph-watermarker');\n    var backgroundColor = imageConfig ? imageConfig.backgroundColor : undefined;\n    var padding = imageConfig ? imageConfig.padding : undefined;\n    if (!padding) padding = [0, 0, 0, 0];else if (isNumber(padding)) padding = [padding, padding, padding, padding];\n    var vHeight = height + padding[0] + padding[2];\n    var vWidth = width + padding[1] + padding[3];\n    if (watermarker) {\n      var _a = this.get('graphWaterMarker').cfg || {},\n        wmWidth = _a.width,\n        wmHeight = _a.height;\n      vHeight = Math.ceil(vHeight / wmHeight) * wmHeight;\n      vWidth = Math.ceil(vWidth / wmWidth) * wmWidth;\n    }\n    var canvasOptions = {\n      container: vContainerDOM,\n      height: vHeight,\n      width: vWidth\n    };\n    var vCanvas = renderer === 'svg' ? new GSVGCanvas(canvasOptions) : new GCanvas(canvasOptions);\n    var group = this.get('group');\n    // clone group and clone image shape's clip\n    var vGroup = cloneGElement(group);\n    var matrix = clone(vGroup.getMatrix());\n    if (!matrix) matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    var centerX = (bbox.maxX + bbox.minX) / 2;\n    var centerY = (bbox.maxY + bbox.minY) / 2;\n    matrix = transform(matrix, [['t', -centerX, -centerY], ['t', width / 2 + padding[3], height / 2 + padding[0]]]);\n    vGroup.resetMatrix();\n    vGroup.setMatrix(matrix);\n    vCanvas.add(vGroup);\n    var vCanvasEl = vCanvas.get('el');\n    if (!type) type = 'image/png';\n    this.asyncToDataUrl(type, backgroundColor, function (dataURL) {\n      var link = document.createElement('a');\n      var fileName = (name || 'graph') + (renderer === 'svg' ? '.svg' : \".\".concat(type.split('/')[1]));\n      _this.dataURLToImage(dataURL, renderer, link, fileName);\n      var e = document.createEvent('MouseEvents');\n      e.initEvent('click', false, false);\n      link.dispatchEvent(e);\n    }, vWidth, vHeight, vCanvasEl);\n  };\n  /**\n   * 画布导出图片，图片仅包含画布可见区域部分内容\n   * @param {String} name 图片的名称\n   * @param {String} type 图片类型，可选值：\"image/png\" | \"image/jpeg\" | \"image/webp\" | \"image/bmp\"\n   * @param {string} backgroundColor 图片背景色\n   */\n  Graph.prototype.downloadImage = function (name, type, backgroundColor) {\n    var _this = this;\n    var self = this;\n    self.stopAnimate();\n    var canvas = self.get('canvas');\n    var renderer = canvas.getRenderer();\n    if (!type) type = 'image/png';\n    var fileName = (name || 'graph') + (renderer === 'svg' ? '.svg' : \".\".concat(type.split('/')[1]));\n    var link = document.createElement('a');\n    self.asyncToDataUrl(type, backgroundColor, function (dataURL) {\n      _this.dataURLToImage(dataURL, renderer, link, fileName);\n      var e = document.createEvent('MouseEvents');\n      e.initEvent('click', false, false);\n      link.dispatchEvent(e);\n    });\n  };\n  Graph.prototype.dataURLToImage = function (dataURL, renderer, link, fileName) {\n    if (!dataURL || dataURL === 'data:') {\n      console.error('Download image failed. The graph is too large or there is invalid attribute values in graph items');\n      return;\n    }\n    if (typeof window !== 'undefined') {\n      if (window.Blob && window.URL && renderer !== 'svg') {\n        var arr = dataURL.split(',');\n        var mime = '';\n        if (arr && arr.length > 0) {\n          var match = arr[0].match(/:(.*?);/);\n          // eslint-disable-next-line prefer-destructuring\n          if (match && match.length >= 2) mime = match[1];\n        }\n        var bstr = atob(arr[1]);\n        var n = bstr.length;\n        var u8arr = new Uint8Array(n);\n        while (n--) {\n          u8arr[n] = bstr.charCodeAt(n);\n        }\n        var blobObj_1 = new Blob([u8arr], {\n          type: mime\n        });\n        if (window.navigator.msSaveBlob) {\n          window.navigator.msSaveBlob(blobObj_1, fileName);\n        } else {\n          link.addEventListener('click', function () {\n            link.download = fileName;\n            link.href = window.URL.createObjectURL(blobObj_1);\n          });\n        }\n      } else {\n        link.addEventListener('click', function () {\n          link.download = fileName;\n          link.href = dataURL;\n        });\n      }\n    }\n  };\n  /**\n   * 添加插件\n   * @param {object} plugin 插件实例\n   */\n  Graph.prototype.addPlugin = function (plugin) {\n    var self = this;\n    if (plugin.destroyed) {\n      return;\n    }\n    self.get('plugins').push(plugin);\n    plugin.initPlugin(self);\n  };\n  /**\n   * 添加插件\n   * @param {object} plugin 插件实例\n   */\n  Graph.prototype.removePlugin = function (plugin) {\n    var plugins = this.get('plugins');\n    var index = plugins.indexOf(plugin);\n    if (index >= 0) {\n      plugin.destroyPlugin();\n      plugins.splice(index, 1);\n    }\n  };\n  /**\n   * 设置图片水印\n   * @param {string} imgURL 图片水印的url地址\n   * @param {WaterMarkerConfig} config 文本水印的配置项\n   */\n  Graph.prototype.setImageWaterMarker = function (imgURL, config) {\n    if (imgURL === void 0) {\n      imgURL = Global.waterMarkerImage;\n    }\n    var container = this.get('container');\n    if (isString(container)) {\n      container = document.getElementById(container);\n    }\n    if (!container.style.position) {\n      container.style.position = 'relative';\n    }\n    var canvas = this.get('graphWaterMarker');\n    var waterMarkerConfig = deepMix({}, Global.imageWaterMarkerConfig, config);\n    var width = waterMarkerConfig.width,\n      height = waterMarkerConfig.height,\n      compatible = waterMarkerConfig.compatible,\n      image = waterMarkerConfig.image;\n    if (!imgURL) {\n      var dom = compatible ? container : document.querySelector('.g6-graph-watermarker');\n      if (dom) dom.style.cssText = undefined;\n      if (canvas) canvas.clear();\n      return;\n    }\n    if (!canvas) {\n      var canvasCfg = {\n        container: container,\n        width: width,\n        height: height,\n        capture: false\n      };\n      var pixelRatio = this.get('pixelRatio');\n      if (pixelRatio) {\n        canvasCfg.pixelRatio = pixelRatio;\n        window.devicePixelRatio = pixelRatio;\n      }\n      canvas = new GCanvas(canvasCfg);\n      this.set('graphWaterMarker', canvas);\n    } else {\n      canvas.clear();\n    }\n    canvas.get('el').style.display = 'none';\n    var ctx = canvas.get('context');\n    var rotate = image.rotate,\n      x = image.x,\n      y = image.y;\n    // 旋转20度\n    ctx.rotate(-rotate * Math.PI / 180);\n    var img = new Image();\n    img.crossOrigin = 'anonymous';\n    img.src = imgURL;\n    img.onload = function () {\n      ctx.drawImage(img, x, y, image.width, image.height);\n      // 恢复旋转角度\n      ctx.rotate(rotate * Math.PI / 180);\n      // 默认按照现代浏览器处理\n      if (!compatible) {\n        var box = document.querySelector('.g6-graph-watermarker');\n        if (!box) {\n          box = document.createElement('div');\n          box.className = 'g6-graph-watermarker';\n        }\n        box.className = 'g6-graph-watermarker';\n        if (!canvas.destroyed) {\n          box.style.cssText = \"background-image: url(\".concat(canvas.get('el').toDataURL('image/png'), \");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;\");\n          container.appendChild(box);\n        }\n      } else {\n        // 当需要兼容不支持 pointer-events属性的浏览器时，将 compatible 设置为 true\n        container.style.cssText = \"background-image: url(\".concat(canvas.get('el').toDataURL('image/png'), \");background-repeat:repeat;\");\n      }\n    };\n  };\n  /**\n   * 设置文本水印\n   * @param {string[]} texts 水印的文本内容\n   * @param {WaterMarkerConfig} config 文本水印的配置项\n   */\n  Graph.prototype.setTextWaterMarker = function (texts, config) {\n    var container = this.get('container');\n    if (isString(container)) {\n      container = document.getElementById(container);\n    }\n    if (!container.style.position) {\n      container.style.position = 'relative';\n    }\n    var canvas = this.get('graphWaterMarker');\n    var waterMarkerConfig = deepMix({}, Global.textWaterMarkerConfig, config);\n    var width = waterMarkerConfig.width,\n      height = waterMarkerConfig.height,\n      compatible = waterMarkerConfig.compatible,\n      text = waterMarkerConfig.text;\n    if (!(texts === null || texts === void 0 ? void 0 : texts.length)) {\n      var dom = compatible ? container : document.querySelector('.g6-graph-watermarker');\n      if (dom) dom.style.cssText = undefined;\n      if (canvas) canvas.clear();\n      return;\n    }\n    if (!canvas) {\n      var canvasCfg = {\n        container: container,\n        width: width,\n        height: height,\n        capture: false\n      };\n      var pixelRatio = this.get('pixelRatio');\n      if (pixelRatio) {\n        canvasCfg.pixelRatio = pixelRatio;\n        window.devicePixelRatio = pixelRatio;\n      }\n      canvas = new GCanvas(canvasCfg);\n      this.set('graphWaterMarker', canvas);\n    } else {\n      canvas.clear();\n    }\n    canvas.get('el').style.display = 'none';\n    var ctx = canvas.get('context');\n    var rotate = text.rotate,\n      fill = text.fill,\n      fontFamily = text.fontFamily,\n      fontSize = text.fontSize,\n      baseline = text.baseline,\n      x = text.x,\n      y = text.y,\n      lineHeight = text.lineHeight;\n    // 旋转20度\n    ctx.rotate(-rotate * Math.PI / 180);\n    // 设置文字样式\n    ctx.font = \"\".concat(fontSize, \"px \").concat(fontFamily);\n    // 设置文字颜色\n    ctx.fillStyle = fill;\n    ctx.textBaseline = baseline;\n    var displayTexts = isString(texts) ? [texts] : texts;\n    for (var i = displayTexts.length - 1; i >= 0; i--) {\n      // 将文字绘制到画布\n      ctx.fillText(displayTexts[i], x, y + i * lineHeight);\n    }\n    // 恢复旋转角度\n    ctx.rotate(rotate * Math.PI / 180);\n    // 默认按照现代浏览器处理\n    if (!compatible) {\n      var box = document.querySelector('.g6-graph-watermarker');\n      if (!box) {\n        box = document.createElement('div');\n        box.className = 'g6-graph-watermarker';\n      }\n      box.style.cssText = \"background-image: url(\".concat(canvas.get('el').toDataURL('image/png'), \");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;\");\n      container.appendChild(box);\n    } else {\n      // 当需要兼容不支持 pointer-events属性的浏览器时，将 compatible 设置为 true\n      container.style.cssText = \"background-image: url(\".concat(canvas.get('el').toDataURL('image/png'), \");background-repeat:repeat;\");\n    }\n  };\n  /**\n   * 销毁画布\n   */\n  Graph.prototype.destroy = function () {\n    var _a, _b, _c, _d;\n    each(this.get('plugins'), function (plugin) {\n      plugin.destroyPlugin();\n    });\n    // destroy tooltip doms, removed when upgrade G6 4.0\n    var tooltipDOMs = this.get('tooltips');\n    if (tooltipDOMs) {\n      for (var i = 0; i < tooltipDOMs.length; i++) {\n        var container = tooltipDOMs[i];\n        if (!container) continue;\n        var parent_1 = container.parentElement;\n        if (!parent_1) continue;\n        parent_1.removeChild(container);\n      }\n    }\n    (_a = this.get('eventController')) === null || _a === void 0 ? void 0 : _a.destroy();\n    (_b = this.get('layoutController')) === null || _b === void 0 ? void 0 : _b.destroy();\n    // this.get('eventController').destroy();\n    // this.get('itemController').destroy();\n    // this.get('modeController').destroy();\n    // this.get('viewController').destroy();\n    // this.get('stateController').destroy();\n    // this.get('canvas').destroy();\n    (_c = this.get('graphWaterMarker')) === null || _c === void 0 ? void 0 : _c.destroy();\n    (_d = document.querySelector('.g6-graph-watermarker')) === null || _d === void 0 ? void 0 : _d.remove();\n    _super.prototype.destroy.call(this);\n  };\n  return Graph;\n}(AbstractGraph);\nexport default Graph;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
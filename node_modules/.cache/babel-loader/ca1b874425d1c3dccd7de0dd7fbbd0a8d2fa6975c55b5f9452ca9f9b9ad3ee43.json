{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/**\n * @fileOverview 自定义边\n * @description 自定义边中有大量逻辑同自定义节点重复，虽然可以提取成为 mixin ，但是考虑到代码的可读性，还是单独实现。\n */\nimport { __assign } from \"tslib\";\nimport { deepMix, mix, each, isNil, isNumber, isArray } from '@antv/util';\nimport { getLabelPosition, getLoopCfgs } from '../util/graphic';\nimport { distance, getCircleCenterByPoints } from '../util/math';\nimport { getControlPoint, getSpline } from '../util/path';\nimport Global from '../global';\nimport Shape from './shape';\nimport { shapeBase, CLS_LABEL_BG_SUFFIX } from './shapeBase';\nvar CLS_SHAPE = 'edge-shape';\n// start,end 倒置，center 不变\nfunction revertAlign(labelPosition) {\n  var textAlign = labelPosition;\n  if (labelPosition === 'start') {\n    textAlign = 'end';\n  } else if (labelPosition === 'end') {\n    textAlign = 'start';\n  }\n  return textAlign;\n}\nvar singleEdge = {\n  itemType: 'edge',\n  /**\n   * 文本的位置\n   * @type {String}\n   */\n  labelPosition: 'center',\n  /**\n   * 文本的 x 偏移\n   * @type {Number}\n   */\n  refX: 0,\n  /**\n   * 文本的 y 偏移\n   * @type {Number}\n   */\n  refY: 0,\n  /**\n   * 文本是否跟着线自动旋转，默认 false\n   * @type {Boolean}\n   */\n  labelAutoRotate: false,\n  // 自定义边时的配置\n  options: {\n    size: Global.defaultEdge.size,\n    style: {\n      x: 0,\n      y: 0,\n      stroke: Global.defaultEdge.style.stroke,\n      lineAppendWidth: Global.defaultEdge.style.lineAppendWidth\n    },\n    labelCfg: {\n      style: {\n        fill: Global.edgeLabel.style.fill,\n        fontSize: Global.edgeLabel.style.fontSize,\n        fontFamily: Global.windowFontFamily\n      }\n    },\n    stateStyles: __assign({}, Global.edgeStateStyles)\n  },\n  /**\n   * 获取边的 path\n   * @internal 供扩展的边覆盖\n   * @param  {Array} points 构成边的点的集合\n   * @return {Array} 构成 path 的数组\n   */\n  getPath: function getPath(points) {\n    var path = [];\n    each(points, function (point, index) {\n      if (index === 0) {\n        path.push(['M', point.x, point.y]);\n      } else {\n        path.push(['L', point.x, point.y]);\n      }\n    });\n    return path;\n  },\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = this.options.style;\n    var strokeStyle = {\n      stroke: cfg.color\n    };\n    // 如果设置了color，则覆盖默认的stroke属性\n    var style = mix({}, defaultStyle, strokeStyle, cfg.style);\n    var size = cfg.size || Global.defaultEdge.size;\n    cfg = this.getPathPoints(cfg);\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    var controlPoints = this.getControlPoints(cfg);\n    var points = [startPoint]; // 添加起始点\n    // 添加控制点\n    if (controlPoints) {\n      points = points.concat(controlPoints);\n    }\n    // 添加结束点\n    points.push(endPoint);\n    var path = this.getPath(points);\n    var styles = mix({}, Global.defaultEdge.style, {\n      stroke: Global.defaultEdge.color,\n      lineWidth: size,\n      path: path\n    }, style);\n    return styles;\n  },\n  updateShapeStyle: function updateShapeStyle(cfg, item, updateType) {\n    var _a;\n    var group = item.getContainer();\n    // const strokeStyle: ShapeStyle = {\n    //   stroke: cfg.color,\n    // };\n    var shape = ((_a = item.getKeyShape) === null || _a === void 0 ? void 0 : _a.call(item)) || group['shapeMap']['edge-shape']; // group.find((element) => element.get('className') === 'edge-shape');\n    var size = cfg.size;\n    cfg = this.getPathPoints(cfg);\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    var controlPoints = this.getControlPoints(cfg); // || cfg.controlPoints;\n    var points = [startPoint]; // 添加起始点\n    // 添加控制点\n    if (controlPoints) {\n      points = points.concat(controlPoints);\n    }\n    // 添加结束点\n    points.push(endPoint);\n    var currentAttr = shape.attr();\n    // const previousStyle = mix({}, strokeStyle, currentAttr, cfg.style);\n    var previousStyle = cfg.style || {};\n    if (previousStyle.stroke === undefined) {\n      previousStyle.stroke = cfg.color;\n    }\n    var source = cfg.sourceNode;\n    var target = cfg.targetNode;\n    var routeCfg = {\n      radius: previousStyle.radius\n    };\n    if (!controlPoints) {\n      routeCfg = {\n        source: source,\n        target: target,\n        offset: previousStyle.offset,\n        radius: previousStyle.radius\n      };\n    }\n    var path = this.getPath(points, routeCfg);\n    var style = {};\n    if (updateType === 'move') {\n      style = {\n        path: path\n      };\n    } else {\n      if (currentAttr.endArrow && previousStyle.endArrow === false) {\n        cfg.style.endArrow = {\n          path: ''\n        };\n      }\n      if (currentAttr.startArrow && previousStyle.startArrow === false) {\n        cfg.style.startArrow = {\n          path: ''\n        };\n      }\n      style = __assign({}, cfg.style);\n      if (style.lineWidth === undefined) style.lineWidth = (isNumber(size) ? size : size === null || size === void 0 ? void 0 : size[0]) || currentAttr.lineWidth;\n      if (style.path === undefined) style.path = path;\n      if (style.stroke === undefined) style.stroke = currentAttr.stroke || cfg.color;\n    }\n    if (shape) {\n      shape.attr(style);\n    }\n  },\n  getLabelStyleByPosition: function getLabelStyleByPosition(cfg, labelCfg, group) {\n    var labelPosition = labelCfg.position || this.labelPosition; // 文本的位置用户可以传入\n    var style = {};\n    var pathShape = group === null || group === void 0 ? void 0 : group['shapeMap'][CLS_SHAPE]; // group?.find((element) => element.get('className') === CLS_SHAPE);\n    // 不对 pathShape 进行判空，如果线不存在，说明有问题了\n    var pointPercent;\n    if (labelPosition === 'start') {\n      pointPercent = 0;\n    } else if (labelPosition === 'end') {\n      pointPercent = 1;\n    } else {\n      pointPercent = 0.5;\n    }\n    // 偏移量\n    var offsetX = labelCfg.refX || this.refX;\n    var offsetY = labelCfg.refY || this.refY;\n    // 如果两个节点重叠，线就变成了一个点，这时候label的位置，就是这个点 + 绝对偏移\n    if (cfg.startPoint.x === cfg.endPoint.x && cfg.startPoint.y === cfg.endPoint.y) {\n      style.x = cfg.startPoint.x + offsetX;\n      style.y = cfg.startPoint.y + offsetY;\n      style.text = cfg.label;\n      return style;\n    }\n    var autoRotate;\n    if (isNil(labelCfg.autoRotate)) autoRotate = this.labelAutoRotate;else autoRotate = labelCfg.autoRotate;\n    var offsetStyle = getLabelPosition(pathShape, pointPercent, offsetX, offsetY, autoRotate);\n    style.x = offsetStyle.x;\n    style.y = offsetStyle.y;\n    style.rotate = offsetStyle.rotate;\n    style.textAlign = this._getTextAlign(labelPosition, offsetStyle.angle);\n    style.text = cfg.label;\n    return style;\n  },\n  getLabelBgStyleByPosition: function getLabelBgStyleByPosition(label, labelCfg) {\n    if (!label) {\n      return {};\n    }\n    var bbox = label.getBBox();\n    var backgroundStyle = labelCfg.style && labelCfg.style.background;\n    if (!backgroundStyle) {\n      return {};\n    }\n    var padding = backgroundStyle.padding;\n    var backgroundWidth = bbox.width + padding[1] + padding[3];\n    var backgroundHeight = bbox.height + padding[0] + padding[2];\n    var style = __assign(__assign({}, backgroundStyle), {\n      width: backgroundWidth,\n      height: backgroundHeight,\n      x: bbox.minX - padding[3],\n      y: bbox.minY - padding[0],\n      matrix: [1, 0, 0, 0, 1, 0, 0, 0, 1]\n    });\n    var autoRotate;\n    if (isNil(labelCfg.autoRotate)) autoRotate = this.labelAutoRotate;else autoRotate = labelCfg.autoRotate;\n    if (autoRotate) {\n      style.matrix = label.attr('matrix') || [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    }\n    return style;\n  },\n  // 获取文本对齐方式\n  _getTextAlign: function _getTextAlign(labelPosition, angle) {\n    var textAlign = 'center';\n    if (!angle) {\n      return labelPosition;\n    }\n    angle = angle % (Math.PI * 2); // 取模\n    if (labelPosition !== 'center') {\n      if (angle >= 0 && angle <= Math.PI / 2 || angle >= 3 / 2 * Math.PI && angle < 2 * Math.PI) {\n        textAlign = labelPosition;\n      } else {\n        textAlign = revertAlign(labelPosition);\n      }\n    }\n    return textAlign;\n  },\n  /**\n   * @internal 获取边的控制点\n   * @param  {Object} cfg 边的配置项\n   * @return {Array} 控制点的数组\n   */\n  getControlPoints: function getControlPoints(cfg) {\n    return cfg.controlPoints;\n  },\n  /**\n   * @internal 处理需要重计算点和边的情况\n   * @param {Object} cfg 边的配置项\n   * @return {Object} 边的配置项\n   */\n  getPathPoints: function getPathPoints(cfg) {\n    return cfg;\n  },\n  /**\n   * 绘制边\n   * @override\n   * @param  {Object} cfg   边的配置项\n   * @param  {G.Group} group 边的容器\n   * @return {IShape} 图形\n   */\n  drawShape: function drawShape(cfg, group) {\n    var shapeStyle = this.getShapeStyle(cfg);\n    var shape = group.addShape('path', {\n      className: CLS_SHAPE,\n      name: CLS_SHAPE,\n      attrs: shapeStyle\n    });\n    group['shapeMap'][CLS_SHAPE] = shape;\n    return shape;\n  },\n  drawLabel: function drawLabel(cfg, group) {\n    var defaultLabelCfg = this.options.labelCfg;\n    var labelCfg = deepMix({}, defaultLabelCfg, cfg.labelCfg);\n    var labelStyle = this.getLabelStyle(cfg, labelCfg, group);\n    var rotate = labelStyle.rotate;\n    delete labelStyle.rotate;\n    var label = group.addShape('text', {\n      attrs: labelStyle,\n      name: 'text-shape',\n      labelRelated: true,\n      draggable: true\n    });\n    group['shapeMap']['text-shape'] = label;\n    if (!isNaN(rotate) && rotate !== '') {\n      label.rotateAtStart(rotate);\n    }\n    if (labelStyle.background) {\n      var rect = this.drawLabelBg(cfg, group, label, labelStyle, rotate);\n      var labelBgClassname = this.itemType + CLS_LABEL_BG_SUFFIX;\n      rect.set('classname', labelBgClassname);\n      group['shapeMap'][labelBgClassname] = rect;\n      label.toFront();\n    }\n    return label;\n  },\n  drawLabelBg: function drawLabelBg(cfg, group, label, labelStyle, rotate) {\n    var defaultLabelCfg = this.options.labelCfg;\n    var labelCfg = deepMix({}, defaultLabelCfg, cfg.labelCfg);\n    var style = this.getLabelBgStyleByPosition(label, labelCfg);\n    var rect = group.addShape('rect', {\n      name: 'text-bg-shape',\n      attrs: style,\n      labelRelated: true\n    });\n    group['shapeMap']['text-bg-shape'] = rect;\n    return rect;\n  }\n};\nvar singleEdgeDef = __assign(__assign({}, shapeBase), singleEdge);\nShape.registerEdge('single-edge', singleEdgeDef);\n// 直线, 不支持控制点\nShape.registerEdge('line', {\n  // 控制点不生效\n  getControlPoints: function getControlPoints() {\n    return undefined;\n  }\n}, 'single-edge');\n// 直线\nShape.registerEdge('spline', {\n  getPath: function getPath(points) {\n    var path = getSpline(points);\n    return path;\n  }\n}, 'single-edge');\nShape.registerEdge('arc', {\n  curveOffset: 20,\n  clockwise: 1,\n  getControlPoints: function getControlPoints(cfg) {\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    var midPoint = {\n      x: (startPoint.x + endPoint.x) / 2,\n      y: (startPoint.y + endPoint.y) / 2\n    };\n    var center;\n    var arcPoint;\n    // 根据给定点计算圆弧\n    if (cfg.controlPoints !== undefined) {\n      arcPoint = cfg.controlPoints[0];\n      center = getCircleCenterByPoints(startPoint, arcPoint, endPoint);\n      // 根据控制点和直线关系决定 clockwise值\n      if (startPoint.x <= endPoint.x && startPoint.y > endPoint.y) {\n        this.clockwise = center.x > arcPoint.x ? 0 : 1;\n      } else if (startPoint.x <= endPoint.x && startPoint.y < endPoint.y) {\n        this.clockwise = center.x > arcPoint.x ? 1 : 0;\n      } else if (startPoint.x > endPoint.x && startPoint.y <= endPoint.y) {\n        this.clockwise = center.y < arcPoint.y ? 0 : 1;\n      } else {\n        this.clockwise = center.y < arcPoint.y ? 1 : 0;\n      }\n      // 若给定点和两端点共线，无法生成圆弧，绘制直线\n      if ((arcPoint.x - startPoint.x) / (arcPoint.y - startPoint.y) === (endPoint.x - startPoint.x) / (endPoint.y - startPoint.y)) {\n        return [];\n      }\n    } else {\n      // 根据直线连线中点的的偏移计算圆弧\n      // 若用户给定偏移量则根据其计算，否则按照默认偏移值计算\n      if (cfg.curveOffset === undefined) {\n        cfg.curveOffset = this.curveOffset;\n      }\n      if (isArray(cfg.curveOffset)) {\n        cfg.curveOffset = cfg.curveOffset[0];\n      }\n      if (cfg.curveOffset < 0) {\n        this.clockwise = 0;\n      } else {\n        this.clockwise = 1;\n      }\n      var vec = {\n        x: endPoint.x - startPoint.x,\n        y: endPoint.y - startPoint.y\n      };\n      var edgeAngle = Math.atan2(vec.y, vec.x);\n      arcPoint = {\n        x: cfg.curveOffset * Math.cos(-Math.PI / 2 + edgeAngle) + midPoint.x,\n        y: cfg.curveOffset * Math.sin(-Math.PI / 2 + edgeAngle) + midPoint.y\n      };\n      center = getCircleCenterByPoints(startPoint, arcPoint, endPoint);\n    }\n    var radius = distance(startPoint, center);\n    var controlPoints = [{\n      x: radius,\n      y: radius\n    }];\n    return controlPoints;\n  },\n  getPath: function getPath(points) {\n    var path = [];\n    path.push(['M', points[0].x, points[0].y]);\n    // 控制点与端点共线\n    if (points.length === 2) {\n      path.push(['L', points[1].x, points[1].y]);\n    } else {\n      path.push(['A', points[1].x, points[1].y, 0, 0, this.clockwise, points[2].x, points[2].y]);\n    }\n    return path;\n  }\n}, 'single-edge');\nShape.registerEdge('quadratic', {\n  curvePosition: 0.5,\n  curveOffset: -20,\n  getControlPoints: function getControlPoints(cfg) {\n    var controlPoints = cfg.controlPoints; // 指定controlPoints\n    if (!controlPoints || !controlPoints.length) {\n      var startPoint = cfg.startPoint,\n        endPoint = cfg.endPoint;\n      if (cfg.curveOffset === undefined) cfg.curveOffset = this.curveOffset;\n      if (cfg.curvePosition === undefined) cfg.curvePosition = this.curvePosition;\n      if (isArray(cfg.curveOffset)) cfg.curveOffset = cfg.curveOffset[0];\n      if (isArray(cfg.curvePosition)) cfg.curvePosition = cfg.curveOffset[0];\n      var innerPoint = getControlPoint(startPoint, endPoint, cfg.curvePosition, cfg.curveOffset);\n      controlPoints = [innerPoint];\n    }\n    return controlPoints;\n  },\n  getPath: function getPath(points) {\n    var path = [];\n    path.push(['M', points[0].x, points[0].y]);\n    path.push(['Q', points[1].x, points[1].y, points[2].x, points[2].y]);\n    return path;\n  }\n}, 'single-edge');\nShape.registerEdge('cubic', {\n  curvePosition: [1 / 2, 1 / 2],\n  curveOffset: [-20, 20],\n  getControlPoints: function getControlPoints(cfg) {\n    var controlPoints = cfg.controlPoints; // 指定 controlPoints\n    if (cfg.curveOffset === undefined) cfg.curveOffset = this.curveOffset;\n    if (cfg.curvePosition === undefined) cfg.curvePosition = this.curvePosition;\n    if (isNumber(cfg.curveOffset)) cfg.curveOffset = [cfg.curveOffset, -cfg.curveOffset];\n    if (isNumber(cfg.curvePosition)) cfg.curvePosition = [cfg.curvePosition, 1 - cfg.curvePosition];\n    if (!controlPoints || !controlPoints.length || controlPoints.length < 2) {\n      var startPoint = cfg.startPoint,\n        endPoint = cfg.endPoint;\n      var innerPoint1 = getControlPoint(startPoint, endPoint, cfg.curvePosition[0], cfg.curveOffset[0]);\n      var innerPoint2 = getControlPoint(startPoint, endPoint, cfg.curvePosition[1], cfg.curveOffset[1]);\n      controlPoints = [innerPoint1, innerPoint2];\n    }\n    return controlPoints;\n  },\n  getPath: function getPath(points) {\n    var path = [];\n    path.push(['M', points[0].x, points[0].y]);\n    path.push(['C', points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y]);\n    return path;\n  }\n}, 'single-edge');\n// 垂直方向的三阶贝塞尔曲线，不再考虑用户外部传入的控制点\nShape.registerEdge('cubic-vertical', {\n  curvePosition: [1 / 2, 1 / 2],\n  minCurveOffset: [0, 0],\n  curveOffset: undefined,\n  getControlPoints: function getControlPoints(cfg) {\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    if (cfg.curvePosition === undefined) cfg.curvePosition = this.curvePosition;\n    if (cfg.curveOffset === undefined) cfg.curveOffset = this.curveOffset;\n    if (cfg.minCurveOffset === undefined) cfg.minCurveOffset = this.minCurveOffset;\n    if (isNumber(cfg.curveOffset)) cfg.curveOffset = [cfg.curveOffset, -cfg.curveOffset];\n    if (isNumber(cfg.minCurveOffset)) cfg.minCurveOffset = [cfg.minCurveOffset, -cfg.minCurveOffset];\n    if (isNumber(cfg.curvePosition)) cfg.curvePosition = [cfg.curvePosition, 1 - cfg.curvePosition];\n    var yDist = endPoint.y - startPoint.y;\n    var curveOffset = [0, 0];\n    if (cfg.curveOffset) {\n      curveOffset = cfg.curveOffset;\n    } else if (Math.abs(yDist) < Math.abs(cfg.minCurveOffset[0])) {\n      curveOffset = cfg.minCurveOffset;\n    }\n    var innerPoint1 = {\n      x: startPoint.x,\n      y: startPoint.y + yDist * this.curvePosition[0] + curveOffset[0]\n    };\n    var innerPoint2 = {\n      x: endPoint.x,\n      y: endPoint.y - yDist * this.curvePosition[1] + curveOffset[1]\n    };\n    return [innerPoint1, innerPoint2];\n  }\n}, 'cubic');\n// 水平方向的三阶贝塞尔曲线，不再考虑用户外部传入的控制点\nShape.registerEdge('cubic-horizontal', {\n  curvePosition: [1 / 2, 1 / 2],\n  minCurveOffset: [0, 0],\n  curveOffset: undefined,\n  getControlPoints: function getControlPoints(cfg) {\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    if (cfg.curvePosition === undefined) cfg.curvePosition = this.curvePosition;\n    if (cfg.curveOffset === undefined) cfg.curveOffset = this.curveOffset;\n    if (cfg.minCurveOffset === undefined) cfg.minCurveOffset = this.minCurveOffset;\n    if (isNumber(cfg.curveOffset)) cfg.curveOffset = [cfg.curveOffset, -cfg.curveOffset];\n    if (isNumber(cfg.minCurveOffset)) cfg.minCurveOffset = [cfg.minCurveOffset, -cfg.minCurveOffset];\n    if (isNumber(cfg.curvePosition)) cfg.curvePosition = [cfg.curvePosition, 1 - cfg.curvePosition];\n    var xDist = endPoint.x - startPoint.x;\n    var curveOffset = [0, 0];\n    if (cfg.curveOffset) {\n      curveOffset = cfg.curveOffset;\n    } else if (Math.abs(xDist) < Math.abs(cfg.minCurveOffset[0])) {\n      curveOffset = cfg.minCurveOffset;\n    }\n    var innerPoint1 = {\n      x: startPoint.x + xDist * this.curvePosition[0] + curveOffset[0],\n      y: startPoint.y\n    };\n    var innerPoint2 = {\n      x: endPoint.x - xDist * this.curvePosition[1] + curveOffset[1],\n      y: endPoint.y\n    };\n    var controlPoints = [innerPoint1, innerPoint2];\n    return controlPoints;\n  }\n}, 'cubic');\nShape.registerEdge('loop', {\n  getPathPoints: function getPathPoints(cfg) {\n    return getLoopCfgs(cfg);\n  },\n  getControlPoints: function getControlPoints(cfg) {\n    return cfg.controlPoints;\n  },\n  afterDraw: function afterDraw(cfg) {\n    cfg.controlPoints = undefined;\n  },\n  afterUpdate: function afterUpdate(cfg) {\n    cfg.controlPoints = undefined;\n  }\n}, 'cubic');","map":{"version":3,"names":["__assign","deepMix","mix","each","isNil","isNumber","isArray","getLabelPosition","getLoopCfgs","distance","getCircleCenterByPoints","getControlPoint","getSpline","Global","Shape","shapeBase","CLS_LABEL_BG_SUFFIX","CLS_SHAPE","revertAlign","labelPosition","textAlign","singleEdge","itemType","refX","refY","labelAutoRotate","options","size","defaultEdge","style","x","y","stroke","lineAppendWidth","labelCfg","fill","edgeLabel","fontSize","fontFamily","windowFontFamily","stateStyles","edgeStateStyles","getPath","points","path","point","index","push","getShapeStyle","cfg","defaultStyle","strokeStyle","color","getPathPoints","startPoint","endPoint","controlPoints","getControlPoints","concat","styles","lineWidth","updateShapeStyle","item","updateType","_a","group","getContainer","shape","getKeyShape","call","currentAttr","attr","previousStyle","undefined","source","sourceNode","target","targetNode","routeCfg","radius","offset","endArrow","startArrow","getLabelStyleByPosition","position","pathShape","pointPercent","offsetX","offsetY","text","label","autoRotate","offsetStyle","rotate","_getTextAlign","angle","getLabelBgStyleByPosition","bbox","getBBox","backgroundStyle","background","padding","backgroundWidth","width","backgroundHeight","height","minX","minY","matrix","Math","PI","drawShape","shapeStyle","addShape","className","name","attrs","drawLabel","defaultLabelCfg","labelStyle","getLabelStyle","labelRelated","draggable","isNaN","rotateAtStart","rect","drawLabelBg","labelBgClassname","set","toFront","singleEdgeDef","registerEdge","curveOffset","clockwise","midPoint","center","arcPoint","vec","edgeAngle","atan2","cos","sin","length","curvePosition","innerPoint","innerPoint1","innerPoint2","minCurveOffset","yDist","abs","xDist","afterDraw","afterUpdate"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/g6-core/es/element/edge.js"],"sourcesContent":["/**\n * @fileOverview 自定义边\n * @description 自定义边中有大量逻辑同自定义节点重复，虽然可以提取成为 mixin ，但是考虑到代码的可读性，还是单独实现。\n */\nimport { __assign } from \"tslib\";\nimport { deepMix, mix, each, isNil, isNumber, isArray } from '@antv/util';\nimport { getLabelPosition, getLoopCfgs } from '../util/graphic';\nimport { distance, getCircleCenterByPoints } from '../util/math';\nimport { getControlPoint, getSpline } from '../util/path';\nimport Global from '../global';\nimport Shape from './shape';\nimport { shapeBase, CLS_LABEL_BG_SUFFIX } from './shapeBase';\nvar CLS_SHAPE = 'edge-shape';\n// start,end 倒置，center 不变\nfunction revertAlign(labelPosition) {\n  var textAlign = labelPosition;\n  if (labelPosition === 'start') {\n    textAlign = 'end';\n  } else if (labelPosition === 'end') {\n    textAlign = 'start';\n  }\n  return textAlign;\n}\nvar singleEdge = {\n  itemType: 'edge',\n  /**\n   * 文本的位置\n   * @type {String}\n   */\n  labelPosition: 'center',\n  /**\n   * 文本的 x 偏移\n   * @type {Number}\n   */\n  refX: 0,\n  /**\n   * 文本的 y 偏移\n   * @type {Number}\n   */\n  refY: 0,\n  /**\n   * 文本是否跟着线自动旋转，默认 false\n   * @type {Boolean}\n   */\n  labelAutoRotate: false,\n  // 自定义边时的配置\n  options: {\n    size: Global.defaultEdge.size,\n    style: {\n      x: 0,\n      y: 0,\n      stroke: Global.defaultEdge.style.stroke,\n      lineAppendWidth: Global.defaultEdge.style.lineAppendWidth\n    },\n    labelCfg: {\n      style: {\n        fill: Global.edgeLabel.style.fill,\n        fontSize: Global.edgeLabel.style.fontSize,\n        fontFamily: Global.windowFontFamily\n      }\n    },\n    stateStyles: __assign({}, Global.edgeStateStyles)\n  },\n  /**\n   * 获取边的 path\n   * @internal 供扩展的边覆盖\n   * @param  {Array} points 构成边的点的集合\n   * @return {Array} 构成 path 的数组\n   */\n  getPath: function getPath(points) {\n    var path = [];\n    each(points, function (point, index) {\n      if (index === 0) {\n        path.push(['M', point.x, point.y]);\n      } else {\n        path.push(['L', point.x, point.y]);\n      }\n    });\n    return path;\n  },\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = this.options.style;\n    var strokeStyle = {\n      stroke: cfg.color\n    };\n    // 如果设置了color，则覆盖默认的stroke属性\n    var style = mix({}, defaultStyle, strokeStyle, cfg.style);\n    var size = cfg.size || Global.defaultEdge.size;\n    cfg = this.getPathPoints(cfg);\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    var controlPoints = this.getControlPoints(cfg);\n    var points = [startPoint]; // 添加起始点\n    // 添加控制点\n    if (controlPoints) {\n      points = points.concat(controlPoints);\n    }\n    // 添加结束点\n    points.push(endPoint);\n    var path = this.getPath(points);\n    var styles = mix({}, Global.defaultEdge.style, {\n      stroke: Global.defaultEdge.color,\n      lineWidth: size,\n      path: path\n    }, style);\n    return styles;\n  },\n  updateShapeStyle: function updateShapeStyle(cfg, item, updateType) {\n    var _a;\n    var group = item.getContainer();\n    // const strokeStyle: ShapeStyle = {\n    //   stroke: cfg.color,\n    // };\n    var shape = ((_a = item.getKeyShape) === null || _a === void 0 ? void 0 : _a.call(item)) || group['shapeMap']['edge-shape']; // group.find((element) => element.get('className') === 'edge-shape');\n    var size = cfg.size;\n    cfg = this.getPathPoints(cfg);\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    var controlPoints = this.getControlPoints(cfg); // || cfg.controlPoints;\n    var points = [startPoint]; // 添加起始点\n    // 添加控制点\n    if (controlPoints) {\n      points = points.concat(controlPoints);\n    }\n    // 添加结束点\n    points.push(endPoint);\n    var currentAttr = shape.attr();\n    // const previousStyle = mix({}, strokeStyle, currentAttr, cfg.style);\n    var previousStyle = cfg.style || {};\n    if (previousStyle.stroke === undefined) {\n      previousStyle.stroke = cfg.color;\n    }\n    var source = cfg.sourceNode;\n    var target = cfg.targetNode;\n    var routeCfg = {\n      radius: previousStyle.radius\n    };\n    if (!controlPoints) {\n      routeCfg = {\n        source: source,\n        target: target,\n        offset: previousStyle.offset,\n        radius: previousStyle.radius\n      };\n    }\n    var path = this.getPath(points, routeCfg);\n    var style = {};\n    if (updateType === 'move') {\n      style = {\n        path: path\n      };\n    } else {\n      if (currentAttr.endArrow && previousStyle.endArrow === false) {\n        cfg.style.endArrow = {\n          path: ''\n        };\n      }\n      if (currentAttr.startArrow && previousStyle.startArrow === false) {\n        cfg.style.startArrow = {\n          path: ''\n        };\n      }\n      style = __assign({}, cfg.style);\n      if (style.lineWidth === undefined) style.lineWidth = (isNumber(size) ? size : size === null || size === void 0 ? void 0 : size[0]) || currentAttr.lineWidth;\n      if (style.path === undefined) style.path = path;\n      if (style.stroke === undefined) style.stroke = currentAttr.stroke || cfg.color;\n    }\n    if (shape) {\n      shape.attr(style);\n    }\n  },\n  getLabelStyleByPosition: function getLabelStyleByPosition(cfg, labelCfg, group) {\n    var labelPosition = labelCfg.position || this.labelPosition; // 文本的位置用户可以传入\n    var style = {};\n    var pathShape = group === null || group === void 0 ? void 0 : group['shapeMap'][CLS_SHAPE]; // group?.find((element) => element.get('className') === CLS_SHAPE);\n    // 不对 pathShape 进行判空，如果线不存在，说明有问题了\n    var pointPercent;\n    if (labelPosition === 'start') {\n      pointPercent = 0;\n    } else if (labelPosition === 'end') {\n      pointPercent = 1;\n    } else {\n      pointPercent = 0.5;\n    }\n    // 偏移量\n    var offsetX = labelCfg.refX || this.refX;\n    var offsetY = labelCfg.refY || this.refY;\n    // 如果两个节点重叠，线就变成了一个点，这时候label的位置，就是这个点 + 绝对偏移\n    if (cfg.startPoint.x === cfg.endPoint.x && cfg.startPoint.y === cfg.endPoint.y) {\n      style.x = cfg.startPoint.x + offsetX;\n      style.y = cfg.startPoint.y + offsetY;\n      style.text = cfg.label;\n      return style;\n    }\n    var autoRotate;\n    if (isNil(labelCfg.autoRotate)) autoRotate = this.labelAutoRotate;else autoRotate = labelCfg.autoRotate;\n    var offsetStyle = getLabelPosition(pathShape, pointPercent, offsetX, offsetY, autoRotate);\n    style.x = offsetStyle.x;\n    style.y = offsetStyle.y;\n    style.rotate = offsetStyle.rotate;\n    style.textAlign = this._getTextAlign(labelPosition, offsetStyle.angle);\n    style.text = cfg.label;\n    return style;\n  },\n  getLabelBgStyleByPosition: function getLabelBgStyleByPosition(label, labelCfg) {\n    if (!label) {\n      return {};\n    }\n    var bbox = label.getBBox();\n    var backgroundStyle = labelCfg.style && labelCfg.style.background;\n    if (!backgroundStyle) {\n      return {};\n    }\n    var padding = backgroundStyle.padding;\n    var backgroundWidth = bbox.width + padding[1] + padding[3];\n    var backgroundHeight = bbox.height + padding[0] + padding[2];\n    var style = __assign(__assign({}, backgroundStyle), {\n      width: backgroundWidth,\n      height: backgroundHeight,\n      x: bbox.minX - padding[3],\n      y: bbox.minY - padding[0],\n      matrix: [1, 0, 0, 0, 1, 0, 0, 0, 1]\n    });\n    var autoRotate;\n    if (isNil(labelCfg.autoRotate)) autoRotate = this.labelAutoRotate;else autoRotate = labelCfg.autoRotate;\n    if (autoRotate) {\n      style.matrix = label.attr('matrix') || [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    }\n    return style;\n  },\n  // 获取文本对齐方式\n  _getTextAlign: function _getTextAlign(labelPosition, angle) {\n    var textAlign = 'center';\n    if (!angle) {\n      return labelPosition;\n    }\n    angle = angle % (Math.PI * 2); // 取模\n    if (labelPosition !== 'center') {\n      if (angle >= 0 && angle <= Math.PI / 2 || angle >= 3 / 2 * Math.PI && angle < 2 * Math.PI) {\n        textAlign = labelPosition;\n      } else {\n        textAlign = revertAlign(labelPosition);\n      }\n    }\n    return textAlign;\n  },\n  /**\n   * @internal 获取边的控制点\n   * @param  {Object} cfg 边的配置项\n   * @return {Array} 控制点的数组\n   */\n  getControlPoints: function getControlPoints(cfg) {\n    return cfg.controlPoints;\n  },\n  /**\n   * @internal 处理需要重计算点和边的情况\n   * @param {Object} cfg 边的配置项\n   * @return {Object} 边的配置项\n   */\n  getPathPoints: function getPathPoints(cfg) {\n    return cfg;\n  },\n  /**\n   * 绘制边\n   * @override\n   * @param  {Object} cfg   边的配置项\n   * @param  {G.Group} group 边的容器\n   * @return {IShape} 图形\n   */\n  drawShape: function drawShape(cfg, group) {\n    var shapeStyle = this.getShapeStyle(cfg);\n    var shape = group.addShape('path', {\n      className: CLS_SHAPE,\n      name: CLS_SHAPE,\n      attrs: shapeStyle\n    });\n    group['shapeMap'][CLS_SHAPE] = shape;\n    return shape;\n  },\n  drawLabel: function drawLabel(cfg, group) {\n    var defaultLabelCfg = this.options.labelCfg;\n    var labelCfg = deepMix({}, defaultLabelCfg, cfg.labelCfg);\n    var labelStyle = this.getLabelStyle(cfg, labelCfg, group);\n    var rotate = labelStyle.rotate;\n    delete labelStyle.rotate;\n    var label = group.addShape('text', {\n      attrs: labelStyle,\n      name: 'text-shape',\n      labelRelated: true,\n      draggable: true\n    });\n    group['shapeMap']['text-shape'] = label;\n    if (!isNaN(rotate) && rotate !== '') {\n      label.rotateAtStart(rotate);\n    }\n    if (labelStyle.background) {\n      var rect = this.drawLabelBg(cfg, group, label, labelStyle, rotate);\n      var labelBgClassname = this.itemType + CLS_LABEL_BG_SUFFIX;\n      rect.set('classname', labelBgClassname);\n      group['shapeMap'][labelBgClassname] = rect;\n      label.toFront();\n    }\n    return label;\n  },\n  drawLabelBg: function drawLabelBg(cfg, group, label, labelStyle, rotate) {\n    var defaultLabelCfg = this.options.labelCfg;\n    var labelCfg = deepMix({}, defaultLabelCfg, cfg.labelCfg);\n    var style = this.getLabelBgStyleByPosition(label, labelCfg);\n    var rect = group.addShape('rect', {\n      name: 'text-bg-shape',\n      attrs: style,\n      labelRelated: true\n    });\n    group['shapeMap']['text-bg-shape'] = rect;\n    return rect;\n  }\n};\nvar singleEdgeDef = __assign(__assign({}, shapeBase), singleEdge);\nShape.registerEdge('single-edge', singleEdgeDef);\n// 直线, 不支持控制点\nShape.registerEdge('line', {\n  // 控制点不生效\n  getControlPoints: function getControlPoints() {\n    return undefined;\n  }\n}, 'single-edge');\n// 直线\nShape.registerEdge('spline', {\n  getPath: function getPath(points) {\n    var path = getSpline(points);\n    return path;\n  }\n}, 'single-edge');\nShape.registerEdge('arc', {\n  curveOffset: 20,\n  clockwise: 1,\n  getControlPoints: function getControlPoints(cfg) {\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    var midPoint = {\n      x: (startPoint.x + endPoint.x) / 2,\n      y: (startPoint.y + endPoint.y) / 2\n    };\n    var center;\n    var arcPoint;\n    // 根据给定点计算圆弧\n    if (cfg.controlPoints !== undefined) {\n      arcPoint = cfg.controlPoints[0];\n      center = getCircleCenterByPoints(startPoint, arcPoint, endPoint);\n      // 根据控制点和直线关系决定 clockwise值\n      if (startPoint.x <= endPoint.x && startPoint.y > endPoint.y) {\n        this.clockwise = center.x > arcPoint.x ? 0 : 1;\n      } else if (startPoint.x <= endPoint.x && startPoint.y < endPoint.y) {\n        this.clockwise = center.x > arcPoint.x ? 1 : 0;\n      } else if (startPoint.x > endPoint.x && startPoint.y <= endPoint.y) {\n        this.clockwise = center.y < arcPoint.y ? 0 : 1;\n      } else {\n        this.clockwise = center.y < arcPoint.y ? 1 : 0;\n      }\n      // 若给定点和两端点共线，无法生成圆弧，绘制直线\n      if ((arcPoint.x - startPoint.x) / (arcPoint.y - startPoint.y) === (endPoint.x - startPoint.x) / (endPoint.y - startPoint.y)) {\n        return [];\n      }\n    } else {\n      // 根据直线连线中点的的偏移计算圆弧\n      // 若用户给定偏移量则根据其计算，否则按照默认偏移值计算\n      if (cfg.curveOffset === undefined) {\n        cfg.curveOffset = this.curveOffset;\n      }\n      if (isArray(cfg.curveOffset)) {\n        cfg.curveOffset = cfg.curveOffset[0];\n      }\n      if (cfg.curveOffset < 0) {\n        this.clockwise = 0;\n      } else {\n        this.clockwise = 1;\n      }\n      var vec = {\n        x: endPoint.x - startPoint.x,\n        y: endPoint.y - startPoint.y\n      };\n      var edgeAngle = Math.atan2(vec.y, vec.x);\n      arcPoint = {\n        x: cfg.curveOffset * Math.cos(-Math.PI / 2 + edgeAngle) + midPoint.x,\n        y: cfg.curveOffset * Math.sin(-Math.PI / 2 + edgeAngle) + midPoint.y\n      };\n      center = getCircleCenterByPoints(startPoint, arcPoint, endPoint);\n    }\n    var radius = distance(startPoint, center);\n    var controlPoints = [{\n      x: radius,\n      y: radius\n    }];\n    return controlPoints;\n  },\n  getPath: function getPath(points) {\n    var path = [];\n    path.push(['M', points[0].x, points[0].y]);\n    // 控制点与端点共线\n    if (points.length === 2) {\n      path.push(['L', points[1].x, points[1].y]);\n    } else {\n      path.push(['A', points[1].x, points[1].y, 0, 0, this.clockwise, points[2].x, points[2].y]);\n    }\n    return path;\n  }\n}, 'single-edge');\nShape.registerEdge('quadratic', {\n  curvePosition: 0.5,\n  curveOffset: -20,\n  getControlPoints: function getControlPoints(cfg) {\n    var controlPoints = cfg.controlPoints; // 指定controlPoints\n    if (!controlPoints || !controlPoints.length) {\n      var startPoint = cfg.startPoint,\n        endPoint = cfg.endPoint;\n      if (cfg.curveOffset === undefined) cfg.curveOffset = this.curveOffset;\n      if (cfg.curvePosition === undefined) cfg.curvePosition = this.curvePosition;\n      if (isArray(cfg.curveOffset)) cfg.curveOffset = cfg.curveOffset[0];\n      if (isArray(cfg.curvePosition)) cfg.curvePosition = cfg.curveOffset[0];\n      var innerPoint = getControlPoint(startPoint, endPoint, cfg.curvePosition, cfg.curveOffset);\n      controlPoints = [innerPoint];\n    }\n    return controlPoints;\n  },\n  getPath: function getPath(points) {\n    var path = [];\n    path.push(['M', points[0].x, points[0].y]);\n    path.push(['Q', points[1].x, points[1].y, points[2].x, points[2].y]);\n    return path;\n  }\n}, 'single-edge');\nShape.registerEdge('cubic', {\n  curvePosition: [1 / 2, 1 / 2],\n  curveOffset: [-20, 20],\n  getControlPoints: function getControlPoints(cfg) {\n    var controlPoints = cfg.controlPoints; // 指定 controlPoints\n    if (cfg.curveOffset === undefined) cfg.curveOffset = this.curveOffset;\n    if (cfg.curvePosition === undefined) cfg.curvePosition = this.curvePosition;\n    if (isNumber(cfg.curveOffset)) cfg.curveOffset = [cfg.curveOffset, -cfg.curveOffset];\n    if (isNumber(cfg.curvePosition)) cfg.curvePosition = [cfg.curvePosition, 1 - cfg.curvePosition];\n    if (!controlPoints || !controlPoints.length || controlPoints.length < 2) {\n      var startPoint = cfg.startPoint,\n        endPoint = cfg.endPoint;\n      var innerPoint1 = getControlPoint(startPoint, endPoint, cfg.curvePosition[0], cfg.curveOffset[0]);\n      var innerPoint2 = getControlPoint(startPoint, endPoint, cfg.curvePosition[1], cfg.curveOffset[1]);\n      controlPoints = [innerPoint1, innerPoint2];\n    }\n    return controlPoints;\n  },\n  getPath: function getPath(points) {\n    var path = [];\n    path.push(['M', points[0].x, points[0].y]);\n    path.push(['C', points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y]);\n    return path;\n  }\n}, 'single-edge');\n// 垂直方向的三阶贝塞尔曲线，不再考虑用户外部传入的控制点\nShape.registerEdge('cubic-vertical', {\n  curvePosition: [1 / 2, 1 / 2],\n  minCurveOffset: [0, 0],\n  curveOffset: undefined,\n  getControlPoints: function getControlPoints(cfg) {\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    if (cfg.curvePosition === undefined) cfg.curvePosition = this.curvePosition;\n    if (cfg.curveOffset === undefined) cfg.curveOffset = this.curveOffset;\n    if (cfg.minCurveOffset === undefined) cfg.minCurveOffset = this.minCurveOffset;\n    if (isNumber(cfg.curveOffset)) cfg.curveOffset = [cfg.curveOffset, -cfg.curveOffset];\n    if (isNumber(cfg.minCurveOffset)) cfg.minCurveOffset = [cfg.minCurveOffset, -cfg.minCurveOffset];\n    if (isNumber(cfg.curvePosition)) cfg.curvePosition = [cfg.curvePosition, 1 - cfg.curvePosition];\n    var yDist = endPoint.y - startPoint.y;\n    var curveOffset = [0, 0];\n    if (cfg.curveOffset) {\n      curveOffset = cfg.curveOffset;\n    } else if (Math.abs(yDist) < Math.abs(cfg.minCurveOffset[0])) {\n      curveOffset = cfg.minCurveOffset;\n    }\n    var innerPoint1 = {\n      x: startPoint.x,\n      y: startPoint.y + yDist * this.curvePosition[0] + curveOffset[0]\n    };\n    var innerPoint2 = {\n      x: endPoint.x,\n      y: endPoint.y - yDist * this.curvePosition[1] + curveOffset[1]\n    };\n    return [innerPoint1, innerPoint2];\n  }\n}, 'cubic');\n// 水平方向的三阶贝塞尔曲线，不再考虑用户外部传入的控制点\nShape.registerEdge('cubic-horizontal', {\n  curvePosition: [1 / 2, 1 / 2],\n  minCurveOffset: [0, 0],\n  curveOffset: undefined,\n  getControlPoints: function getControlPoints(cfg) {\n    var startPoint = cfg.startPoint,\n      endPoint = cfg.endPoint;\n    if (cfg.curvePosition === undefined) cfg.curvePosition = this.curvePosition;\n    if (cfg.curveOffset === undefined) cfg.curveOffset = this.curveOffset;\n    if (cfg.minCurveOffset === undefined) cfg.minCurveOffset = this.minCurveOffset;\n    if (isNumber(cfg.curveOffset)) cfg.curveOffset = [cfg.curveOffset, -cfg.curveOffset];\n    if (isNumber(cfg.minCurveOffset)) cfg.minCurveOffset = [cfg.minCurveOffset, -cfg.minCurveOffset];\n    if (isNumber(cfg.curvePosition)) cfg.curvePosition = [cfg.curvePosition, 1 - cfg.curvePosition];\n    var xDist = endPoint.x - startPoint.x;\n    var curveOffset = [0, 0];\n    if (cfg.curveOffset) {\n      curveOffset = cfg.curveOffset;\n    } else if (Math.abs(xDist) < Math.abs(cfg.minCurveOffset[0])) {\n      curveOffset = cfg.minCurveOffset;\n    }\n    var innerPoint1 = {\n      x: startPoint.x + xDist * this.curvePosition[0] + curveOffset[0],\n      y: startPoint.y\n    };\n    var innerPoint2 = {\n      x: endPoint.x - xDist * this.curvePosition[1] + curveOffset[1],\n      y: endPoint.y\n    };\n    var controlPoints = [innerPoint1, innerPoint2];\n    return controlPoints;\n  }\n}, 'cubic');\nShape.registerEdge('loop', {\n  getPathPoints: function getPathPoints(cfg) {\n    return getLoopCfgs(cfg);\n  },\n  getControlPoints: function getControlPoints(cfg) {\n    return cfg.controlPoints;\n  },\n  afterDraw: function afterDraw(cfg) {\n    cfg.controlPoints = undefined;\n  },\n  afterUpdate: function afterUpdate(cfg) {\n    cfg.controlPoints = undefined;\n  }\n}, 'cubic');"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
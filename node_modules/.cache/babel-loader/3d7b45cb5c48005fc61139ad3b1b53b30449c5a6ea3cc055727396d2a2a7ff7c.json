{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport function getUniformLengthByType(type) {\n  var arrayLength = 0;\n  switch (type) {\n    case 'vec2':\n    case 'ivec2':\n      arrayLength = 2;\n      break;\n    case 'vec3':\n    case 'ivec3':\n      arrayLength = 3;\n      break;\n    case 'vec4':\n    case 'ivec4':\n    case 'mat2':\n      arrayLength = 4;\n      break;\n    case 'mat3':\n      arrayLength = 9;\n      break;\n    case 'mat4':\n      arrayLength = 16;\n      break;\n    default:\n  }\n  return arrayLength;\n}\nvar uniformRegExp = /uniform\\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\\s+([\\s\\S]*?);/g;\nfunction fillUniforms(content) {\n  var uniformPrefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var uniforms = {};\n  content = content.replace(uniformRegExp, function (_, type, c) {\n    var defaultValues = c.split(':');\n    var uniformName = defaultValues[0].trim();\n    var defaultValue = '';\n    if (defaultValues.length > 1) {\n      defaultValue = defaultValues[1].trim();\n    }\n\n    // set default value for uniform according to its type\n    // eg. vec2 u -> [0.0, 0.0]\n    switch (type) {\n      case 'bool':\n        defaultValue = defaultValue === 'true';\n        break;\n      case 'float':\n      case 'int':\n        defaultValue = Number(defaultValue);\n        break;\n      case 'vec2':\n      case 'vec3':\n      case 'vec4':\n      case 'ivec2':\n      case 'ivec3':\n      case 'ivec4':\n      case 'mat2':\n      case 'mat3':\n      case 'mat4':\n        if (defaultValue) {\n          defaultValue = defaultValue.replace('[', '').replace(']', '').split(',').reduce(function (prev, cur) {\n            prev.push(Number(cur.trim()));\n            return prev;\n          }, []);\n        } else {\n          defaultValue = new Array(getUniformLengthByType(type)).fill(0);\n        }\n        break;\n      default:\n    }\n\n    // @ts-ignore\n    uniforms[uniformName] = defaultValue;\n    return \"\".concat(uniformPrefix ? 'uniform ' : '').concat(type, \" \").concat(uniformName, \";\\n\");\n  });\n  return {\n    content: content,\n    uniforms: uniforms\n  };\n}\nexport function extractUniforms(content) {\n  // eslint-disable-next-line prefer-const\n  var _fillUniforms = fillUniforms(content, true),\n    c = _fillUniforms.content,\n    u = _fillUniforms.uniforms;\n  c = c.replace(/(\\s*uniform\\s*.*\\s*){((?:\\s*.*\\s*)*?)};/g, function (substr, header, uniforms) {\n    uniforms = uniforms.trim().replace(/^.*$/gm, function (uniform) {\n      return \"uniform \".concat(uniform);\n    });\n    var _fillUniforms2 = fillUniforms(uniforms),\n      cc = _fillUniforms2.content,\n      uu = _fillUniforms2.uniforms;\n    Object.assign(u, uu);\n    return \"\".concat(header, \"{\\n\").concat(cc, \"\\n};\");\n  });\n  return {\n    content: c,\n    uniforms: u\n  };\n}\nexport function removeDuplicateUniforms(content) {\n  var uniforms = {};\n  return content.replace(uniformRegExp, function (_, type, uniformName) {\n    var name = uniformName.trim();\n    if (!uniforms[name]) {\n      uniforms[name] = true;\n      return \"uniform \".concat(type, \" \").concat(name, \";\\n\");\n    } else {\n      return '';\n    }\n  });\n}","map":{"version":3,"names":["getUniformLengthByType","type","arrayLength","uniformRegExp","fillUniforms","content","uniformPrefix","arguments","length","undefined","uniforms","replace","_","c","defaultValues","split","uniformName","trim","defaultValue","Number","reduce","prev","cur","push","Array","fill","concat","extractUniforms","_fillUniforms","u","substr","header","uniform","_fillUniforms2","cc","uu","Object","assign","removeDuplicateUniforms","name"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-core/es/utils/shader-module.js"],"sourcesContent":["export function getUniformLengthByType(type) {\n  var arrayLength = 0;\n  switch (type) {\n    case 'vec2':\n    case 'ivec2':\n      arrayLength = 2;\n      break;\n    case 'vec3':\n    case 'ivec3':\n      arrayLength = 3;\n      break;\n    case 'vec4':\n    case 'ivec4':\n    case 'mat2':\n      arrayLength = 4;\n      break;\n    case 'mat3':\n      arrayLength = 9;\n      break;\n    case 'mat4':\n      arrayLength = 16;\n      break;\n    default:\n  }\n  return arrayLength;\n}\nvar uniformRegExp = /uniform\\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\\s+([\\s\\S]*?);/g;\nfunction fillUniforms(content) {\n  var uniformPrefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var uniforms = {};\n  content = content.replace(uniformRegExp, function (_, type, c) {\n    var defaultValues = c.split(':');\n    var uniformName = defaultValues[0].trim();\n    var defaultValue = '';\n    if (defaultValues.length > 1) {\n      defaultValue = defaultValues[1].trim();\n    }\n\n    // set default value for uniform according to its type\n    // eg. vec2 u -> [0.0, 0.0]\n    switch (type) {\n      case 'bool':\n        defaultValue = defaultValue === 'true';\n        break;\n      case 'float':\n      case 'int':\n        defaultValue = Number(defaultValue);\n        break;\n      case 'vec2':\n      case 'vec3':\n      case 'vec4':\n      case 'ivec2':\n      case 'ivec3':\n      case 'ivec4':\n      case 'mat2':\n      case 'mat3':\n      case 'mat4':\n        if (defaultValue) {\n          defaultValue = defaultValue.replace('[', '').replace(']', '').split(',').reduce(function (prev, cur) {\n            prev.push(Number(cur.trim()));\n            return prev;\n          }, []);\n        } else {\n          defaultValue = new Array(getUniformLengthByType(type)).fill(0);\n        }\n        break;\n      default:\n    }\n\n    // @ts-ignore\n    uniforms[uniformName] = defaultValue;\n    return \"\".concat(uniformPrefix ? 'uniform ' : '').concat(type, \" \").concat(uniformName, \";\\n\");\n  });\n  return {\n    content: content,\n    uniforms: uniforms\n  };\n}\nexport function extractUniforms(content) {\n  // eslint-disable-next-line prefer-const\n  var _fillUniforms = fillUniforms(content, true),\n    c = _fillUniforms.content,\n    u = _fillUniforms.uniforms;\n  c = c.replace(/(\\s*uniform\\s*.*\\s*){((?:\\s*.*\\s*)*?)};/g, function (substr, header, uniforms) {\n    uniforms = uniforms.trim().replace(/^.*$/gm, function (uniform) {\n      return \"uniform \".concat(uniform);\n    });\n    var _fillUniforms2 = fillUniforms(uniforms),\n      cc = _fillUniforms2.content,\n      uu = _fillUniforms2.uniforms;\n    Object.assign(u, uu);\n    return \"\".concat(header, \"{\\n\").concat(cc, \"\\n};\");\n  });\n  return {\n    content: c,\n    uniforms: u\n  };\n}\nexport function removeDuplicateUniforms(content) {\n  var uniforms = {};\n  return content.replace(uniformRegExp, function (_, type, uniformName) {\n    var name = uniformName.trim();\n    if (!uniforms[name]) {\n      uniforms[name] = true;\n      return \"uniform \".concat(type, \" \").concat(name, \";\\n\");\n    } else {\n      return '';\n    }\n  });\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _initializerDefineProperty from \"@babel/runtime/helpers/esm/initializerDefineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _applyDecoratedDescriptor from \"@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"@babel/runtime/helpers/esm/initializerWarningHelper\";\nvar _dec, _class, _descriptor;\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { BlendType, lazyInject, MaskOperation, StencilType, TYPES } from '@antv/l7-core';\nimport { rgb2arr } from '@antv/l7-utils';\nimport { BlendTypes } from \"../utils/blend\";\nimport { getStencil as _getStencil, getStencilMask } from \"../utils/stencil\";\nimport { getCommonStyleAttributeOptions, ShaderLocation } from \"./CommonStyleAttribute\";\nimport { DefaultUniformStyleType, DefaultUniformStyleValue } from \"./constant\";\nimport { MultipleOfFourNumber } from \"./utils\";\nvar shaderLocationMap = {\n  opacity: ShaderLocation.OPACITY,\n  stroke: ShaderLocation.STROKE,\n  offsets: ShaderLocation.OFFSETS,\n  rotation: ShaderLocation.ROTATION,\n  extrusionBase: ShaderLocation.EXTRUSION_BASE,\n  thetaOffset: 15\n};\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nvar BaseModel = (_dec = lazyInject(TYPES.IGlobalConfigService), (_class = /*#__PURE__*/function () {\n  // @lazyInject(TYPES.IIconService)\n  // protected readonly iconService: IIconService;\n\n  // @lazyInject(TYPES.IFontService)\n  // protected readonly fontService: IFontService;\n\n  // @lazyInject(TYPES.IShaderModuleService)\n\n  // 支持数据映射的buffer\n  // 不支持数据映射的buffer\n\n  // style texture data mapping\n\n  function BaseModel(layer) {\n    _classCallCheck(this, BaseModel);\n    _defineProperty(this, \"uniformBuffers\", []);\n    _defineProperty(this, \"textures\", []);\n    _defineProperty(this, \"preStyleAttribute\", {});\n    _defineProperty(this, \"encodeStyleAttribute\", {});\n    _initializerDefineProperty(this, \"configService\", _descriptor, this);\n    this.layer = layer;\n    this.rendererService = layer.getContainer().get(TYPES.IRendererService);\n    this.pickingService = layer.getContainer().get(TYPES.IPickingService);\n    this.shaderModuleService = layer.getContainer().get(TYPES.IShaderModuleService);\n    this.styleAttributeService = layer.getContainer().get(TYPES.IStyleAttributeService);\n    this.mapService = layer.getContainer().get(TYPES.IMapService);\n    this.iconService = layer.getContainer().get(TYPES.IIconService);\n    this.fontService = layer.getContainer().get(TYPES.IFontService);\n    this.cameraService = layer.getContainer().get(TYPES.ICameraService);\n    this.layerService = layer.getContainer().get(TYPES.ILayerService);\n    // 初始化支持数据映射的 Style 属性\n\n    this.registerStyleAttribute();\n    // 注册 Attribute\n    this.registerBuiltinAttributes();\n    // 开启动画\n    this.startModelAnimate();\n    var createTexture2D = this.rendererService.createTexture2D;\n    this.createTexture2D = createTexture2D;\n  }\n\n  // style datatexture mapping\n  _createClass(BaseModel, [{\n    key: \"getBlend\",\n    value: function getBlend() {\n      var _this$layer$getLayerC = this.layer.getLayerConfig(),\n        _this$layer$getLayerC2 = _this$layer$getLayerC.blend,\n        blend = _this$layer$getLayerC2 === void 0 ? 'normal' : _this$layer$getLayerC2;\n      return BlendTypes[BlendType[blend]];\n    }\n  }, {\n    key: \"getStencil\",\n    value: function getStencil(option) {\n      var _this$layer$getLayerC3 = this.layer.getLayerConfig(),\n        _this$layer$getLayerC4 = _this$layer$getLayerC3.mask,\n        mask = _this$layer$getLayerC4 === void 0 ? false : _this$layer$getLayerC4,\n        _this$layer$getLayerC5 = _this$layer$getLayerC3.maskInside,\n        maskInside = _this$layer$getLayerC5 === void 0 ? true : _this$layer$getLayerC5,\n        enableMask = _this$layer$getLayerC3.enableMask,\n        _this$layer$getLayerC6 = _this$layer$getLayerC3.maskOperation,\n        maskOperation = _this$layer$getLayerC6 === void 0 ? MaskOperation.AND : _this$layer$getLayerC6;\n      // TODO 临时处理，后期移除MaskLayer\n      if (this.layer.type === 'MaskLayer') {\n        return getStencilMask({\n          isStencil: true,\n          stencilType: StencilType.SINGLE\n        }); // 用于遮罩的stencil 参数\n      }\n\n      if (option.isStencil) {\n        return getStencilMask(_objectSpread(_objectSpread({}, option), {}, {\n          maskOperation: maskOperation\n        })); // 用于遮罩的stencil 参数\n      }\n\n      var maskflag = mask ||\n      //  mask 兼容历史写法\n      enableMask && this.layer.masks.length !== 0 ||\n      // 外部图层的mask\n      this.layer.tileMask !== undefined; // 瓦片图层\n      // !!(mask || enableMask || this.layer.tileMask);\n      return _getStencil(maskflag, maskInside);\n    }\n  }, {\n    key: \"getDefaultStyle\",\n    value: function getDefaultStyle() {\n      return {};\n    }\n    // public getUninforms(): IModelUniform {\n    //   throw new Error('Method not implemented.');\n    // }\n  }, {\n    key: \"getUninforms\",\n    value: function getUninforms() {\n      var commoninfo = this.getCommonUniformsInfo();\n      var attributeInfo = this.getUniformsBufferInfo(this.getStyleAttribute());\n      this.updateStyleUnifoms();\n      var result = _objectSpread(_objectSpread({}, attributeInfo.uniformsOption), commoninfo.uniformsOption);\n      //如果是regl渲染 需要在uniform中带上u_texture 暂时用this.rendererService.device判断\n      if (!this.rendererService.hasOwnProperty('device') && this.textures && this.textures.length === 1) {\n        result['u_texture'] = this.textures[0];\n      }\n      return result;\n    }\n  }, {\n    key: \"getAnimateUniforms\",\n    value: function getAnimateUniforms() {\n      return {};\n    }\n  }, {\n    key: \"needUpdate\",\n    value: function () {\n      var _needUpdate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", false);\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      function needUpdate() {\n        return _needUpdate.apply(this, arguments);\n      }\n      return needUpdate;\n    }() // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"buildModels\",\n    value: function () {\n      var _buildModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              throw new Error('Method not implemented.');\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }));\n      function buildModels() {\n        return _buildModels.apply(this, arguments);\n      }\n      return buildModels;\n    }() // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"initModels\",\n    value: function () {\n      var _initModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              throw new Error('Method not implemented.');\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }));\n      function initModels() {\n        return _initModels.apply(this, arguments);\n      }\n      return initModels;\n    }() // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"clearModels\",\n    value: function clearModels() {\n      var refresh = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      return;\n    }\n  }, {\n    key: \"getAttribute\",\n    value: function getAttribute() {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"prerender\",\n    value: function prerender() {}\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"render\",\n    value: function render(renderOptions) {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"registerBuiltinAttributes\",\n    value: function registerBuiltinAttributes() {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"animateOption2Array\",\n    value: function animateOption2Array(option) {\n      return [option.enable ? 0 : 1.0, option.duration || 4.0, option.interval || 0.2, option.trailLength || 0.1];\n    }\n  }, {\n    key: \"startModelAnimate\",\n    value: function startModelAnimate() {\n      var _ref = this.layer.getLayerConfig(),\n        animateOption = _ref.animateOption;\n      if (animateOption.enable) {\n        this.layer.setAnimateStartTime();\n      }\n    }\n\n    // 动态注入参与数据映射的uniform\n  }, {\n    key: \"getInject\",\n    value: function getInject() {\n      var encodeStyleAttribute = this.layer.encodeStyleAttribute;\n      var str = '';\n      // a_Position = 0\n      // a_Color = 1\n      // a_PickingColor = 2\n\n      var uniforms = [];\n      // 支持数据映射的类型\n      this.layer.enableShaderEncodeStyles.forEach(function (key) {\n        if (encodeStyleAttribute[key]) {\n          // 配置了数据映射的类型\n          str += \"#define USE_ATTRIBUTE_\".concat(key.toUpperCase(), \" 0.0; \\n\\n\");\n        } else {\n          uniforms.push(\"  \".concat(DefaultUniformStyleType[key], \" u_\").concat(key, \";\"));\n        }\n        var location = shaderLocationMap[key];\n        if (!location && key === 'THETA_OFFSET') {\n          location = 15;\n        }\n        str += \"\\n          #ifdef USE_ATTRIBUTE_\".concat(key.toUpperCase(), \"\\n          layout(location = \").concat(shaderLocationMap[key], \") in \").concat(DefaultUniformStyleType[key], \" a_\").concat(key.charAt(0).toUpperCase() + key.slice(1), \";\\n        #endif\\n\\n        \");\n      });\n      var attributeUniforms = uniforms.length ? \"\\nlayout(std140) uniform AttributeUniforms {\\n\".concat(uniforms.join('\\n'), \"\\n};\\n    \") : '';\n      str += attributeUniforms;\n      var innerStr = '';\n      this.layer.enableShaderEncodeStyles.forEach(function (key) {\n        innerStr += \"\\n\\n    #ifdef USE_ATTRIBUTE_\".concat(key.toUpperCase(), \"\\n      \").concat(DefaultUniformStyleType[key], \" \").concat(key, \"  = a_\").concat(key.charAt(0).toUpperCase() + key.slice(1), \";\\n    #else\\n      \").concat(DefaultUniformStyleType[key], \" \").concat(key, \" = u_\").concat(key, \";\\n    #endif\\n\\n    \");\n      });\n      return {\n        'vs:#decl': str,\n        'fs:#decl': attributeUniforms,\n        'vs:#main-start': innerStr\n      };\n    }\n\n    // 获取数据映射样式\n  }, {\n    key: \"getStyleAttribute\",\n    value: function getStyleAttribute() {\n      var _this = this;\n      var options = {};\n      // TODO: 优化\n      this.layer.enableShaderEncodeStyles.forEach(function (key) {\n        if (!_this.layer.encodeStyleAttribute[key]) {\n          // 没有设置样式映射\n          // @ts-ignore\n          var keyValue = _this.layer.getLayerConfig()[key];\n          var value = typeof keyValue === 'undefined' ? DefaultUniformStyleValue[key] : keyValue;\n          if (key === 'stroke') {\n            value = rgb2arr(value);\n          }\n          options['u_' + key] = value;\n        }\n      });\n      return options;\n    }\n    // 注册数据映射样式\n  }, {\n    key: \"registerStyleAttribute\",\n    value: function registerStyleAttribute() {\n      var _this2 = this;\n      Object.keys(this.layer.encodeStyleAttribute).forEach(function (key) {\n        var options = getCommonStyleAttributeOptions(key);\n        if (options) {\n          _this2.styleAttributeService.registerStyleAttribute(options);\n          if (options.descriptor) {\n            options.descriptor.shaderLocation = shaderLocationMap[key];\n          }\n        }\n      });\n    }\n  }, {\n    key: \"updateEncodeAttribute\",\n    value: function updateEncodeAttribute(type, flag) {\n      this.encodeStyleAttribute[type] = flag;\n    }\n  }, {\n    key: \"initUniformsBuffer\",\n    value: function initUniformsBuffer() {\n      var attrUniforms = this.getUniformsBufferInfo(this.getStyleAttribute());\n      var commonUniforms = this.getCommonUniformsInfo();\n      if (attrUniforms.uniformsLength !== 0) {\n        this.attributeUnifoms = this.rendererService.createBuffer({\n          data: new Float32Array(MultipleOfFourNumber(attrUniforms.uniformsLength)).fill(0),\n          // 长度需要大于等于 4\n          isUBO: true\n        });\n        this.uniformBuffers.push(this.attributeUnifoms);\n      }\n      if (commonUniforms.uniformsLength !== 0) {\n        this.commonUnifoms = this.rendererService.createBuffer({\n          data: new Float32Array(MultipleOfFourNumber(commonUniforms.uniformsLength)).fill(0),\n          isUBO: true\n        });\n        this.uniformBuffers.push(this.commonUnifoms);\n      }\n    }\n    // 获取数据映射 uniform 信息\n  }, {\n    key: \"getUniformsBufferInfo\",\n    value: function getUniformsBufferInfo(uniformsOption) {\n      var uniformsLength = 0;\n      var uniformsArray = [];\n      Object.values(uniformsOption).forEach(function (value) {\n        if (Array.isArray(value)) {\n          uniformsArray.push.apply(uniformsArray, _toConsumableArray(value));\n          uniformsLength += value.length;\n        } else if (typeof value === 'number') {\n          // 排除纹理\n          uniformsArray.push(value);\n          uniformsLength += 1;\n        } else if (typeof value === 'boolean') {\n          uniformsArray.push(Number(value));\n          uniformsLength += 1;\n        }\n      });\n      return {\n        uniformsOption: uniformsOption,\n        uniformsLength: uniformsLength,\n        uniformsArray: uniformsArray\n      };\n    }\n  }, {\n    key: \"getCommonUniformsInfo\",\n    value: function getCommonUniformsInfo() {\n      return {\n        uniformsLength: 0,\n        uniformsArray: [],\n        uniformsOption: {}\n      };\n    }\n\n    // 更新支持数据映射的uniform\n  }, {\n    key: \"updateStyleUnifoms\",\n    value: function updateStyleUnifoms() {\n      var _this$attributeUnifom, _this$commonUnifoms;\n      var _this$getUniformsBuff = this.getUniformsBufferInfo(this.getStyleAttribute()),\n        uniformsArray = _this$getUniformsBuff.uniformsArray;\n      var _this$getCommonUnifor = this.getCommonUniformsInfo(),\n        commonUniformsArray = _this$getCommonUnifor.uniformsArray;\n      (_this$attributeUnifom = this.attributeUnifoms) === null || _this$attributeUnifom === void 0 || _this$attributeUnifom.subData({\n        offset: 0,\n        data: new Uint8Array(new Float32Array(uniformsArray).buffer)\n      });\n      (_this$commonUnifoms = this.commonUnifoms) === null || _this$commonUnifoms === void 0 || _this$commonUnifoms.subData({\n        offset: 0,\n        data: new Uint8Array(new Float32Array(commonUniformsArray).buffer)\n      });\n    }\n  }]);\n  return BaseModel;\n}(), _descriptor = _applyDecoratedDescriptor(_class.prototype, \"configService\", [_dec], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _class));\nexport { BaseModel as default };","map":{"version":3,"names":["_toConsumableArray","_asyncToGenerator","_objectSpread","_initializerDefineProperty","_classCallCheck","_createClass","_defineProperty","_applyDecoratedDescriptor","_initializerWarningHelper","_dec","_class","_descriptor","_regeneratorRuntime","BlendType","lazyInject","MaskOperation","StencilType","TYPES","rgb2arr","BlendTypes","getStencil","_getStencil","getStencilMask","getCommonStyleAttributeOptions","ShaderLocation","DefaultUniformStyleType","DefaultUniformStyleValue","MultipleOfFourNumber","shaderLocationMap","opacity","OPACITY","stroke","STROKE","offsets","OFFSETS","rotation","ROTATION","extrusionBase","EXTRUSION_BASE","thetaOffset","BaseModel","IGlobalConfigService","layer","rendererService","getContainer","get","IRendererService","pickingService","IPickingService","shaderModuleService","IShaderModuleService","styleAttributeService","IStyleAttributeService","mapService","IMapService","iconService","IIconService","fontService","IFontService","cameraService","ICameraService","layerService","ILayerService","registerStyleAttribute","registerBuiltinAttributes","startModelAnimate","createTexture2D","key","value","getBlend","_this$layer$getLayerC","getLayerConfig","_this$layer$getLayerC2","blend","option","_this$layer$getLayerC3","_this$layer$getLayerC4","mask","_this$layer$getLayerC5","maskInside","enableMask","_this$layer$getLayerC6","maskOperation","AND","type","isStencil","stencilType","SINGLE","maskflag","masks","length","tileMask","undefined","getDefaultStyle","getUninforms","commoninfo","getCommonUniformsInfo","attributeInfo","getUniformsBufferInfo","getStyleAttribute","updateStyleUnifoms","result","uniformsOption","hasOwnProperty","textures","getAnimateUniforms","_needUpdate","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","stop","needUpdate","apply","arguments","_buildModels","_callee2","_callee2$","_context2","Error","buildModels","_initModels","_callee3","_callee3$","_context3","initModels","clearModels","refresh","getAttribute","prerender","render","renderOptions","animateOption2Array","enable","duration","interval","trailLength","_ref","animateOption","setAnimateStartTime","getInject","encodeStyleAttribute","str","uniforms","enableShaderEncodeStyles","forEach","concat","toUpperCase","push","location","charAt","slice","attributeUniforms","join","innerStr","_this","options","keyValue","_this2","Object","keys","descriptor","shaderLocation","updateEncodeAttribute","flag","initUniformsBuffer","attrUniforms","commonUniforms","uniformsLength","attributeUnifoms","createBuffer","data","Float32Array","fill","isUBO","uniformBuffers","commonUnifoms","uniformsArray","values","Array","isArray","Number","_this$attributeUnifom","_this$commonUnifoms","_this$getUniformsBuff","_this$getCommonUnifor","commonUniformsArray","subData","offset","Uint8Array","buffer","prototype","configurable","enumerable","writable","initializer","default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-layers/es/core/BaseModel.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _initializerDefineProperty from \"@babel/runtime/helpers/esm/initializerDefineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _applyDecoratedDescriptor from \"@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"@babel/runtime/helpers/esm/initializerWarningHelper\";\nvar _dec, _class, _descriptor;\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { BlendType, lazyInject, MaskOperation, StencilType, TYPES } from '@antv/l7-core';\nimport { rgb2arr } from '@antv/l7-utils';\nimport { BlendTypes } from \"../utils/blend\";\nimport { getStencil as _getStencil, getStencilMask } from \"../utils/stencil\";\nimport { getCommonStyleAttributeOptions, ShaderLocation } from \"./CommonStyleAttribute\";\nimport { DefaultUniformStyleType, DefaultUniformStyleValue } from \"./constant\";\nimport { MultipleOfFourNumber } from \"./utils\";\nvar shaderLocationMap = {\n  opacity: ShaderLocation.OPACITY,\n  stroke: ShaderLocation.STROKE,\n  offsets: ShaderLocation.OFFSETS,\n  rotation: ShaderLocation.ROTATION,\n  extrusionBase: ShaderLocation.EXTRUSION_BASE,\n  thetaOffset: 15\n};\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nvar BaseModel = (_dec = lazyInject(TYPES.IGlobalConfigService), (_class = /*#__PURE__*/function () {\n  // @lazyInject(TYPES.IIconService)\n  // protected readonly iconService: IIconService;\n\n  // @lazyInject(TYPES.IFontService)\n  // protected readonly fontService: IFontService;\n\n  // @lazyInject(TYPES.IShaderModuleService)\n\n  // 支持数据映射的buffer\n  // 不支持数据映射的buffer\n\n  // style texture data mapping\n\n  function BaseModel(layer) {\n    _classCallCheck(this, BaseModel);\n    _defineProperty(this, \"uniformBuffers\", []);\n    _defineProperty(this, \"textures\", []);\n    _defineProperty(this, \"preStyleAttribute\", {});\n    _defineProperty(this, \"encodeStyleAttribute\", {});\n    _initializerDefineProperty(this, \"configService\", _descriptor, this);\n    this.layer = layer;\n    this.rendererService = layer.getContainer().get(TYPES.IRendererService);\n    this.pickingService = layer.getContainer().get(TYPES.IPickingService);\n    this.shaderModuleService = layer.getContainer().get(TYPES.IShaderModuleService);\n    this.styleAttributeService = layer.getContainer().get(TYPES.IStyleAttributeService);\n    this.mapService = layer.getContainer().get(TYPES.IMapService);\n    this.iconService = layer.getContainer().get(TYPES.IIconService);\n    this.fontService = layer.getContainer().get(TYPES.IFontService);\n    this.cameraService = layer.getContainer().get(TYPES.ICameraService);\n    this.layerService = layer.getContainer().get(TYPES.ILayerService);\n    // 初始化支持数据映射的 Style 属性\n\n    this.registerStyleAttribute();\n    // 注册 Attribute\n    this.registerBuiltinAttributes();\n    // 开启动画\n    this.startModelAnimate();\n    var createTexture2D = this.rendererService.createTexture2D;\n    this.createTexture2D = createTexture2D;\n  }\n\n  // style datatexture mapping\n  _createClass(BaseModel, [{\n    key: \"getBlend\",\n    value: function getBlend() {\n      var _this$layer$getLayerC = this.layer.getLayerConfig(),\n        _this$layer$getLayerC2 = _this$layer$getLayerC.blend,\n        blend = _this$layer$getLayerC2 === void 0 ? 'normal' : _this$layer$getLayerC2;\n      return BlendTypes[BlendType[blend]];\n    }\n  }, {\n    key: \"getStencil\",\n    value: function getStencil(option) {\n      var _this$layer$getLayerC3 = this.layer.getLayerConfig(),\n        _this$layer$getLayerC4 = _this$layer$getLayerC3.mask,\n        mask = _this$layer$getLayerC4 === void 0 ? false : _this$layer$getLayerC4,\n        _this$layer$getLayerC5 = _this$layer$getLayerC3.maskInside,\n        maskInside = _this$layer$getLayerC5 === void 0 ? true : _this$layer$getLayerC5,\n        enableMask = _this$layer$getLayerC3.enableMask,\n        _this$layer$getLayerC6 = _this$layer$getLayerC3.maskOperation,\n        maskOperation = _this$layer$getLayerC6 === void 0 ? MaskOperation.AND : _this$layer$getLayerC6;\n      // TODO 临时处理，后期移除MaskLayer\n      if (this.layer.type === 'MaskLayer') {\n        return getStencilMask({\n          isStencil: true,\n          stencilType: StencilType.SINGLE\n        }); // 用于遮罩的stencil 参数\n      }\n\n      if (option.isStencil) {\n        return getStencilMask(_objectSpread(_objectSpread({}, option), {}, {\n          maskOperation: maskOperation\n        })); // 用于遮罩的stencil 参数\n      }\n\n      var maskflag = mask ||\n      //  mask 兼容历史写法\n      enableMask && this.layer.masks.length !== 0 ||\n      // 外部图层的mask\n      this.layer.tileMask !== undefined; // 瓦片图层\n      // !!(mask || enableMask || this.layer.tileMask);\n      return _getStencil(maskflag, maskInside);\n    }\n  }, {\n    key: \"getDefaultStyle\",\n    value: function getDefaultStyle() {\n      return {};\n    }\n    // public getUninforms(): IModelUniform {\n    //   throw new Error('Method not implemented.');\n    // }\n  }, {\n    key: \"getUninforms\",\n    value: function getUninforms() {\n      var commoninfo = this.getCommonUniformsInfo();\n      var attributeInfo = this.getUniformsBufferInfo(this.getStyleAttribute());\n      this.updateStyleUnifoms();\n      var result = _objectSpread(_objectSpread({}, attributeInfo.uniformsOption), commoninfo.uniformsOption);\n      //如果是regl渲染 需要在uniform中带上u_texture 暂时用this.rendererService.device判断\n      if (!this.rendererService.hasOwnProperty('device') && this.textures && this.textures.length === 1) {\n        result['u_texture'] = this.textures[0];\n      }\n      return result;\n    }\n  }, {\n    key: \"getAnimateUniforms\",\n    value: function getAnimateUniforms() {\n      return {};\n    }\n  }, {\n    key: \"needUpdate\",\n    value: function () {\n      var _needUpdate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", false);\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      function needUpdate() {\n        return _needUpdate.apply(this, arguments);\n      }\n      return needUpdate;\n    }() // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"buildModels\",\n    value: function () {\n      var _buildModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              throw new Error('Method not implemented.');\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }));\n      function buildModels() {\n        return _buildModels.apply(this, arguments);\n      }\n      return buildModels;\n    }() // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"initModels\",\n    value: function () {\n      var _initModels = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              throw new Error('Method not implemented.');\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }));\n      function initModels() {\n        return _initModels.apply(this, arguments);\n      }\n      return initModels;\n    }() // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"clearModels\",\n    value: function clearModels() {\n      var refresh = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      return;\n    }\n  }, {\n    key: \"getAttribute\",\n    value: function getAttribute() {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"prerender\",\n    value: function prerender() {}\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  }, {\n    key: \"render\",\n    value: function render(renderOptions) {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"registerBuiltinAttributes\",\n    value: function registerBuiltinAttributes() {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"animateOption2Array\",\n    value: function animateOption2Array(option) {\n      return [option.enable ? 0 : 1.0, option.duration || 4.0, option.interval || 0.2, option.trailLength || 0.1];\n    }\n  }, {\n    key: \"startModelAnimate\",\n    value: function startModelAnimate() {\n      var _ref = this.layer.getLayerConfig(),\n        animateOption = _ref.animateOption;\n      if (animateOption.enable) {\n        this.layer.setAnimateStartTime();\n      }\n    }\n\n    // 动态注入参与数据映射的uniform\n  }, {\n    key: \"getInject\",\n    value: function getInject() {\n      var encodeStyleAttribute = this.layer.encodeStyleAttribute;\n      var str = '';\n      // a_Position = 0\n      // a_Color = 1\n      // a_PickingColor = 2\n\n      var uniforms = [];\n      // 支持数据映射的类型\n      this.layer.enableShaderEncodeStyles.forEach(function (key) {\n        if (encodeStyleAttribute[key]) {\n          // 配置了数据映射的类型\n          str += \"#define USE_ATTRIBUTE_\".concat(key.toUpperCase(), \" 0.0; \\n\\n\");\n        } else {\n          uniforms.push(\"  \".concat(DefaultUniformStyleType[key], \" u_\").concat(key, \";\"));\n        }\n        var location = shaderLocationMap[key];\n        if (!location && key === 'THETA_OFFSET') {\n          location = 15;\n        }\n        str += \"\\n          #ifdef USE_ATTRIBUTE_\".concat(key.toUpperCase(), \"\\n          layout(location = \").concat(shaderLocationMap[key], \") in \").concat(DefaultUniformStyleType[key], \" a_\").concat(key.charAt(0).toUpperCase() + key.slice(1), \";\\n        #endif\\n\\n        \");\n      });\n      var attributeUniforms = uniforms.length ? \"\\nlayout(std140) uniform AttributeUniforms {\\n\".concat(uniforms.join('\\n'), \"\\n};\\n    \") : '';\n      str += attributeUniforms;\n      var innerStr = '';\n      this.layer.enableShaderEncodeStyles.forEach(function (key) {\n        innerStr += \"\\n\\n    #ifdef USE_ATTRIBUTE_\".concat(key.toUpperCase(), \"\\n      \").concat(DefaultUniformStyleType[key], \" \").concat(key, \"  = a_\").concat(key.charAt(0).toUpperCase() + key.slice(1), \";\\n    #else\\n      \").concat(DefaultUniformStyleType[key], \" \").concat(key, \" = u_\").concat(key, \";\\n    #endif\\n\\n    \");\n      });\n      return {\n        'vs:#decl': str,\n        'fs:#decl': attributeUniforms,\n        'vs:#main-start': innerStr\n      };\n    }\n\n    // 获取数据映射样式\n  }, {\n    key: \"getStyleAttribute\",\n    value: function getStyleAttribute() {\n      var _this = this;\n      var options = {};\n      // TODO: 优化\n      this.layer.enableShaderEncodeStyles.forEach(function (key) {\n        if (!_this.layer.encodeStyleAttribute[key]) {\n          // 没有设置样式映射\n          // @ts-ignore\n          var keyValue = _this.layer.getLayerConfig()[key];\n          var value = typeof keyValue === 'undefined' ? DefaultUniformStyleValue[key] : keyValue;\n          if (key === 'stroke') {\n            value = rgb2arr(value);\n          }\n          options['u_' + key] = value;\n        }\n      });\n      return options;\n    }\n    // 注册数据映射样式\n  }, {\n    key: \"registerStyleAttribute\",\n    value: function registerStyleAttribute() {\n      var _this2 = this;\n      Object.keys(this.layer.encodeStyleAttribute).forEach(function (key) {\n        var options = getCommonStyleAttributeOptions(key);\n        if (options) {\n          _this2.styleAttributeService.registerStyleAttribute(options);\n          if (options.descriptor) {\n            options.descriptor.shaderLocation = shaderLocationMap[key];\n          }\n        }\n      });\n    }\n  }, {\n    key: \"updateEncodeAttribute\",\n    value: function updateEncodeAttribute(type, flag) {\n      this.encodeStyleAttribute[type] = flag;\n    }\n  }, {\n    key: \"initUniformsBuffer\",\n    value: function initUniformsBuffer() {\n      var attrUniforms = this.getUniformsBufferInfo(this.getStyleAttribute());\n      var commonUniforms = this.getCommonUniformsInfo();\n      if (attrUniforms.uniformsLength !== 0) {\n        this.attributeUnifoms = this.rendererService.createBuffer({\n          data: new Float32Array(MultipleOfFourNumber(attrUniforms.uniformsLength)).fill(0),\n          // 长度需要大于等于 4\n          isUBO: true\n        });\n        this.uniformBuffers.push(this.attributeUnifoms);\n      }\n      if (commonUniforms.uniformsLength !== 0) {\n        this.commonUnifoms = this.rendererService.createBuffer({\n          data: new Float32Array(MultipleOfFourNumber(commonUniforms.uniformsLength)).fill(0),\n          isUBO: true\n        });\n        this.uniformBuffers.push(this.commonUnifoms);\n      }\n    }\n    // 获取数据映射 uniform 信息\n  }, {\n    key: \"getUniformsBufferInfo\",\n    value: function getUniformsBufferInfo(uniformsOption) {\n      var uniformsLength = 0;\n      var uniformsArray = [];\n      Object.values(uniformsOption).forEach(function (value) {\n        if (Array.isArray(value)) {\n          uniformsArray.push.apply(uniformsArray, _toConsumableArray(value));\n          uniformsLength += value.length;\n        } else if (typeof value === 'number') {\n          // 排除纹理\n          uniformsArray.push(value);\n          uniformsLength += 1;\n        } else if (typeof value === 'boolean') {\n          uniformsArray.push(Number(value));\n          uniformsLength += 1;\n        }\n      });\n      return {\n        uniformsOption: uniformsOption,\n        uniformsLength: uniformsLength,\n        uniformsArray: uniformsArray\n      };\n    }\n  }, {\n    key: \"getCommonUniformsInfo\",\n    value: function getCommonUniformsInfo() {\n      return {\n        uniformsLength: 0,\n        uniformsArray: [],\n        uniformsOption: {}\n      };\n    }\n\n    // 更新支持数据映射的uniform\n  }, {\n    key: \"updateStyleUnifoms\",\n    value: function updateStyleUnifoms() {\n      var _this$attributeUnifom, _this$commonUnifoms;\n      var _this$getUniformsBuff = this.getUniformsBufferInfo(this.getStyleAttribute()),\n        uniformsArray = _this$getUniformsBuff.uniformsArray;\n      var _this$getCommonUnifor = this.getCommonUniformsInfo(),\n        commonUniformsArray = _this$getCommonUnifor.uniformsArray;\n      (_this$attributeUnifom = this.attributeUnifoms) === null || _this$attributeUnifom === void 0 || _this$attributeUnifom.subData({\n        offset: 0,\n        data: new Uint8Array(new Float32Array(uniformsArray).buffer)\n      });\n      (_this$commonUnifoms = this.commonUnifoms) === null || _this$commonUnifoms === void 0 || _this$commonUnifoms.subData({\n        offset: 0,\n        data: new Uint8Array(new Float32Array(commonUniformsArray).buffer)\n      });\n    }\n  }]);\n  return BaseModel;\n}(), (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"configService\", [_dec], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class));\nexport { BaseModel as default };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
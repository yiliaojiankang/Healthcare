{"ast":null,"code":"var ELLIPSIS_CODE = '\\u2026';\n/** 获取字符串长度 */\nexport function strLen(str) {\n  var len = 0;\n  for (var i = 0; i < str.length; i++) {\n    len += charAtLength(str, i);\n  }\n  return len;\n}\n/** 是否属于ASCII编码范畴 */\nexport function charAtLength(str, i) {\n  if (str.charCodeAt(i) > 0 && str.charCodeAt(i) < 128) {\n    return 1;\n  } else {\n    return 2;\n  }\n}\n/** 文本省略 */\nexport function ellipsisString(str, reseveLength, position) {\n  if (position === void 0) {\n    position = 'tail';\n  }\n  var count = str.length;\n  var rst = '';\n  if (position === 'tail') {\n    for (var i = 0, index = 0; i < reseveLength;) {\n      var charLength = charAtLength(str, index);\n      if (i + charLength <= reseveLength) {\n        rst += str[index];\n        i += charAtLength(str, index);\n        index++;\n      } else {\n        break;\n      }\n    }\n    rst += ELLIPSIS_CODE;\n  } else if (position === 'head') {\n    for (var i = 0, index = count - 1; i < reseveLength;) {\n      var charLength = charAtLength(str, index);\n      if (i + charLength <= reseveLength) {\n        rst += str[index];\n        i += charAtLength(str, index);\n        index--;\n      } else {\n        break;\n      }\n    }\n    rst = ELLIPSIS_CODE + rst;\n  } else {\n    var startStr = '';\n    var endStr = '';\n    for (var i = 0, startIndex = 0, endIndex = count - 1; i < reseveLength;) {\n      var startCodeLen = charAtLength(str, startIndex);\n      var hasAdd = false; // 设置标志位，防止头尾都没有附加字符\n      if (startCodeLen + i <= reseveLength) {\n        startStr += str[startIndex];\n        startIndex++;\n        i += startCodeLen;\n        hasAdd = true;\n      }\n      var endCodeLen = charAtLength(str, endIndex);\n      if (endCodeLen + i <= reseveLength) {\n        endStr = str[endIndex] + endStr;\n        i += endCodeLen;\n        endIndex--;\n        hasAdd = true;\n      }\n      if (!hasAdd) {\n        // 如果都没有增加字符，说明都不适合则中断\n        break;\n      }\n    }\n    rst = startStr + ELLIPSIS_CODE + endStr;\n  }\n  return rst;\n}","map":{"version":3,"names":["ELLIPSIS_CODE","strLen","str","len","i","length","charAtLength","charCodeAt","ellipsisString","reseveLength","position","count","rst","index","charLength","startStr","endStr","startIndex","endIndex","startCodeLen","hasAdd","endCodeLen"],"sources":["../../src/util/text.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
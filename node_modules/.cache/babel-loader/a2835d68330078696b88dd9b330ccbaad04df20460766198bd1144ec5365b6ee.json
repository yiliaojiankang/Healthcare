{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { each, isArray, isObject } from '@antv/util';\nimport { SVG_ATTR_MAP } from '../constant';\nimport ShapeBase from './base';\nvar Path = /** @class */function (_super) {\n  __extends(Path, _super);\n  function Path() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.type = 'path';\n    _this.canFill = true;\n    _this.canStroke = true;\n    return _this;\n  }\n  Path.prototype.getDefaultAttrs = function () {\n    var attrs = _super.prototype.getDefaultAttrs.call(this);\n    return __assign(__assign({}, attrs), {\n      startArrow: false,\n      endArrow: false\n    });\n  };\n  Path.prototype.createPath = function (context, targetAttrs) {\n    var _this = this;\n    var attrs = this.attr();\n    var el = this.get('el');\n    each(targetAttrs || attrs, function (value, attr) {\n      if (attr === 'path' && isArray(value)) {\n        el.setAttribute('d', _this._formatPath(value));\n      } else if (attr === 'startArrow' || attr === 'endArrow') {\n        if (value) {\n          var id = isObject(value) ? context.addArrow(attrs, SVG_ATTR_MAP[attr]) : context.getDefaultArrow(attrs, SVG_ATTR_MAP[attr]);\n          el.setAttribute(SVG_ATTR_MAP[attr], \"url(#\" + id + \")\");\n        } else {\n          el.removeAttribute(SVG_ATTR_MAP[attr]);\n        }\n      } else if (SVG_ATTR_MAP[attr]) {\n        el.setAttribute(SVG_ATTR_MAP[attr], value);\n      }\n    });\n  };\n  Path.prototype._formatPath = function (value) {\n    var newValue = value.map(function (path) {\n      return path.join(' ');\n    }).join('');\n    if (~newValue.indexOf('NaN')) {\n      return '';\n    }\n    return newValue;\n  };\n  /**\n   * Get total length of path\n   * 尽管通过浏览器的 SVGPathElement.getTotalLength() 接口获取的 path 长度，\n   * 与 Canvas 版本通过数学计算的方式得到的长度有一些细微差异，但最大误差在个位数像素，精度上可以能接受\n   * @return {number} length\n   */\n  Path.prototype.getTotalLength = function () {\n    var el = this.get('el');\n    return el ? el.getTotalLength() : null;\n  };\n  /**\n   * Get point according to ratio\n   * @param {number} ratio\n   * @return {Point} point\n   */\n  Path.prototype.getPoint = function (ratio) {\n    var el = this.get('el');\n    var totalLength = this.getTotalLength();\n    // @see https://github.com/antvis/g/issues/634\n    if (totalLength === 0) {\n      return null;\n    }\n    var point = el ? el.getPointAtLength(ratio * totalLength) : null;\n    return point ? {\n      x: point.x,\n      y: point.y\n    } : null;\n  };\n  return Path;\n}(ShapeBase);\nexport default Path;","map":{"version":3,"names":["each","isArray","isObject","SVG_ATTR_MAP","ShapeBase","Path","_super","__extends","_this","apply","arguments","type","canFill","canStroke","prototype","getDefaultAttrs","attrs","call","__assign","startArrow","endArrow","createPath","context","targetAttrs","attr","el","get","value","setAttribute","_formatPath","id","addArrow","getDefaultArrow","removeAttribute","newValue","map","path","join","indexOf","getTotalLength","getPoint","ratio","totalLength","point","getPointAtLength","x","y"],"sources":["../../src/shape/path.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
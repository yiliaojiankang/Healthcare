{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport { amap2Project, amap2UnProject } from \"../geo\";\nimport { MapType } from \"../interface/map\";\n// arc\nexport function arcLineAtOffset(source, target, offset, thetaOffset, mapVersion) {\n  var segmentNumber = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 30;\n  var autoFit = arguments.length > 6 ? arguments[6] : undefined;\n  var pointOffset = offset;\n  if (autoFit) {\n    // Tip: 自动偏移到线的节点位置\n    pointOffset = Math.round(offset * (segmentNumber - 1)) / (segmentNumber - 1);\n  }\n  if (!thetaOffset) {\n    return interpolate(source, target, pointOffset, 0.314, mapVersion);\n  } else {\n    return interpolate(source, target, pointOffset, thetaOffset, mapVersion);\n  }\n}\nfunction bezier3(arr, t) {\n  var ut = 1 - t;\n  return (arr[0] * ut + arr[1] * t) * ut + (arr[1] * ut + arr[2] * t) * t;\n}\nfunction calDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2));\n}\nfunction midPoint(source, target, thetaOffset) {\n  var center = [target[0] - source[0], target[1] - source[1]]; // target - source;\n  var r = calDistance(center, [0, 0]);\n  var theta = Math.atan2(center[1], center[0]);\n  var r2 = r / 2.0 / Math.cos(thetaOffset);\n  var theta2 = theta + thetaOffset;\n  var mid = [r2 * Math.cos(theta2) + source[0], r2 * Math.sin(theta2) + source[1]];\n  return mid;\n}\nfunction interpolate(source, target, offset, thetaOffset, mapVersion) {\n  if (mapVersion === MapType['GAODE2.x']) {\n    // amap2\n    var sourceFlat = amap2Project(source[0], source[1]);\n    var targetFlat = amap2Project(target[0], target[1]);\n    var mid = midPoint(sourceFlat, targetFlat, thetaOffset);\n    var x = [sourceFlat[0], mid[0], targetFlat[0]];\n    var y = [sourceFlat[1], mid[1], targetFlat[1]];\n    return [].concat(_toConsumableArray(amap2UnProject(bezier3(x, offset), bezier3(y, offset))), [0]);\n  } else {\n    // amap\n    var _mid = midPoint(source, target, thetaOffset);\n    var _x = [source[0], _mid[0], target[0]];\n    var _y = [source[1], _mid[1], target[1]];\n    return [bezier3(_x, offset), bezier3(_y, offset), 0];\n  }\n}","map":{"version":3,"names":["_toConsumableArray","amap2Project","amap2UnProject","MapType","arcLineAtOffset","source","target","offset","thetaOffset","mapVersion","segmentNumber","arguments","length","undefined","autoFit","pointOffset","Math","round","interpolate","bezier3","arr","t","ut","calDistance","p1","p2","sqrt","pow","midPoint","center","r","theta","atan2","r2","cos","theta2","mid","sin","sourceFlat","targetFlat","x","y","concat","_mid","_x","_y"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-utils/es/lineAtOffset/arc.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport { amap2Project, amap2UnProject } from \"../geo\";\nimport { MapType } from \"../interface/map\";\n// arc\nexport function arcLineAtOffset(source, target, offset, thetaOffset, mapVersion) {\n  var segmentNumber = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 30;\n  var autoFit = arguments.length > 6 ? arguments[6] : undefined;\n  var pointOffset = offset;\n  if (autoFit) {\n    // Tip: 自动偏移到线的节点位置\n    pointOffset = Math.round(offset * (segmentNumber - 1)) / (segmentNumber - 1);\n  }\n  if (!thetaOffset) {\n    return interpolate(source, target, pointOffset, 0.314, mapVersion);\n  } else {\n    return interpolate(source, target, pointOffset, thetaOffset, mapVersion);\n  }\n}\nfunction bezier3(arr, t) {\n  var ut = 1 - t;\n  return (arr[0] * ut + arr[1] * t) * ut + (arr[1] * ut + arr[2] * t) * t;\n}\nfunction calDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2));\n}\nfunction midPoint(source, target, thetaOffset) {\n  var center = [target[0] - source[0], target[1] - source[1]]; // target - source;\n  var r = calDistance(center, [0, 0]);\n  var theta = Math.atan2(center[1], center[0]);\n  var r2 = r / 2.0 / Math.cos(thetaOffset);\n  var theta2 = theta + thetaOffset;\n  var mid = [r2 * Math.cos(theta2) + source[0], r2 * Math.sin(theta2) + source[1]];\n  return mid;\n}\nfunction interpolate(source, target, offset, thetaOffset, mapVersion) {\n  if (mapVersion === MapType['GAODE2.x']) {\n    // amap2\n    var sourceFlat = amap2Project(source[0], source[1]);\n    var targetFlat = amap2Project(target[0], target[1]);\n    var mid = midPoint(sourceFlat, targetFlat, thetaOffset);\n    var x = [sourceFlat[0], mid[0], targetFlat[0]];\n    var y = [sourceFlat[1], mid[1], targetFlat[1]];\n    return [].concat(_toConsumableArray(amap2UnProject(bezier3(x, offset), bezier3(y, offset))), [0]);\n  } else {\n    // amap\n    var _mid = midPoint(source, target, thetaOffset);\n    var _x = [source[0], _mid[0], target[0]];\n    var _y = [source[1], _mid[1], target[1]];\n    return [bezier3(_x, offset), bezier3(_y, offset), 0];\n  }\n}"],"mappings":"AAAA,OAAOA,kBAAkB,MAAM,8CAA8C;AAC7E,SAASC,YAAY,EAAEC,cAAc,QAAQ,QAAQ;AACrD,SAASC,OAAO,QAAQ,kBAAkB;AAC1C;AACA,OAAO,SAASC,eAAeA,CAACC,MAAM,EAAEC,MAAM,EAAEC,MAAM,EAAEC,WAAW,EAAEC,UAAU,EAAE;EAC/E,IAAIC,aAAa,GAAGC,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE;EAC1F,IAAIG,OAAO,GAAGH,SAAS,CAACC,MAAM,GAAG,CAAC,GAAGD,SAAS,CAAC,CAAC,CAAC,GAAGE,SAAS;EAC7D,IAAIE,WAAW,GAAGR,MAAM;EACxB,IAAIO,OAAO,EAAE;IACX;IACAC,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACV,MAAM,IAAIG,aAAa,GAAG,CAAC,CAAC,CAAC,IAAIA,aAAa,GAAG,CAAC,CAAC;EAC9E;EACA,IAAI,CAACF,WAAW,EAAE;IAChB,OAAOU,WAAW,CAACb,MAAM,EAAEC,MAAM,EAAES,WAAW,EAAE,KAAK,EAAEN,UAAU,CAAC;EACpE,CAAC,MAAM;IACL,OAAOS,WAAW,CAACb,MAAM,EAAEC,MAAM,EAAES,WAAW,EAAEP,WAAW,EAAEC,UAAU,CAAC;EAC1E;AACF;AACA,SAASU,OAAOA,CAACC,GAAG,EAAEC,CAAC,EAAE;EACvB,IAAIC,EAAE,GAAG,CAAC,GAAGD,CAAC;EACd,OAAO,CAACD,GAAG,CAAC,CAAC,CAAC,GAAGE,EAAE,GAAGF,GAAG,CAAC,CAAC,CAAC,GAAGC,CAAC,IAAIC,EAAE,GAAG,CAACF,GAAG,CAAC,CAAC,CAAC,GAAGE,EAAE,GAAGF,GAAG,CAAC,CAAC,CAAC,GAAGC,CAAC,IAAIA,CAAC;AACzE;AACA,SAASE,WAAWA,CAACC,EAAE,EAAEC,EAAE,EAAE;EAC3B,OAAOT,IAAI,CAACU,IAAI,CAACV,IAAI,CAACW,GAAG,CAACH,EAAE,CAAC,CAAC,CAAC,GAAGC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGT,IAAI,CAACW,GAAG,CAACH,EAAE,CAAC,CAAC,CAAC,GAAGC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC3E;AACA,SAASG,QAAQA,CAACvB,MAAM,EAAEC,MAAM,EAAEE,WAAW,EAAE;EAC7C,IAAIqB,MAAM,GAAG,CAACvB,MAAM,CAAC,CAAC,CAAC,GAAGD,MAAM,CAAC,CAAC,CAAC,EAAEC,MAAM,CAAC,CAAC,CAAC,GAAGD,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC7D,IAAIyB,CAAC,GAAGP,WAAW,CAACM,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACnC,IAAIE,KAAK,GAAGf,IAAI,CAACgB,KAAK,CAACH,MAAM,CAAC,CAAC,CAAC,EAAEA,MAAM,CAAC,CAAC,CAAC,CAAC;EAC5C,IAAII,EAAE,GAAGH,CAAC,GAAG,GAAG,GAAGd,IAAI,CAACkB,GAAG,CAAC1B,WAAW,CAAC;EACxC,IAAI2B,MAAM,GAAGJ,KAAK,GAAGvB,WAAW;EAChC,IAAI4B,GAAG,GAAG,CAACH,EAAE,GAAGjB,IAAI,CAACkB,GAAG,CAACC,MAAM,CAAC,GAAG9B,MAAM,CAAC,CAAC,CAAC,EAAE4B,EAAE,GAAGjB,IAAI,CAACqB,GAAG,CAACF,MAAM,CAAC,GAAG9B,MAAM,CAAC,CAAC,CAAC,CAAC;EAChF,OAAO+B,GAAG;AACZ;AACA,SAASlB,WAAWA,CAACb,MAAM,EAAEC,MAAM,EAAEC,MAAM,EAAEC,WAAW,EAAEC,UAAU,EAAE;EACpE,IAAIA,UAAU,KAAKN,OAAO,CAAC,UAAU,CAAC,EAAE;IACtC;IACA,IAAImC,UAAU,GAAGrC,YAAY,CAACI,MAAM,CAAC,CAAC,CAAC,EAAEA,MAAM,CAAC,CAAC,CAAC,CAAC;IACnD,IAAIkC,UAAU,GAAGtC,YAAY,CAACK,MAAM,CAAC,CAAC,CAAC,EAAEA,MAAM,CAAC,CAAC,CAAC,CAAC;IACnD,IAAI8B,GAAG,GAAGR,QAAQ,CAACU,UAAU,EAAEC,UAAU,EAAE/B,WAAW,CAAC;IACvD,IAAIgC,CAAC,GAAG,CAACF,UAAU,CAAC,CAAC,CAAC,EAAEF,GAAG,CAAC,CAAC,CAAC,EAAEG,UAAU,CAAC,CAAC,CAAC,CAAC;IAC9C,IAAIE,CAAC,GAAG,CAACH,UAAU,CAAC,CAAC,CAAC,EAAEF,GAAG,CAAC,CAAC,CAAC,EAAEG,UAAU,CAAC,CAAC,CAAC,CAAC;IAC9C,OAAO,EAAE,CAACG,MAAM,CAAC1C,kBAAkB,CAACE,cAAc,CAACiB,OAAO,CAACqB,CAAC,EAAEjC,MAAM,CAAC,EAAEY,OAAO,CAACsB,CAAC,EAAElC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACnG,CAAC,MAAM;IACL;IACA,IAAIoC,IAAI,GAAGf,QAAQ,CAACvB,MAAM,EAAEC,MAAM,EAAEE,WAAW,CAAC;IAChD,IAAIoC,EAAE,GAAG,CAACvC,MAAM,CAAC,CAAC,CAAC,EAAEsC,IAAI,CAAC,CAAC,CAAC,EAAErC,MAAM,CAAC,CAAC,CAAC,CAAC;IACxC,IAAIuC,EAAE,GAAG,CAACxC,MAAM,CAAC,CAAC,CAAC,EAAEsC,IAAI,CAAC,CAAC,CAAC,EAAErC,MAAM,CAAC,CAAC,CAAC,CAAC;IACxC,OAAO,CAACa,OAAO,CAACyB,EAAE,EAAErC,MAAM,CAAC,EAAEY,OAAO,CAAC0B,EAAE,EAAEtC,MAAM,CAAC,EAAE,CAAC,CAAC;EACtD;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}
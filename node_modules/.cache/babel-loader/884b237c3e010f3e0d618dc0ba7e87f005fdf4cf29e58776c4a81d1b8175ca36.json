{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _degree = _interopRequireDefault(require(\"./degree\"));\nvar _util = require(\"./util\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n * PageRank https://en.wikipedia.org/wiki/PageRank\n * refer: https://github.com/anvaka/ngraph.pagerank\n * @param graph\n * @param epsilon 判断是否收敛的精度值，默认 0.000001\n * @param linkProb 阻尼系数（dumping factor），指任意时刻，用户访问到某节点后继续访问该节点链接的下一个节点的概率，经验值 0.85\n */\nvar pageRank = function pageRank(graphData, epsilon, linkProb) {\n  if (typeof epsilon !== 'number') epsilon = 0.000001;\n  if (typeof linkProb !== 'number') linkProb = 0.85;\n  var distance = 1;\n  var leakedRank = 0;\n  var maxIterations = 1000;\n  var _a = graphData.nodes,\n    nodes = _a === void 0 ? [] : _a,\n    _b = graphData.edges,\n    edges = _b === void 0 ? [] : _b;\n  var nodesCount = nodes.length;\n  var currentRank;\n  var curRanks = {};\n  var prevRanks = {};\n  // Initialize pageranks 初始化\n  for (var j = 0; j < nodesCount; ++j) {\n    var node = nodes[j];\n    var nodeId = node.id;\n    curRanks[nodeId] = 1 / nodesCount;\n    prevRanks[nodeId] = 1 / nodesCount;\n  }\n  var nodeDegree = (0, _degree.default)(graphData);\n  while (maxIterations > 0 && distance > epsilon) {\n    leakedRank = 0;\n    for (var j = 0; j < nodesCount; ++j) {\n      var node = nodes[j];\n      var nodeId = node.id;\n      currentRank = 0;\n      if (nodeDegree[node.id].inDegree === 0) {\n        curRanks[nodeId] = 0;\n      } else {\n        var neighbors = (0, _util.getNeighbors)(nodeId, edges, 'source');\n        for (var i = 0; i < neighbors.length; ++i) {\n          var neighbor = neighbors[i];\n          var outDegree = nodeDegree[neighbor].outDegree;\n          if (outDegree > 0) currentRank += prevRanks[neighbor] / outDegree;\n        }\n        curRanks[nodeId] = linkProb * currentRank;\n        leakedRank += curRanks[nodeId];\n      }\n    }\n    leakedRank = (1 - leakedRank) / nodesCount;\n    distance = 0;\n    for (var j = 0; j < nodesCount; ++j) {\n      var node = nodes[j];\n      var nodeId = node.id;\n      currentRank = curRanks[nodeId] + leakedRank;\n      distance += Math.abs(currentRank - prevRanks[nodeId]);\n      prevRanks[nodeId] = currentRank;\n    }\n    maxIterations -= 1;\n  }\n  return prevRanks;\n};\nvar _default = pageRank;\nexports.default = _default;","map":{"version":3,"names":["Object","defineProperty","exports","value","default","_degree","_interopRequireDefault","require","_util","obj","__esModule","pageRank","graphData","epsilon","linkProb","distance","leakedRank","maxIterations","_a","nodes","_b","edges","nodesCount","length","currentRank","curRanks","prevRanks","j","node","nodeId","id","nodeDegree","inDegree","neighbors","getNeighbors","i","neighbor","outDegree","Math","abs","_default"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/algorithm/lib/pageRank.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _degree = _interopRequireDefault(require(\"./degree\"));\nvar _util = require(\"./util\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n/**\n * PageRank https://en.wikipedia.org/wiki/PageRank\n * refer: https://github.com/anvaka/ngraph.pagerank\n * @param graph\n * @param epsilon 判断是否收敛的精度值，默认 0.000001\n * @param linkProb 阻尼系数（dumping factor），指任意时刻，用户访问到某节点后继续访问该节点链接的下一个节点的概率，经验值 0.85\n */\nvar pageRank = function pageRank(graphData, epsilon, linkProb) {\n  if (typeof epsilon !== 'number') epsilon = 0.000001;\n  if (typeof linkProb !== 'number') linkProb = 0.85;\n  var distance = 1;\n  var leakedRank = 0;\n  var maxIterations = 1000;\n  var _a = graphData.nodes,\n    nodes = _a === void 0 ? [] : _a,\n    _b = graphData.edges,\n    edges = _b === void 0 ? [] : _b;\n  var nodesCount = nodes.length;\n  var currentRank;\n  var curRanks = {};\n  var prevRanks = {};\n  // Initialize pageranks 初始化\n  for (var j = 0; j < nodesCount; ++j) {\n    var node = nodes[j];\n    var nodeId = node.id;\n    curRanks[nodeId] = 1 / nodesCount;\n    prevRanks[nodeId] = 1 / nodesCount;\n  }\n  var nodeDegree = (0, _degree.default)(graphData);\n  while (maxIterations > 0 && distance > epsilon) {\n    leakedRank = 0;\n    for (var j = 0; j < nodesCount; ++j) {\n      var node = nodes[j];\n      var nodeId = node.id;\n      currentRank = 0;\n      if (nodeDegree[node.id].inDegree === 0) {\n        curRanks[nodeId] = 0;\n      } else {\n        var neighbors = (0, _util.getNeighbors)(nodeId, edges, 'source');\n        for (var i = 0; i < neighbors.length; ++i) {\n          var neighbor = neighbors[i];\n          var outDegree = nodeDegree[neighbor].outDegree;\n          if (outDegree > 0) currentRank += prevRanks[neighbor] / outDegree;\n        }\n        curRanks[nodeId] = linkProb * currentRank;\n        leakedRank += curRanks[nodeId];\n      }\n    }\n    leakedRank = (1 - leakedRank) / nodesCount;\n    distance = 0;\n    for (var j = 0; j < nodesCount; ++j) {\n      var node = nodes[j];\n      var nodeId = node.id;\n      currentRank = curRanks[nodeId] + leakedRank;\n      distance += Math.abs(currentRank - prevRanks[nodeId]);\n      prevRanks[nodeId] = currentRank;\n    }\n    maxIterations -= 1;\n  }\n  return prevRanks;\n};\nvar _default = pageRank;\nexports.default = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}
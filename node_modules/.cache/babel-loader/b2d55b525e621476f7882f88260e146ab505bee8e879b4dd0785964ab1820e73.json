{"ast":null,"code":"\"use strict\";\n\n/**\n * @fileOverview Combo force layout\n * @author shiwu.wyy@antfin.com\n */\nrequire(\"core-js/modules/es.array.push.js\");\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ComboForceLayout = void 0;\nvar base_1 = require(\"./base\");\nvar util_1 = require(\"../util\");\n/**\n * force layout for graph with combos\n */\nvar ComboForceLayout = /** @class */function (_super) {\n  __extends(ComboForceLayout, _super);\n  function ComboForceLayout(options) {\n    var _this = _super.call(this) || this;\n    /** 布局中心 */\n    _this.center = [0, 0];\n    /** 停止迭代的最大迭代数 */\n    _this.maxIteration = 100;\n    /** 重力大小，影响图的紧凑程度 */\n    _this.gravity = 10;\n    /** 群组中心力大小 */\n    _this.comboGravity = 10;\n    /** 默认边长度 */\n    _this.linkDistance = 10;\n    /** 每次迭代位移的衰减相关参数 */\n    _this.alpha = 1;\n    _this.alphaMin = 0.001;\n    _this.alphaDecay = 1 - Math.pow(_this.alphaMin, 1 / 300);\n    _this.alphaTarget = 0;\n    /** 节点运动速度衰减参数 */\n    _this.velocityDecay = 0.6;\n    /** 边引力大小 */\n    _this.edgeStrength = 0.6;\n    /** 节点引力大小 */\n    _this.nodeStrength = 30;\n    /** 是否开启防止重叠 */\n    _this.preventOverlap = false;\n    /** 是否开启节点之间的防止重叠 */\n    _this.preventNodeOverlap = false;\n    /** 是否开启 Combo 之间的防止重叠 */\n    _this.preventComboOverlap = false;\n    /** 防止重叠的碰撞力大小 */\n    _this.collideStrength = undefined;\n    /** 防止重叠的碰撞力大小 */\n    _this.nodeCollideStrength = 0.5;\n    /** 防止重叠的碰撞力大小 */\n    _this.comboCollideStrength = 0.5;\n    /** Combo 最小间距，防止重叠时的间隙 */\n    _this.comboSpacing = 20;\n    /** Combo 内部的 padding */\n    _this.comboPadding = 10;\n    /** 优化计算斥力的速度，两节点间距超过 optimizeRangeFactor * width 则不再计算斥力和重叠斥力 */\n    _this.optimizeRangeFactor = 1;\n    /** 每次迭代的回调函数 */\n    _this.onTick = function () {};\n    /** 迭代结束的回调函数 */\n    _this.onLayoutEnd = function () {};\n    /** 根据边两端节点层级差距的调整引力系数的因子，取值范围 [0, 1]。层级差距越大，引力越小 */\n    _this.depthAttractiveForceScale = 1;\n    /** 根据边两端节点层级差距的调整斥力系数的因子，取值范围 [1, Infinity]。层级差距越大，斥力越大 */\n    _this.depthRepulsiveForceScale = 2;\n    /** 内部计算参数 */\n    _this.nodes = [];\n    _this.edges = [];\n    _this.combos = [];\n    _this.comboTrees = [];\n    _this.width = 300;\n    _this.height = 300;\n    _this.bias = [];\n    _this.nodeMap = {};\n    _this.oriComboMap = {};\n    _this.indexMap = {};\n    _this.comboMap = {};\n    _this.previousLayouted = false;\n    _this.updateCfg(options);\n    return _this;\n  }\n  ComboForceLayout.prototype.getDefaultCfg = function () {\n    return {\n      maxIteration: 100,\n      center: [0, 0],\n      gravity: 10,\n      speed: 1,\n      comboGravity: 30,\n      preventOverlap: false,\n      preventComboOverlap: true,\n      preventNodeOverlap: true,\n      nodeSpacing: undefined,\n      collideStrength: undefined,\n      nodeCollideStrength: 0.5,\n      comboCollideStrength: 0.5,\n      comboSpacing: 20,\n      comboPadding: 10,\n      edgeStrength: 0.6,\n      nodeStrength: 30,\n      linkDistance: 10\n    };\n  };\n  /**\n   * 执行布局\n   */\n  ComboForceLayout.prototype.execute = function () {\n    var self = this;\n    var nodes = self.nodes;\n    var center = self.center;\n    self.comboTree = {\n      id: \"comboTreeRoot\",\n      depth: -1,\n      children: self.comboTrees\n    };\n    if (!nodes || nodes.length === 0) {\n      if (self.onLayoutEnd) self.onLayoutEnd();\n      return;\n    }\n    if (nodes.length === 1) {\n      nodes[0].x = center[0];\n      nodes[0].y = center[1];\n      if (self.onLayoutEnd) self.onLayoutEnd();\n      return;\n    }\n    self.initVals();\n    // layout\n    self.run();\n    if (self.onLayoutEnd) self.onLayoutEnd();\n  };\n  ComboForceLayout.prototype.run = function () {\n    var self = this;\n    var nodes = self.nodes;\n    var maxIteration = self.previousLayouted ? self.maxIteration / 5 : self.maxIteration;\n    if (!self.width && typeof window !== \"undefined\") {\n      self.width = window.innerWidth;\n    }\n    if (!self.height && typeof window !== \"undefined\") {\n      self.height = window.innerHeight;\n    }\n    var center = self.center;\n    var velocityDecay = self.velocityDecay;\n    // init the positions to make the nodes with same combo gather around the combo\n    var comboMap = self.comboMap;\n    if (!self.previousLayouted) self.initPos(comboMap);\n    var _loop_1 = function (i) {\n      var displacements = [];\n      nodes.forEach(function (_, j) {\n        displacements[j] = {\n          x: 0,\n          y: 0\n        };\n      });\n      self.applyCalculate(displacements);\n      // gravity for combos\n      self.applyComboCenterForce(displacements);\n      // move\n      nodes.forEach(function (n, j) {\n        if (!(0, util_1.isNumber)(n.x) || !(0, util_1.isNumber)(n.y)) return;\n        n.x += displacements[j].x * velocityDecay;\n        n.y += displacements[j].y * velocityDecay;\n      });\n      self.alpha += (self.alphaTarget - self.alpha) * self.alphaDecay;\n      self.onTick();\n    };\n    // iterate\n    for (var i = 0; i < maxIteration; i++) {\n      _loop_1(i);\n    }\n    // move to center\n    var meanCenter = [0, 0];\n    nodes.forEach(function (n) {\n      if (!(0, util_1.isNumber)(n.x) || !(0, util_1.isNumber)(n.y)) return;\n      meanCenter[0] += n.x;\n      meanCenter[1] += n.y;\n    });\n    meanCenter[0] /= nodes.length;\n    meanCenter[1] /= nodes.length;\n    var centerOffset = [center[0] - meanCenter[0], center[1] - meanCenter[1]];\n    nodes.forEach(function (n, j) {\n      if (!(0, util_1.isNumber)(n.x) || !(0, util_1.isNumber)(n.y)) return;\n      n.x += centerOffset[0];\n      n.y += centerOffset[1];\n    });\n    // arrange the empty combo\n    self.combos.forEach(function (combo) {\n      var mapped = comboMap[combo.id];\n      if (mapped && mapped.empty) {\n        combo.x = mapped.cx || combo.x;\n        combo.y = mapped.cy || combo.y;\n      }\n    });\n    self.previousLayouted = true;\n  };\n  ComboForceLayout.prototype.initVals = function () {\n    var self = this;\n    var edges = self.edges;\n    var nodes = self.nodes;\n    var combos = self.combos;\n    var count = {};\n    var nodeMap = {};\n    var indexMap = {};\n    nodes.forEach(function (node, i) {\n      nodeMap[node.id] = node;\n      indexMap[node.id] = i;\n    });\n    self.nodeMap = nodeMap;\n    self.indexMap = indexMap;\n    var oriComboMap = {};\n    combos.forEach(function (combo) {\n      oriComboMap[combo.id] = combo;\n    });\n    self.oriComboMap = oriComboMap;\n    self.comboMap = self.getComboMap();\n    var preventOverlap = self.preventOverlap;\n    self.preventComboOverlap = self.preventComboOverlap || preventOverlap;\n    self.preventNodeOverlap = self.preventNodeOverlap || preventOverlap;\n    var collideStrength = self.collideStrength;\n    if (collideStrength) {\n      self.comboCollideStrength = collideStrength;\n      self.nodeCollideStrength = collideStrength;\n    }\n    self.comboCollideStrength = self.comboCollideStrength ? self.comboCollideStrength : 0;\n    self.nodeCollideStrength = self.nodeCollideStrength ? self.nodeCollideStrength : 0;\n    // get edge bias\n    for (var i = 0; i < edges.length; ++i) {\n      var source = (0, util_1.getEdgeTerminal)(edges[i], 'source');\n      var target = (0, util_1.getEdgeTerminal)(edges[i], 'target');\n      if (count[source]) count[source]++;else count[source] = 1;\n      if (count[target]) count[target]++;else count[target] = 1;\n    }\n    var bias = [];\n    for (var i = 0; i < edges.length; ++i) {\n      var source = (0, util_1.getEdgeTerminal)(edges[i], 'source');\n      var target = (0, util_1.getEdgeTerminal)(edges[i], 'target');\n      bias[i] = count[source] / (count[source] + count[target]);\n    }\n    this.bias = bias;\n    var nodeSize = self.nodeSize;\n    var nodeSpacing = self.nodeSpacing;\n    var nodeSizeFunc;\n    var nodeSpacingFunc;\n    // nodeSpacing to function\n    if ((0, util_1.isNumber)(nodeSpacing)) {\n      nodeSpacingFunc = function () {\n        return nodeSpacing;\n      };\n    } else if ((0, util_1.isFunction)(nodeSpacing)) {\n      nodeSpacingFunc = nodeSpacing;\n    } else {\n      nodeSpacingFunc = function () {\n        return 0;\n      };\n    }\n    this.nodeSpacing = nodeSpacingFunc;\n    // nodeSize to function\n    if (!nodeSize) {\n      nodeSizeFunc = function (d) {\n        if (d.size) {\n          if ((0, util_1.isArray)(d.size)) {\n            var res = d.size[0] > d.size[1] ? d.size[0] : d.size[1];\n            return res / 2;\n          }\n          if ((0, util_1.isObject)(d.size)) {\n            var res = d.size.width > d.size.height ? d.size.width : d.size.height;\n            return res / 2;\n          }\n          return d.size / 2;\n        }\n        return 10;\n      };\n    } else if ((0, util_1.isFunction)(nodeSize)) {\n      nodeSizeFunc = function (d) {\n        return nodeSize(d);\n      };\n    } else if ((0, util_1.isArray)(nodeSize)) {\n      var larger = nodeSize[0] > nodeSize[1] ? nodeSize[0] : nodeSize[1];\n      var radius_1 = larger / 2;\n      nodeSizeFunc = function (d) {\n        return radius_1;\n      };\n    } else {\n      // number type\n      var radius_2 = nodeSize / 2;\n      nodeSizeFunc = function (d) {\n        return radius_2;\n      };\n    }\n    this.nodeSize = nodeSizeFunc;\n    // comboSpacing to function\n    var comboSpacing = self.comboSpacing;\n    var comboSpacingFunc;\n    if ((0, util_1.isNumber)(comboSpacing)) {\n      comboSpacingFunc = function () {\n        return comboSpacing;\n      };\n    } else if ((0, util_1.isFunction)(comboSpacing)) {\n      comboSpacingFunc = comboSpacing;\n    } else {\n      // null type\n      comboSpacingFunc = function () {\n        return 0;\n      };\n    }\n    this.comboSpacing = comboSpacingFunc;\n    // comboPadding to function\n    var comboPadding = self.comboPadding;\n    var comboPaddingFunc;\n    if ((0, util_1.isNumber)(comboPadding)) {\n      comboPaddingFunc = function () {\n        return comboPadding;\n      };\n    } else if ((0, util_1.isArray)(comboPadding)) {\n      comboPaddingFunc = function () {\n        return Math.max.apply(null, comboPadding);\n      };\n    } else if ((0, util_1.isFunction)(comboPadding)) {\n      comboPaddingFunc = comboPadding;\n    } else {\n      // null type\n      comboPaddingFunc = function () {\n        return 0;\n      };\n    }\n    this.comboPadding = comboPaddingFunc;\n    // linkDistance to function\n    var linkDistance = this.linkDistance;\n    var linkDistanceFunc;\n    if (!linkDistance) {\n      linkDistance = 10;\n    }\n    if ((0, util_1.isNumber)(linkDistance)) {\n      linkDistanceFunc = function (d) {\n        return linkDistance;\n      };\n    } else {\n      linkDistanceFunc = linkDistance;\n    }\n    this.linkDistance = linkDistanceFunc;\n    // linkStrength to function\n    var edgeStrength = this.edgeStrength;\n    var edgeStrengthFunc;\n    if (!edgeStrength) {\n      edgeStrength = 1;\n    }\n    if ((0, util_1.isNumber)(edgeStrength)) {\n      edgeStrengthFunc = function (d) {\n        return edgeStrength;\n      };\n    } else {\n      edgeStrengthFunc = edgeStrength;\n    }\n    this.edgeStrength = edgeStrengthFunc;\n    // nodeStrength to function\n    var nodeStrength = this.nodeStrength;\n    var nodeStrengthFunc;\n    if (!nodeStrength) {\n      nodeStrength = 30;\n    }\n    if ((0, util_1.isNumber)(nodeStrength)) {\n      nodeStrengthFunc = function (d) {\n        return nodeStrength;\n      };\n    } else {\n      nodeStrengthFunc = nodeStrength;\n    }\n    this.nodeStrength = nodeStrengthFunc;\n  };\n  ComboForceLayout.prototype.initPos = function (comboMap) {\n    var self = this;\n    var nodes = self.nodes;\n    nodes.forEach(function (node, i) {\n      var comboId = node.comboId;\n      var combo = comboMap[comboId];\n      if (comboId && combo) {\n        node.x = combo.cx + 100 / (i + 1);\n        node.y = combo.cy + 100 / (i + 1);\n      } else {\n        node.x = 100 / (i + 1);\n        node.y = 100 / (i + 1);\n      }\n    });\n  };\n  ComboForceLayout.prototype.getComboMap = function () {\n    var self = this;\n    var nodeMap = self.nodeMap;\n    var comboTrees = self.comboTrees;\n    var oriComboMap = self.oriComboMap;\n    var comboMap = {};\n    (comboTrees || []).forEach(function (ctree) {\n      var treeChildren = [];\n      (0, util_1.traverseTreeUp)(ctree, function (treeNode) {\n        if (treeNode.itemType === \"node\") return true; // skip it\n        if (!oriComboMap[treeNode.id]) return true; // means it is hidden, skip it\n        if (comboMap[treeNode.id] === undefined) {\n          var combo = {\n            id: treeNode.id,\n            name: treeNode.id,\n            cx: 0,\n            cy: 0,\n            count: 0,\n            depth: self.oriComboMap[treeNode.id].depth || 0,\n            children: []\n          };\n          comboMap[treeNode.id] = combo;\n        }\n        var children = treeNode.children;\n        if (children) {\n          children.forEach(function (child) {\n            if (!comboMap[child.id] && !nodeMap[child.id]) return true; // means it is hidden\n            treeChildren.push(child);\n          });\n        }\n        var c = comboMap[treeNode.id];\n        c.cx = 0;\n        c.cy = 0;\n        if (treeChildren.length === 0) {\n          c.empty = true;\n          var oriCombo = oriComboMap[treeNode.id];\n          c.cx = oriCombo.x;\n          c.cy = oriCombo.y;\n        }\n        treeChildren.forEach(function (child) {\n          c.count++;\n          if (child.itemType !== \"node\") {\n            var childCombo = comboMap[child.id];\n            if ((0, util_1.isNumber)(childCombo.cx)) c.cx += childCombo.cx;\n            if ((0, util_1.isNumber)(childCombo.cy)) c.cy += childCombo.cy;\n            return;\n          }\n          var node = nodeMap[child.id];\n          // means the node is hidden, skip it\n          if (!node) return;\n          if ((0, util_1.isNumber)(node.x)) {\n            c.cx += node.x;\n          }\n          if ((0, util_1.isNumber)(node.y)) {\n            c.cy += node.y;\n          }\n        });\n        c.cx /= c.count || 1;\n        c.cy /= c.count || 1;\n        c.children = treeChildren;\n        return true;\n      });\n    });\n    return comboMap;\n  };\n  ComboForceLayout.prototype.applyComboCenterForce = function (displacements) {\n    var self = this;\n    var gravity = self.gravity;\n    var comboGravity = self.comboGravity || gravity;\n    var alpha = this.alpha;\n    var comboTrees = self.comboTrees;\n    var indexMap = self.indexMap;\n    var nodeMap = self.nodeMap;\n    var comboMap = self.comboMap;\n    (comboTrees || []).forEach(function (ctree) {\n      (0, util_1.traverseTreeUp)(ctree, function (treeNode) {\n        if (treeNode.itemType === \"node\") return true; // skip it\n        var combo = comboMap[treeNode.id];\n        // means the combo is hidden, skip it\n        if (!combo) return true;\n        var c = comboMap[treeNode.id];\n        // higher depth the combo, larger the gravity\n        var gravityScale = (c.depth + 1) / 10 * 0.5;\n        // apply combo center force for all the descend nodes in this combo\n        // and update the center position and count for this combo\n        var comboX = c.cx;\n        var comboY = c.cy;\n        c.cx = 0;\n        c.cy = 0;\n        c.children.forEach(function (child) {\n          if (child.itemType !== \"node\") {\n            var childCombo = comboMap[child.id];\n            if (childCombo && (0, util_1.isNumber)(childCombo.cx)) c.cx += childCombo.cx;\n            if (childCombo && (0, util_1.isNumber)(childCombo.cy)) c.cy += childCombo.cy;\n            return;\n          }\n          var node = nodeMap[child.id];\n          var vecX = node.x - comboX || 0.005;\n          var vecY = node.y - comboY || 0.005;\n          var l = Math.sqrt(vecX * vecX + vecY * vecY);\n          var childIdx = indexMap[node.id];\n          var params = comboGravity * alpha / l * gravityScale;\n          displacements[childIdx].x -= vecX * params;\n          displacements[childIdx].y -= vecY * params;\n          if ((0, util_1.isNumber)(node.x)) c.cx += node.x;\n          if ((0, util_1.isNumber)(node.y)) c.cy += node.y;\n        });\n        c.cx /= c.count || 1;\n        c.cy /= c.count || 1;\n        return true;\n      });\n    });\n  };\n  ComboForceLayout.prototype.applyCalculate = function (displacements) {\n    var self = this;\n    var comboMap = self.comboMap;\n    var nodes = self.nodes;\n    // store the vx, vy, and distance to reduce dulplicate calculation\n    var vecMap = {};\n    nodes.forEach(function (v, i) {\n      nodes.forEach(function (u, j) {\n        if (i < j) return;\n        var vx = v.x - u.x || 0.005;\n        var vy = v.y - u.y || 0.005;\n        var vl2 = vx * vx + vy * vy;\n        var vl = Math.sqrt(vl2);\n        if (vl2 < 1) vl2 = vl;\n        vecMap[\"\".concat(v.id, \"-\").concat(u.id)] = {\n          vx: vx,\n          vy: vy,\n          vl2: vl2,\n          vl: vl\n        };\n        vecMap[\"\".concat(u.id, \"-\").concat(v.id)] = {\n          vl2: vl2,\n          vl: vl,\n          vx: -vx,\n          vy: -vy\n        };\n      });\n    });\n    // get the sizes of the combos\n    self.updateComboSizes(comboMap);\n    self.calRepulsive(displacements, vecMap);\n    self.calAttractive(displacements, vecMap);\n    var preventComboOverlap = self.preventComboOverlap;\n    if (preventComboOverlap) self.comboNonOverlapping(displacements, comboMap);\n  };\n  /**\n   * Update the sizes of the combos according to their children\n   * Used for combos nonoverlap, but not re-render the combo shapes\n   */\n  ComboForceLayout.prototype.updateComboSizes = function (comboMap) {\n    var self = this;\n    var comboTrees = self.comboTrees;\n    var nodeMap = self.nodeMap;\n    var nodeSize = self.nodeSize;\n    var comboSpacing = self.comboSpacing;\n    var comboPadding = self.comboPadding;\n    (comboTrees || []).forEach(function (ctree) {\n      var treeChildren = [];\n      (0, util_1.traverseTreeUp)(ctree, function (treeNode) {\n        if (treeNode.itemType === \"node\") return true; // skip it\n        var c = comboMap[treeNode.id];\n        // means the combo is hidden, skip it\n        if (!c) return false;\n        var children = treeNode.children;\n        if (children) {\n          children.forEach(function (child) {\n            // means the combo is hidden.\n            if (!comboMap[child.id] && !nodeMap[child.id]) return;\n            treeChildren.push(child);\n          });\n        }\n        c.minX = Infinity;\n        c.minY = Infinity;\n        c.maxX = -Infinity;\n        c.maxY = -Infinity;\n        treeChildren.forEach(function (child) {\n          if (child.itemType !== \"node\") return true; // skip it\n          var node = nodeMap[child.id];\n          if (!node) return true; // means it is hidden\n          var r = nodeSize(node);\n          var nodeMinX = node.x - r;\n          var nodeMinY = node.y - r;\n          var nodeMaxX = node.x + r;\n          var nodeMaxY = node.y + r;\n          if (c.minX > nodeMinX) c.minX = nodeMinX;\n          if (c.minY > nodeMinY) c.minY = nodeMinY;\n          if (c.maxX < nodeMaxX) c.maxX = nodeMaxX;\n          if (c.maxY < nodeMaxY) c.maxY = nodeMaxY;\n        });\n        var minSize = self.oriComboMap[treeNode.id].size || 10;\n        if ((0, util_1.isArray)(minSize)) minSize = minSize[0];\n        var maxLength = Math.max(c.maxX - c.minX, c.maxY - c.minY, minSize);\n        c.r = maxLength / 2 + comboSpacing(c) / 2 + comboPadding(c);\n        return true;\n      });\n    });\n  };\n  /**\n   * prevent the overlappings among combos\n   */\n  ComboForceLayout.prototype.comboNonOverlapping = function (displacements, comboMap) {\n    var self = this;\n    var comboTree = self.comboTree;\n    var comboCollideStrength = self.comboCollideStrength;\n    var indexMap = self.indexMap;\n    var nodeMap = self.nodeMap;\n    (0, util_1.traverseTreeUp)(comboTree, function (treeNode) {\n      if (!comboMap[treeNode.id] && !nodeMap[treeNode.id] && treeNode.id !== \"comboTreeRoot\") {\n        return false;\n      } // means it is hidden\n      var children = treeNode.children;\n      // 同个子树下的子 combo 间两两对比\n      if (children && children.length > 1) {\n        children.forEach(function (v, i) {\n          if (v.itemType === \"node\") return false; // skip it\n          var cv = comboMap[v.id];\n          if (!cv) return; // means it is hidden, skip it\n          children.forEach(function (u, j) {\n            if (i <= j) return false;\n            if (u.itemType === \"node\") return false; // skip it\n            var cu = comboMap[u.id];\n            if (!cu) return false; // means it is hidden, skip it\n            var vx = cv.cx - cu.cx || 0.005;\n            var vy = cv.cy - cu.cy || 0.005;\n            var l = vx * vx + vy * vy;\n            var rv = cv.r || 1;\n            var ru = cu.r || 1;\n            var r = rv + ru;\n            var ru2 = ru * ru;\n            var rv2 = rv * rv;\n            // overlapping\n            if (l < r * r) {\n              var vnodes = v.children;\n              if (!vnodes || vnodes.length === 0) return false; // skip it\n              var unodes_1 = u.children;\n              if (!unodes_1 || unodes_1.length === 0) return false; // skip it\n              var sqrtl = Math.sqrt(l);\n              var ll = (r - sqrtl) / sqrtl * comboCollideStrength;\n              var xl_1 = vx * ll;\n              var yl_1 = vy * ll;\n              var rratio_1 = ru2 / (rv2 + ru2);\n              var irratio_1 = 1 - rratio_1;\n              // 两兄弟 combo 的子节点上施加斥力\n              vnodes.forEach(function (vn) {\n                if (vn.itemType !== \"node\") return false; // skip it\n                if (!nodeMap[vn.id]) return; // means it is hidden, skip it\n                var vindex = indexMap[vn.id];\n                unodes_1.forEach(function (un) {\n                  if (un.itemType !== \"node\") return false;\n                  if (!nodeMap[un.id]) return false; // means it is hidden, skip it\n                  var uindex = indexMap[un.id];\n                  displacements[vindex].x += xl_1 * rratio_1;\n                  displacements[vindex].y += yl_1 * rratio_1;\n                  displacements[uindex].x -= xl_1 * irratio_1;\n                  displacements[uindex].y -= yl_1 * irratio_1;\n                });\n              });\n            }\n          });\n        });\n      }\n      return true;\n    });\n  };\n  /**\n   * Calculate the repulsive force between each node pair\n   * @param displacements The array stores the displacements for nodes\n   * @param vecMap The map stores vector between each node pair\n   */\n  ComboForceLayout.prototype.calRepulsive = function (displacements, vecMap) {\n    var self = this;\n    var nodes = self.nodes;\n    var max = self.width * self.optimizeRangeFactor;\n    var nodeStrength = self.nodeStrength;\n    var alpha = self.alpha;\n    var nodeCollideStrength = self.nodeCollideStrength;\n    var preventNodeOverlap = self.preventNodeOverlap;\n    var nodeSizeFunc = self.nodeSize;\n    var nodeSpacingFunc = self.nodeSpacing;\n    var scale = self.depthRepulsiveForceScale;\n    var center = self.center;\n    nodes.forEach(function (v, i) {\n      if (!v.x || !v.y) return;\n      // center gravity\n      if (center) {\n        var gravity = self.gravity;\n        var vecX = v.x - center[0] || 0.005;\n        var vecY = v.y - center[1] || 0.005;\n        var l = Math.sqrt(vecX * vecX + vecY * vecY);\n        displacements[i].x -= vecX * gravity * alpha / l;\n        displacements[i].y -= vecY * gravity * alpha / l;\n      }\n      nodes.forEach(function (u, j) {\n        if (i === j) {\n          return;\n        }\n        if (!u.x || !u.y) return;\n        var _a = vecMap[\"\".concat(v.id, \"-\").concat(u.id)],\n          vl2 = _a.vl2,\n          vl = _a.vl;\n        if (vl > max) return;\n        var _b = vecMap[\"\".concat(v.id, \"-\").concat(u.id)],\n          vx = _b.vx,\n          vy = _b.vy;\n        var depthDiff = Math.log(Math.abs(u.depth - v.depth) / 10) + 1 || 1;\n        depthDiff = depthDiff < 1 ? 1 : depthDiff;\n        if (u.comboId !== v.comboId) depthDiff += 1;\n        var depthParam = depthDiff ? Math.pow(scale, depthDiff) : 1;\n        var params = nodeStrength(u) * alpha / vl2 * depthParam;\n        displacements[i].x += vx * params;\n        displacements[i].y += vy * params;\n        // prevent node overlappings\n        if (i < j && preventNodeOverlap) {\n          var ri = nodeSizeFunc(v) + nodeSpacingFunc(v) || 1;\n          var rj = nodeSizeFunc(u) + nodeSpacingFunc(u) || 1;\n          var r = ri + rj;\n          if (vl2 < r * r) {\n            var ll = (r - vl) / vl * nodeCollideStrength;\n            var rj2 = rj * rj;\n            var rratio = rj2 / (ri * ri + rj2);\n            var xl = vx * ll;\n            var yl = vy * ll;\n            displacements[i].x += xl * rratio;\n            displacements[i].y += yl * rratio;\n            rratio = 1 - rratio;\n            displacements[j].x -= xl * rratio;\n            displacements[j].y -= yl * rratio;\n          }\n        }\n      });\n    });\n  };\n  /**\n   * Calculate the attractive force between the node pair with edge\n   * @param displacements The array stores the displacements for nodes\n   * @param vecMap The map stores vector between each node pair\n   */\n  ComboForceLayout.prototype.calAttractive = function (displacements, vecMap) {\n    var self = this;\n    var edges = self.edges;\n    var linkDistance = self.linkDistance;\n    var alpha = self.alpha;\n    var edgeStrength = self.edgeStrength;\n    var bias = self.bias;\n    var scale = self.depthAttractiveForceScale;\n    edges.forEach(function (e, i) {\n      var source = (0, util_1.getEdgeTerminal)(e, 'source');\n      var target = (0, util_1.getEdgeTerminal)(e, 'target');\n      if (!source || !target || source === target) return;\n      var uIndex = self.indexMap[source];\n      var vIndex = self.indexMap[target];\n      var u = self.nodeMap[source];\n      var v = self.nodeMap[target];\n      if (!u || !v) return;\n      var depthDiff = u.depth === v.depth ? 0 : Math.log(Math.abs(u.depth - v.depth) / 10);\n      if (u.comboId === v.comboId) {\n        depthDiff = depthDiff / 2;\n      }\n      var depthParam = depthDiff ? Math.pow(scale, depthDiff) : 1;\n      if (u.comboId !== v.comboId && depthParam === 1) {\n        depthParam = scale / 2;\n      } else if (u.comboId === v.comboId) {\n        depthParam = 2;\n      }\n      if (!(0, util_1.isNumber)(v.x) || !(0, util_1.isNumber)(u.x) || !(0, util_1.isNumber)(v.y) || !(0, util_1.isNumber)(u.y)) {\n        return;\n      }\n      var _a = vecMap[\"\".concat(target, \"-\").concat(source)],\n        vl = _a.vl,\n        vx = _a.vx,\n        vy = _a.vy;\n      var l = (vl - linkDistance(e)) / vl * alpha * edgeStrength(e) * depthParam;\n      var vecX = vx * l;\n      var vecY = vy * l;\n      var b = bias[i];\n      displacements[vIndex].x -= vecX * b;\n      displacements[vIndex].y -= vecY * b;\n      displacements[uIndex].x += vecX * (1 - b);\n      displacements[uIndex].y += vecY * (1 - b);\n    });\n  };\n  ComboForceLayout.prototype.getType = function () {\n    return \"comboForce\";\n  };\n  return ComboForceLayout;\n}(base_1.Base);\nexports.ComboForceLayout = ComboForceLayout;","map":{"version":3,"names":["require","base_1","util_1","ComboForceLayout","_super","__extends","options","_this","call","center","maxIteration","gravity","comboGravity","linkDistance","alpha","alphaMin","alphaDecay","Math","pow","alphaTarget","velocityDecay","edgeStrength","nodeStrength","preventOverlap","preventNodeOverlap","preventComboOverlap","collideStrength","undefined","nodeCollideStrength","comboCollideStrength","comboSpacing","comboPadding","optimizeRangeFactor","onTick","onLayoutEnd","depthAttractiveForceScale","depthRepulsiveForceScale","nodes","edges","combos","comboTrees","width","height","bias","nodeMap","oriComboMap","indexMap","comboMap","previousLayouted","updateCfg","prototype","getDefaultCfg","speed","nodeSpacing","execute","self","comboTree","id","depth","children","length","x","y","initVals","run","window","innerWidth","innerHeight","initPos","i","displacements","forEach","_","j","applyCalculate","applyComboCenterForce","n","isNumber","meanCenter","centerOffset","combo","mapped","empty","cx","cy","count","node","getComboMap","source","getEdgeTerminal","target","nodeSize","nodeSizeFunc","nodeSpacingFunc","isFunction","d","size","isArray","res","isObject","larger","radius_1","radius_2","comboSpacingFunc","comboPaddingFunc","max","apply","linkDistanceFunc","edgeStrengthFunc","nodeStrengthFunc","comboId","ctree","treeChildren","traverseTreeUp","treeNode","itemType","name","child","push","c","oriCombo","childCombo","gravityScale","comboX","comboY","vecX","vecY","l","sqrt","childIdx","params","vecMap","v","u","vx","vy","vl2","vl","concat","updateComboSizes","calRepulsive","calAttractive","comboNonOverlapping","minX","Infinity","minY","maxX","maxY","r","nodeMinX","nodeMinY","nodeMaxX","nodeMaxY","minSize","maxLength","cv","cu","rv","ru","ru2","rv2","vnodes","unodes_1","sqrtl","ll","xl_1","yl_1","rratio_1","irratio_1","vn","vindex","un","uindex","scale","_a","_b","depthDiff","log","abs","depthParam","ri","rj","rj2","rratio","xl","yl","e","uIndex","vIndex","b","getType","Base","exports"],"sources":["../../src/layout/comboForce.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}
{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getProtocolAction } from \"../../ajax\";\nimport { tileToBounds } from \"./lonlat-tile\";\n/*\n * 判断是否是一个合法的瓦片请求模版\n */\nexport function isURLTemplate(s) {\n  return /(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(s);\n}\n\n/**\n * https://github.com/openlayers/openlayers/blob/main/src/ol/tileurlfunction.js\n * @param {string} url URL.\n * @return {Array<string>} Array of urls.\n */\nexport function expandUrl(url) {\n  var urls = [];\n  var match = /\\{([a-z])-([a-z])\\}/.exec(url);\n  if (match) {\n    // char range\n    var startCharCode = match[1].charCodeAt(0);\n    var stopCharCode = match[2].charCodeAt(0);\n    var charCode;\n    for (charCode = startCharCode; charCode <= stopCharCode; ++charCode) {\n      urls.push(url.replace(match[0], String.fromCharCode(charCode)));\n    }\n    return urls;\n  }\n  match = /\\{(\\d+)-(\\d+)\\}/.exec(url);\n  if (match) {\n    // number range\n    var stop = parseInt(match[2], 10);\n    for (var i = parseInt(match[1], 10); i <= stop; i++) {\n      urls.push(url.replace(match[0], i.toString()));\n    }\n    return urls;\n  }\n  urls.push(url);\n  return urls;\n}\n\n/*\n * 获取瓦片请求地址\n */\nexport function getURLFromTemplate(template, properties) {\n  if (!template || !template.length) {\n    throw new Error('url is not allowed to be empty');\n  }\n  var x = properties.x,\n    y = properties.y,\n    z = properties.z;\n  var urls = expandUrl(template);\n  var index = Math.abs(x + y) % urls.length;\n  // 兼容其他协议的 URL 模版\n  var url = getProtocolAction(urls[index]) ? \"\".concat(urls[index], \"/{z}/{x}/{y}\") : urls[index];\n  return url.replace(/\\{x\\}/g, x.toString()).replace(/\\{y\\}/g, y.toString()).replace(/\\{z\\}/g, z.toString()).replace(/\\{bbox\\}/g, tileToBounds(x, y, z).join(',')).replace(/\\{-y\\}/g, (Math.pow(2, z) - y - 1).toString());\n}\n\n/**\n * wmts url\n */\n\nexport function getWMTSURLFromTemplate(template, properties) {\n  var x = properties.x,\n    y = properties.y,\n    z = properties.z,\n    layer = properties.layer,\n    _properties$version = properties.version,\n    version = _properties$version === void 0 ? '1.0.0' : _properties$version,\n    _properties$style = properties.style,\n    style = _properties$style === void 0 ? 'default' : _properties$style,\n    format = properties.format,\n    _properties$service = properties.service,\n    service = _properties$service === void 0 ? 'WMTS' : _properties$service,\n    tileMatrixset = properties.tileMatrixset;\n  var urls = expandUrl(template);\n  var index = Math.abs(x + y) % urls.length;\n  var url = \"\".concat(urls[index], \"&SERVICE=\").concat(service, \"&REQUEST=GetTile&VERSION=\").concat(version, \"&LAYER=\").concat(layer, \"&STYLE=\").concat(style, \"&TILEMATRIXSET=\").concat(tileMatrixset, \"&FORMAT=\").concat(format, \"&TILECOL=\").concat(x, \"&TILEROW=\").concat(y, \"&TILEMATRIX=\").concat(z);\n  return url;\n}","map":{"version":3,"names":["getProtocolAction","tileToBounds","isURLTemplate","s","test","expandUrl","url","urls","match","exec","startCharCode","charCodeAt","stopCharCode","charCode","push","replace","String","fromCharCode","stop","parseInt","i","toString","getURLFromTemplate","template","properties","length","Error","x","y","z","index","Math","abs","concat","join","pow","getWMTSURLFromTemplate","layer","_properties$version","version","_properties$style","style","format","_properties$service","service","tileMatrixset"],"sources":["D:/桌面文件/C4大赛/作品源代码/vue/node_modules/@antv/l7-utils/es/tileset-manager/utils/tile-url.js"],"sourcesContent":["import { getProtocolAction } from \"../../ajax\";\nimport { tileToBounds } from \"./lonlat-tile\";\n/*\n * 判断是否是一个合法的瓦片请求模版\n */\nexport function isURLTemplate(s) {\n  return /(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(s);\n}\n\n/**\n * https://github.com/openlayers/openlayers/blob/main/src/ol/tileurlfunction.js\n * @param {string} url URL.\n * @return {Array<string>} Array of urls.\n */\nexport function expandUrl(url) {\n  var urls = [];\n  var match = /\\{([a-z])-([a-z])\\}/.exec(url);\n  if (match) {\n    // char range\n    var startCharCode = match[1].charCodeAt(0);\n    var stopCharCode = match[2].charCodeAt(0);\n    var charCode;\n    for (charCode = startCharCode; charCode <= stopCharCode; ++charCode) {\n      urls.push(url.replace(match[0], String.fromCharCode(charCode)));\n    }\n    return urls;\n  }\n  match = /\\{(\\d+)-(\\d+)\\}/.exec(url);\n  if (match) {\n    // number range\n    var stop = parseInt(match[2], 10);\n    for (var i = parseInt(match[1], 10); i <= stop; i++) {\n      urls.push(url.replace(match[0], i.toString()));\n    }\n    return urls;\n  }\n  urls.push(url);\n  return urls;\n}\n\n/*\n * 获取瓦片请求地址\n */\nexport function getURLFromTemplate(template, properties) {\n  if (!template || !template.length) {\n    throw new Error('url is not allowed to be empty');\n  }\n  var x = properties.x,\n    y = properties.y,\n    z = properties.z;\n  var urls = expandUrl(template);\n  var index = Math.abs(x + y) % urls.length;\n  // 兼容其他协议的 URL 模版\n  var url = getProtocolAction(urls[index]) ? \"\".concat(urls[index], \"/{z}/{x}/{y}\") : urls[index];\n  return url.replace(/\\{x\\}/g, x.toString()).replace(/\\{y\\}/g, y.toString()).replace(/\\{z\\}/g, z.toString()).replace(/\\{bbox\\}/g, tileToBounds(x, y, z).join(',')).replace(/\\{-y\\}/g, (Math.pow(2, z) - y - 1).toString());\n}\n\n/**\n * wmts url\n */\n\nexport function getWMTSURLFromTemplate(template, properties) {\n  var x = properties.x,\n    y = properties.y,\n    z = properties.z,\n    layer = properties.layer,\n    _properties$version = properties.version,\n    version = _properties$version === void 0 ? '1.0.0' : _properties$version,\n    _properties$style = properties.style,\n    style = _properties$style === void 0 ? 'default' : _properties$style,\n    format = properties.format,\n    _properties$service = properties.service,\n    service = _properties$service === void 0 ? 'WMTS' : _properties$service,\n    tileMatrixset = properties.tileMatrixset;\n  var urls = expandUrl(template);\n  var index = Math.abs(x + y) % urls.length;\n  var url = \"\".concat(urls[index], \"&SERVICE=\").concat(service, \"&REQUEST=GetTile&VERSION=\").concat(version, \"&LAYER=\").concat(layer, \"&STYLE=\").concat(style, \"&TILEMATRIXSET=\").concat(tileMatrixset, \"&FORMAT=\").concat(format, \"&TILECOL=\").concat(x, \"&TILEROW=\").concat(y, \"&TILEMATRIX=\").concat(z);\n  return url;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
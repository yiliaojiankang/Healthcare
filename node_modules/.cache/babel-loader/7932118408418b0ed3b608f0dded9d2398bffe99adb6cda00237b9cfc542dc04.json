{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { Action, Util } from '@antv/g2';\nimport { get, isNil, last, size } from '@antv/util';\nimport { deepAssign } from '../../utils/deep-assign';\n// 面包屑文字和分割符'/'之间的距离\nvar PADDING = 4;\n// 面包屑位置距离树图的距离\nvar PADDING_LEFT = 0;\n// 面包屑位置距离树图的顶部距离\nexport var PADDING_TOP = 5;\n/** Group name of breadCrumb: 面包屑 */\nexport var BREAD_CRUMB_NAME = 'drilldown-bread-crumb';\n// 面包屑默认配置\nexport var DEFAULT_BREAD_CRUMB_CONFIG = {\n  /** 位置，默认：左上角 */\n  position: 'top-left',\n  dividerText: '/',\n  textStyle: {\n    fontSize: 12,\n    fill: 'rgba(0, 0, 0, 0.65)',\n    cursor: 'pointer'\n  },\n  activeTextStyle: {\n    fill: '#87B5FF'\n  }\n};\n/**\n * hierarchy 数据转换的参数\n */\nexport var HIERARCHY_DATA_TRANSFORM_PARAMS = 'hierarchy-data-transform-params';\n/**\n * @description 下钻交互的 action\n * @author liuzhenying\n *\n * 适用于：hierarchy plot\n */\nvar DrillDownAction = /** @class */function (_super) {\n  __extends(DrillDownAction, _super);\n  function DrillDownAction() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    /** Action name */\n    _this.name = 'drill-down';\n    // 存储历史下钻数据\n    _this.historyCache = [];\n    // 面包屑 group\n    _this.breadCrumbGroup = null;\n    // 面包屑基础配置\n    _this.breadCrumbCfg = DEFAULT_BREAD_CRUMB_CONFIG;\n    return _this;\n  }\n  /**\n   * 点击事件, 下钻数据，并绘制面包屑\n   */\n  DrillDownAction.prototype.click = function () {\n    var data = get(this.context, ['event', 'data', 'data']);\n    if (!data) return false;\n    this.drill(data);\n    this.drawBreadCrumb();\n  };\n  /**\n   * 重置位置，初始化及触发 chart  afterchangesize 回调时使用\n   */\n  DrillDownAction.prototype.resetPosition = function () {\n    // 当在第一层级未绘制面包屑，此时 changedata 触发 resetPosition 函数，需判断 this.breadCrumbGroup 是否存在\n    if (!this.breadCrumbGroup) return;\n    var coordinate = this.context.view.getCoordinate();\n    var breadCrumbGroup = this.breadCrumbGroup;\n    var bbox = breadCrumbGroup.getBBox();\n    var position = this.getButtonCfg().position;\n    // @todo 后续抽取一个函数来处理，以及增加 margin 或者 padding 的设置\n    // 非 polar 的，需要使用 coordinate，除却图表组件\n    var point = {\n      x: coordinate.start.x,\n      y: coordinate.end.y - (bbox.height + PADDING_TOP * 2)\n    };\n    if (coordinate.isPolar) {\n      // 默认，左上角直接出发\n      point = {\n        x: 0,\n        y: 0\n      };\n    }\n    if (position === 'bottom-left') {\n      // 涉及到坐标反转的问题\n      point = {\n        x: coordinate.start.x,\n        y: coordinate.start.y\n      };\n    }\n    /** PADDING_LEFT, PADDING_TOP 与画布边缘的距离 */\n    var matrix = Util.transform(null, [['t', point.x + PADDING_LEFT, point.y + bbox.height + PADDING_TOP]]);\n    breadCrumbGroup.setMatrix(matrix);\n  };\n  /**\n   * 返回上一层\n   */\n  DrillDownAction.prototype.back = function () {\n    if (size(this.historyCache)) {\n      this.backTo(this.historyCache.slice(0, -1));\n    }\n  };\n  /**\n   * 重置\n   */\n  DrillDownAction.prototype.reset = function () {\n    if (this.historyCache[0]) {\n      this.backTo(this.historyCache.slice(0, 1));\n    }\n    // 清空\n    this.historyCache = [];\n    this.hideCrumbGroup();\n  };\n  /**\n   * 下钻数据并更新 view 显示层\n   * @param nodeInfo 下钻数据\n   */\n  DrillDownAction.prototype.drill = function (nodeInfo) {\n    var view = this.context.view;\n    var transformData = get(view, ['interactions', 'drill-down', 'cfg', 'transformData'], function (v) {\n      return v;\n    });\n    // 重新 update 数据\n    var drillData = transformData(__assign({\n      data: nodeInfo.data\n    }, nodeInfo[HIERARCHY_DATA_TRANSFORM_PARAMS]));\n    view.changeData(drillData);\n    // 存储历史记录\n    var historyCache = [];\n    var node = nodeInfo;\n    while (node) {\n      var nodeData = node.data;\n      historyCache.unshift({\n        id: \"\".concat(nodeData.name, \"_\").concat(node.height, \"_\").concat(node.depth),\n        name: nodeData.name,\n        // children 是实际数据\n        children: transformData(__assign({\n          data: nodeData\n        }, nodeInfo[HIERARCHY_DATA_TRANSFORM_PARAMS]))\n      });\n      node = node.parent;\n    }\n    this.historyCache = (this.historyCache || []).slice(0, -1).concat(historyCache);\n  };\n  /**\n   * 回退事件，点击面包屑时触发\n   * @param historyCache 当前要回退到的历史\n   */\n  DrillDownAction.prototype.backTo = function (historyCache) {\n    if (!historyCache || historyCache.length <= 0) {\n      return;\n    }\n    var view = this.context.view;\n    var data = last(historyCache).children; // 处理后的数组\n    view.changeData(data);\n    if (historyCache.length > 1) {\n      this.historyCache = historyCache;\n      this.drawBreadCrumb();\n    } else {\n      // 清空\n      this.historyCache = [];\n      this.hideCrumbGroup();\n    }\n  };\n  /**\n   * 获取 mix 默认的配置和用户配置\n   */\n  DrillDownAction.prototype.getButtonCfg = function () {\n    var view = this.context.view;\n    var drillDownConfig = get(view, ['interactions', 'drill-down', 'cfg', 'drillDownConfig']);\n    return deepAssign(this.breadCrumbCfg, drillDownConfig === null || drillDownConfig === void 0 ? void 0 : drillDownConfig.breadCrumb, this.cfg);\n  };\n  /**\n   * 显示面包屑\n   */\n  DrillDownAction.prototype.drawBreadCrumb = function () {\n    this.drawBreadCrumbGroup();\n    this.resetPosition();\n    this.breadCrumbGroup.show();\n  };\n  /**\n   * 绘制 Button 和 文本\n   */\n  DrillDownAction.prototype.drawBreadCrumbGroup = function () {\n    var _this = this;\n    var config = this.getButtonCfg();\n    var cache = this.historyCache;\n    // 初始化面包屑 group\n    if (!this.breadCrumbGroup) {\n      this.breadCrumbGroup = this.context.view.foregroundGroup.addGroup({\n        name: BREAD_CRUMB_NAME\n      });\n    } else {\n      this.breadCrumbGroup.clear();\n    }\n    // 绘制面包屑\n    var left = 0;\n    cache.forEach(function (record, index) {\n      // 添加文本\n      var textShape = _this.breadCrumbGroup.addShape({\n        type: 'text',\n        id: record.id,\n        name: \"\".concat(BREAD_CRUMB_NAME, \"_\").concat(record.name, \"_text\"),\n        attrs: __assign(__assign({\n          text: index === 0 && !isNil(config.rootText) ? config.rootText : record.name\n        }, config.textStyle), {\n          x: left,\n          y: 0\n        })\n      });\n      var textShapeBox = textShape.getBBox();\n      left += textShapeBox.width + PADDING;\n      // 增加文本事件\n      textShape.on('click', function (event) {\n        var _a;\n        var targetId = event.target.get('id');\n        if (targetId !== ((_a = last(cache)) === null || _a === void 0 ? void 0 : _a.id)) {\n          var newHistoryCache = cache.slice(0, cache.findIndex(function (d) {\n            return d.id === targetId;\n          }) + 1);\n          _this.backTo(newHistoryCache);\n        }\n      });\n      // active 效果内置\n      textShape.on('mouseenter', function (event) {\n        var _a;\n        var targetId = event.target.get('id');\n        if (targetId !== ((_a = last(cache)) === null || _a === void 0 ? void 0 : _a.id)) {\n          textShape.attr(config.activeTextStyle);\n        } else {\n          textShape.attr({\n            cursor: 'default'\n          });\n        }\n      });\n      textShape.on('mouseleave', function () {\n        textShape.attr(config.textStyle);\n      });\n      if (index < cache.length - 1) {\n        // 添加反斜杠\n        var dividerShape = _this.breadCrumbGroup.addShape({\n          type: 'text',\n          name: \"\".concat(config.name, \"_\").concat(record.name, \"_divider\"),\n          attrs: __assign(__assign({\n            text: config.dividerText\n          }, config.textStyle), {\n            x: left,\n            y: 0\n          })\n        });\n        var dividerBox = dividerShape.getBBox();\n        left += dividerBox.width + PADDING;\n      }\n    });\n  };\n  /**\n   * 隐藏面包屑\n   */\n  DrillDownAction.prototype.hideCrumbGroup = function () {\n    if (this.breadCrumbGroup) {\n      this.breadCrumbGroup.hide();\n    }\n  };\n  /**\n   * @override\n   * destroy: 销毁资源\n   */\n  DrillDownAction.prototype.destroy = function () {\n    if (this.breadCrumbGroup) {\n      this.breadCrumbGroup.remove();\n    }\n    _super.prototype.destroy.call(this);\n  };\n  return DrillDownAction;\n}(Action);\nexport { DrillDownAction };","map":{"version":3,"names":["Action","Util","get","isNil","last","size","deepAssign","PADDING","PADDING_LEFT","PADDING_TOP","BREAD_CRUMB_NAME","DEFAULT_BREAD_CRUMB_CONFIG","position","dividerText","textStyle","fontSize","fill","cursor","activeTextStyle","HIERARCHY_DATA_TRANSFORM_PARAMS","DrillDownAction","_super","__extends","_this","apply","arguments","name","historyCache","breadCrumbGroup","breadCrumbCfg","prototype","click","data","context","drill","drawBreadCrumb","resetPosition","coordinate","view","getCoordinate","bbox","getBBox","getButtonCfg","point","x","start","y","end","height","isPolar","matrix","transform","setMatrix","back","backTo","slice","reset","hideCrumbGroup","nodeInfo","transformData","v","drillData","__assign","changeData","node","nodeData","unshift","id","concat","depth","children","parent","length","drillDownConfig","breadCrumb","cfg","drawBreadCrumbGroup","show","config","cache","foregroundGroup","addGroup","clear","left","forEach","record","index","textShape","addShape","type","attrs","text","rootText","textShapeBox","width","on","event","targetId","target","_a","newHistoryCache","findIndex","d","attr","dividerShape","dividerBox","hide","destroy","remove","call"],"sources":["../../../src/interactions/actions/drill-down.ts"],"sourcesContent":["import { Action, IGroup, Util } from '@antv/g2';\nimport { get, isNil, last, size } from '@antv/util';\nimport { Data } from '../../types';\nimport { DrillDownCfg } from '../../types/drill-down';\nimport { deepAssign } from '../../utils/deep-assign';\n\n// 面包屑文字和分割符'/'之间的距离\nconst PADDING = 4;\n// 面包屑位置距离树图的距离\nconst PADDING_LEFT = 0;\n// 面包屑位置距离树图的顶部距离\nexport const PADDING_TOP = 5;\n\n/** Group name of breadCrumb: 面包屑 */\nexport const BREAD_CRUMB_NAME = 'drilldown-bread-crumb';\n\n// 面包屑默认配置\nexport const DEFAULT_BREAD_CRUMB_CONFIG: DrillDownCfg['breadCrumb'] = {\n  /** 位置，默认：左上角 */\n  position: 'top-left',\n  dividerText: '/',\n  textStyle: {\n    fontSize: 12,\n    fill: 'rgba(0, 0, 0, 0.65)',\n    cursor: 'pointer',\n  },\n  activeTextStyle: {\n    fill: '#87B5FF',\n  },\n};\n\n/**\n * hierarchy 数据转换的参数\n */\nexport const HIERARCHY_DATA_TRANSFORM_PARAMS = 'hierarchy-data-transform-params';\n\n/**\n * Hierarchy plot 节点的数据\n */\nexport type HierarchyNode<N = any /** 节点 */> = {\n  /** 节点的原始数据，树型结构（todo 是否更正 key 为 origin） */\n  data: { name: string; value?: any; children: { name: string; value?: any }[] };\n  /** 在构建节点数据时候，增加的扩展配置, 用于存储 transformData 的入参配置 */\n  [HIERARCHY_DATA_TRANSFORM_PARAMS]: object;\n  /** 当前的层级结构，每一次下钻都会更新. 不是 unique */\n  depth: number;\n  /** 当前所处高度，depth + height = 总的层级 */\n  height: number;\n  parent: N;\n  children: N[];\n};\n\ntype HistoryCache = {\n  name: string;\n  id: string;\n  children: Data;\n}[];\n\n/**\n * @description 下钻交互的 action\n * @author liuzhenying\n *\n * 适用于：hierarchy plot\n */\nexport class DrillDownAction extends Action {\n  /** Action name */\n  public name = 'drill-down';\n\n  // 存储历史下钻数据\n  protected historyCache: HistoryCache = [];\n  // 面包屑 group\n  private breadCrumbGroup: IGroup = null;\n  // 面包屑基础配置\n  private breadCrumbCfg: DrillDownCfg['breadCrumb'] = DEFAULT_BREAD_CRUMB_CONFIG;\n\n  /**\n   * 点击事件, 下钻数据，并绘制面包屑\n   */\n  public click() {\n    const data = get(this.context, ['event', 'data', 'data']);\n    if (!data) return false;\n\n    this.drill(data);\n    this.drawBreadCrumb();\n  }\n\n  /**\n   * 重置位置，初始化及触发 chart  afterchangesize 回调时使用\n   */\n  public resetPosition() {\n    // 当在第一层级未绘制面包屑，此时 changedata 触发 resetPosition 函数，需判断 this.breadCrumbGroup 是否存在\n    if (!this.breadCrumbGroup) return;\n    const coordinate = this.context.view.getCoordinate();\n    const breadCrumbGroup = this.breadCrumbGroup;\n    const bbox = breadCrumbGroup.getBBox();\n\n    const { position } = this.getButtonCfg();\n\n    // @todo 后续抽取一个函数来处理，以及增加 margin 或者 padding 的设置\n    // 非 polar 的，需要使用 coordinate，除却图表组件\n    let point = { x: coordinate.start.x, y: coordinate.end.y - (bbox.height + PADDING_TOP * 2) };\n    if (coordinate.isPolar) {\n      // 默认，左上角直接出发\n      point = { x: 0, y: 0 };\n    }\n    if (position === 'bottom-left') {\n      // 涉及到坐标反转的问题\n      point = { x: coordinate.start.x, y: coordinate.start.y };\n    }\n    /** PADDING_LEFT, PADDING_TOP 与画布边缘的距离 */\n    const matrix = Util.transform(null, [['t', point.x + PADDING_LEFT, point.y + bbox.height + PADDING_TOP]]);\n    breadCrumbGroup.setMatrix(matrix);\n  }\n\n  /**\n   * 返回上一层\n   */\n  public back(): void {\n    if (size(this.historyCache)) {\n      this.backTo(this.historyCache.slice(0, -1));\n    }\n  }\n\n  /**\n   * 重置\n   */\n  public reset(): void {\n    if (this.historyCache[0]) {\n      this.backTo(this.historyCache.slice(0, 1));\n    }\n    // 清空\n    this.historyCache = [];\n    this.hideCrumbGroup();\n  }\n\n  /**\n   * 下钻数据并更新 view 显示层\n   * @param nodeInfo 下钻数据\n   */\n  protected drill(nodeInfo: HierarchyNode) {\n    const { view } = this.context;\n    const transformData = get(view, ['interactions', 'drill-down', 'cfg', 'transformData'], (v) => v);\n\n    // 重新 update 数据\n    const drillData = transformData({ data: nodeInfo.data, ...nodeInfo[HIERARCHY_DATA_TRANSFORM_PARAMS] });\n    view.changeData(drillData);\n\n    // 存储历史记录\n    const historyCache: HistoryCache = [];\n\n    let node = nodeInfo;\n    while (node) {\n      const nodeData = node.data;\n      historyCache.unshift({\n        id: `${nodeData.name}_${node.height}_${node.depth}`,\n        name: nodeData.name,\n        // children 是实际数据\n        children: transformData({ data: nodeData, ...nodeInfo[HIERARCHY_DATA_TRANSFORM_PARAMS] }),\n      });\n      node = node.parent;\n    }\n\n    this.historyCache = (this.historyCache || []).slice(0, -1).concat(historyCache);\n  }\n\n  /**\n   * 回退事件，点击面包屑时触发\n   * @param historyCache 当前要回退到的历史\n   */\n  protected backTo(historyCache: HistoryCache) {\n    if (!historyCache || historyCache.length <= 0) {\n      return;\n    }\n\n    const { view } = this.context;\n    const data = last(historyCache).children; // 处理后的数组\n    view.changeData(data);\n\n    if (historyCache.length > 1) {\n      this.historyCache = historyCache;\n      this.drawBreadCrumb();\n    } else {\n      // 清空\n      this.historyCache = [];\n      this.hideCrumbGroup();\n    }\n  }\n\n  /**\n   * 获取 mix 默认的配置和用户配置\n   */\n  private getButtonCfg() {\n    const { view } = this.context;\n    const drillDownConfig: DrillDownCfg = get(view, ['interactions', 'drill-down', 'cfg', 'drillDownConfig']);\n\n    return deepAssign(this.breadCrumbCfg, drillDownConfig?.breadCrumb, this.cfg);\n  }\n\n  /**\n   * 显示面包屑\n   */\n  private drawBreadCrumb() {\n    this.drawBreadCrumbGroup();\n    this.resetPosition();\n    this.breadCrumbGroup.show();\n  }\n\n  /**\n   * 绘制 Button 和 文本\n   */\n  private drawBreadCrumbGroup() {\n    const config = this.getButtonCfg();\n    const cache = this.historyCache;\n\n    // 初始化面包屑 group\n    if (!this.breadCrumbGroup) {\n      this.breadCrumbGroup = this.context.view.foregroundGroup.addGroup({\n        name: BREAD_CRUMB_NAME,\n      });\n    } else {\n      this.breadCrumbGroup.clear();\n    }\n\n    // 绘制面包屑\n    let left = 0;\n    cache.forEach((record, index) => {\n      // 添加文本\n      const textShape = this.breadCrumbGroup.addShape({\n        type: 'text',\n        id: record.id,\n        name: `${BREAD_CRUMB_NAME}_${record.name}_text`,\n        attrs: {\n          text: index === 0 && !isNil(config.rootText) ? config.rootText : record.name,\n          ...config.textStyle,\n          x: left,\n          y: 0,\n        },\n      });\n\n      const textShapeBox = textShape.getBBox();\n      left += textShapeBox.width + PADDING;\n\n      // 增加文本事件\n      textShape.on('click', (event) => {\n        const targetId = event.target.get('id');\n        if (targetId !== last(cache)?.id) {\n          const newHistoryCache = cache.slice(0, cache.findIndex((d) => d.id === targetId) + 1);\n          this.backTo(newHistoryCache);\n        }\n      });\n      // active 效果内置\n      textShape.on('mouseenter', (event) => {\n        const targetId = event.target.get('id');\n        if (targetId !== last(cache)?.id) {\n          textShape.attr(config.activeTextStyle);\n        } else {\n          textShape.attr({ cursor: 'default' });\n        }\n      });\n      textShape.on('mouseleave', () => {\n        textShape.attr(config.textStyle);\n      });\n\n      if (index < cache.length - 1) {\n        // 添加反斜杠\n        const dividerShape = this.breadCrumbGroup.addShape({\n          type: 'text',\n          name: `${config.name}_${record.name}_divider`,\n          attrs: {\n            text: config.dividerText,\n            ...config.textStyle,\n            x: left,\n            y: 0,\n          },\n        });\n\n        const dividerBox = dividerShape.getBBox();\n        left += dividerBox.width + PADDING;\n      }\n    });\n  }\n\n  /**\n   * 隐藏面包屑\n   */\n  private hideCrumbGroup() {\n    if (this.breadCrumbGroup) {\n      this.breadCrumbGroup.hide();\n    }\n  }\n\n  /**\n   * @override\n   * destroy: 销毁资源\n   */\n  public destroy() {\n    if (this.breadCrumbGroup) {\n      this.breadCrumbGroup.remove();\n    }\n    super.destroy();\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
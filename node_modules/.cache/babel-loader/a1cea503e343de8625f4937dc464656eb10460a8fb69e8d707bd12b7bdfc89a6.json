{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nimport { gl } from '@antv/g-webgpu-core';\nimport { extractUniforms } from '../utils/uniform';\nimport { blendEquationMap, blendFuncMap, cullFaceMap, depthFuncMap, primitiveMap, stencilFuncMap, stencilOpMap } from './constants';\n/**\n * adaptor for regl.DrawCommand\n */\nvar ReglModel = /*#__PURE__*/function () {\n  function ReglModel(reGl, options) {\n    _classCallCheck(this, ReglModel);\n    this.reGl = void 0;\n    this.drawCommand = void 0;\n    this.uniforms = {};\n    this.reGl = reGl;\n    var vs = options.vs,\n      fs = options.fs,\n      defines = options.defines,\n      attributes = options.attributes,\n      uniforms = options.uniforms,\n      primitive = options.primitive,\n      count = options.count,\n      elements = options.elements,\n      depth = options.depth,\n      blend = options.blend,\n      stencil = options.stencil,\n      cull = options.cull,\n      instances = options.instances,\n      scissor = options.scissor,\n      viewport = options.viewport;\n    var reglUniforms = {};\n    if (uniforms) {\n      this.uniforms = extractUniforms(uniforms);\n      Object.keys(uniforms).forEach(function (uniformName) {\n        // use regl prop API\n        // @ts-ignore\n        reglUniforms[uniformName] = reGl.prop(uniformName);\n      });\n    }\n    var reglAttributes = {};\n    Object.keys(attributes).forEach(function (name) {\n      reglAttributes[name] = attributes[name].get();\n    });\n    var defineStmts = defines && this.generateDefines(defines) || '';\n    var drawParams = {\n      attributes: reglAttributes,\n      frag: \"#ifdef GL_FRAGMENT_PRECISION_HIGH\\n  precision highp float;\\n#else\\n  precision mediump float;\\n#endif\\n\".concat(defineStmts, \"\\n\").concat(fs),\n      uniforms: reglUniforms,\n      vert: \"\\n\".concat(defineStmts, \"\\n\").concat(vs),\n      primitive: primitiveMap[primitive === undefined ? gl.TRIANGLES : primitive]\n    };\n    if (instances) {\n      drawParams.instances = instances;\n    }\n\n    // elements 中可能包含 count，此时不应传入\n    if (count) {\n      drawParams.count = count;\n    }\n    if (elements) {\n      drawParams.elements = elements.get();\n    }\n    if (scissor) {\n      drawParams.scissor = scissor;\n    }\n    if (viewport) {\n      drawParams.viewport = viewport;\n    }\n    this.initDepthDrawParams({\n      depth: depth\n    }, drawParams);\n    this.initBlendDrawParams({\n      blend: blend\n    }, drawParams);\n    this.initStencilDrawParams({\n      stencil: stencil\n    }, drawParams);\n    this.initCullDrawParams({\n      cull: cull\n    }, drawParams);\n    this.drawCommand = reGl(drawParams);\n  }\n  _createClass(ReglModel, [{\n    key: \"addUniforms\",\n    value: function addUniforms(uniforms) {\n      this.uniforms = _objectSpread(_objectSpread({}, this.uniforms), extractUniforms(uniforms));\n    }\n  }, {\n    key: \"draw\",\n    value: function draw(options) {\n      var uniforms = _objectSpread(_objectSpread({}, this.uniforms), extractUniforms(options.uniforms || {}));\n      var reglDrawProps = {};\n      Object.keys(uniforms).forEach(function (uniformName) {\n        var type = _typeof(uniforms[uniformName]);\n        if (type === 'boolean' || type === 'number' || Array.isArray(uniforms[uniformName]) ||\n        // @ts-ignore\n        uniforms[uniformName].BYTES_PER_ELEMENT) {\n          reglDrawProps[uniformName] = uniforms[uniformName];\n        } else if (type === 'string') {\n          // TODO: image url\n        } else {\n          reglDrawProps[uniformName] = uniforms[uniformName].get();\n        }\n      });\n      this.drawCommand(reglDrawProps);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      // don't need do anything since we will call `rendererService.cleanup()`\n    }\n\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#depth-buffer\n     */\n  }, {\n    key: \"initDepthDrawParams\",\n    value: function initDepthDrawParams(_ref, drawParams) {\n      var depth = _ref.depth;\n      if (depth) {\n        drawParams.depth = {\n          enable: depth.enable === undefined ? true : !!depth.enable,\n          mask: depth.mask === undefined ? true : !!depth.mask,\n          func: depthFuncMap[depth.func || gl.LESS],\n          range: depth.range || [0, 1]\n        };\n      }\n    }\n\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#blending\n     */\n  }, {\n    key: \"initBlendDrawParams\",\n    value: function initBlendDrawParams(_ref2, drawParams) {\n      var blend = _ref2.blend;\n      if (blend) {\n        var enable = blend.enable,\n          func = blend.func,\n          equation = blend.equation,\n          _blend$color = blend.color,\n          color = _blend$color === void 0 ? [0, 0, 0, 0] : _blend$color;\n        // @ts-ignore\n        drawParams.blend = {\n          enable: !!enable,\n          func: {\n            srcRGB: blendFuncMap[func && func.srcRGB || gl.SRC_ALPHA],\n            srcAlpha: blendFuncMap[func && func.srcAlpha || gl.SRC_ALPHA],\n            dstRGB: blendFuncMap[func && func.dstRGB || gl.ONE_MINUS_SRC_ALPHA],\n            dstAlpha: blendFuncMap[func && func.dstAlpha || gl.ONE_MINUS_SRC_ALPHA]\n          },\n          equation: {\n            rgb: blendEquationMap[equation && equation.rgb || gl.FUNC_ADD],\n            alpha: blendEquationMap[equation && equation.alpha || gl.FUNC_ADD]\n          },\n          color: color\n        };\n      }\n    }\n\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#stencil\n     */\n  }, {\n    key: \"initStencilDrawParams\",\n    value: function initStencilDrawParams(_ref3, drawParams) {\n      var stencil = _ref3.stencil;\n      if (stencil) {\n        var enable = stencil.enable,\n          _stencil$mask = stencil.mask,\n          mask = _stencil$mask === void 0 ? -1 : _stencil$mask,\n          _stencil$func = stencil.func,\n          func = _stencil$func === void 0 ? {\n            cmp: gl.ALWAYS,\n            ref: 0,\n            mask: -1\n          } : _stencil$func,\n          _stencil$opFront = stencil.opFront,\n          opFront = _stencil$opFront === void 0 ? {\n            fail: gl.KEEP,\n            zfail: gl.KEEP,\n            zpass: gl.KEEP\n          } : _stencil$opFront,\n          _stencil$opBack = stencil.opBack,\n          opBack = _stencil$opBack === void 0 ? {\n            fail: gl.KEEP,\n            zfail: gl.KEEP,\n            zpass: gl.KEEP\n          } : _stencil$opBack;\n        drawParams.stencil = {\n          enable: !!enable,\n          mask: mask,\n          func: _objectSpread(_objectSpread({}, func), {}, {\n            cmp: stencilFuncMap[func.cmp]\n          }),\n          opFront: {\n            fail: stencilOpMap[opFront.fail],\n            zfail: stencilOpMap[opFront.zfail],\n            zpass: stencilOpMap[opFront.zpass]\n          },\n          opBack: {\n            fail: stencilOpMap[opBack.fail],\n            zfail: stencilOpMap[opBack.zfail],\n            zpass: stencilOpMap[opBack.zpass]\n          }\n        };\n      }\n    }\n\n    /**\n     * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#culling\n     */\n  }, {\n    key: \"initCullDrawParams\",\n    value: function initCullDrawParams(_ref4, drawParams) {\n      var cull = _ref4.cull;\n      if (cull) {\n        var enable = cull.enable,\n          _cull$face = cull.face,\n          face = _cull$face === void 0 ? gl.BACK : _cull$face;\n        drawParams.cull = {\n          enable: !!enable,\n          face: cullFaceMap[face]\n        };\n      }\n    }\n  }, {\n    key: \"generateDefines\",\n    value: function generateDefines(defines) {\n      return Object.keys(defines).map(function (name) {\n        return \"#define \".concat(name, \" \").concat(Number(defines[name]));\n      }).join('\\n');\n    }\n  }]);\n  return ReglModel;\n}();\nexport { ReglModel as default };","map":{"version":3,"names":["gl","extractUniforms","blendEquationMap","blendFuncMap","cullFaceMap","depthFuncMap","primitiveMap","stencilFuncMap","stencilOpMap","ReglModel","reGl","options","_classCallCheck","drawCommand","uniforms","vs","fs","defines","attributes","primitive","count","elements","depth","blend","stencil","cull","instances","scissor","viewport","reglUniforms","Object","keys","forEach","uniformName","prop","reglAttributes","name","get","defineStmts","generateDefines","drawParams","frag","concat","vert","undefined","TRIANGLES","initDepthDrawParams","initBlendDrawParams","initStencilDrawParams","initCullDrawParams","_createClass","key","value","addUniforms","_objectSpread","draw","reglDrawProps","type","_typeof","Array","isArray","BYTES_PER_ELEMENT","destroy","_ref","enable","mask","func","LESS","range","_ref2","equation","_blend$color","color","srcRGB","SRC_ALPHA","srcAlpha","dstRGB","ONE_MINUS_SRC_ALPHA","dstAlpha","rgb","FUNC_ADD","alpha","_ref3","_stencil$mask","_stencil$func","cmp","ALWAYS","ref","_stencil$opFront","opFront","fail","KEEP","zfail","zpass","_stencil$opBack","opBack","_ref4","_cull$face","face","BACK","map","Number","join","default"],"sources":["../../src/webgl/ReglModel.ts"],"sourcesContent":["import {\n  gl,\n} from '@antv/g-webgpu-core';\nimport type {\n  IModel,\n  IModelDrawOptions,\n  IModelInitializationOptions,\n  IUniform,\n} from '@antv/g-webgpu-core';\nimport regl from 'regl';\nimport { extractUniforms } from '../utils/uniform';\nimport {\n  blendEquationMap,\n  blendFuncMap,\n  cullFaceMap,\n  depthFuncMap,\n  primitiveMap,\n  stencilFuncMap,\n  stencilOpMap,\n} from './constants';\nimport ReglAttribute from './ReglAttribute';\nimport ReglElements from './ReglElements';\nimport ReglFramebuffer from './ReglFramebuffer';\nimport ReglTexture2D from './ReglTexture2D';\n\n/**\n * adaptor for regl.DrawCommand\n */\nexport default class ReglModel implements IModel {\n  private reGl: regl.Regl;\n  private drawCommand: regl.DrawCommand;\n  private uniforms: {\n    [key: string]: IUniform;\n  } = {};\n\n  constructor(reGl: regl.Regl, options: IModelInitializationOptions) {\n    this.reGl = reGl;\n    const {\n      vs,\n      fs,\n      defines,\n      attributes,\n      uniforms,\n      primitive,\n      count,\n      elements,\n      depth,\n      blend,\n      stencil,\n      cull,\n      instances,\n      scissor,\n      // @ts-ignore\n      viewport,\n    } = options;\n    const reglUniforms: { [key: string]: IUniform } = {};\n    if (uniforms) {\n      this.uniforms = extractUniforms(uniforms);\n      Object.keys(uniforms).forEach((uniformName) => {\n        // use regl prop API\n        // @ts-ignore\n        reglUniforms[uniformName] = reGl.prop(uniformName);\n      });\n    }\n\n    const reglAttributes: { [key: string]: regl.Attribute } = {};\n    Object.keys(attributes).forEach((name: string) => {\n      reglAttributes[name] = (attributes[name] as ReglAttribute).get();\n    });\n\n    const defineStmts = (defines && this.generateDefines(defines)) || '';\n    const drawParams: regl.DrawConfig = {\n      attributes: reglAttributes,\n      frag: `#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n${defineStmts}\n${fs}`,\n      uniforms: reglUniforms,\n      vert: `\n${defineStmts}\n${vs}`,\n      primitive:\n        primitiveMap[primitive === undefined ? gl.TRIANGLES : primitive],\n    };\n    if (instances) {\n      drawParams.instances = instances;\n    }\n\n    // elements 中可能包含 count，此时不应传入\n    if (count) {\n      drawParams.count = count;\n    }\n\n    if (elements) {\n      drawParams.elements = (elements as ReglElements).get();\n    }\n\n    if (scissor) {\n      drawParams.scissor = scissor;\n    }\n\n    if (viewport) {\n      drawParams.viewport = viewport;\n    }\n\n    this.initDepthDrawParams({ depth }, drawParams);\n    this.initBlendDrawParams({ blend }, drawParams);\n    this.initStencilDrawParams({ stencil }, drawParams);\n    this.initCullDrawParams({ cull }, drawParams);\n\n    this.drawCommand = reGl(drawParams);\n  }\n\n  public addUniforms(uniforms: { [key: string]: IUniform }) {\n    this.uniforms = {\n      ...this.uniforms,\n      ...extractUniforms(uniforms),\n    };\n  }\n\n  public draw(options: IModelDrawOptions) {\n    const uniforms: {\n      [key: string]: IUniform;\n    } = {\n      ...this.uniforms,\n      ...extractUniforms(options.uniforms || {}),\n    };\n\n    const reglDrawProps: {\n      [key: string]:\n        | regl.Framebuffer\n        | regl.Texture2D\n        | number\n        | number[]\n        | boolean;\n    } = {};\n\n    Object.keys(uniforms).forEach((uniformName: string) => {\n      const type = typeof uniforms[uniformName];\n      if (\n        type === 'boolean' ||\n        type === 'number' ||\n        Array.isArray(uniforms[uniformName]) ||\n        // @ts-ignore\n        uniforms[uniformName].BYTES_PER_ELEMENT\n      ) {\n        reglDrawProps[uniformName] = uniforms[uniformName] as\n          | number\n          | number[]\n          | boolean;\n      } else if (type === 'string') {\n        // TODO: image url\n      } else {\n        reglDrawProps[uniformName] = (uniforms[uniformName] as\n          | ReglFramebuffer\n          | ReglTexture2D).get();\n      }\n    });\n    this.drawCommand(reglDrawProps);\n  }\n\n  public destroy() {\n    // don't need do anything since we will call `rendererService.cleanup()`\n  }\n\n  /**\n   * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#depth-buffer\n   */\n  private initDepthDrawParams(\n    { depth }: Pick<IModelInitializationOptions, 'depth'>,\n    drawParams: regl.DrawConfig,\n  ) {\n    if (depth) {\n      drawParams.depth = {\n        enable: depth.enable === undefined ? true : !!depth.enable,\n        mask: depth.mask === undefined ? true : !!depth.mask,\n        func: depthFuncMap[depth.func || gl.LESS],\n        range: depth.range || [0, 1],\n      };\n    }\n  }\n\n  /**\n   * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#blending\n   */\n  private initBlendDrawParams(\n    { blend }: Pick<IModelInitializationOptions, 'blend'>,\n    drawParams: regl.DrawConfig,\n  ) {\n    if (blend) {\n      const { enable, func, equation, color = [0, 0, 0, 0] } = blend;\n      // @ts-ignore\n      drawParams.blend = {\n        enable: !!enable,\n        func: {\n          srcRGB: blendFuncMap[(func && func.srcRGB) || gl.SRC_ALPHA],\n          srcAlpha: blendFuncMap[(func && func.srcAlpha) || gl.SRC_ALPHA],\n          dstRGB: blendFuncMap[(func && func.dstRGB) || gl.ONE_MINUS_SRC_ALPHA],\n          dstAlpha:\n            blendFuncMap[(func && func.dstAlpha) || gl.ONE_MINUS_SRC_ALPHA],\n        },\n        equation: {\n          rgb: blendEquationMap[(equation && equation.rgb) || gl.FUNC_ADD],\n          alpha: blendEquationMap[(equation && equation.alpha) || gl.FUNC_ADD],\n        },\n        color,\n      };\n    }\n  }\n\n  /**\n   * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#stencil\n   */\n  private initStencilDrawParams(\n    { stencil }: Pick<IModelInitializationOptions, 'stencil'>,\n    drawParams: regl.DrawConfig,\n  ) {\n    if (stencil) {\n      const {\n        enable,\n        mask = -1,\n        func = {\n          cmp: gl.ALWAYS,\n          ref: 0,\n          mask: -1,\n        },\n        opFront = {\n          fail: gl.KEEP,\n          zfail: gl.KEEP,\n          zpass: gl.KEEP,\n        },\n        opBack = {\n          fail: gl.KEEP,\n          zfail: gl.KEEP,\n          zpass: gl.KEEP,\n        },\n      } = stencil;\n      drawParams.stencil = {\n        enable: !!enable,\n        mask,\n        func: {\n          ...func,\n          cmp: stencilFuncMap[func.cmp],\n        },\n        opFront: {\n          fail: stencilOpMap[opFront.fail],\n          zfail: stencilOpMap[opFront.zfail],\n          zpass: stencilOpMap[opFront.zpass],\n        },\n        opBack: {\n          fail: stencilOpMap[opBack.fail],\n          zfail: stencilOpMap[opBack.zfail],\n          zpass: stencilOpMap[opBack.zpass],\n        },\n      };\n    }\n  }\n\n  /**\n   * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#culling\n   */\n  private initCullDrawParams(\n    { cull }: Pick<IModelInitializationOptions, 'cull'>,\n    drawParams: regl.DrawConfig,\n  ) {\n    if (cull) {\n      const { enable, face = gl.BACK } = cull;\n      drawParams.cull = {\n        enable: !!enable,\n        face: cullFaceMap[face],\n      };\n    }\n  }\n\n  private generateDefines(defines: Record<string, number | boolean>) {\n    return Object.keys(defines)\n      .map((name) => `#define ${name} ${Number(defines[name])}`)\n      .join('\\n');\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
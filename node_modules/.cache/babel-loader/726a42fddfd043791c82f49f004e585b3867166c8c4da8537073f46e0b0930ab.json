{"ast":null,"code":"import { ext, vec2, vec3 } from '@antv/matrix-util';\nvar identityMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\nexport function getMatrixByAngle(point, angle, matrix) {\n  if (matrix === void 0) {\n    matrix = identityMatrix;\n  }\n  if (!angle) {\n    // 角度为 0 或者 null 时返回 null\n    return null;\n  }\n  var m = ext.transform(matrix, [['t', -point.x, -point.y], ['r', angle], ['t', point.x, point.y]]);\n  return m;\n}\nexport function getMatrixByTranslate(point, currentMatrix) {\n  if (!point.x && !point.y) {\n    // 0，0 或者 nan 的情况下返回 null\n    return null;\n  }\n  return ext.transform(currentMatrix || identityMatrix, [['t', point.x, point.y]]);\n}\n// 从矩阵获取旋转的角度\nexport function getAngleByMatrix(matrix) {\n  var xVector = [1, 0, 0];\n  var out = [0, 0, 0];\n  vec3.transformMat3(out, xVector, matrix);\n  return Math.atan2(out[1], out[0]);\n}\n// 矩阵 * 向量\nfunction multiplyVec2(matrix, v) {\n  var out = [0, 0];\n  vec2.transformMat3(out, v, matrix);\n  return out;\n}\nexport function applyMatrix2BBox(matrix, bbox) {\n  var topLeft = multiplyVec2(matrix, [bbox.minX, bbox.minY]);\n  var topRight = multiplyVec2(matrix, [bbox.maxX, bbox.minY]);\n  var bottomLeft = multiplyVec2(matrix, [bbox.minX, bbox.maxY]);\n  var bottomRight = multiplyVec2(matrix, [bbox.maxX, bbox.maxY]);\n  var minX = Math.min(topLeft[0], topRight[0], bottomLeft[0], bottomRight[0]);\n  var maxX = Math.max(topLeft[0], topRight[0], bottomLeft[0], bottomRight[0]);\n  var minY = Math.min(topLeft[1], topRight[1], bottomLeft[1], bottomRight[1]);\n  var maxY = Math.max(topLeft[1], topRight[1], bottomLeft[1], bottomRight[1]);\n  return {\n    x: minX,\n    y: minY,\n    minX: minX,\n    minY: minY,\n    maxX: maxX,\n    maxY: maxY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nexport function applyRotate(shape, rotate, x, y) {\n  if (rotate) {\n    var matrix = getMatrixByAngle({\n      x: x,\n      y: y\n    }, rotate, shape.getMatrix());\n    shape.setMatrix(matrix);\n  }\n}\nexport function applyTranslate(shape, x, y) {\n  var translateMatrix = getMatrixByTranslate({\n    x: x,\n    y: y\n  });\n  shape.attr('matrix', translateMatrix);\n}","map":{"version":3,"names":["ext","vec2","vec3","identityMatrix","getMatrixByAngle","point","angle","matrix","m","transform","x","y","getMatrixByTranslate","currentMatrix","getAngleByMatrix","xVector","out","transformMat3","Math","atan2","multiplyVec2","v","applyMatrix2BBox","bbox","topLeft","minX","minY","topRight","maxX","bottomLeft","maxY","bottomRight","min","max","width","height","applyRotate","shape","rotate","getMatrix","setMatrix","applyTranslate","translateMatrix","attr"],"sources":["../../src/util/matrix.ts"],"sourcesContent":[null],"mappings":"AACA,SAASA,GAAG,EAAEC,IAAI,EAAEC,IAAI,QAAQ,mBAAmB;AAGnD,IAAMC,cAAc,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AAClD,OAAM,SAAUC,gBAAgBA,CAACC,KAAY,EAAEC,KAAa,EAAEC,MAAuB;EAAvB,IAAAA,MAAA;IAAAA,MAAA,GAAAJ,cAAuB;EAAA;EACnF,IAAI,CAACG,KAAK,EAAE;IACV;IACA,OAAO,IAAI;;EAEb,IAAME,CAAC,GAAGR,GAAG,CAACS,SAAS,CAACF,MAAM,EAAE,CAC9B,CAAC,GAAG,EAAE,CAACF,KAAK,CAACK,CAAC,EAAE,CAACL,KAAK,CAACM,CAAC,CAAC,EACzB,CAAC,GAAG,EAAEL,KAAK,CAAC,EACZ,CAAC,GAAG,EAAED,KAAK,CAACK,CAAC,EAAEL,KAAK,CAACM,CAAC,CAAC,CACxB,CAAC;EACF,OAAOH,CAAC;AACV;AAEA,OAAM,SAAUI,oBAAoBA,CAACP,KAAY,EAAEQ,aAAwB;EACzE,IAAI,CAACR,KAAK,CAACK,CAAC,IAAI,CAACL,KAAK,CAACM,CAAC,EAAE;IACxB;IACA,OAAO,IAAI;;EAEb,OAAOX,GAAG,CAACS,SAAS,CAACI,aAAa,IAAIV,cAAc,EAAE,CAAC,CAAC,GAAG,EAAEE,KAAK,CAACK,CAAC,EAAEL,KAAK,CAACM,CAAC,CAAC,CAAC,CAAC;AAClF;AAEA;AACA,OAAM,SAAUG,gBAAgBA,CAACP,MAIhC;EACC,IAAMQ,OAAO,GAA6B,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACnD,IAAMC,GAAG,GAA+B,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACjDd,IAAI,CAACe,aAAa,CAACD,GAAG,EAAED,OAAO,EAAER,MAAM,CAAC;EACxC,OAAOW,IAAI,CAACC,KAAK,CAACH,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,CAAC;AACnC;AACA;AACA,SAASI,YAAYA,CAACb,MAAM,EAAEc,CAAC;EAC7B,IAAML,GAAG,GAAqB,CAAC,CAAC,EAAE,CAAC,CAAC;EACpCf,IAAI,CAACgB,aAAa,CAACD,GAAG,EAAEK,CAAC,EAAEd,MAAM,CAAC;EAClC,OAAOS,GAAG;AACZ;AAEA,OAAM,SAAUM,gBAAgBA,CAACf,MAAgB,EAAEgB,IAAU;EAC3D,IAAMC,OAAO,GAAGJ,YAAY,CAACb,MAAM,EAAE,CAACgB,IAAI,CAACE,IAAI,EAAEF,IAAI,CAACG,IAAI,CAAC,CAAC;EAC5D,IAAMC,QAAQ,GAAGP,YAAY,CAACb,MAAM,EAAE,CAACgB,IAAI,CAACK,IAAI,EAAEL,IAAI,CAACG,IAAI,CAAC,CAAC;EAC7D,IAAMG,UAAU,GAAGT,YAAY,CAACb,MAAM,EAAE,CAACgB,IAAI,CAACE,IAAI,EAAEF,IAAI,CAACO,IAAI,CAAC,CAAC;EAC/D,IAAMC,WAAW,GAAGX,YAAY,CAACb,MAAM,EAAE,CAACgB,IAAI,CAACK,IAAI,EAAEL,IAAI,CAACO,IAAI,CAAC,CAAC;EAChE,IAAML,IAAI,GAAGP,IAAI,CAACc,GAAG,CAACR,OAAO,CAAC,CAAC,CAAC,EAAEG,QAAQ,CAAC,CAAC,CAAC,EAAEE,UAAU,CAAC,CAAC,CAAC,EAAEE,WAAW,CAAC,CAAC,CAAC,CAAC;EAC7E,IAAMH,IAAI,GAAGV,IAAI,CAACe,GAAG,CAACT,OAAO,CAAC,CAAC,CAAC,EAAEG,QAAQ,CAAC,CAAC,CAAC,EAAEE,UAAU,CAAC,CAAC,CAAC,EAAEE,WAAW,CAAC,CAAC,CAAC,CAAC;EAC7E,IAAML,IAAI,GAAGR,IAAI,CAACc,GAAG,CAACR,OAAO,CAAC,CAAC,CAAC,EAAEG,QAAQ,CAAC,CAAC,CAAC,EAAEE,UAAU,CAAC,CAAC,CAAC,EAAEE,WAAW,CAAC,CAAC,CAAC,CAAC;EAC7E,IAAMD,IAAI,GAAGZ,IAAI,CAACe,GAAG,CAACT,OAAO,CAAC,CAAC,CAAC,EAAEG,QAAQ,CAAC,CAAC,CAAC,EAAEE,UAAU,CAAC,CAAC,CAAC,EAAEE,WAAW,CAAC,CAAC,CAAC,CAAC;EAC7E,OAAO;IACLrB,CAAC,EAAEe,IAAI;IACPd,CAAC,EAAEe,IAAI;IACPD,IAAI,EAAAA,IAAA;IACJC,IAAI,EAAAA,IAAA;IACJE,IAAI,EAAAA,IAAA;IACJE,IAAI,EAAAA,IAAA;IACJI,KAAK,EAAEN,IAAI,GAAGH,IAAI;IAClBU,MAAM,EAAEL,IAAI,GAAGJ;GAChB;AACH;AAEA,OAAM,SAAUU,WAAWA,CAACC,KAAe,EAAEC,MAAc,EAAE5B,CAAS,EAAEC,CAAS;EAC/E,IAAI2B,MAAM,EAAE;IACV,IAAM/B,MAAM,GAAGH,gBAAgB,CAAC;MAAEM,CAAC,EAAAA,CAAA;MAAEC,CAAC,EAAAA;IAAA,CAAE,EAAE2B,MAAM,EAAED,KAAK,CAACE,SAAS,EAAE,CAAC;IACpEF,KAAK,CAACG,SAAS,CAACjC,MAAM,CAAC;;AAE3B;AAEA,OAAM,SAAUkC,cAAcA,CAACJ,KAAe,EAAE3B,CAAS,EAAEC,CAAS;EAClE,IAAM+B,eAAe,GAAG9B,oBAAoB,CAAC;IAAEF,CAAC,EAAAA,CAAA;IAAEC,CAAC,EAAAA;EAAA,CAAE,CAAC;EACtD0B,KAAK,CAACM,IAAI,CAAC,QAAQ,EAAED,eAAe,CAAC;AACvC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
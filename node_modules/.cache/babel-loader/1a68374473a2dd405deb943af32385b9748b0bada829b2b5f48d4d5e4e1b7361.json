{"ast":null,"code":"import { __assign } from \"tslib\";\nimport { each, every, find, findIndex, get, isBoolean, isEqual, isObject } from '@antv/util';\nimport { animation as commonAnimation, annotation as commonAnnotation, interaction as commonInteraction, limitInPlot as commonLimitInPlot, scale, theme as commonTheme } from '../../adaptor/common';\nimport { deepAssign, flow } from '../../utils';\nimport { percent } from '../../utils/transform/percent';\nimport { findViewById } from '../../utils/view';\nimport { LEFT_AXES_VIEW, RIGHT_AXES_VIEW } from './constant';\nimport { AxisType, DualAxesGeometry } from './types';\nimport { drawSingleGeometry } from './util/geometry';\nimport { getViewLegendItems } from './util/legend';\nimport { getGeometryOption, getYAxisWithDefault, isColumn, transformObjectToArray } from './util/option';\nimport { doSliderFilter } from './util/render-sider';\n/**\n * transformOptions，双轴图整体的取参逻辑如下\n * 1. get index getOptions: 对应的是默认的图表参数，如 appendPadding，syncView 等\n * 2. get adpator transformOption: 对应的是双轴图的默认参数，deepAssign 优先级从低到高如下\n *    2.1 defaultoption，如 tooltip，legend\n *    2.2 用户填写 options\n *    2.3 根据用户填写的 options 补充的数组型 options，如 yaxis，GeometryOption，因为 deepAssign 无法 assign 数组\n *\n * @param params\n */\nexport function transformOptions(params) {\n  var _a;\n  var options = params.options;\n  var _b = options.geometryOptions,\n    geometryOptions = _b === void 0 ? [] : _b,\n    xField = options.xField,\n    yField = options.yField;\n  var allLine = every(geometryOptions, function (_a) {\n    var geometry = _a.geometry;\n    return geometry === DualAxesGeometry.Line || geometry === undefined;\n  });\n  return deepAssign({}, {\n    options: {\n      geometryOptions: [],\n      meta: (_a = {}, _a[xField] = {\n        // 默认为 cat 类型\n        type: 'cat',\n        // x 轴一定是同步 scale 的\n        sync: true,\n        // 如果有没有柱子，则\n        range: allLine ? [0, 1] : undefined\n      }, _a),\n      tooltip: {\n        showMarkers: allLine,\n        // 存在柱状图，不显示 crosshairs\n        showCrosshairs: allLine,\n        shared: true,\n        crosshairs: {\n          type: 'x'\n        }\n      },\n      interactions: !allLine ? [{\n        type: 'legend-visible-filter'\n      }, {\n        type: 'active-region'\n      }] : [{\n        type: 'legend-visible-filter'\n      }],\n      legend: {\n        position: 'top-left'\n      }\n    }\n  }, params, {\n    options: {\n      // yAxis\n      yAxis: transformObjectToArray(yField, options.yAxis),\n      // geometryOptions\n      geometryOptions: [getGeometryOption(xField, yField[0], geometryOptions[0]), getGeometryOption(xField, yField[1], geometryOptions[1])],\n      // annotations\n      annotations: transformObjectToArray(yField, options.annotations)\n    }\n  });\n}\n/**\n * 创建 双轴图 中绘制图形的 view，提前创建是因为 theme 适配器的需要\n * @param params\n */\nfunction createViews(params) {\n  var _a, _b;\n  var chart = params.chart,\n    options = params.options;\n  var geometryOptions = options.geometryOptions;\n  var SORT_MAP = {\n    line: 0,\n    column: 1\n  };\n  // 包含配置，id，数据的结构\n  var geometries = [{\n    type: (_a = geometryOptions[0]) === null || _a === void 0 ? void 0 : _a.geometry,\n    id: LEFT_AXES_VIEW\n  }, {\n    type: (_b = geometryOptions[1]) === null || _b === void 0 ? void 0 : _b.geometry,\n    id: RIGHT_AXES_VIEW\n  }];\n  // 将线的 view 放置在更上一层，防止线柱遮挡。先柱后先\n  geometries.sort(function (a, b) {\n    return -SORT_MAP[a.type] + SORT_MAP[b.type];\n  }).forEach(function (g) {\n    return chart.createView({\n      id: g.id\n    });\n  });\n  return params;\n}\n/**\n * 绘制图形\n * @param params\n */\nfunction geometry(params) {\n  var chart = params.chart,\n    options = params.options;\n  var xField = options.xField,\n    yField = options.yField,\n    geometryOptions = options.geometryOptions,\n    data = options.data,\n    tooltip = options.tooltip;\n  // 包含配置，id，数据的结构\n  var geometries = [__assign(__assign({}, geometryOptions[0]), {\n    id: LEFT_AXES_VIEW,\n    data: data[0],\n    yField: yField[0]\n  }), __assign(__assign({}, geometryOptions[1]), {\n    id: RIGHT_AXES_VIEW,\n    data: data[1],\n    yField: yField[1]\n  })];\n  geometries.forEach(function (geometry) {\n    var id = geometry.id,\n      data = geometry.data,\n      yField = geometry.yField;\n    // 百分比柱状图需要额外处理一次数据\n    var isPercent = isColumn(geometry) && geometry.isPercent;\n    var formatData = isPercent ? percent(data, yField, xField, yField) : data;\n    var view = findViewById(chart, id).data(formatData);\n    var tooltipOptions = isPercent ? __assign({\n      formatter: function (datum) {\n        return {\n          name: datum[geometry.seriesField] || yField,\n          value: (Number(datum[yField]) * 100).toFixed(2) + '%'\n        };\n      }\n    }, tooltip) : tooltip;\n    // 绘制图形\n    drawSingleGeometry({\n      chart: view,\n      options: {\n        xField: xField,\n        yField: yField,\n        tooltip: tooltipOptions,\n        geometryOption: geometry\n      }\n    });\n  });\n  return params;\n}\nexport function color(params) {\n  var _a;\n  var chart = params.chart,\n    options = params.options;\n  var geometryOptions = options.geometryOptions;\n  var themeColor = ((_a = chart.getTheme()) === null || _a === void 0 ? void 0 : _a.colors10) || [];\n  var start = 0;\n  /* 为 geometry 添加默认 color。\n   * 1. 若 geometryOptions 存在 color，则在 drawGeometry 时已处理\n   * 2. 若 不存在 color，获取 Geometry group scales个数，在 theme color 10 中提取\n   * 3. 为防止 group 过多导致右色板无值或值很少，右 view 面板在依次提取剩下的 N 个 后再 concat 一次 themeColor\n   * 4. 为简便获取 Geometry group scales个数，在绘制完后再执行 color\n   * 5. 考虑之后将不同 view 使用同一个色板的需求沉淀到 g2\n   */\n  chart.once('beforepaint', function () {\n    each(geometryOptions, function (geometryOption, index) {\n      var view = findViewById(chart, index === 0 ? LEFT_AXES_VIEW : RIGHT_AXES_VIEW);\n      if (geometryOption.color) return;\n      var groupScale = view.getGroupScales();\n      var count = get(groupScale, [0, 'values', 'length'], 1);\n      var color = themeColor.slice(start, start + count).concat(index === 0 ? [] : themeColor);\n      view.geometries.forEach(function (geometry) {\n        if (geometryOption.seriesField) {\n          geometry.color(geometryOption.seriesField, color);\n        } else {\n          geometry.color(color[0]);\n        }\n      });\n      start += count;\n    });\n    chart.render(true);\n  });\n  return params;\n}\n/**\n * meta 配置\n * @param params\n */\nexport function meta(params) {\n  var _a, _b;\n  var chart = params.chart,\n    options = params.options;\n  var xAxis = options.xAxis,\n    yAxis = options.yAxis,\n    xField = options.xField,\n    yField = options.yField;\n  scale((_a = {}, _a[xField] = xAxis, _a[yField[0]] = yAxis[0], _a))(deepAssign({}, params, {\n    chart: findViewById(chart, LEFT_AXES_VIEW)\n  }));\n  scale((_b = {}, _b[xField] = xAxis, _b[yField[1]] = yAxis[1], _b))(deepAssign({}, params, {\n    chart: findViewById(chart, RIGHT_AXES_VIEW)\n  }));\n  return params;\n}\n/**\n * axis 配置\n * @param params\n */\nexport function axis(params) {\n  var chart = params.chart,\n    options = params.options;\n  var leftView = findViewById(chart, LEFT_AXES_VIEW);\n  var rightView = findViewById(chart, RIGHT_AXES_VIEW);\n  var xField = options.xField,\n    yField = options.yField,\n    xAxis = options.xAxis,\n    yAxis = options.yAxis;\n  chart.axis(xField, false);\n  chart.axis(yField[0], false);\n  chart.axis(yField[1], false);\n  // 左 View\n  leftView.axis(xField, xAxis);\n  leftView.axis(yField[0], getYAxisWithDefault(yAxis[0], AxisType.Left));\n  // 右 Y 轴\n  rightView.axis(xField, false);\n  rightView.axis(yField[1], getYAxisWithDefault(yAxis[1], AxisType.Right));\n  return params;\n}\n/**\n * tooltip 配置\n * @param params\n */\nexport function tooltip(params) {\n  var chart = params.chart,\n    options = params.options;\n  var tooltip = options.tooltip;\n  var leftView = findViewById(chart, LEFT_AXES_VIEW);\n  var rightView = findViewById(chart, RIGHT_AXES_VIEW);\n  // tooltip 经过 getDefaultOption 处理后，一定不为 undefined\n  chart.tooltip(tooltip);\n  // 在 view 上添加 tooltip，使得 shared 和 interaction active-region 起作用\n  // view 应该继承 chart 里的 shared，但是从表现看来，继承有点问题\n  leftView.tooltip({\n    shared: true\n  });\n  rightView.tooltip({\n    shared: true\n  });\n  return params;\n}\n/**\n * interaction 配置\n * @param params\n */\nexport function interaction(params) {\n  var chart = params.chart;\n  commonInteraction(deepAssign({}, params, {\n    chart: findViewById(chart, LEFT_AXES_VIEW)\n  }));\n  commonInteraction(deepAssign({}, params, {\n    chart: findViewById(chart, RIGHT_AXES_VIEW)\n  }));\n  return params;\n}\n/**\n * annotation 配置\n * @param params\n */\nexport function annotation(params) {\n  var chart = params.chart,\n    options = params.options;\n  var annotations = options.annotations;\n  var a1 = get(annotations, [0]);\n  var a2 = get(annotations, [1]);\n  commonAnnotation(a1)(deepAssign({}, params, {\n    chart: findViewById(chart, LEFT_AXES_VIEW),\n    options: {\n      annotations: a1\n    }\n  }));\n  commonAnnotation(a2)(deepAssign({}, params, {\n    chart: findViewById(chart, RIGHT_AXES_VIEW),\n    options: {\n      annotations: a2\n    }\n  }));\n  return params;\n}\nexport function theme(params) {\n  var chart = params.chart;\n  /*\n   * 双轴图中，部分组件是绘制在子 view 层（例如 axis，line），部分组件是绘制在 chart （例如 legend)\n   * 为 chart 和 子 view 均注册 theme，使其自行遵循 G2 theme geometry > view > chart 进行渲染。\n   */\n  commonTheme(deepAssign({}, params, {\n    chart: findViewById(chart, LEFT_AXES_VIEW)\n  }));\n  commonTheme(deepAssign({}, params, {\n    chart: findViewById(chart, RIGHT_AXES_VIEW)\n  }));\n  commonTheme(params);\n  return params;\n}\nexport function animation(params) {\n  var chart = params.chart;\n  commonAnimation(deepAssign({}, params, {\n    chart: findViewById(chart, LEFT_AXES_VIEW)\n  }));\n  commonAnimation(deepAssign({}, params, {\n    chart: findViewById(chart, RIGHT_AXES_VIEW)\n  }));\n  return params;\n}\n/**\n * 双轴图 limitInPlot\n * @param params\n */\nexport function limitInPlot(params) {\n  var chart = params.chart,\n    options = params.options;\n  var yAxis = options.yAxis;\n  commonLimitInPlot(deepAssign({}, params, {\n    chart: findViewById(chart, LEFT_AXES_VIEW),\n    options: {\n      yAxis: yAxis[0]\n    }\n  }));\n  commonLimitInPlot(deepAssign({}, params, {\n    chart: findViewById(chart, RIGHT_AXES_VIEW),\n    options: {\n      yAxis: yAxis[1]\n    }\n  }));\n  return params;\n}\n/**\n * legend 配置\n * 使用 custom，便于和类似于分组柱状图-单折线图的逻辑统一\n * @param params\n */\nexport function legend(params) {\n  var chart = params.chart,\n    options = params.options;\n  var legend = options.legend,\n    geometryOptions = options.geometryOptions,\n    yField = options.yField,\n    data = options.data;\n  var leftView = findViewById(chart, LEFT_AXES_VIEW);\n  var rightView = findViewById(chart, RIGHT_AXES_VIEW);\n  if (legend === false) {\n    chart.legend(false);\n  } else if (isObject(legend) && legend.custom === true) {\n    chart.legend(legend);\n  } else {\n    var leftLegend_1 = get(geometryOptions, [0, 'legend'], legend);\n    var rightLegend_1 = get(geometryOptions, [1, 'legend'], legend);\n    // 均使用自定义图例\n    chart.once('beforepaint', function () {\n      var leftItems = data[0].length ? getViewLegendItems({\n        view: leftView,\n        geometryOption: geometryOptions[0],\n        yField: yField[0],\n        legend: leftLegend_1\n      }) : [];\n      var rightItems = data[1].length ? getViewLegendItems({\n        view: rightView,\n        geometryOption: geometryOptions[1],\n        yField: yField[1],\n        legend: rightLegend_1\n      }) : [];\n      chart.legend(deepAssign({}, legend, {\n        custom: true,\n        // todo 修改类型定义\n        // @ts-ignore\n        items: leftItems.concat(rightItems)\n      }));\n    });\n    if (geometryOptions[0].seriesField) {\n      leftView.legend(geometryOptions[0].seriesField, leftLegend_1);\n    }\n    if (geometryOptions[1].seriesField) {\n      rightView.legend(geometryOptions[1].seriesField, rightLegend_1);\n    }\n    // 自定义图例交互\n    chart.on('legend-item:click', function (evt) {\n      var delegateObject = get(evt, 'gEvent.delegateObject', {});\n      if (delegateObject && delegateObject.item) {\n        var _a = delegateObject.item,\n          field_1 = _a.value,\n          isGeometry = _a.isGeometry,\n          viewId = _a.viewId;\n        // geometry 的时候，直接使用 view.changeVisible\n        if (isGeometry) {\n          var idx = findIndex(yField, function (yF) {\n            return yF === field_1;\n          });\n          if (idx > -1) {\n            var geometries = get(findViewById(chart, viewId), 'geometries');\n            each(geometries, function (g) {\n              g.changeVisible(!delegateObject.item.unchecked);\n            });\n          }\n        } else {\n          var legendItem_1 = get(chart.getController('legend'), 'option.items', []);\n          // 分组柱线图\n          each(chart.views, function (view) {\n            // 单折柱图\n            var groupScale = view.getGroupScales();\n            each(groupScale, function (scale) {\n              if (scale.values && scale.values.indexOf(field_1) > -1) {\n                view.filter(scale.field, function (value) {\n                  var curLegendItem = find(legendItem_1, function (item) {\n                    return item.value === value;\n                  });\n                  // 使用 legend 中的 unchecked 来判断，使得支持关闭多个图例\n                  return !curLegendItem.unchecked;\n                });\n              }\n            });\n            chart.render(true);\n          });\n        }\n      }\n    });\n  }\n  return params;\n}\n/**\n * 双轴图 slider 适配器\n * @param params\n */\nexport function slider(params) {\n  var chart = params.chart,\n    options = params.options;\n  var slider = options.slider;\n  var leftView = findViewById(chart, LEFT_AXES_VIEW);\n  var rightView = findViewById(chart, RIGHT_AXES_VIEW);\n  if (slider) {\n    // 左 View\n    leftView.option('slider', slider);\n    // 监听左侧 slider 改变事件， 同步右侧 View 视图\n    leftView.on('slider:valuechanged', function (evt) {\n      var _a = evt.event,\n        value = _a.value,\n        originValue = _a.originValue;\n      if (isEqual(value, originValue)) {\n        return;\n      }\n      doSliderFilter(rightView, value);\n    });\n    chart.once('afterpaint', function () {\n      // 初始化数据，配置默认值时需要同步\n      if (!isBoolean(slider)) {\n        var start = slider.start,\n          end = slider.end;\n        if (start || end) {\n          doSliderFilter(rightView, [start, end]);\n        }\n      }\n    });\n  }\n  return params;\n}\n/**\n * 双折线图适配器\n * @param chart\n * @param options\n */\nexport function adaptor(params) {\n  // transformOptions 一定在最前面处理；color legend 使用了 beforepaint，为便于理解放在最后面\n  return flow(transformOptions, createViews,\n  // 主题靠前设置，作为最低优先级\n  theme, geometry, meta, axis, limitInPlot, tooltip, interaction, annotation, animation, color, legend, slider)(params);\n}","map":{"version":3,"names":["each","every","find","findIndex","get","isBoolean","isEqual","isObject","animation","commonAnimation","annotation","commonAnnotation","interaction","commonInteraction","limitInPlot","commonLimitInPlot","scale","theme","commonTheme","deepAssign","flow","percent","findViewById","LEFT_AXES_VIEW","RIGHT_AXES_VIEW","AxisType","DualAxesGeometry","drawSingleGeometry","getViewLegendItems","getGeometryOption","getYAxisWithDefault","isColumn","transformObjectToArray","doSliderFilter","transformOptions","params","options","_b","geometryOptions","xField","yField","allLine","_a","geometry","Line","undefined","meta","type","sync","range","tooltip","showMarkers","showCrosshairs","shared","crosshairs","interactions","legend","position","yAxis","annotations","createViews","chart","SORT_MAP","line","column","geometries","id","sort","a","b","forEach","g","createView","data","isPercent","formatData","view","tooltipOptions","__assign","formatter","datum","name","seriesField","value","Number","toFixed","geometryOption","color","themeColor","getTheme","colors10","start","once","index","groupScale","getGroupScales","count","slice","concat","render","xAxis","axis","leftView","rightView","Left","Right","a1","a2","custom","leftLegend_1","rightLegend_1","leftItems","length","rightItems","items","on","evt","delegateObject","item","field_1","isGeometry","viewId","idx","yF","changeVisible","unchecked","legendItem_1","getController","views","values","indexOf","filter","field","curLegendItem","slider","option","event","originValue","end","adaptor"],"sources":["../../../src/plots/dual-axes/adaptor.ts"],"sourcesContent":["import { Event, Scale, Types } from '@antv/g2';\nimport { each, every, find, findIndex, get, isBoolean, isEqual, isObject } from '@antv/util';\nimport {\n  animation as commonAnimation,\n  annotation as commonAnnotation,\n  interaction as commonInteraction,\n  limitInPlot as commonLimitInPlot,\n  scale,\n  theme as commonTheme,\n} from '../../adaptor/common';\nimport { Params } from '../../core/adaptor';\nimport { Datum } from '../../types';\nimport { deepAssign, flow } from '../../utils';\nimport { percent } from '../../utils/transform/percent';\nimport { findViewById } from '../../utils/view';\nimport { LEFT_AXES_VIEW, RIGHT_AXES_VIEW } from './constant';\nimport { AxisType, DualAxesGeometry, DualAxesOptions } from './types';\nimport { drawSingleGeometry } from './util/geometry';\nimport { getViewLegendItems } from './util/legend';\nimport { getGeometryOption, getYAxisWithDefault, isColumn, transformObjectToArray } from './util/option';\nimport { doSliderFilter } from './util/render-sider';\n\n/**\n * transformOptions，双轴图整体的取参逻辑如下\n * 1. get index getOptions: 对应的是默认的图表参数，如 appendPadding，syncView 等\n * 2. get adpator transformOption: 对应的是双轴图的默认参数，deepAssign 优先级从低到高如下\n *    2.1 defaultoption，如 tooltip，legend\n *    2.2 用户填写 options\n *    2.3 根据用户填写的 options 补充的数组型 options，如 yaxis，GeometryOption，因为 deepAssign 无法 assign 数组\n *\n * @param params\n */\nexport function transformOptions(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { options } = params;\n  const { geometryOptions = [], xField, yField } = options;\n  const allLine = every(\n    geometryOptions,\n    ({ geometry }) => geometry === DualAxesGeometry.Line || geometry === undefined\n  );\n  return deepAssign(\n    {},\n    {\n      options: {\n        geometryOptions: [],\n        meta: {\n          [xField]: {\n            // 默认为 cat 类型\n            type: 'cat',\n            // x 轴一定是同步 scale 的\n            sync: true,\n            // 如果有没有柱子，则\n            range: allLine ? [0, 1] : undefined,\n          },\n        },\n        tooltip: {\n          showMarkers: allLine,\n          // 存在柱状图，不显示 crosshairs\n          showCrosshairs: allLine,\n          shared: true,\n          crosshairs: {\n            type: 'x',\n          },\n        },\n        interactions: !allLine\n          ? [{ type: 'legend-visible-filter' }, { type: 'active-region' }]\n          : [{ type: 'legend-visible-filter' }],\n        legend: {\n          position: 'top-left',\n        },\n      },\n    },\n    params,\n    {\n      options: {\n        // yAxis\n        yAxis: transformObjectToArray(yField, options.yAxis),\n        // geometryOptions\n        geometryOptions: [\n          getGeometryOption(xField, yField[0], geometryOptions[0]),\n          getGeometryOption(xField, yField[1], geometryOptions[1]),\n        ],\n        // annotations\n        annotations: transformObjectToArray(yField, options.annotations),\n      },\n    }\n  );\n}\n\n/**\n * 创建 双轴图 中绘制图形的 view，提前创建是因为 theme 适配器的需要\n * @param params\n */\nfunction createViews(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { geometryOptions } = options;\n\n  const SORT_MAP = { line: 0, column: 1 };\n\n  // 包含配置，id，数据的结构\n  const geometries = [\n    { type: geometryOptions[0]?.geometry, id: LEFT_AXES_VIEW },\n    { type: geometryOptions[1]?.geometry, id: RIGHT_AXES_VIEW },\n  ];\n\n  // 将线的 view 放置在更上一层，防止线柱遮挡。先柱后先\n  geometries.sort((a, b) => -SORT_MAP[a.type] + SORT_MAP[b.type]).forEach((g) => chart.createView({ id: g.id }));\n\n  return params;\n}\n\n/**\n * 绘制图形\n * @param params\n */\nfunction geometry(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { xField, yField, geometryOptions, data, tooltip } = options;\n\n  // 包含配置，id，数据的结构\n  const geometries = [\n    { ...geometryOptions[0], id: LEFT_AXES_VIEW, data: data[0], yField: yField[0] },\n    { ...geometryOptions[1], id: RIGHT_AXES_VIEW, data: data[1], yField: yField[1] },\n  ];\n\n  geometries.forEach((geometry) => {\n    const { id, data, yField } = geometry;\n    // 百分比柱状图需要额外处理一次数据\n    const isPercent = isColumn(geometry) && geometry.isPercent;\n    const formatData = isPercent ? percent(data, yField, xField, yField) : data;\n    const view = findViewById(chart, id).data(formatData);\n\n    const tooltipOptions = isPercent\n      ? {\n          formatter: (datum: Datum) => ({\n            name: datum[geometry.seriesField] || yField,\n            value: (Number(datum[yField]) * 100).toFixed(2) + '%',\n          }),\n          ...tooltip,\n        }\n      : tooltip;\n\n    // 绘制图形\n    drawSingleGeometry({\n      chart: view,\n      options: {\n        xField,\n        yField,\n        tooltip: tooltipOptions,\n        geometryOption: geometry,\n      },\n    });\n  });\n  return params;\n}\n\nexport function color(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { geometryOptions } = options;\n  const themeColor = chart.getTheme()?.colors10 || [];\n\n  let start = 0;\n  /* 为 geometry 添加默认 color。\n   * 1. 若 geometryOptions 存在 color，则在 drawGeometry 时已处理\n   * 2. 若 不存在 color，获取 Geometry group scales个数，在 theme color 10 中提取\n   * 3. 为防止 group 过多导致右色板无值或值很少，右 view 面板在依次提取剩下的 N 个 后再 concat 一次 themeColor\n   * 4. 为简便获取 Geometry group scales个数，在绘制完后再执行 color\n   * 5. 考虑之后将不同 view 使用同一个色板的需求沉淀到 g2\n   */\n  chart.once('beforepaint', () => {\n    each(geometryOptions, (geometryOption, index) => {\n      const view = findViewById(chart, index === 0 ? LEFT_AXES_VIEW : RIGHT_AXES_VIEW);\n      if (geometryOption.color) return;\n      const groupScale = view.getGroupScales();\n      const count = get(groupScale, [0, 'values', 'length'], 1);\n      const color = themeColor.slice(start, start + count).concat(index === 0 ? [] : themeColor);\n      view.geometries.forEach((geometry) => {\n        if (geometryOption.seriesField) {\n          geometry.color(geometryOption.seriesField, color);\n        } else {\n          geometry.color(color[0]);\n        }\n      });\n      start += count;\n    });\n    chart.render(true);\n  });\n\n  return params;\n}\n\n/**\n * meta 配置\n * @param params\n */\nexport function meta(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { xAxis, yAxis, xField, yField } = options;\n\n  scale({\n    [xField]: xAxis,\n    [yField[0]]: yAxis[0],\n  })(deepAssign({}, params, { chart: findViewById(chart, LEFT_AXES_VIEW) }));\n\n  scale({\n    [xField]: xAxis,\n    [yField[1]]: yAxis[1],\n  })(deepAssign({}, params, { chart: findViewById(chart, RIGHT_AXES_VIEW) }));\n\n  return params;\n}\n\n/**\n * axis 配置\n * @param params\n */\nexport function axis(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const leftView = findViewById(chart, LEFT_AXES_VIEW);\n  const rightView = findViewById(chart, RIGHT_AXES_VIEW);\n  const { xField, yField, xAxis, yAxis } = options;\n\n  chart.axis(xField, false);\n  chart.axis(yField[0], false);\n  chart.axis(yField[1], false);\n\n  // 左 View\n  leftView.axis(xField, xAxis);\n  leftView.axis(yField[0], getYAxisWithDefault(yAxis[0], AxisType.Left));\n\n  // 右 Y 轴\n  rightView.axis(xField, false);\n  rightView.axis(yField[1], getYAxisWithDefault(yAxis[1], AxisType.Right));\n\n  return params;\n}\n\n/**\n * tooltip 配置\n * @param params\n */\nexport function tooltip(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { tooltip } = options;\n  const leftView = findViewById(chart, LEFT_AXES_VIEW);\n  const rightView = findViewById(chart, RIGHT_AXES_VIEW);\n  // tooltip 经过 getDefaultOption 处理后，一定不为 undefined\n  chart.tooltip(tooltip);\n  // 在 view 上添加 tooltip，使得 shared 和 interaction active-region 起作用\n  // view 应该继承 chart 里的 shared，但是从表现看来，继承有点问题\n  leftView.tooltip({\n    shared: true,\n  });\n  rightView.tooltip({\n    shared: true,\n  });\n  return params;\n}\n\n/**\n * interaction 配置\n * @param params\n */\nexport function interaction(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart } = params;\n\n  commonInteraction(deepAssign({}, params, { chart: findViewById(chart, LEFT_AXES_VIEW) }));\n  commonInteraction(deepAssign({}, params, { chart: findViewById(chart, RIGHT_AXES_VIEW) }));\n\n  return params;\n}\n\n/**\n * annotation 配置\n * @param params\n */\nexport function annotation(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { annotations } = options;\n\n  const a1 = get(annotations, [0]);\n  const a2 = get(annotations, [1]);\n\n  commonAnnotation(a1)(\n    deepAssign({}, params, {\n      chart: findViewById(chart, LEFT_AXES_VIEW),\n      options: {\n        annotations: a1,\n      },\n    })\n  );\n  commonAnnotation(a2)(\n    deepAssign({}, params, {\n      chart: findViewById(chart, RIGHT_AXES_VIEW),\n      options: {\n        annotations: a2,\n      },\n    })\n  );\n  return params;\n}\n\nexport function theme(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart } = params;\n\n  /*\n   * 双轴图中，部分组件是绘制在子 view 层（例如 axis，line），部分组件是绘制在 chart （例如 legend)\n   * 为 chart 和 子 view 均注册 theme，使其自行遵循 G2 theme geometry > view > chart 进行渲染。\n   */\n  commonTheme(deepAssign({}, params, { chart: findViewById(chart, LEFT_AXES_VIEW) }));\n  commonTheme(deepAssign({}, params, { chart: findViewById(chart, RIGHT_AXES_VIEW) }));\n  commonTheme(params);\n\n  return params;\n}\n\nexport function animation(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart } = params;\n\n  commonAnimation(deepAssign({}, params, { chart: findViewById(chart, LEFT_AXES_VIEW) }));\n  commonAnimation(deepAssign({}, params, { chart: findViewById(chart, RIGHT_AXES_VIEW) }));\n\n  return params;\n}\n\n/**\n * 双轴图 limitInPlot\n * @param params\n */\nexport function limitInPlot(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { yAxis } = options;\n\n  commonLimitInPlot(\n    deepAssign({}, params, {\n      chart: findViewById(chart, LEFT_AXES_VIEW),\n      options: {\n        yAxis: yAxis[0],\n      },\n    })\n  );\n\n  commonLimitInPlot(\n    deepAssign({}, params, {\n      chart: findViewById(chart, RIGHT_AXES_VIEW),\n      options: {\n        yAxis: yAxis[1],\n      },\n    })\n  );\n\n  return params;\n}\n\n/**\n * legend 配置\n * 使用 custom，便于和类似于分组柱状图-单折线图的逻辑统一\n * @param params\n */\nexport function legend(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { legend, geometryOptions, yField, data } = options;\n  const leftView = findViewById(chart, LEFT_AXES_VIEW);\n  const rightView = findViewById(chart, RIGHT_AXES_VIEW);\n\n  if (legend === false) {\n    chart.legend(false);\n  } else if (isObject(legend) && legend.custom === true) {\n    chart.legend(legend);\n  } else {\n    const leftLegend = get(geometryOptions, [0, 'legend'], legend);\n    const rightLegend = get(geometryOptions, [1, 'legend'], legend);\n    // 均使用自定义图例\n    chart.once('beforepaint', () => {\n      const leftItems = data[0].length\n        ? getViewLegendItems({\n            view: leftView,\n            geometryOption: geometryOptions[0],\n            yField: yField[0],\n            legend: leftLegend,\n          })\n        : [];\n\n      const rightItems = data[1].length\n        ? getViewLegendItems({\n            view: rightView,\n            geometryOption: geometryOptions[1],\n            yField: yField[1],\n            legend: rightLegend,\n          })\n        : [];\n\n      chart.legend(\n        deepAssign({}, legend, {\n          custom: true,\n          // todo 修改类型定义\n          // @ts-ignore\n          items: leftItems.concat(rightItems),\n        })\n      );\n    });\n\n    if (geometryOptions[0].seriesField) {\n      leftView.legend(geometryOptions[0].seriesField, leftLegend);\n    }\n    if (geometryOptions[1].seriesField) {\n      rightView.legend(geometryOptions[1].seriesField, rightLegend);\n    }\n\n    // 自定义图例交互\n    chart.on('legend-item:click', (evt) => {\n      const delegateObject = get(evt, 'gEvent.delegateObject', {});\n      if (delegateObject && delegateObject.item) {\n        const { value: field, isGeometry, viewId } = delegateObject.item;\n        // geometry 的时候，直接使用 view.changeVisible\n        if (isGeometry) {\n          const idx = findIndex(yField, (yF: string) => yF === field);\n          if (idx > -1) {\n            const geometries = get(findViewById(chart, viewId), 'geometries');\n            each(geometries, (g) => {\n              g.changeVisible(!delegateObject.item.unchecked);\n            });\n          }\n        } else {\n          const legendItem = get(chart.getController('legend'), 'option.items', []);\n          // 分组柱线图\n          each(chart.views, (view) => {\n            // 单折柱图\n            const groupScale = view.getGroupScales();\n            each(groupScale, (scale: Scale) => {\n              if (scale.values && scale.values.indexOf(field) > -1) {\n                view.filter(scale.field, (value) => {\n                  const curLegendItem: Types.LegendItem = find(\n                    legendItem,\n                    (item: Types.LegendItem) => item.value === value\n                  );\n                  // 使用 legend 中的 unchecked 来判断，使得支持关闭多个图例\n                  return !curLegendItem.unchecked;\n                });\n              }\n            });\n            chart.render(true);\n          });\n        }\n      }\n    });\n  }\n\n  return params;\n}\n\n/**\n * 双轴图 slider 适配器\n * @param params\n */\nexport function slider(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  const { chart, options } = params;\n  const { slider } = options;\n  const leftView = findViewById(chart, LEFT_AXES_VIEW);\n  const rightView = findViewById(chart, RIGHT_AXES_VIEW);\n  if (slider) {\n    // 左 View\n    leftView.option('slider', slider);\n    // 监听左侧 slider 改变事件， 同步右侧 View 视图\n    leftView.on('slider:valuechanged', (evt: Event) => {\n      const {\n        event: { value, originValue },\n      } = evt;\n      if (isEqual(value, originValue)) {\n        return;\n      }\n      doSliderFilter(rightView, value);\n    });\n    chart.once('afterpaint', () => {\n      // 初始化数据，配置默认值时需要同步\n      if (!isBoolean(slider)) {\n        const { start, end } = slider;\n        if (start || end) {\n          doSliderFilter(rightView, [start, end]);\n        }\n      }\n    });\n  }\n\n  return params;\n}\n\n/**\n * 双折线图适配器\n * @param chart\n * @param options\n */\nexport function adaptor(params: Params<DualAxesOptions>): Params<DualAxesOptions> {\n  // transformOptions 一定在最前面处理；color legend 使用了 beforepaint，为便于理解放在最后面\n  return flow(\n    transformOptions,\n    createViews,\n    // 主题靠前设置，作为最低优先级\n    theme,\n    geometry,\n    meta,\n    axis,\n    limitInPlot,\n    tooltip,\n    interaction,\n    annotation,\n    animation,\n    color,\n    legend,\n    slider\n  )(params);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
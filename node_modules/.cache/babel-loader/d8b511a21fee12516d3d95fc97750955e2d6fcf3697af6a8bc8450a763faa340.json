{"ast":null,"code":"import { __assign } from \"tslib\";\nimport { get } from '@antv/util';\nimport { ellipsisLabel } from './label';\nimport { applyRotate, applyTranslate } from './matrix';\nimport { formatPadding } from './util';\nexport function renderTag(container, tagCfg) {\n  var x = tagCfg.x,\n    y = tagCfg.y,\n    content = tagCfg.content,\n    style = tagCfg.style,\n    id = tagCfg.id,\n    name = tagCfg.name,\n    rotate = tagCfg.rotate,\n    maxLength = tagCfg.maxLength,\n    autoEllipsis = tagCfg.autoEllipsis,\n    isVertical = tagCfg.isVertical,\n    ellipsisPosition = tagCfg.ellipsisPosition,\n    background = tagCfg.background;\n  var tagGroup = container.addGroup({\n    id: id + \"-group\",\n    name: name + \"-group\",\n    attrs: {\n      x: x,\n      y: y\n    }\n  });\n  // Text shape\n  var text = tagGroup.addShape({\n    type: 'text',\n    id: id,\n    name: name,\n    attrs: __assign({\n      x: 0,\n      y: 0,\n      text: content\n    }, style)\n  });\n  // maxLength 应包含 background 中的 padding 值\n  var padding = formatPadding(get(background, 'padding', 0));\n  if (maxLength && autoEllipsis) {\n    var maxTextLength = maxLength - (padding[1] + padding[3]);\n    // 超出自动省略\n    ellipsisLabel(!isVertical, text, maxTextLength, ellipsisPosition);\n  }\n  if (background) {\n    // 渲染文本背景\n    var backgroundStyle = get(background, 'style', {});\n    var _a = text.getCanvasBBox(),\n      minX = _a.minX,\n      minY = _a.minY,\n      width = _a.width,\n      height = _a.height;\n    var tagBg = tagGroup.addShape('rect', {\n      id: id + \"-bg\",\n      name: id + \"-bg\",\n      attrs: __assign({\n        x: minX - padding[3],\n        y: minY - padding[0],\n        width: width + padding[1] + padding[3],\n        height: height + padding[0] + padding[2]\n      }, backgroundStyle)\n    });\n    tagBg.toBack();\n  }\n  applyTranslate(tagGroup, x, y);\n  applyRotate(tagGroup, rotate, x, y);\n}","map":{"version":3,"names":["get","ellipsisLabel","applyRotate","applyTranslate","formatPadding","renderTag","container","tagCfg","x","y","content","style","id","name","rotate","maxLength","autoEllipsis","isVertical","ellipsisPosition","background","tagGroup","addGroup","attrs","text","addShape","type","__assign","padding","maxTextLength","backgroundStyle","_a","getCanvasBBox","minX","minY","width","height","tagBg","toBack"],"sources":["../../src/util/graphic.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
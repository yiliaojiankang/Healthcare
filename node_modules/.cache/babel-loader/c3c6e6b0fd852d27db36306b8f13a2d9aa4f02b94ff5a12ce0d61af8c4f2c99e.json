{"ast":null,"code":"import { registerInteraction } from '@antv/g2';\nvar INTERACTION_MAP = {\n  hover: '__interval-connected-area-hover__',\n  click: '__interval-connected-area-click__'\n};\nvar getStartStages = function (trigger, style) {\n  if (trigger === 'hover') {\n    return [{\n      trigger: \"interval:mouseenter\",\n      action: ['element-highlight-by-color:highlight', 'element-link-by-color:link'],\n      arg: [null, {\n        style: style\n      }]\n    }];\n  }\n  return [{\n    trigger: \"interval:click\",\n    action: ['element-highlight-by-color:clear', 'element-highlight-by-color:highlight', 'element-link-by-color:clear', 'element-link-by-color:unlink', 'element-link-by-color:link'],\n    arg: [null, null, null, null, {\n      style: style\n    }]\n  }];\n};\n/** hover 触发的连通区域交互 */\nregisterInteraction(INTERACTION_MAP.hover, {\n  start: getStartStages(INTERACTION_MAP.hover),\n  end: [{\n    trigger: 'interval:mouseleave',\n    action: ['element-highlight-by-color:reset', 'element-link-by-color:unlink']\n  }]\n});\n/** click 触发的联通区域交互 */\nregisterInteraction(INTERACTION_MAP.click, {\n  start: getStartStages(INTERACTION_MAP.click),\n  end: [{\n    trigger: 'document:mousedown',\n    action: ['element-highlight-by-color:clear', 'element-link-by-color:clear']\n  }]\n});\n/**\n * 返回支持联通区域组件交互的 adaptor，适用于堆叠柱形图/堆叠条形图\n * @param disable\n */\nexport function connectedArea(disable) {\n  if (disable === void 0) {\n    disable = false;\n  }\n  return function (params) {\n    var chart = params.chart,\n      options = params.options;\n    var connectedArea = options.connectedArea;\n    var clear = function () {\n      chart.removeInteraction(INTERACTION_MAP.hover);\n      chart.removeInteraction(INTERACTION_MAP.click);\n    };\n    if (!disable && connectedArea) {\n      var trigger = connectedArea.trigger || 'hover';\n      clear();\n      chart.interaction(INTERACTION_MAP[trigger], {\n        start: getStartStages(trigger, connectedArea.style)\n      });\n    } else {\n      clear();\n    }\n    return params;\n  };\n}","map":{"version":3,"names":["registerInteraction","INTERACTION_MAP","hover","click","getStartStages","trigger","style","action","arg","start","end","connectedArea","disable","params","chart","options","clear","removeInteraction","interaction"],"sources":["../../src/adaptor/connected-area.ts"],"sourcesContent":["import { Element, registerInteraction, ShapeAttrs } from '@antv/g2';\nimport { Params } from '../core/adaptor';\n\nexport interface ConnectedAreaOptions {\n  /** 触发方式, 默认 hover */\n  trigger?: 'hover' | 'click';\n  /** 自定义样式 */\n  style?: ShapeAttrs | ((style: ShapeAttrs, element: Element) => ShapeAttrs);\n}\n\n/** 联通区域组件：使用于堆叠柱形图、堆叠条形图 */\nexport interface OptionWithConnectedArea {\n  connectedArea?: ConnectedAreaOptions | false;\n}\n\nconst INTERACTION_MAP = {\n  hover: '__interval-connected-area-hover__',\n  click: '__interval-connected-area-click__',\n};\n\nconst getStartStages = (trigger: string, style?: ConnectedAreaOptions['style']) => {\n  if (trigger === 'hover') {\n    return [\n      {\n        trigger: `interval:mouseenter`,\n        action: ['element-highlight-by-color:highlight', 'element-link-by-color:link'],\n        arg: [null, { style }],\n      },\n    ];\n  }\n  return [\n    {\n      trigger: `interval:click`,\n      action: [\n        'element-highlight-by-color:clear',\n        'element-highlight-by-color:highlight',\n        'element-link-by-color:clear',\n        'element-link-by-color:unlink',\n        'element-link-by-color:link',\n      ],\n      arg: [null, null, null, null, { style }],\n    },\n  ];\n};\n\n/** hover 触发的连通区域交互 */\nregisterInteraction(INTERACTION_MAP.hover, {\n  start: getStartStages(INTERACTION_MAP.hover),\n  end: [\n    {\n      trigger: 'interval:mouseleave',\n      action: ['element-highlight-by-color:reset', 'element-link-by-color:unlink'],\n    },\n  ],\n});\n\n/** click 触发的联通区域交互 */\nregisterInteraction(INTERACTION_MAP.click, {\n  start: getStartStages(INTERACTION_MAP.click),\n  end: [\n    {\n      trigger: 'document:mousedown',\n      action: ['element-highlight-by-color:clear', 'element-link-by-color:clear'],\n    },\n  ],\n});\n\n/**\n * 返回支持联通区域组件交互的 adaptor，适用于堆叠柱形图/堆叠条形图\n * @param disable\n */\nexport function connectedArea<O extends OptionWithConnectedArea>(disable = false) {\n  return function (params: Params<O>): Params<O> {\n    const { chart, options } = params;\n    const { connectedArea } = options;\n\n    const clear = () => {\n      chart.removeInteraction(INTERACTION_MAP.hover);\n      chart.removeInteraction(INTERACTION_MAP.click);\n    };\n\n    if (!disable && connectedArea) {\n      const trigger = connectedArea.trigger || 'hover';\n      clear();\n      chart.interaction(INTERACTION_MAP[trigger], {\n        start: getStartStages(trigger, connectedArea.style),\n      });\n    } else {\n      clear();\n    }\n\n    return params;\n  };\n}\n"],"mappings":"AAAA,SAAkBA,mBAAmB,QAAoB,UAAU;AAenE,IAAMC,eAAe,GAAG;EACtBC,KAAK,EAAE,mCAAmC;EAC1CC,KAAK,EAAE;CACR;AAED,IAAMC,cAAc,GAAG,SAAAA,CAACC,OAAe,EAAEC,KAAqC;EAC5E,IAAID,OAAO,KAAK,OAAO,EAAE;IACvB,OAAO,CACL;MACEA,OAAO,EAAE,qBAAqB;MAC9BE,MAAM,EAAE,CAAC,sCAAsC,EAAE,4BAA4B,CAAC;MAC9EC,GAAG,EAAE,CAAC,IAAI,EAAE;QAAEF,KAAK,EAAAA;MAAA,CAAE;KACtB,CACF;;EAEH,OAAO,CACL;IACED,OAAO,EAAE,gBAAgB;IACzBE,MAAM,EAAE,CACN,kCAAkC,EAClC,sCAAsC,EACtC,6BAA6B,EAC7B,8BAA8B,EAC9B,4BAA4B,CAC7B;IACDC,GAAG,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;MAAEF,KAAK,EAAAA;IAAA,CAAE;GACxC,CACF;AACH,CAAC;AAED;AACAN,mBAAmB,CAACC,eAAe,CAACC,KAAK,EAAE;EACzCO,KAAK,EAAEL,cAAc,CAACH,eAAe,CAACC,KAAK,CAAC;EAC5CQ,GAAG,EAAE,CACH;IACEL,OAAO,EAAE,qBAAqB;IAC9BE,MAAM,EAAE,CAAC,kCAAkC,EAAE,8BAA8B;GAC5E;CAEJ,CAAC;AAEF;AACAP,mBAAmB,CAACC,eAAe,CAACE,KAAK,EAAE;EACzCM,KAAK,EAAEL,cAAc,CAACH,eAAe,CAACE,KAAK,CAAC;EAC5CO,GAAG,EAAE,CACH;IACEL,OAAO,EAAE,oBAAoB;IAC7BE,MAAM,EAAE,CAAC,kCAAkC,EAAE,6BAA6B;GAC3E;CAEJ,CAAC;AAEF;;;;AAIA,OAAM,SAAUI,aAAaA,CAAoCC,OAAe;EAAf,IAAAA,OAAA;IAAAA,OAAA,QAAe;EAAA;EAC9E,OAAO,UAAUC,MAAiB;IACxB,IAAAC,KAAK,GAAcD,MAAM,CAAAC,KAApB;MAAEC,OAAO,GAAKF,MAAM,CAAAE,OAAX;IACd,IAAAJ,aAAa,GAAKI,OAAO,CAAAJ,aAAZ;IAErB,IAAMK,KAAK,GAAG,SAAAA,CAAA;MACZF,KAAK,CAACG,iBAAiB,CAAChB,eAAe,CAACC,KAAK,CAAC;MAC9CY,KAAK,CAACG,iBAAiB,CAAChB,eAAe,CAACE,KAAK,CAAC;IAChD,CAAC;IAED,IAAI,CAACS,OAAO,IAAID,aAAa,EAAE;MAC7B,IAAMN,OAAO,GAAGM,aAAa,CAACN,OAAO,IAAI,OAAO;MAChDW,KAAK,EAAE;MACPF,KAAK,CAACI,WAAW,CAACjB,eAAe,CAACI,OAAO,CAAC,EAAE;QAC1CI,KAAK,EAAEL,cAAc,CAACC,OAAO,EAAEM,aAAa,CAACL,KAAK;OACnD,CAAC;KACH,MAAM;MACLU,KAAK,EAAE;;IAGT,OAAOH,MAAM;EACf,CAAC;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}
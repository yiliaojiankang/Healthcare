!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@antv/l7")):"function"==typeof define&&define.amd?define(["exports","@antv/l7"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).L7=e.L7||{},e.L7.Draw={}),e.L7)}(this,(function(e,t){"use strict";var n={draw:"crosshair",pointHover:"pointer",pointDrag:"move",lineHover:"pointer",lineDrag:"move",polygonHover:"pointer",polygonDrag:"move"},r={point:[],line:[],polygon:[],midPoint:[],dashLine:[],text:[]},i="top",o="bottom",a="right",s="left",u="auto",l=[i,o,a,s],c="start",h="end",d="clippingParents",f="viewport",p="popper",v="reference",g=l.reduce((function(e,t){return e.concat([t+"-"+c,t+"-"+h])}),[]),y=[].concat(l,[u]).reduce((function(e,t){return e.concat([t,t+"-"+c,t+"-"+h])}),[]),m=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function b(e){return e?(e.nodeName||"").toLowerCase():null}function D(e){if(null==e)return window;if(""+e!="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function w(e){return e instanceof D(e).Element||e instanceof Element}function E(e){return e instanceof D(e).HTMLElement||e instanceof HTMLElement}function x(e){return"undefined"!=typeof ShadowRoot&&(e instanceof D(e).ShadowRoot||e instanceof ShadowRoot)}var P={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},i=t.elements[e];E(i)&&b(i)&&(Object.assign(i.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],i=t.attributes[e]||{},o=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});E(r)&&b(r)&&(Object.assign(r.style,o),Object.keys(i).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]};function k(e){return e.split("-")[0]}var M=Math.max,L=Math.min,A=Math.round;function O(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function C(){return!/^((?!chrome|android).)*safari/i.test(O())}function _(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),i=1,o=1;t&&E(e)&&(i=e.offsetWidth>0&&A(r.width)/e.offsetWidth||1,o=e.offsetHeight>0&&A(r.height)/e.offsetHeight||1);var a=(w(e)?D(e):window).visualViewport,s=!C()&&n,u=(r.left+(s&&a?a.offsetLeft:0))/i,l=(r.top+(s&&a?a.offsetTop:0))/o,c=r.width/i,h=r.height/o;return{width:c,height:h,top:l,right:u+c,bottom:l+h,left:u,x:u,y:l}}function R(e){var t=_(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)>1||(n=t.width),Math.abs(t.height-r)>1||(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function S(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&x(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function j(e){return D(e).getComputedStyle(e)}function T(e){return["table","td","th"].indexOf(b(e))>=0}function H(e){return((w(e)?e.ownerDocument:e.document)||window.document).documentElement}function B(e){return"html"===b(e)?e:e.assignedSlot||e.parentNode||(x(e)?e.host:null)||H(e)}function F(e){return E(e)&&"fixed"!==j(e).position?e.offsetParent:null}function N(e){for(var t=D(e),n=F(e);n&&T(n)&&"static"===j(n).position;)n=F(n);return n&&("html"===b(n)||"body"===b(n)&&"static"===j(n).position)?t:n||function(e){var t=/firefox/i.test(O());if(/Trident/i.test(O())&&E(e)&&"fixed"===j(e).position)return null;var n=B(e);for(x(n)&&(n=n.host);E(n)&&0>["html","body"].indexOf(b(n));){var r=j(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}function I(e){return 0>["top","bottom"].indexOf(e)?"y":"x"}function U(e,t,n){return M(e,L(t,n))}function Y(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function X(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}var z={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,u=e.options,c=n.elements.arrow,h=n.modifiersData.popperOffsets,d=k(n.placement),f=I(d),p=[s,a].indexOf(d)>=0?"height":"width";if(c&&h){var v=function(e,t){return Y("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:X(e,l))}(u.padding,n),g=R(c),y="y"===f?i:s,m="y"===f?o:a,b=n.rects.reference[p]+n.rects.reference[f]-h[f]-n.rects.popper[p],D=h[f]-n.rects.reference[f],w=N(c),E=w?"y"===f?w.clientHeight||0:w.clientWidth||0:0,x=E/2-g[p]/2+(b/2-D/2),P=U(v[y],x,E-g[p]-v[m]);n.modifiersData[r]=((t={})[f]=P,t.centerOffset=P-x,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&S(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function V(e){return e.split("-")[1]}var q={top:"auto",right:"auto",bottom:"auto",left:"auto"};function W(e){var t,n=e.popper,r=e.popperRect,u=e.placement,l=e.variation,c=e.offsets,d=e.position,f=e.gpuAcceleration,p=e.adaptive,v=e.roundOffsets,g=e.isFixed,y=c.x,m=void 0===y?0:y,b=c.y,w=void 0===b?0:b,E="function"==typeof v?v({x:m,y:w}):{x:m,y:w};m=E.x,w=E.y;var x=c.hasOwnProperty("x"),P=c.hasOwnProperty("y"),k=s,M=i,L=window;if(p){var O=N(n),C="clientHeight",_="clientWidth";if(O===D(n)&&"static"!==j(O=H(n)).position&&"absolute"===d&&(C="scrollHeight",_="scrollWidth"),u===i||(u===s||u===a)&&l===h)M=o,w-=(g&&O===L&&L.visualViewport?L.visualViewport.height:O[C])-r.height,w*=f?1:-1;if(u===s||(u===i||u===o)&&l===h)k=a,m-=(g&&O===L&&L.visualViewport?L.visualViewport.width:O[_])-r.width,m*=f?1:-1}var R,S=Object.assign({position:d},p&&q),T=!0===v?function(e,t){var n=e.y,r=t.devicePixelRatio||1;return{x:A(e.x*r)/r||0,y:A(n*r)/r||0}}({x:m,y:w},D(n)):{x:m,y:w};return m=T.x,w=T.y,Object.assign({},S,f?((R={})[M]=P?"0":"",R[k]=x?"0":"",R.transform=(L.devicePixelRatio||1)>1?"translate3d("+m+"px, "+w+"px, 0)":"translate("+m+"px, "+w+"px)",R):((t={})[M]=P?w+"px":"",t[k]=x?m+"px":"",t.transform="",t))}var $={passive:!0};var G={left:"right",right:"left",bottom:"top",top:"bottom"};function K(e){return e.replace(/left|right|bottom|top/g,(function(e){return G[e]}))}var J={start:"end",end:"start"};function Z(e){return e.replace(/start|end/g,(function(e){return J[e]}))}function Q(e){var t=D(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function ee(e){return _(H(e)).left+Q(e).scrollLeft}function te(e){var t=j(e);return/auto|scroll|overlay|hidden/.test(t.overflow+t.overflowY+t.overflowX)}function ne(e){return 0>["html","body","#document"].indexOf(b(e))?E(e)&&te(e)?e:ne(B(e)):e.ownerDocument.body}function re(e,t){var n;void 0===t&&(t=[]);var r=ne(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=D(r),a=i?[o].concat(o.visualViewport||[],te(r)?r:[]):r,s=t.concat(a);return i?s:s.concat(re(B(a)))}function ie(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function oe(e,t,n){return t===f?ie(function(e,t){var n=D(e),r=H(e),i=n.visualViewport,o=r.clientWidth,a=r.clientHeight,s=0,u=0;if(i){o=i.width,a=i.height;var l=C();(l||!l&&"fixed"===t)&&(s=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:s+ee(e),y:u}}(e,n)):w(t)?function(e,t){var n=_(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):ie(function(e){var t,n=H(e),r=Q(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=M(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=M(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-r.scrollLeft+ee(e),u=-r.scrollTop;return"rtl"===j(i||n).direction&&(s+=M(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:a,x:s,y:u}}(H(e)))}function ae(e,t,n,r){var i="clippingParents"===t?function(e){var t=re(B(e)),n=["absolute","fixed"].indexOf(j(e).position)>=0&&E(e)?N(e):e;return w(n)?t.filter((function(e){return w(e)&&S(e,n)&&"body"!==b(e)})):[]}(e):[].concat(t),o=[].concat(i,[n]),a=o.reduce((function(t,n){var i=oe(e,n,r);return t.top=M(i.top,t.top),t.right=L(i.right,t.right),t.bottom=L(i.bottom,t.bottom),t.left=M(i.left,t.left),t}),oe(e,o[0],r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function se(e){var t,n=e.reference,r=e.element,u=e.placement,l=u?k(u):null,d=u?V(u):null,f=n.x+n.width/2-r.width/2,p=n.y+n.height/2-r.height/2;switch(l){case i:t={x:f,y:n.y-r.height};break;case o:t={x:f,y:n.y+n.height};break;case a:t={x:n.x+n.width,y:p};break;case s:t={x:n.x-r.width,y:p};break;default:t={x:n.x,y:n.y}}var v=l?I(l):null;if(null!=v){var g="y"===v?"height":"width";switch(d){case c:t[v]=t[v]-(n[g]/2-r[g]/2);break;case h:t[v]=t[v]+(n[g]/2-r[g]/2)}}return t}function ue(e,t){void 0===t&&(t={});var n=t.placement,r=void 0===n?e.placement:n,s=t.strategy,u=void 0===s?e.strategy:s,c=t.boundary,h=void 0===c?d:c,g=t.rootBoundary,y=void 0===g?f:g,m=t.elementContext,b=void 0===m?p:m,D=t.altBoundary,E=void 0!==D&&D,x=t.padding,P=void 0===x?0:x,k=Y("number"!=typeof P?P:X(P,l)),M=e.rects.popper,L=e.elements[E?b===p?v:p:b],A=ae(w(L)?L:L.contextElement||H(e.elements.popper),h,y,u),O=_(e.elements.reference),C=se({reference:O,element:M,strategy:"absolute",placement:r}),R=ie(Object.assign({},M,C)),S=b===p?R:O,j={top:A.top-S.top+k.top,bottom:S.bottom-A.bottom+k.bottom,left:A.left-S.left+k.left,right:S.right-A.right+k.right},T=e.modifiersData.offset;if(b===p&&T){var B=T[r];Object.keys(j).forEach((function(e){var t=0>[a,o].indexOf(e)?-1:1;j[e]+=B[0>[i,o].indexOf(e)?"x":"y"]*t}))}return j}function le(e,t){void 0===t&&(t={});var n=t.boundary,r=t.rootBoundary,i=t.padding,o=t.flipVariations,a=t.allowedAutoPlacements,s=void 0===a?y:a,u=V(t.placement),c=u?o?g:g.filter((function(e){return V(e)===u})):l,h=c.filter((function(e){return s.indexOf(e)>=0}));0===h.length&&(h=c);var d=h.reduce((function(t,o){return t[o]=ue(e,{placement:o,boundary:n,rootBoundary:r,padding:i})[k(o)],t}),{});return Object.keys(d).sort((function(e,t){return d[e]-d[t]}))}var ce={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var l=n.mainAxis,h=void 0===l||l,d=n.altAxis,f=void 0===d||d,p=n.fallbackPlacements,v=n.padding,g=n.boundary,y=n.rootBoundary,m=n.altBoundary,b=n.flipVariations,D=void 0===b||b,w=n.allowedAutoPlacements,E=t.options.placement,x=k(E),P=p||(x===E||!D?[K(E)]:function(e){if(k(e)===u)return[];var t=K(e);return[Z(e),t,Z(t)]}(E)),M=[E].concat(P).reduce((function(e,n){return e.concat(k(n)===u?le(t,{placement:n,boundary:g,rootBoundary:y,padding:v,flipVariations:D,allowedAutoPlacements:w}):n)}),[]),L=t.rects.reference,A=t.rects.popper,O=new Map,C=!0,_=M[0],R=0;M.length>R;R++){var S=M[R],j=k(S),T=V(S)===c,H=[i,o].indexOf(j)>=0,B=H?"width":"height",F=ue(t,{placement:S,boundary:g,rootBoundary:y,altBoundary:m,padding:v}),N=H?T?a:s:T?o:i;L[B]>A[B]&&(N=K(N));var I=K(N),U=[];if(h&&U.push(0>=F[j]),f&&U.push(0>=F[N],0>=F[I]),U.every((function(e){return e}))){_=S,C=!1;break}O.set(S,U)}if(C)for(var Y=function(e){var t=M.find((function(t){var n=O.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return _=t,"break"},X=D?3:1;X>0;X--){if("break"===Y(X))break}t.placement!==_&&(t.modifiersData[r]._skip=!0,t.placement=_,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function he(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function de(e){return[i,a,o,s].some((function(t){return e[t]>=0}))}var fe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.name,r=e.options.offset,o=void 0===r?[0,0]:r,u=y.reduce((function(e,n){return e[n]=function(e,t,n){var r=k(e),o=0>[s,i].indexOf(r)?1:-1,u="function"==typeof n?n(Object.assign({},t,{placement:e})):n,l=u[0],c=u[1];return l=l||0,c=(c||0)*o,0>[s,a].indexOf(r)?{x:l,y:c}:{x:c,y:l}}(n,t.rects,o),e}),{}),l=u[t.placement],c=l.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l.x,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=u}};var pe={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,u=n.mainAxis,l=void 0===u||u,h=n.altAxis,d=void 0!==h&&h,f=n.tether,p=void 0===f||f,v=n.tetherOffset,g=void 0===v?0:v,y=ue(t,{boundary:n.boundary,rootBoundary:n.rootBoundary,padding:n.padding,altBoundary:n.altBoundary}),m=k(t.placement),b=V(t.placement),D=!b,w=I(m),E="x"===w?"y":"x",x=t.modifiersData.popperOffsets,P=t.rects.reference,A=t.rects.popper,O="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,C="number"==typeof O?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),_=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,S={x:0,y:0};if(x){if(l){var j,T="y"===w?i:s,H="y"===w?o:a,B="y"===w?"height":"width",F=x[w],Y=F+y[T],X=F-y[H],z=p?-A[B]/2:0,q=b===c?P[B]:A[B],W=b===c?-A[B]:-P[B],$=t.elements.arrow,G=p&&$?R($):{width:0,height:0},K=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},J=K[T],Z=K[H],Q=U(0,P[B],G[B]),ee=D?P[B]/2-z-Q-J-C.mainAxis:q-Q-J-C.mainAxis,te=D?-P[B]/2+z+Q+Z+C.mainAxis:W+Q+Z+C.mainAxis,ne=t.elements.arrow&&N(t.elements.arrow),re=null!=(j=null==_?void 0:_[w])?j:0,ie=F+te-re,oe=U(p?L(Y,F+ee-re-(ne?"y"===w?ne.clientTop||0:ne.clientLeft||0:0)):Y,F,p?M(X,ie):X);x[w]=oe,S[w]=oe-F}if(d){var ae,se=x[E],le="y"===E?"height":"width",ce=se+y["x"===w?i:s],he=se-y["x"===w?o:a],de=-1!==[i,s].indexOf(m),fe=null!=(ae=null==_?void 0:_[E])?ae:0,pe=de?ce:se-P[le]-A[le]-fe+C.altAxis,ve=de?se+P[le]+A[le]-fe-C.altAxis:he,ge=p&&de?function(e,t,n){var r=U(e,t,n);return r>n?n:r}(pe,se,ve):U(p?pe:ce,se,p?ve:he);x[E]=ge,S[E]=ge-se}t.modifiersData[r]=S}},requiresIfExists:["offset"]};function ve(e,t,n){void 0===n&&(n=!1);var r,i,o=E(t),a=E(t)&&function(e){var t=e.getBoundingClientRect(),n=A(t.width)/e.offsetWidth||1,r=A(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),s=H(t),u=_(e,a,n),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(o||!o&&!n)&&(("body"!==b(t)||te(s))&&(l=(r=t)!==D(r)&&E(r)?{scrollLeft:(i=r).scrollLeft,scrollTop:i.scrollTop}:Q(r)),E(t)?((c=_(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):s&&(c.x=ee(s))),{x:u.left+l.scrollLeft-c.x,y:u.top+l.scrollTop-c.y,width:u.width,height:u.height}}function ge(e){var t=new Map,n=new Set,r=[];function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||i(e)})),r}var ye={placement:"bottom",modifiers:[],strategy:"absolute"};function me(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function be(e){void 0===e&&(e={});var t=e.defaultModifiers,n=void 0===t?[]:t,r=e.defaultOptions,i=void 0===r?ye:r;return function(e,t,r){void 0===r&&(r=i);var o,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},ye,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},u=[],l=!1,c={state:s,setOptions:function(r){var o="function"==typeof r?r(s.options):r;h(),s.options=Object.assign({},i,s.options,o),s.scrollParents={reference:w(e)?re(e):e.contextElement?re(e.contextElement):[],popper:re(t)};var a,l,d=function(e){var t=ge(e);return m.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((a=[].concat(n,s.options.modifiers),l=a.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{}),Object.keys(l).map((function(e){return l[e]}))));return s.orderedModifiers=d.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.options,n=e.effect;if("function"==typeof n){var r=n({state:s,name:e.name,instance:c,options:void 0===t?{}:t});u.push(r||function(){})}})),c.update()},forceUpdate:function(){if(!l){var e=s.elements,t=e.reference,n=e.popper;if(me(t,n)){s.rects={reference:ve(t,N(n),"fixed"===s.options.strategy),popper:R(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;s.orderedModifiers.length>r;r++)if(!0!==s.reset){var i=s.orderedModifiers[r],o=i.fn,a=i.options;"function"==typeof o&&(s=o({state:s,options:void 0===a?{}:a,name:i.name,instance:c})||s)}else s.reset=!1,r=-1}}},update:(o=function(){return new Promise((function(e){c.forceUpdate(),e(s)}))},function(){return a||(a=new Promise((function(e){Promise.resolve().then((function(){a=void 0,e(o())}))}))),a}),destroy:function(){h(),l=!0}};if(!me(e,t))return c;function h(){u.forEach((function(e){return e()})),u=[]}return c.setOptions(r).then((function(e){!l&&r.onFirstUpdate&&r.onFirstUpdate(e)})),c}}var De=be({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,o=void 0===i||i,a=r.resize,s=void 0===a||a,u=D(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&l.forEach((function(e){e.addEventListener("scroll",n.update,$)})),s&&u.addEventListener("resize",n.update,$),function(){o&&l.forEach((function(e){e.removeEventListener("scroll",n.update,$)})),s&&u.removeEventListener("resize",n.update,$)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state;t.modifiersData[e.name]=se({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,o=n.adaptive,a=void 0===o||o,s=n.roundOffsets,u=void 0===s||s,l={placement:k(t.placement),variation:V(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,W(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,W(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},P,fe,ce,pe,z,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,o=t.modifiersData.preventOverflow,a=ue(t,{elementContext:"reference"}),s=ue(t,{altBoundary:!0}),u=he(a,r),l=he(s,i,o),c=de(u),h=de(l);t.modifiersData[n]={referenceClippingOffsets:u,popperEscapeOffsets:l,isReferenceHidden:c,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":h})}}]}),we="tippy-content",Ee="tippy-backdrop",xe="tippy-arrow",Pe="tippy-svg-arrow",ke={passive:!0,capture:!0},Me=function(){return document.body};function Le(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?Array.isArray(n)?n[t]:n:r}return e}function Ae(e,t){var n={}.toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function Oe(e,t){return"function"==typeof e?e.apply(void 0,t):e}function Ce(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout((function(){e(r)}),t)};var n}function _e(e){return[].concat(e)}function Re(e,t){-1===e.indexOf(t)&&e.push(t)}function Se(e){return[].slice.call(e)}function je(e){return Object.keys(e).reduce((function(t,n){return void 0!==e[n]&&(t[n]=e[n]),t}),{})}function Te(){return document.createElement("div")}function He(e){return["Element","Fragment"].some((function(t){return Ae(e,t)}))}function Be(e){return Ae(e,"MouseEvent")}function Fe(e){return He(e)?[e]:function(e){return Ae(e,"NodeList")}(e)?Se(e):Array.isArray(e)?e:Se(document.querySelectorAll(e))}function Ne(e,t){e.forEach((function(e){e&&(e.style.transitionDuration=t+"ms")}))}function Ie(e,t){e.forEach((function(e){e&&e.setAttribute("data-state",t)}))}function Ue(e){var t,n=_e(e)[0];return null!=n&&null!=(t=n.ownerDocument)&&t.body?n.ownerDocument:document}function Ye(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(t){e[r](t,n)}))}function Xe(e,t){for(var n=t;n;){var r;if(e.contains(n))return!0;n=null==n.getRootNode||null==(r=n.getRootNode())?void 0:r.host}return!1}var ze={isTouch:!1},Ve=0;function qe(){ze.isTouch||(ze.isTouch=!0,window.performance&&document.addEventListener("mousemove",We))}function We(){var e=performance.now();20>e-Ve&&(ze.isTouch=!1,document.removeEventListener("mousemove",We)),Ve=e}function $e(){var e,t=document.activeElement;(e=t)&&e._tippy&&e._tippy.reference===e&&(t.blur&&!t._tippy.state.isVisible&&t.blur())}var Ge=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto,Ke=Object.assign({appendTo:Me,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),Je=Object.keys(Ke);function Ze(e){var t=(e.plugins||[]).reduce((function(t,n){var r,i=n.name;i&&(t[i]=void 0!==e[i]?e[i]:null!=(r=Ke[i])?r:n.defaultValue);return t}),{});return Object.assign({},e,t)}function Qe(e,t){var n=Object.assign({},t,{content:Oe(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(Ze(Object.assign({},Ke,{plugins:t}))):Je).reduce((function(t,n){var r=(e.getAttribute("data-tippy-"+n)||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t}),{})}(e,t.plugins));return n.aria=Object.assign({},Ke.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}var et=function(){return"innerHTML"};function tt(e,t){e[et()]=t}function nt(e){var t=Te();return!0===e?t.className=xe:(t.className=Pe,He(e)?t.appendChild(e):tt(t,e)),t}function rt(e,t){He(t.content)?(tt(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?tt(e,t.content):e.textContent=t.content)}function it(e){var t=e.firstElementChild,n=Se(t.children);return{box:t,content:n.find((function(e){return e.classList.contains(we)})),arrow:n.find((function(e){return e.classList.contains(xe)||e.classList.contains(Pe)})),backdrop:n.find((function(e){return e.classList.contains(Ee)}))}}function ot(e){var t=Te(),n=Te();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=Te();function i(n,r){var i=it(t),o=i.box,a=i.content,s=i.arrow;r.theme?o.setAttribute("data-theme",r.theme):o.removeAttribute("data-theme"),"string"==typeof r.animation?o.setAttribute("data-animation",r.animation):o.removeAttribute("data-animation"),r.inertia?o.setAttribute("data-inertia",""):o.removeAttribute("data-inertia"),o.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?o.setAttribute("role",r.role):o.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||rt(a,e.props),r.arrow?s?n.arrow!==r.arrow&&(o.removeChild(s),o.appendChild(nt(r.arrow))):o.appendChild(nt(r.arrow)):s&&o.removeChild(s)}return r.className=we,r.setAttribute("data-state","hidden"),rt(r,e.props),t.appendChild(n),n.appendChild(r),i(e.props,e.props),{popper:t,onUpdate:i}}ot.$$tippy=!0;var at=1,st=[],ut=[];function lt(e,t){var n,r,i,o,a,s,u,l,c=Qe(e,Object.assign({},Ke,Ze(je(t)))),h=!1,d=!1,f=!1,p=!1,v=[],g=Ce(W,c.interactiveDebounce),y=at++,m=(l=c.plugins).filter((function(e,t){return l.indexOf(e)===t})),b={id:y,reference:e,popper:Te(),popperInstance:null,props:c,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:m,clearDelayTimeouts:function(){clearTimeout(n),clearTimeout(r),cancelAnimationFrame(i)},setProps:function(t){if(b.state.isDestroyed)return;S("onBeforeUpdate",[b,t]),V();var n=b.props,r=Qe(e,Object.assign({},n,je(t),{ignoreAttributes:!0}));b.props=r,z(),n.interactiveDebounce!==r.interactiveDebounce&&(H(),g=Ce(W,r.interactiveDebounce));n.triggerTarget&&!r.triggerTarget?_e(n.triggerTarget).forEach((function(e){e.removeAttribute("aria-expanded")})):r.triggerTarget&&e.removeAttribute("aria-expanded");T(),R(),E&&E(n,r);b.popperInstance&&(J(),Q().forEach((function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})));S("onAfterUpdate",[b,t])},setContent:function(e){b.setProps({content:e})},show:function(){var e=b.state.isVisible,t=b.state.isDestroyed,n=!b.state.isEnabled,r=ze.isTouch&&!b.props.touch,i=Le(b.props.duration,0,Ke.duration);if(e||t||n||r)return;if(A().hasAttribute("disabled"))return;if(S("onShow",[b],!1),!1===b.props.onShow(b))return;b.state.isVisible=!0,L()&&(w.style.visibility="visible");R(),I(),b.state.isMounted||(w.style.transition="none");if(L()){var o=C();Ne([o.box,o.content],0)}s=function(){var e;if(b.state.isVisible&&!p){if(p=!0,w.style.transition=b.props.moveTransition,L()&&b.props.animation){var t=C(),n=t.box,r=t.content;Ne([n,r],i),Ie([n,r],"visible")}j(),T(),Re(ut,b),null==(e=b.popperInstance)||e.forceUpdate(),S("onMount",[b]),b.props.animation&&L()&&function(e,t){Y(e,t)}(i,(function(){b.state.isShown=!0,S("onShown",[b])}))}},function(){var e,t=b.props.appendTo,n=A();e=b.props.interactive&&t===Me||"parent"===t?n.parentNode:Oe(t,[n]);e.contains(w)||e.appendChild(w);b.state.isMounted=!0,J()}()},hide:function(){var e=!b.state.isVisible,t=b.state.isDestroyed,n=!b.state.isEnabled,r=Le(b.props.duration,1,Ke.duration);if(e||t||n)return;if(S("onHide",[b],!1),!1===b.props.onHide(b))return;b.state.isVisible=!1,b.state.isShown=!1,p=!1,h=!1,L()&&(w.style.visibility="hidden");if(H(),U(),R(!0),L()){var i=C(),o=i.box,a=i.content;b.props.animation&&(Ne([o,a],r),Ie([o,a],"hidden"))}j(),T(),b.props.animation?L()&&function(e,t){Y(e,(function(){!b.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&t()}))}(r,b.unmount):b.unmount()},hideWithInteractivity:function(e){O().addEventListener("mousemove",g),Re(st,g),g(e)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){b.state.isVisible&&b.hide();if(!b.state.isMounted)return;Z(),Q().forEach((function(e){e._tippy.unmount()})),w.parentNode&&w.parentNode.removeChild(w);ut=ut.filter((function(e){return e!==b})),b.state.isMounted=!1,S("onHidden",[b])},destroy:function(){if(b.state.isDestroyed)return;b.clearDelayTimeouts(),b.unmount(),V(),delete e._tippy,b.state.isDestroyed=!0,S("onDestroy",[b])}};if(!c.render)return b;var D=c.render(b),w=D.popper,E=D.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+b.id,b.popper=w,e._tippy=b,w._tippy=b;var x=m.map((function(e){return e.fn(b)})),P=e.hasAttribute("aria-expanded");return z(),T(),R(),S("onCreate",[b]),c.showOnCreate&&ee(),w.addEventListener("mouseenter",(function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()})),w.addEventListener("mouseleave",(function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&O().addEventListener("mousemove",g)})),b;function k(){var e=b.props.touch;return Array.isArray(e)?e:[e,0]}function M(){return"hold"===k()[0]}function L(){var e;return!(null==(e=b.props.render)||!e.$$tippy)}function A(){return u||e}function O(){var e=A().parentNode;return e?Ue(e):document}function C(){return it(w)}function _(e){return b.state.isMounted&&!b.state.isVisible||ze.isTouch||o&&"focus"===o.type?0:Le(b.props.delay,e?0:1,Ke.delay)}function R(e){void 0===e&&(e=!1),w.style.pointerEvents=b.props.interactive&&!e?"":"none",w.style.zIndex=""+b.props.zIndex}function S(e,t,n){var r;(void 0===n&&(n=!0),x.forEach((function(n){n[e]&&n[e].apply(n,t)})),n)&&(r=b.props)[e].apply(r,t)}function j(){var t=b.props.aria;if(t.content){var n="aria-"+t.content,r=w.id;_e(b.props.triggerTarget||e).forEach((function(e){var t=e.getAttribute(n);if(b.state.isVisible)e.setAttribute(n,t?t+" "+r:r);else{var i=t&&t.replace(r,"").trim();i?e.setAttribute(n,i):e.removeAttribute(n)}}))}}function T(){!P&&b.props.aria.expanded&&_e(b.props.triggerTarget||e).forEach((function(e){b.props.interactive?e.setAttribute("aria-expanded",b.state.isVisible&&e===A()?"true":"false"):e.removeAttribute("aria-expanded")}))}function H(){O().removeEventListener("mousemove",g),st=st.filter((function(e){return e!==g}))}function B(t){if(!ze.isTouch||!f&&"mousedown"!==t.type){var n=t.composedPath&&t.composedPath()[0]||t.target;if(!b.props.interactive||!Xe(w,n)){if(_e(b.props.triggerTarget||e).some((function(e){return Xe(e,n)}))){if(ze.isTouch)return;if(b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else S("onClickOutside",[b,t]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),d=!0,setTimeout((function(){d=!1})),b.state.isMounted||U())}}}function F(){f=!0}function N(){f=!1}function I(){var e=O();e.addEventListener("mousedown",B,!0),e.addEventListener("touchend",B,ke),e.addEventListener("touchstart",N,ke),e.addEventListener("touchmove",F,ke)}function U(){var e=O();e.removeEventListener("mousedown",B,!0),e.removeEventListener("touchend",B,ke),e.removeEventListener("touchstart",N,ke),e.removeEventListener("touchmove",F,ke)}function Y(e,t){var n=C().box;function r(e){e.target===n&&(Ye(n,"remove",r),t())}if(0===e)return t();Ye(n,"remove",a),Ye(n,"add",r),a=r}function X(t,n,r){void 0===r&&(r=!1),_e(b.props.triggerTarget||e).forEach((function(e){e.addEventListener(t,n,r),v.push({node:e,eventType:t,handler:n,options:r})}))}function z(){var e;M()&&(X("touchstart",q,{passive:!0}),X("touchend",$,{passive:!0})),(e=b.props.trigger,e.split(/\s+/).filter(Boolean)).forEach((function(e){if("manual"!==e)switch(X(e,q),e){case"mouseenter":X("mouseleave",$);break;case"focus":X(Ge?"focusout":"blur",G);break;case"focusin":X("focusout",G)}}))}function V(){v.forEach((function(e){e.node.removeEventListener(e.eventType,e.handler,e.options)})),v=[]}function q(e){var t,n=!1;if(b.state.isEnabled&&!K(e)&&!d){var r="focus"===(null==(t=o)?void 0:t.type);o=e,u=e.currentTarget,T(),!b.state.isVisible&&Be(e)&&st.forEach((function(t){return t(e)})),"click"===e.type&&(0>b.props.trigger.indexOf("mouseenter")||h)&&!1!==b.props.hideOnClick&&b.state.isVisible?n=!0:ee(e),"click"===e.type&&(h=!n),n&&!r&&te(e)}}function W(e){var t=e.target,n=A().contains(t)||w.contains(t);if("mousemove"!==e.type||!n){var r=Q().concat(w).map((function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:c}:null})).filter(Boolean);(function(e,t){var n=t.clientX,r=t.clientY;return e.every((function(e){var t=e.popperRect,i=e.popperState,o=e.props.interactiveBorder,a=i.placement.split("-")[0],s=i.modifiersData.offset;return!s||t.top-r+("bottom"===a?s.top.y:0)>o||r-t.bottom-("top"===a?s.bottom.y:0)>o||t.left-n+("right"===a?s.left.x:0)>o||n-t.right-("left"===a?s.right.x:0)>o}))})(r,e)&&(H(),te(e))}}function $(e){K(e)||b.props.trigger.indexOf("click")>=0&&h||(b.props.interactive?b.hideWithInteractivity(e):te(e))}function G(e){0>b.props.trigger.indexOf("focusin")&&e.target!==A()||b.props.interactive&&e.relatedTarget&&w.contains(e.relatedTarget)||te(e)}function K(e){return!!ze.isTouch&&M()!==e.type.indexOf("touch")>=0}function J(){Z();var t=b.props,n=t.popperOptions,r=t.placement,i=t.offset,o=t.getReferenceClientRect,a=t.moveTransition,u=L()?it(w).arrow:null,l=o?{getBoundingClientRect:o,contextElement:o.contextElement||A()}:e,c={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(L()){var n=C().box;["placement","reference-hidden","escaped"].forEach((function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)})),t.attributes.popper={}}}},h=[{name:"offset",options:{offset:i}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!a}},c];L()&&u&&h.push({name:"arrow",options:{element:u,padding:3}}),h.push.apply(h,(null==n?void 0:n.modifiers)||[]),b.popperInstance=De(l,w,Object.assign({},n,{placement:r,onFirstUpdate:s,modifiers:h}))}function Z(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Q(){return Se(w.querySelectorAll("[data-tippy-root]"))}function ee(e){b.clearDelayTimeouts(),e&&S("onTrigger",[b,e]),I();var t=_(!0),r=k(),i=r[1];ze.isTouch&&"hold"===r[0]&&i&&(t=i),t?n=setTimeout((function(){b.show()}),t):b.show()}function te(e){if(b.clearDelayTimeouts(),S("onUntrigger",[b,e]),b.state.isVisible){if(0>b.props.trigger.indexOf("mouseenter")||0>b.props.trigger.indexOf("click")||0>["mouseleave","mousemove"].indexOf(e.type)||!h){var t=_(!1);t?r=setTimeout((function(){b.state.isVisible&&b.hide()}),t):i=requestAnimationFrame((function(){b.hide()}))}}else U()}}function ct(e,t){void 0===t&&(t={});var n=Ke.plugins.concat(t.plugins||[]);document.addEventListener("touchstart",qe,ke),window.addEventListener("blur",$e);var r=Object.assign({},t,{plugins:n}),i=Fe(e).reduce((function(e,t){var n=t&&lt(t,r);return n&&e.push(n),e}),[]);return He(e)?i[0]:i}ct.defaultProps=Ke,ct.setDefaultProps=function(e){Object.keys(e).forEach((function(t){Ke[t]=e[t]}))},ct.currentInput=ze;Object.assign({},P,{effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow)}});var ht={clientX:0,clientY:0},dt=[];function ft(e){ht={clientX:e.clientX,clientY:e.clientY}}var pt={name:"followCursor",defaultValue:!1,fn:function(e){var t=e.reference,n=Ue(e.props.triggerTarget||t),r=!1,i=!1,o=!0,a=e.props;function s(){return"initial"===e.props.followCursor&&e.state.isVisible}function u(){n.addEventListener("mousemove",h)}function l(){n.removeEventListener("mousemove",h)}function c(){r=!0,e.setProps({getReferenceClientRect:null}),r=!1}function h(n){var r=!n.target||t.contains(n.target),i=e.props.followCursor,o=n.clientX,a=n.clientY,s=t.getBoundingClientRect(),u=o-s.left,l=a-s.top;!r&&e.props.interactive||e.setProps({getReferenceClientRect:function(){var e=t.getBoundingClientRect(),n=o,r=a;"initial"===i&&(n=e.left+u,r=e.top+l);var s="horizontal"===i?e.top:r,c="vertical"===i?e.right:n,h="horizontal"===i?e.bottom:r,d="vertical"===i?e.left:n;return{width:c-d,height:h-s,top:s,right:c,bottom:h,left:d}}})}function d(){e.props.followCursor&&(dt.push({instance:e,doc:n}),function(e){e.addEventListener("mousemove",ft)}(n))}function f(){0===(dt=dt.filter((function(t){return t.instance!==e}))).filter((function(e){return e.doc===n})).length&&function(e){e.removeEventListener("mousemove",ft)}(n)}return{onCreate:d,onDestroy:f,onBeforeUpdate:function(){a=e.props},onAfterUpdate:function(t,n){var o=n.followCursor;r||void 0!==o&&a.followCursor!==o&&(f(),o?(d(),!e.state.isMounted||i||s()||u()):(l(),c()))},onMount:function(){e.props.followCursor&&!i&&(o&&(h(ht),o=!1),s()||u())},onTrigger:function(e,t){Be(t)&&(ht={clientX:t.clientX,clientY:t.clientY}),i="focus"===t.type},onHidden:function(){e.props.followCursor&&(c(),l(),o=!0)}}}};ct.setDefaultProps({render:ot});var vt,gt,yt,mt,bt,Dt,wt={showTotalDistance:!1,showDashDistance:!0,showWhen:["normal","active"],format:function(e){return 1e3>e?+e.toFixed(2)+"m":+(e/1e3).toFixed(2)+"km"}},Et={showWhen:["normal","active"],format:function(e){return e>1e6?"".concat(+(e/1e6).toFixed(2),"km²"):"".concat(+e.toFixed(2),"m²")}},xt={maxSize:100},Pt={remove:["del","backspace"],revert:["command+z","ctrl+z"],redo:["command+shift+z","ctrl+shift+z"]},kt={allowHTML:!0,followCursor:!0,placement:"bottom-start",offset:[-10,20],plugins:[pt],trigger:"manual",hideOnClick:!1,theme:"light"},Mt={data:"drawData",pointAdsorbPixel:12,lineAdsorbPixel:10};function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot(e)}function Ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _t(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zt(r.key),r)}}function Rt(e,t,n){return t&&_t(e.prototype,t),n&&_t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function St(e,t,n){return(t=zt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ht(e,t)}function Tt(e){return Tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Tt(e)}function Ht(e,t){return Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ht(e,t)}function Bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tt(e);if(t){var i=Tt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Bt(e)}(this,n)}}function Nt(){return Nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Tt(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(3>arguments.length?e:n):i.value}},Nt.apply(this,arguments)}function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Yt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(e){return function(e){if(Array.isArray(e))return Xt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Yt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yt(e,t){if(e){if("string"==typeof e)return Xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xt(e,t):void 0}}function Xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);t>n;n++)r[n]=e[n];return r}function zt(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(vt=e.DrawEvent||(e.DrawEvent={})).Init="init",vt.Destroy="destroy",vt.Enable="enable",vt.Disable="disable",vt.Add="add",vt.Edit="edit",vt.Remove="remove",vt.Clear="clear",vt.Change="change",vt.DragStart="dragStart",vt.Dragging="dragging",vt.DragEnd="dragEnd",vt.Select="select",vt.AddNode="addNode",vt.RemoveNode="removeNode",(gt=e.SourceEvent||(e.SourceEvent={})).Change="change",gt.Update="update",(yt=e.RenderEvent||(e.RenderEvent={})).Click="click",yt.UnClick="unclick",yt.Dragstart="dragstart",yt.Mousemove="mousemove",yt.Mouseout="mouseout",yt.Dragging="dragging",yt.Dragend="dragend",yt.DblClick="dblClick",yt.Contextmenu="contextmenu",(mt=e.LayerEvent||(e.LayerEvent={})).Mousedown="mousedown",mt.Mouseup="mouseup",mt.Click="click",mt.UnClick="unclick",mt.Dblclick="dblclick",mt.Mousemove="mousemove",mt.Mouseover="mouseover",mt.Mouseenter="mouseenter",mt.Mouseleave="mouseleave",mt.Mouseout="mouseout",mt.Contextmenu="contextmenu",(bt=e.SceneEvent||(e.SceneEvent={})).Loaded="loaded",bt.MapMove="mapmove",bt.MoveStart="movestart",bt.MoveEnd="moveend",bt.ZoomChange="zoomchange",bt.ZoomStart="zoomstart",bt.ZoomEnd="zoomend",bt.Click="click",bt.Dblclick="dblclick",bt.Mousemove="mousemove",bt.Mousewheel="mousewheel",bt.Mouseover="mouseover",bt.Mouseout="mouseout",bt.Mouseup="mouseup",bt.Mousedown="mousedown",bt.Contextmenu="contextmenu",bt.Dragstart="dragstart",bt.Dragging="dragging",bt.Dragend="dragend",(Dt=e.ControlEvent||(e.ControlEvent={})).DrawChange="drawchange",Dt.DataChange="datachange",Dt.DrawSelect="drawselect",Dt.DrawClear="drawclear";var Vt=6371008.8,qt={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*Vt,kilometers:6371.0088,kilometres:6371.0088,meters:Vt,metres:Vt,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:Vt/1852,radians:1,yards:6967335.223679999},Wt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function $t(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function Gt(e,t,n){if(void 0===n&&(n={}),!e)throw Error("coordinates is required");if(!Array.isArray(e))throw Error("coordinates must be an Array");if(2>e.length)throw Error("coordinates must be at least 2 numbers long");if(!sn(e[0])||!sn(e[1]))throw Error("coordinates must contain numbers");return $t({type:"Point",coordinates:e},t,n)}function Kt(e,t,n){void 0===n&&(n={});for(var r=0,i=e;i.length>r;r++){var o=i[r];if(4>o.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;o[o.length-1].length>a;a++)if(o[o.length-1][a]!==o[0][a])throw Error("First and last Position are not equivalent.")}return $t({type:"Polygon",coordinates:e},t,n)}function Jt(e,t,n){if(void 0===n&&(n={}),2>e.length)throw Error("coordinates must be an array of two or more positions");return $t({type:"LineString",coordinates:e},t,n)}function Zt(e,t){void 0===t&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function Qt(e,t,n){return void 0===n&&(n={}),$t({type:"MultiLineString",coordinates:e},t,n)}function en(e,t,n){return void 0===n&&(n={}),$t({type:"MultiPoint",coordinates:e},t,n)}function tn(e,t,n){return void 0===n&&(n={}),$t({type:"MultiPolygon",coordinates:e},t,n)}function nn(e,t){void 0===t&&(t="kilometers");var n=qt[t];if(!n)throw Error(t+" units is invalid");return e*n}function rn(e,t){void 0===t&&(t="kilometers");var n=qt[t];if(!n)throw Error(t+" units is invalid");return e/n}function on(e){return 180*(e%(2*Math.PI))/Math.PI}function an(e){return e%360*Math.PI/180}function sn(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function un(e){return!!e&&e.constructor===Object}var ln=Object.freeze({__proto__:null,earthRadius:Vt,factors:qt,unitsFactors:{centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Vt,yards:1.0936133},areaFactors:Wt,feature:$t,geometry:function(e,t,n){switch(e){case"Point":return Gt(t).geometry;case"LineString":return Jt(t).geometry;case"Polygon":return Kt(t).geometry;case"MultiPoint":return en(t).geometry;case"MultiLineString":return Qt(t).geometry;case"MultiPolygon":return tn(t).geometry;default:throw Error(e+" is invalid")}},point:Gt,points:function(e,t,n){return void 0===n&&(n={}),Zt(e.map((function(e){return Gt(e,t)})),n)},polygon:Kt,polygons:function(e,t,n){return void 0===n&&(n={}),Zt(e.map((function(e){return Kt(e,t)})),n)},lineString:Jt,lineStrings:function(e,t,n){return void 0===n&&(n={}),Zt(e.map((function(e){return Jt(e,t)})),n)},featureCollection:Zt,multiLineString:Qt,multiPoint:en,multiPolygon:tn,geometryCollection:function(e,t,n){return void 0===n&&(n={}),$t({type:"GeometryCollection",geometries:e},t,n)},round:function(e,t){if(void 0===t&&(t=0),t&&t<0)throw Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n},radiansToLength:nn,lengthToRadians:rn,lengthToDegrees:function(e,t){return on(rn(e,t))},bearingToAzimuth:function(e){var t=e%360;return 0>t&&(t+=360),t},radiansToDegrees:on,degreesToRadians:an,convertLength:function(e,t,n){if(void 0===t&&(t="kilometers"),void 0===n&&(n="kilometers"),e<0)throw Error("length must be a positive number");return nn(rn(e,t),n)},convertArea:function(e,t,n){if(void 0===t&&(t="meters"),void 0===n&&(n="kilometers"),e<0)throw Error("area must be a positive number");var r=Wt[t];if(!r)throw Error("invalid original units");var i=Wt[n];if(!i)throw Error("invalid final units");return e/r*i},isNumber:sn,isObject:un,validateBBox:function(e){if(!e)throw Error("bbox is required");if(!Array.isArray(e))throw Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!sn(e))throw Error("bbox must only contain numbers")}))},validateId:function(e){if(!e)throw Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw Error("id must be a number or a string")}});function cn(e,t,n){if(null!==e)for(var r,i,o,a,s,u,l,c,h=0,d=0,f=e.type,p="FeatureCollection"===f,v="Feature"===f,g=p?e.features.length:1,y=0;g>y;y++){s=(c=!!(l=p?e.features[y].geometry:v?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var m=0;s>m;m++){var b=0,D=0;if(null!==(a=c?l.geometries[m]:l)){u=a.coordinates;var w=a.type;switch(h=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===t(u,d,y,b,D))return!1;d++,b++;break;case"LineString":case"MultiPoint":for(r=0;u.length>r;r++){if(!1===t(u[r],d,y,b,D))return!1;d++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(r=0;u.length>r;r++){for(i=0;u[r].length-h>i;i++){if(!1===t(u[r][i],d,y,b,D))return!1;d++}"MultiLineString"===w&&b++,"Polygon"===w&&D++}"Polygon"===w&&b++;break;case"MultiPolygon":for(r=0;u.length>r;r++){for(D=0,i=0;u[r].length>i;i++){for(o=0;u[r][i].length-h>o;o++){if(!1===t(u[r][i][o],d,y,b,D))return!1;d++}D++}b++}break;case"GeometryCollection":for(r=0;a.geometries.length>r;r++)if(!1===cn(a.geometries[r],t,n))return!1;break;default:throw Error("Unknown Geometry Type")}}}}}function hn(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;e.features.length>n&&!1!==t(e.features[n].properties,n);n++);break;case"Feature":t(e.properties,0)}}function dn(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var n=0;e.features.length>n&&!1!==t(e.features[n],n);n++);}function fn(e){var t=[];return cn(e,(function(e){t.push(e)})),t}function pn(e,t){var n,r,i,o,a,s,u,l,c,h,d=0,f="FeatureCollection"===e.type,p="Feature"===e.type,v=f?e.features.length:1;for(n=0;v>n;n++){for(l=f?e.features[n].properties:p?e.properties:{},c=f?e.features[n].bbox:p?e.bbox:void 0,h=f?e.features[n].id:p?e.id:void 0,a=(u=!!(s=f?e.features[n].geometry:p?e.geometry:e)&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;a>i;i++)if(null!==(o=u?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,d,l,c,h))return!1;break;case"GeometryCollection":for(r=0;o.geometries.length>r;r++)if(!1===t(o.geometries[r],d,l,c,h))return!1;break;default:throw Error("Unknown Geometry Type")}else if(!1===t(null,d,l,c,h))return!1;d++}}function vn(e,t,n){var r=n;return pn(e,(function(e,i,o,a,s){r=0===i&&void 0===n?e:t(r,e,i,o,a,s)})),r}function gn(e,t){pn(e,(function(e,n,r,i,o){var a,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t($t(e,r,{bbox:i,id:o}),n,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;e.coordinates.length>u;u++){if(!1===t($t({type:a,coordinates:e.coordinates[u]},r),n,u))return!1}}))}function yn(e,t){gn(e,(function(e,n,r){var i=0;if(e.geometry){var o=e.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var a,s=0,u=0,l=0;return!1!==cn(e,(function(o,c,h,d,f){if(void 0===a||n>s||d>u||f>l)return a=o,s=n,u=d,l=f,void(i=0);var p=Jt([a,o],e.properties);if(!1===t(p,n,r,f,i))return!1;i++,a=o}))&&void 0}}}))}function mn(e,t,n){var r=n,i=!1;return yn(e,(function(e,o,a,s,u){r=!1===i&&void 0===n?e:t(r,e,o,a,s,u),i=!0})),r}function bn(e,t){if(!e)throw Error("geojson is required");gn(e,(function(e,n,r){if(null!==e.geometry){var i=e.geometry.coordinates;switch(e.geometry.type){case"LineString":if(!1===t(e,n,r,0,0))return!1;break;case"Polygon":for(var o=0;i.length>o;o++)if(!1===t(Jt(i[o],e.properties),n,r,o))return!1}}}))}var Dn=Object.freeze({__proto__:null,coordAll:fn,coordEach:cn,coordReduce:function(e,t,n,r){var i=n;return cn(e,(function(e,r,o,a,s){i=0===r&&void 0===n?e:t(i,e,r,o,a,s)}),r),i},featureEach:dn,featureReduce:function(e,t,n){var r=n;return dn(e,(function(e,i){r=0===i&&void 0===n?e:t(r,e,i)})),r},findPoint:function(e,t){if(!un(t=t||{}))throw Error("options is invalid");var n,r=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,a=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":0>r&&(r=e.features.length+r),s=s||e.features[r].properties,n=e.features[r].geometry;break;case"Feature":s=s||e.properties,n=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=e;break;default:throw Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return Gt(u,s,t);case"MultiPoint":return 0>i&&(i=u.length+i),Gt(u[i],s,t);case"LineString":return 0>a&&(a=u.length+a),Gt(u[a],s,t);case"Polygon":return 0>o&&(o=u.length+o),0>a&&(a=u[o].length+a),Gt(u[o][a],s,t);case"MultiLineString":return 0>i&&(i=u.length+i),0>a&&(a=u[i].length+a),Gt(u[i][a],s,t);case"MultiPolygon":return 0>i&&(i=u.length+i),0>o&&(o=u[i].length+o),0>a&&(a=u[i][o].length-a),Gt(u[i][o][a],s,t)}throw Error("geojson is invalid")},findSegment:function(e,t){if(!un(t=t||{}))throw Error("options is invalid");var n,r=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,a=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":0>r&&(r=e.features.length+r),s=s||e.features[r].properties,n=e.features[r].geometry;break;case"Feature":s=s||e.properties,n=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=e;break;default:throw Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return 0>a&&(a=u.length+a-1),Jt([u[a],u[a+1]],s,t);case"Polygon":return 0>o&&(o=u.length+o),0>a&&(a=u[o].length+a-1),Jt([u[o][a],u[o][a+1]],s,t);case"MultiLineString":return 0>i&&(i=u.length+i),0>a&&(a=u[i].length+a-1),Jt([u[i][a],u[i][a+1]],s,t);case"MultiPolygon":return 0>i&&(i=u.length+i),0>o&&(o=u[i].length+o),0>a&&(a=u[i][o].length-a-1),Jt([u[i][o][a],u[i][o][a+1]],s,t)}throw Error("geojson is invalid")},flattenEach:gn,flattenReduce:function(e,t,n){var r=n;return gn(e,(function(e,i,o){r=0===i&&0===o&&void 0===n?e:t(r,e,i,o)})),r},geomEach:pn,geomReduce:vn,lineEach:bn,lineReduce:function(e,t,n){var r=n;return bn(e,(function(e,i,o,a){r=0===i&&void 0===n?e:t(r,e,i,o,a)})),r},propEach:hn,propReduce:function(e,t,n){var r=n;return hn(e,(function(e,i){r=0===i&&void 0===n?e:t(r,e,i)})),r},segmentEach:yn,segmentReduce:mn});function wn(e){var t=[1/0,1/0,-1/0,-1/0];return cn(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),e[0]>t[2]&&(t[2]=e[0]),e[1]>t[3]&&(t[3]=e[1])})),t}wn.default=wn;var En=Object.freeze({__proto__:null,default:wn});function xn(e){if(!e)throw Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw Error("coord must be GeoJSON Point or an Array of numbers")}function Pn(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function kn(e){return"Feature"===e.type?e.geometry:e}function Mn(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}function Ln(e,t,n,r,i){An(e,t,n||0,r||e.length-1,i||Cn)}function An(e,t,n,r,i){for(;r>n;){if(r-n>600){var o=r-n+1,a=t-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(0>a-o/2?-1:1);An(e,t,Math.max(n,Math.floor(t-a*u/o+l)),Math.min(r,Math.floor(t+(o-a)*u/o+l)),i)}var c=e[t],h=n,d=r;for(On(e,n,t),i(e[r],c)>0&&On(e,n,r);d>h;){for(On(e,h,d),h++,d--;0>i(e[h],c);)h++;for(;i(e[d],c)>0;)d--}0===i(e[n],c)?On(e,n,d):On(e,++d,r),d>t||(n=d+1),t>d||(r=d-1)}}function On(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Cn(e,t){return t>e?-1:e>t?1:0}function _n(e,t,n){if(!n)return t.indexOf(e);for(let r=0;t.length>r;r++)if(n(e,t[r]))return r;return-1}function Rn(e,t){Sn(e,0,e.children.length,t,e)}function Sn(e,t,n,r,i){i||(i=Yn(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=t;n>o;o++){const t=e.children[o];jn(i,e.leaf?r(t):t)}return i}function jn(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Tn(e,t){return e.minX-t.minX}function Hn(e,t){return e.minY-t.minY}function Bn(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Fn(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Nn(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function In(e,t){return!(e.minX>t.minX||e.minY>t.minY||t.maxX>e.maxX||t.maxY>e.maxY)}function Un(e,t){return!(t.minX>e.maxX||t.minY>e.maxY||e.minX>t.maxX||e.minY>t.maxY)}function Yn(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Xn(e,t,n,r,i){const o=[t,n];for(;o.length;){if(r>=(n=o.pop())-(t=o.pop()))continue;const a=t+Math.ceil((n-t)/r/2)*r;Ln(e,a,t,n,i),o.push(t,a,a,n)}}var zn=Object.freeze({__proto__:null,default:class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!Un(e,t))return n;const r=this.toBBox,i=[];for(;t;){for(let o=0;t.children.length>o;o++){const a=t.children[o],s=t.leaf?r(a):a;Un(e,s)&&(t.leaf?n.push(a):In(e,s)?this._all(a,n):i.push(a))}t=i.pop()}return n}collides(e){let t=this.data;if(!Un(e,t))return!1;const n=[];for(;t;){for(let r=0;t.children.length>r;r++){const i=t.children[r],o=t.leaf?this.toBBox(i):i;if(Un(e,o)){if(t.leaf||In(e,o))return!0;n.push(i)}}t=n.pop()}return!1}load(e){if(!e||!e.length)return this;if(this._minEntries>e.length){for(let t=0;e.length>t;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(t.height>this.data.height){const e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}else this.data=t;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Yn([]),this}remove(e,t){if(!e)return this;let n=this.data;const r=this.toBBox(e),i=[],o=[];let a,s,u;for(;n||i.length;){if(n||(n=i.pop(),s=i[i.length-1],a=o.pop(),u=!0),n.leaf){const r=_n(e,n.children,t);if(-1!==r)return n.children.splice(r,1),i.push(n),this._condense(i),this}u||n.leaf||!In(n,r)?s?(a++,n=s.children[a],u=!1):n=null:(i.push(n),o.push(a),a=0,s=n,n=n.children[0])}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,r){const i=n-t+1;let o,a=this._maxEntries;if(a>=i)return o=Yn(e.slice(t,n+1)),Rn(o,this.toBBox),o;r||(a=Math.ceil(i/Math.pow(a,(r=Math.ceil(Math.log(i)/Math.log(a)))-1))),o=Yn([]),o.leaf=!1,o.height=r;const s=Math.ceil(i/a),u=s*Math.ceil(Math.sqrt(a));Xn(e,t,n,u,this.compareMinX);for(let i=t;n>=i;i+=u){const t=Math.min(i+u-1,n);Xn(e,i,t,s,this.compareMinY);for(let n=i;t>=n;n+=s){o.children.push(this._build(e,n,Math.min(n+s-1,t),r-1))}}return Rn(o,this.toBBox),o}_chooseSubtree(e,t,n,r){for(;r.push(t),!t.leaf&&r.length-1!==n;){let n,r=1/0,a=1/0;for(let s=0;t.children.length>s;s++){const u=t.children[s],l=Bn(u),c=(Math.max((o=u).maxX,(i=e).maxX)-Math.min(o.minX,i.minX))*(Math.max(o.maxY,i.maxY)-Math.min(o.minY,i.minY))-l;a>c?(a=c,r=r>l?l:r,n=u):c===a&&r>l&&(r=l,n=u)}t=n||t.children[0]}var i,o;return t}_insert(e,t,n){const r=n?e:this.toBBox(e),i=[],o=this._chooseSubtree(r,this.data,t,i);for(o.children.push(e),jn(o,r);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(r,i,t)}_split(e,t){const n=e[t],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);const o=this._chooseSplitIndex(n,i,r),a=Yn(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Rn(n,this.toBBox),Rn(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this.data=Yn([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Rn(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let r,i=1/0,o=1/0;for(let a=t;n-t>=a;a++){const t=Sn(e,0,a,this.toBBox),s=Sn(e,a,n,this.toBBox),u=Nn(t,s),l=Bn(t)+Bn(s);i>u?(i=u,r=a,o=o>l?l:o):u===i&&o>l&&(o=l,r=a)}return r||n-t}_chooseSplitAxis(e,t,n){const r=e.leaf?this.compareMinX:Tn,i=e.leaf?this.compareMinY:Hn,o=this._allDistMargin(e,t,n,r);this._allDistMargin(e,t,n,i)>o&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const i=this.toBBox,o=Sn(e,0,t,i),a=Sn(e,n-t,n,i);let s=Fn(o)+Fn(a);for(let r=t;n-t>r;r++){const t=e.children[r];jn(o,e.leaf?i(t):t),s+=Fn(o)}for(let r=n-t-1;r>=t;r--){const t=e.children[r];jn(a,e.leaf?i(t):t),s+=Fn(a)}return s}_adjustParentBBoxes(e,t,n){for(let r=n;r>=0;r--)jn(t[r],e)}_condense(e){for(let t,n=e.length-1;n>=0;n--)0===e[n].children.length?n>0?(t=e[n-1].children,t.splice(t.indexOf(e[n]),1)):this.clear():Rn(e[n],this.toBBox)}}});function Vn(e,t){return t>e?-1:e>t?1:0}var qn=Object.freeze({__proto__:null,default:class{constructor(e=[],t=Vn){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,r=t[e];for(;e>0;){const i=e-1>>1,o=t[i];if(n(r,o)>=0)break;t[e]=o,e=i}t[e]=r}_down(e){const{data:t,compare:n}=this,r=this.length>>1,i=t[e];for(;r>e;){let r=1+(e<<1),o=t[r];const a=r+1;if(this.length>a&&0>n(t[a],o)&&(r=a,o=t[a]),n(o,i)>=0)break;t[e]=o,e=r}t[e]=i}}}),Wn=function(e,t,n,r){var i=e[0],o=e[1],a=!1;void 0===n&&(n=0),void 0===r&&(r=t.length);for(var s=(r-n)/2,u=0,l=s-1;s>u;l=u++){var c=t[n+2*u+0],h=t[n+2*u+1],d=t[n+2*l+1];h>o!=d>o&&(t[n+2*l+0]-c)*(o-h)/(d-h)+c>i&&(a=!a)}return a},$n=function(e,t,n,r){var i=e[0],o=e[1],a=!1;void 0===n&&(n=0),void 0===r&&(r=t.length);for(var s=r-n,u=0,l=s-1;s>u;l=u++){var c=t[u+n][0],h=t[u+n][1],d=t[l+n][1];h>o!=d>o&&(t[l+n][0]-c)*(o-h)/(d-h)+c>i&&(a=!a)}return a},Gn=function(e,t,n,r){return t.length>0&&Array.isArray(t[0])?$n(e,t,n,r):Wn(e,t,n,r)},Kn=Wn;Gn.nested=$n,Gn.flat=Kn;var Jn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Zn(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}function Qn(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}var er=Zn((function(e,t){!function(e){const t=134217729,n=33306690738754706e-32;function r(e,t,n,r,i){let o,a,s,u,l=t[0],c=r[0],h=0,d=0;c>l==c>-l?(o=l,l=t[++h]):(o=c,c=r[++d]);let f=0;if(e>h&&n>d)for(c>l==c>-l?(s=o-((a=l+o)-l),l=t[++h]):(s=o-((a=c+o)-c),c=r[++d]),o=a,0!==s&&(i[f++]=s);e>h&&n>d;)c>l==c>-l?(s=o-((a=o+l)-(u=a-o))+(l-u),l=t[++h]):(s=o-((a=o+c)-(u=a-o))+(c-u),c=r[++d]),o=a,0!==s&&(i[f++]=s);for(;e>h;)s=o-((a=o+l)-(u=a-o))+(l-u),l=t[++h],o=a,0!==s&&(i[f++]=s);for(;n>d;)s=o-((a=o+c)-(u=a-o))+(c-u),c=r[++d],o=a,0!==s&&(i[f++]=s);return 0===o&&0!==f||(i[f++]=o),f}function i(e){return new Float64Array(e)}const o=33306690738754716e-32,a=22204460492503146e-32,s=11093356479670487e-47,u=i(4),l=i(8),c=i(12),h=i(16),d=i(4);e.orient2d=function(e,i,f,p,v,g){const y=(i-g)*(f-v),m=(e-v)*(p-g),b=y-m;if(0===y||0===m||y>0!=m>0)return b;const D=Math.abs(y+m);return o*D>Math.abs(b)?-function(e,i,o,f,p,v,g){let y,m,b,D,w,E,x,P,k,M,L,A,O,C,_,R,S,j;const T=e-p,H=o-p,B=i-v,F=f-v;w=(_=(P=T-(x=(E=t*T)-(E-T)))*(M=F-(k=(E=t*F)-(E-F)))-((C=T*F)-x*k-P*k-x*M))-(L=_-(S=(P=B-(x=(E=t*B)-(E-B)))*(M=H-(k=(E=t*H)-(E-H)))-((R=B*H)-x*k-P*k-x*M))),u[0]=_-(L+w)+(w-S),w=(O=C-((A=C+L)-(w=A-C))+(L-w))-(L=O-R),u[1]=O-(L+w)+(w-R),w=(j=A+L)-A,u[2]=A-(j-w)+(L-w),u[3]=j;let N=function(e,t){let n=t[0];for(let r=1;e>r;r++)n+=t[r];return n}(4,u),I=a*g;if(N>=I||-N>=I)return N;if(y=e-(T+(w=e-T))+(w-p),b=o-(H+(w=o-H))+(w-p),m=i-(B+(w=i-B))+(w-v),D=f-(F+(w=f-F))+(w-v),0===y&&0===m&&0===b&&0===D)return N;if(I=s*g+n*Math.abs(N),(N+=T*D+F*y-(B*b+H*m))>=I||-N>=I)return N;w=(_=(P=y-(x=(E=t*y)-(E-y)))*(M=F-(k=(E=t*F)-(E-F)))-((C=y*F)-x*k-P*k-x*M))-(L=_-(S=(P=m-(x=(E=t*m)-(E-m)))*(M=H-(k=(E=t*H)-(E-H)))-((R=m*H)-x*k-P*k-x*M))),d[0]=_-(L+w)+(w-S),w=(O=C-((A=C+L)-(w=A-C))+(L-w))-(L=O-R),d[1]=O-(L+w)+(w-R),w=(j=A+L)-A,d[2]=A-(j-w)+(L-w),d[3]=j;const U=r(4,u,4,d,l);w=(_=(P=T-(x=(E=t*T)-(E-T)))*(M=D-(k=(E=t*D)-(E-D)))-((C=T*D)-x*k-P*k-x*M))-(L=_-(S=(P=B-(x=(E=t*B)-(E-B)))*(M=b-(k=(E=t*b)-(E-b)))-((R=B*b)-x*k-P*k-x*M))),d[0]=_-(L+w)+(w-S),w=(O=C-((A=C+L)-(w=A-C))+(L-w))-(L=O-R),d[1]=O-(L+w)+(w-R),w=(j=A+L)-A,d[2]=A-(j-w)+(L-w),d[3]=j;const Y=r(U,l,4,d,c);w=(_=(P=y-(x=(E=t*y)-(E-y)))*(M=D-(k=(E=t*D)-(E-D)))-((C=y*D)-x*k-P*k-x*M))-(L=_-(S=(P=m-(x=(E=t*m)-(E-m)))*(M=b-(k=(E=t*b)-(E-b)))-((R=m*b)-x*k-P*k-x*M))),d[0]=_-(L+w)+(w-S),w=(O=C-((A=C+L)-(w=A-C))+(L-w))-(L=O-R),d[1]=O-(L+w)+(w-R),w=(j=A+L)-A,d[2]=A-(j-w)+(L-w),d[3]=j;const X=r(Y,c,4,d,h);return h[X-1]}(e,i,f,p,v,g,D):b},e.orient2dfast=function(e,t,n,r,i,o){return(t-o)*(n-i)-(e-i)*(r-o)},Object.defineProperty(e,"__esModule",{value:!0})}(t)})),tr=Qn(zn),nr=Qn(qn),rr=er.orient2d;nr.default&&(nr=nr.default);var ir=or;function or(e,t,n){t=Math.max(0,void 0===t?2:t),n=n||0;var r=function(e){for(var t=e[0],n=e[0],r=e[0],i=e[0],o=0;e.length>o;o++){var a=e[o];t[0]>a[0]&&(t=a),a[0]>r[0]&&(r=a),n[1]>a[1]&&(n=a),a[1]>i[1]&&(i=a)}var s=[t,n,r,i],u=s.slice();for(o=0;e.length>o;o++)Gn(e[o],s)||u.push(e[o]);return function(e){e.sort(yr);for(var t=[],n=0;e.length>n;n++){for(;t.length>=2&&0>=hr(t[t.length-2],t[t.length-1],e[n]);)t.pop();t.push(e[n])}for(var r=[],i=e.length-1;i>=0;i--){for(;r.length>=2&&0>=hr(r[r.length-2],r[r.length-1],e[i]);)r.pop();r.push(e[i])}return r.pop(),t.pop(),t.concat(r)}(u)}(e),i=new tr(16);i.toBBox=function(e){return{minX:e[0],minY:e[1],maxX:e[0],maxY:e[1]}},i.compareMinX=function(e,t){return e[0]-t[0]},i.compareMinY=function(e,t){return e[1]-t[1]},i.load(e);for(var o,a=[],s=0;r.length>s;s++){var u=r[s];i.remove(u),o=fr(u,o),a.push(o)}var l=new tr(16);for(s=0;a.length>s;s++)l.insert(dr(a[s]));for(var c=t*t,h=n*n;a.length;){var d=a.shift(),f=d.p,p=d.next.p,v=pr(f,p);if(v>=h){var g=v/c;(u=ar(i,d.prev.p,f,p,d.next.next.p,g,l))&&Math.min(pr(u,f),pr(u,p))<=g&&(a.push(d),a.push(fr(u,d)),i.remove(u),l.remove(d),l.insert(dr(d)),l.insert(dr(d.next)))}}d=o;var y=[];do{y.push(d.p),d=d.next}while(d!==o);return y.push(d.p),y}function ar(e,t,n,r,i,o,a){for(var s=new nr([],sr),u=e.data;u;){for(var l=0;u.children.length>l;l++){var c=u.children[l],h=u.leaf?vr(c,n,r):ur(n,r,c);o<h||s.push({node:c,dist:h})}for(;s.length&&!s.peek().node.children;){var d=s.pop(),f=d.node,p=vr(f,t,n),v=vr(f,r,i);if(p>d.dist&&v>d.dist&&cr(n,f,a)&&cr(r,f,a))return f}(u=s.pop())&&(u=u.node)}return null}function sr(e,t){return e.dist-t.dist}function ur(e,t,n){if(lr(e,n)||lr(t,n))return 0;var r=gr(e[0],e[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(0===r)return 0;var i=gr(e[0],e[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(0===i)return 0;var o=gr(e[0],e[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var a=gr(e[0],e[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===a?0:Math.min(r,i,o,a)}function lr(e,t){return!(t.minX>e[0]||e[0]>t.maxX||t.minY>e[1]||e[1]>t.maxY)}function cr(e,t,n){for(var r,i,o,a,s=n.search({minX:Math.min(e[0],t[0]),minY:Math.min(e[1],t[1]),maxX:Math.max(e[0],t[0]),maxY:Math.max(e[1],t[1])}),u=0;s.length>u;u++)if(i=s[u].next.p,o=e,(r=s[u].p)!==(a=t)&&i!==o&&hr(r,i,o)>0!=hr(r,i,a)>0&&hr(o,a,r)>0!=hr(o,a,i)>0)return!1;return!0}function hr(e,t,n){return rr(e[0],e[1],t[0],t[1],n[0],n[1])}function dr(e){var t=e.p,n=e.next.p;return e.minX=Math.min(t[0],n[0]),e.minY=Math.min(t[1],n[1]),e.maxX=Math.max(t[0],n[0]),e.maxY=Math.max(t[1],n[1]),e}function fr(e,t){var n={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function pr(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function vr(e,t,n){var r=t[0],i=t[1],o=n[0]-r,a=n[1]-i;if(0!==o||0!==a){var s=((e[0]-r)*o+(e[1]-i)*a)/(o*o+a*a);s>1?(r=n[0],i=n[1]):s>0&&(r+=o*s,i+=a*s)}return(o=e[0]-r)*o+(a=e[1]-i)*a}function gr(e,t,n,r,i,o,a,s){var u,l,c,h,d=n-e,f=r-t,p=a-i,v=s-o,g=e-i,y=t-o,m=d*d+f*f,b=d*p+f*v,D=p*p+v*v,w=d*g+f*y,E=p*g+v*y,x=m*D-b*b,P=x,k=x;0===x?(l=0,P=1,h=E,k=D):(h=m*E-b*w,0>(l=b*E-D*w)?(l=0,h=E,k=D):l>P&&(l=P,h=E+b,k=D)),0>h?(h=0,0>-w?l=0:-w>m?l=P:(l=-w,P=m)):h>k&&(h=k,0>-w+b?l=0:-w+b>m?l=P:(l=-w+b,P=m));var M=(1-(c=0===h?0:h/k))*i+c*a-((1-(u=0===l?0:l/P))*e+u*n),L=(1-c)*o+c*s-((1-u)*t+u*r);return M*M+L*L}function yr(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}function mr(e,t,n){void 0===n&&(n={});var r=xn(e),i=xn(t),o=an(i[1]-r[1]),a=an(i[0]-r[0]),s=an(r[1]),u=an(i[1]),l=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(u);return nn(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),n.units)}function br(e){return function(e,t){void 0===t&&(t={});var n=Number(e[0]),r=Number(e[1]),i=Number(e[2]),o=Number(e[3]);if(6===e.length)throw Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[n,r];return Kt([[a,[i,r],[i,o],[n,o],a]],t.properties,{bbox:e,id:t.id})}(wn(e))}function Dr(e,t,n,r){void 0===r&&(r={});var i=xn(e),o=an(i[0]),a=an(i[1]),s=an(n),u=rn(t,r.units),l=Math.asin(Math.sin(a)*Math.cos(u)+Math.cos(a)*Math.sin(u)*Math.cos(s));return Gt([on(o+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(a),Math.cos(u)-Math.sin(a)*Math.sin(l))),on(l)],r.properties)}function wr(e,t,n){if(void 0===n&&(n={}),!0===n.final)return function(e,t){var n=wr(t,e);return n=(n+180)%360}(e,t);var r=xn(e),i=xn(t),o=an(r[0]),a=an(i[0]),s=an(r[1]),u=an(i[1]);return on(Math.atan2(Math.sin(a-o)*Math.cos(u),Math.cos(s)*Math.sin(u)-Math.sin(s)*Math.cos(u)*Math.cos(a-o)))}function Er(e,t){void 0===t&&(t={});var n=wn(e);return Gt([(n[0]+n[2])/2,(n[1]+n[3])/2],t.properties,t)}function xr(e,t){void 0===t&&(t={});var n=0,r=0,i=0;return cn(e,(function(e){n+=e[0],r+=e[1],i++}),!0),Gt([n/i,r/i],t.properties)}function Pr(e,t){switch(void 0===t&&(t={}),Mn(e)){case"Point":return Gt(xn(e),t.properties);case"Polygon":var n=[];cn(e,(function(e){n.push(e)}));var r,i,o,a,s,u,l,c,h=xr(e,{properties:t.properties}),d=h.geometry.coordinates,f=0,p=0,v=0,g=n.map((function(e){return[e[0]-d[0],e[1]-d[1]]}));for(r=0;n.length-1>r;r++)v+=c=(a=(i=g[r])[0])*(l=(o=g[r+1])[1])-(s=o[0])*(u=i[1]),f+=(a+s)*c,p+=(u+l)*c;if(0===v)return h;var y=1/(6*(.5*v));return Gt([d[0]+y*f,d[1]+y*p],t.properties);default:var m=function(e,t){void 0===t&&(t={}),t.concavity=t.concavity||1/0;var n=[];if(cn(e,(function(e){n.push([e[0],e[1]])})),!n.length)return null;var r=ir(n,t.concavity);return r.length>3?Kt([r]):null}(e);return m?Pr(m,{properties:t.properties}):xr(e,{properties:t.properties})}}function kr(e){if(!e)throw Error("geojson is required");var t=[];return gn(e,(function(e){!function(e,t){var n=[],r=e.geometry;if(null!==r){switch(r.type){case"Polygon":n=Pn(r);break;case"LineString":n=[Pn(r)]}n.forEach((function(n){var r=function(e,t){var n=[];return e.reduce((function(e,r){var i,o,a,s,u,l,c=Jt([e,r],t);return c.bbox=[(u=(o=r)[0])>(a=(i=e)[0])?a:u,(l=o[1])>(s=i[1])?s:l,a>u?a:u,s>l?s:l],n.push(c),r})),n}(n,e.properties);r.forEach((function(e){e.id=t.length,t.push(e)}))}))}}(e,t)})),Zt(t)}ir.default=or;function Mr(e,t,n){if(!n)return t.indexOf(e);for(let r=0;t.length>r;r++)if(n(e,t[r]))return r;return-1}function Lr(e,t){Ar(e,0,e.children.length,t,e)}function Ar(e,t,n,r,i){i||(i=Br(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=t;n>o;o++){const t=e.children[o];Or(i,e.leaf?r(t):t)}return i}function Or(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Cr(e,t){return e.minX-t.minX}function _r(e,t){return e.minY-t.minY}function Rr(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Sr(e){return e.maxX-e.minX+(e.maxY-e.minY)}function jr(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function Tr(e,t){return!(e.minX>t.minX||e.minY>t.minY||t.maxX>e.maxX||t.maxY>e.maxY)}function Hr(e,t){return!(t.minX>e.maxX||t.minY>e.maxY||e.minX>t.maxX||e.minY>t.maxY)}function Br(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Fr(e,t,n,r,i){const o=[t,n];for(;o.length;){if(r>=(n=o.pop())-(t=o.pop()))continue;const a=t+Math.ceil((n-t)/r/2)*r;Ln(e,a,t,n,i),o.push(t,a,a,n)}}var Nr=Object.freeze({__proto__:null,default:class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!Hr(e,t))return n;const r=this.toBBox,i=[];for(;t;){for(let o=0;t.children.length>o;o++){const a=t.children[o],s=t.leaf?r(a):a;Hr(e,s)&&(t.leaf?n.push(a):Tr(e,s)?this._all(a,n):i.push(a))}t=i.pop()}return n}collides(e){let t=this.data;if(!Hr(e,t))return!1;const n=[];for(;t;){for(let r=0;t.children.length>r;r++){const i=t.children[r],o=t.leaf?this.toBBox(i):i;if(Hr(e,o)){if(t.leaf||Tr(e,o))return!0;n.push(i)}}t=n.pop()}return!1}load(e){if(!e||!e.length)return this;if(this._minEntries>e.length){for(let t=0;e.length>t;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(t.height>this.data.height){const e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}else this.data=t;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Br([]),this}remove(e,t){if(!e)return this;let n=this.data;const r=this.toBBox(e),i=[],o=[];let a,s,u;for(;n||i.length;){if(n||(n=i.pop(),s=i[i.length-1],a=o.pop(),u=!0),n.leaf){const r=Mr(e,n.children,t);if(-1!==r)return n.children.splice(r,1),i.push(n),this._condense(i),this}u||n.leaf||!Tr(n,r)?s?(a++,n=s.children[a],u=!1):n=null:(i.push(n),o.push(a),a=0,s=n,n=n.children[0])}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,r){const i=n-t+1;let o,a=this._maxEntries;if(a>=i)return o=Br(e.slice(t,n+1)),Lr(o,this.toBBox),o;r||(a=Math.ceil(i/Math.pow(a,(r=Math.ceil(Math.log(i)/Math.log(a)))-1))),o=Br([]),o.leaf=!1,o.height=r;const s=Math.ceil(i/a),u=s*Math.ceil(Math.sqrt(a));Fr(e,t,n,u,this.compareMinX);for(let i=t;n>=i;i+=u){const t=Math.min(i+u-1,n);Fr(e,i,t,s,this.compareMinY);for(let n=i;t>=n;n+=s){o.children.push(this._build(e,n,Math.min(n+s-1,t),r-1))}}return Lr(o,this.toBBox),o}_chooseSubtree(e,t,n,r){for(;r.push(t),!t.leaf&&r.length-1!==n;){let n,r=1/0,a=1/0;for(let s=0;t.children.length>s;s++){const u=t.children[s],l=Rr(u),c=(Math.max((o=u).maxX,(i=e).maxX)-Math.min(o.minX,i.minX))*(Math.max(o.maxY,i.maxY)-Math.min(o.minY,i.minY))-l;a>c?(a=c,r=r>l?l:r,n=u):c===a&&r>l&&(r=l,n=u)}t=n||t.children[0]}var i,o;return t}_insert(e,t,n){const r=n?e:this.toBBox(e),i=[],o=this._chooseSubtree(r,this.data,t,i);for(o.children.push(e),Or(o,r);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(r,i,t)}_split(e,t){const n=e[t],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);const o=this._chooseSplitIndex(n,i,r),a=Br(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Lr(n,this.toBBox),Lr(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this.data=Br([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Lr(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let r,i=1/0,o=1/0;for(let a=t;n-t>=a;a++){const t=Ar(e,0,a,this.toBBox),s=Ar(e,a,n,this.toBBox),u=jr(t,s),l=Rr(t)+Rr(s);i>u?(i=u,r=a,o=o>l?l:o):u===i&&o>l&&(o=l,r=a)}return r||n-t}_chooseSplitAxis(e,t,n){const r=e.leaf?this.compareMinX:Cr,i=e.leaf?this.compareMinY:_r,o=this._allDistMargin(e,t,n,r);this._allDistMargin(e,t,n,i)>o&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const i=this.toBBox,o=Ar(e,0,t,i),a=Ar(e,n-t,n,i);let s=Sr(o)+Sr(a);for(let r=t;n-t>r;r++){const t=e.children[r];Or(o,e.leaf?i(t):t),s+=Sr(o)}for(let r=n-t-1;r>=t;r--){const t=e.children[r];Or(a,e.leaf?i(t):t),s+=Sr(a)}return s}_adjustParentBBoxes(e,t,n){for(let r=n;r>=0;r--)Or(t[r],e)}_condense(e){for(let t,n=e.length-1;n>=0;n--)0===e[n].children.length?n>0?(t=e[n-1].children,t.splice(t.indexOf(e[n]),1)):this.clear():Lr(e[n],this.toBBox)}}}),Ir=Qn(Nr),Ur=Qn(ln),Yr=Qn(Dn),Xr=Qn(En).default,zr=Yr.featureEach,Vr=Ur.featureCollection;function qr(e){var t=new Ir(e);return t.insert=function(e){if("Feature"!==e.type)throw Error("invalid feature");return e.bbox=e.bbox?e.bbox:Xr(e),Ir.prototype.insert.call(this,e)},t.load=function(e){var t=[];return Array.isArray(e)?e.forEach((function(e){if("Feature"!==e.type)throw Error("invalid features");e.bbox=e.bbox?e.bbox:Xr(e),t.push(e)})):zr(e,(function(e){if("Feature"!==e.type)throw Error("invalid features");e.bbox=e.bbox?e.bbox:Xr(e),t.push(e)})),Ir.prototype.load.call(this,t)},t.remove=function(e,t){if("Feature"!==e.type)throw Error("invalid feature");return e.bbox=e.bbox?e.bbox:Xr(e),Ir.prototype.remove.call(this,e,t)},t.clear=function(){return Ir.prototype.clear.call(this)},t.search=function(e){var t=Ir.prototype.search.call(this,this.toBBox(e));return Vr(t)},t.collides=function(e){return Ir.prototype.collides.call(this,this.toBBox(e))},t.all=function(){var e=Ir.prototype.all.call(this);return Vr(e)},t.toJSON=function(){return Ir.prototype.toJSON.call(this)},t.fromJSON=function(e){return Ir.prototype.fromJSON.call(this,e)},t.toBBox=function(e){var t;if(e.bbox)t=e.bbox;else if(Array.isArray(e)&&4===e.length)t=e;else if(Array.isArray(e)&&6===e.length)t=[e[0],e[1],e[3],e[4]];else if("Feature"===e.type)t=Xr(e);else{if("FeatureCollection"!==e.type)throw Error("invalid geojson");t=Xr(e)}return{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},t}var Wr=qr;function $r(e,t){var n={},r=[];if("LineString"===e.type&&(e=$t(e)),"LineString"===t.type&&(t=$t(t)),"Feature"===e.type&&"Feature"===t.type&&null!==e.geometry&&null!==t.geometry&&"LineString"===e.geometry.type&&"LineString"===t.geometry.type&&2===e.geometry.coordinates.length&&2===t.geometry.coordinates.length){var i=Gr(e,t);return i&&r.push(i),Zt(r)}var o=Wr();return o.load(kr(t)),dn(kr(e),(function(e){dn(o.search(e),(function(t){var i=Gr(e,t);if(i){var o=Pn(i).join(",");n[o]||(n[o]=!0,r.push(i))}}))})),Zt(r)}function Gr(e,t){var n=Pn(e),r=Pn(t);if(2!==n.length)throw Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw Error("<intersects> line2 must only contain 2 coordinates");var i=n[0][0],o=n[0][1],a=n[1][0],s=n[1][1],u=r[0][0],l=r[0][1],c=r[1][0],h=r[1][1],d=(h-l)*(a-i)-(c-u)*(s-o),f=(c-u)*(o-l)-(h-l)*(i-u),p=(a-i)*(o-l)-(s-o)*(i-u);if(0===d)return null;var v=f/d,g=p/d;return 0>v||v>1||0>g||g>1?null:Gt([i+v*(a-i),o+v*(s-o)])}Wr.default=qr;var Kr=6378137;function Jr(e){return vn(e,(function(e,t){return e+function(e){var t,n=0;switch(e.type){case"Polygon":return Zr(e.coordinates);case"MultiPolygon":for(t=0;e.coordinates.length>t;t++)n+=Zr(e.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)}),0)}function Zr(e){var t=0;if(e&&e.length>0){t+=Math.abs(Qr(e[0]));for(var n=1;e.length>n;n++)t-=Math.abs(Qr(e[n]))}return t}function Qr(e){var t,n,r,i,o,a,s=0,u=e.length;if(u>2){for(a=0;u>a;a++)a===u-2?(r=u-2,i=u-1,o=0):a===u-1?(r=u-1,i=0,o=1):(r=a,i=a+1,o=a+2),t=e[r],n=e[i],s+=(ei(e[o][0])-ei(t[0]))*Math.sin(ei(n[1]));s=s*Kr*Kr/2}return s}function ei(e){return e*Math.PI/180}function ti(e,t){return void 0===t&&(t={}),mn(e,(function(e,n){var r=n.geometry.coordinates;return e+mr(r[0],r[1],t)}),0)}function ni(e,t){void 0===t&&(t={});var n=kn(e);switch(t.properties||"Feature"!==e.type||(t.properties=e.properties),n.type){case"Polygon":return function(e,t){void 0===t&&(t={});var n=kn(e),r=n.coordinates,i=t.properties?t.properties:"Feature"===e.type?e.properties:{};return ri(r,i)}(n,t);case"MultiPolygon":return function(e,t){void 0===t&&(t={});var n=kn(e),r=n.coordinates,i=t.properties?t.properties:"Feature"===e.type?e.properties:{},o=[];return r.forEach((function(e){o.push(ri(e,i))})),Zt(o)}(n,t);default:throw Error("invalid poly")}}function ri(e,t){return e.length>1?Qt(e,t):Jt(e[0],t)}function ii(e){for(var t,n,r=Pn(e),i=0,o=1;r.length>o;)t=n||r[0],i+=((n=r[o])[0]-t[0])*(n[1]+t[1]),o++;return i>0}var oi=Zn((function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=this._events[n?n+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var r=0,i=t.length,o=Array(i);i>r;r++)o[r]=t[r].fn;return o},s.prototype.listenerCount=function(e){var t=this._events[n?n+e:e];return t?t.fn?1:t.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,o),!0;case 6:return c.fn.call(c.context,t,r,i,o,a),!0}for(l=1,u=Array(h-1);h>l;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var d,f=c.length;for(l=0;f>l;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),h){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,r);break;case 4:c[l].fn.call(c[l].context,t,r,i);break;default:if(!u)for(d=1,u=Array(h-1);h>d;d++)u[d-1]=arguments[d];c[l].fn.apply(c[l].context,u)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,l=[],c=s.length;c>u;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?this._events[t=n?n+e:e]&&a(this,t):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})),ai=function(e){jt(n,e);var t=Ft(n);function n(e,r){var i,o=r.style;return Ct(this,n),(i=t.call(this)).scene=void 0,i.style=void 0,i.layers=void 0,i.data=[],i.scene=e,i.style=o,i.layers=i.initLayers(),i.layers.forEach((function(t){e.addLayer(t)})),o.callback instanceof Function&&o.callback(i.layers),i}return Rt(n,[{key:"getLayers",value:function(){return this.layers}},{key:"show",value:function(){this.layers.forEach((function(e){e.show()}))}},{key:"hide",value:function(){this.layers.forEach((function(e){e.hide()}))}},{key:"setData",value:function(e){var t=Ut(e).sort((function(e,t){return+e.properties.isActive-+t.properties.isActive}));this.data=t,this.layers.forEach((function(e){e.setData(Zt(t))}))}},{key:"destroy",value:function(){var e=this;this.layers.forEach((function(t){e.scene.removeLayer(t)}))}}]),n}(oi.EventEmitter),si=function(e){jt(r,e);var n=Ft(r);function r(){return Ct(this,r),n.apply(this,arguments)}return Rt(r,[{key:"initLayers",value:function(){var e=this.style,n=e.normal,r=e.style,i=e.options;return[new t.LineLayer(null!=i?i:{}).source(Zt([])).size(n.size).color(n.color).shape("line").style(r)]}}]),r}(ai);var ui=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},li="object"==typeof Jn&&Jn&&Jn.Object===Object&&Jn,ci="object"==typeof self&&self&&self.Object===Object&&self,hi=li||ci||Function("return this")(),di=function(){return hi.Date.now()},fi=/\s/;var pi=function(e){for(var t=e.length;t--&&fi.test(e.charAt(t)););return t},vi=/^\s+/;var gi=function(e){return e?e.slice(0,pi(e)+1).replace(vi,""):e},yi=hi.Symbol,mi=Object.prototype,bi=mi.hasOwnProperty,Di=mi.toString,wi=yi?yi.toStringTag:void 0;var Ei=function(e){var t=bi.call(e,wi),n=e[wi];try{e[wi]=void 0;var r=!0}catch(e){}var i=Di.call(e);return r&&(t?e[wi]=n:delete e[wi]),i},xi=Object.prototype.toString;var Pi=function(e){return xi.call(e)},ki=yi?yi.toStringTag:void 0;var Mi=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ki&&ki in Object(e)?Ei(e):Pi(e)};var Li=function(e){return null!=e&&"object"==typeof e};var Ai=function(e){return"symbol"==typeof e||Li(e)&&"[object Symbol]"==Mi(e)},Oi=/^[-+]0x[0-9a-f]+$/i,Ci=/^0b[01]+$/i,_i=/^0o[0-7]+$/i,Ri=parseInt;var Si=function(e){if("number"==typeof e)return e;if(Ai(e))return NaN;if(ui(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ui(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=gi(e);var n=Ci.test(e);return n||_i.test(e)?Ri(e.slice(2),n?2:8):Oi.test(e)?NaN:+e},ji=Math.max,Ti=Math.min;var Hi=function(e,t,n){var r,i,o,a,s,u,l=0,c=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,l=t,a=e.apply(o,n)}function p(e){var n=e-u;return void 0===u||n>=t||0>n||h&&e-l>=o}function v(){var e=di();if(p(e))return g(e);s=setTimeout(v,function(e){var n=t-(e-u);return h?Ti(n,o-(e-l)):n}(e))}function g(e){return s=void 0,d&&r?f(e):(r=i=void 0,a)}function y(){var e=di(),n=p(e);if(r=arguments,i=this,u=e,n){if(void 0===s)return function(e){return l=e,s=setTimeout(v,t),c?f(e):a}(u);if(h)return clearTimeout(s),s=setTimeout(v,t),f(u)}return void 0===s&&(s=setTimeout(v,t)),a}return t=Si(t)||0,ui(n)&&(c=!!n.leading,o=(h="maxWait"in n)?ji(Si(n.maxWait)||0,t):o,d="trailing"in n?!!n.trailing:d),y.cancel=function(){void 0!==s&&clearTimeout(s),l=0,r=u=i=s=void 0},y.flush=function(){return void 0===s?a:g(di())},y},Bi=function(n){jt(i,n);var r=Ft(i);function i(){var t;Ct(this,i);for(var n=arguments.length,o=Array(n),a=0;n>a;a++)o[a]=arguments[a];return(t=r.call.apply(r,[this].concat(o))).onMouseMove=function(n){t.emit(e.RenderEvent.Mousemove,n)},t.onMouseOut=function(n){t.emit(e.RenderEvent.Mouseout,n)},t.onMouseDown=function(n){t.emit(e.RenderEvent.Dragstart,n)},t.onDragging=function(n){t.emit(e.RenderEvent.Dragging,n)},t.onDragEnd=Hi((function(n){t.emit(e.RenderEvent.Dragend,n)}),0),t.onUnClick=function(n){t.emit(e.RenderEvent.UnClick,n)},t.enableHover=function(){var n,r;t.disableHover(),null===(n=t.layers[0])||void 0===n||n.on(e.LayerEvent.Mousemove,t.onMouseMove),null===(r=t.layers[0])||void 0===r||r.on(e.LayerEvent.Mouseout,t.onMouseOut)},t.disableHover=function(){var n,r;null===(n=t.layers[0])||void 0===n||n.off(e.LayerEvent.Mousemove,t.onMouseMove),null===(r=t.layers[0])||void 0===r||r.off(e.LayerEvent.Mouseout,t.onMouseOut)},t}return Rt(i,[{key:"initLayers",value:function(){var e=this.style,n=e.normal,r=e.hover,i=e.active,o=e.style,a=e.options;return[new t.LineLayer(null!=a?a:{}).source(Zt([])).size("isHover*isActive",(function(e,t){return t?i.size:e?r.size:n.size})).color("isHover*isActive",(function(e,t){return t?i.color:e?r.color:n.color})).shape("line").style(o)]}},{key:"enableDrag",value:function(){this.disableDrag(),this.layers[0].on(e.LayerEvent.Mousedown,this.onMouseDown),this.scene.on(e.SceneEvent.Dragging,this.onDragging),this.scene.on(e.SceneEvent.Mouseup,this.onDragEnd),this.scene.on(e.SceneEvent.Dragend,this.onDragEnd)}},{key:"disableDrag",value:function(){this.layers[0].off(e.LayerEvent.Mousedown,this.onMouseDown),this.scene.off(e.SceneEvent.Dragging,this.onDragging),this.scene.off(e.SceneEvent.Mouseup,this.onDragEnd),this.scene.off(e.SceneEvent.Dragend,this.onDragEnd)}},{key:"enableUnClick",value:function(){this.disableUnClick(),this.layers[0].on(e.LayerEvent.UnClick,this.onUnClick)}},{key:"disableUnClick",value:function(){this.layers[0].off(e.LayerEvent.UnClick,this.onUnClick)}}]),i}(ai),Fi=function(n){jt(i,n);var r=Ft(i);function i(){var t;Ct(this,i);for(var n=arguments.length,o=Array(n),a=0;n>a;a++)o[a]=arguments[a];return(t=r.call.apply(r,[this].concat(o))).onMouseMove=function(n){t.emit(e.RenderEvent.Mousemove,n)},t.onMouseOut=function(n){t.emit(e.RenderEvent.Mouseout,n)},t.onMouseDown=function(n){t.emit(e.RenderEvent.Click,n)},t}return Rt(i,[{key:"initLayers",value:function(){var e=this.style,n=e.normal,r=e.style,i=void 0===r?{}:r,o=e.options,a=n.shape,s=n.size,u=n.color;return[new t.PointLayer(null!=o?o:{}).source(Zt([])).size(s).color(u).shape(a).style(i)]}},{key:"enableClick",value:function(){this.disableClick(),this.layers[0].on(e.LayerEvent.Mousedown,this.onMouseDown)}},{key:"disableClick",value:function(){this.layers[0].off(e.LayerEvent.Mousedown,this.onMouseDown)}},{key:"enableHover",value:function(){var t,n;this.disableHover(),null===(t=this.layers[0])||void 0===t||t.on(e.LayerEvent.Mousemove,this.onMouseMove),null===(n=this.layers[0])||void 0===n||n.on(e.LayerEvent.Mouseout,this.onMouseOut)}},{key:"disableHover",value:function(){var t,n;null===(t=this.layers[0])||void 0===t||t.off(e.LayerEvent.Mousemove,this.onMouseMove),null===(n=this.layers[0])||void 0===n||n.off(e.LayerEvent.Mouseout,this.onMouseOut)}}]),i}(ai),Ni=function(n){jt(i,n);var r=Ft(i);function i(){var t;Ct(this,i);for(var n=arguments.length,o=Array(n),a=0;n>a;a++)o[a]=arguments[a];return(t=r.call.apply(r,[this].concat(o))).onCreate=function(n){t.emit(e.RenderEvent.UnClick,n)},t.onMouseMove=function(n){t.emit(e.RenderEvent.Mousemove,n)},t.onMouseOut=function(n){t.emit(e.RenderEvent.Mouseout,n)},t.onMouseDown=function(n){t.emit(e.RenderEvent.Dragstart,n)},t.onDragging=function(n){t.emit(e.RenderEvent.Dragging,n)},t.onDragEnd=Hi((function(n){t.emit(e.RenderEvent.Dragend,n)}),0),t.onClick=function(n){t.emit(e.RenderEvent.Click,n)},t.onContextmenu=function(n){t.emit(e.RenderEvent.Contextmenu,n)},t}return Rt(i,[{key:"initLayers",value:function(){var e=this.style,n=e.normal,r=e.hover,i=e.active,o=e.style,a=void 0===o?{}:o,s=e.options;return[new t.PointLayer(null!=s?s:{}).source(Zt([])).size("isHover*isActive",(function(e,t){return t?i.size:e?r.size:n.size})).color("isHover*isActive",(function(e,t){return t?i.color:e?r.color:n.color})).shape("isHover*isActive",(function(e,t){return t?i.shape:e?r.shape:n.shape})).style(a)]}},{key:"enableCreate",value:function(){this.disableCreate(),this.layers[0].on(e.LayerEvent.UnClick,this.onCreate)}},{key:"disableCreate",value:function(){this.layers[0].off(e.LayerEvent.UnClick,this.onCreate)}},{key:"enableHover",value:function(){var t,n;this.disableHover(),null===(t=this.layers[0])||void 0===t||t.on(e.LayerEvent.Mousemove,this.onMouseMove),null===(n=this.layers[0])||void 0===n||n.on(e.LayerEvent.Mouseout,this.onMouseOut)}},{key:"disableHover",value:function(){var t,n;null===(t=this.layers[0])||void 0===t||t.off(e.LayerEvent.Mousemove,this.onMouseMove),null===(n=this.layers[0])||void 0===n||n.off(e.LayerEvent.Mouseout,this.onMouseOut)}},{key:"enableDrag",value:function(){this.disableDrag(),this.layers[0].on(e.LayerEvent.Mousedown,this.onMouseDown),this.scene.on(e.SceneEvent.Dragging,this.onDragging),this.scene.on(e.SceneEvent.Mouseup,this.onDragEnd),this.scene.on(e.SceneEvent.Dragend,this.onDragEnd)}},{key:"disableDrag",value:function(){this.layers[0].off(e.LayerEvent.Mousedown,this.onMouseDown),this.scene.off(e.SceneEvent.Dragging,this.onDragging),this.scene.off(e.SceneEvent.Mouseup,this.onDragEnd),this.scene.off(e.SceneEvent.Dragend,this.onDragEnd)}},{key:"enableClick",value:function(){this.disableClick(),this.layers[0].on(e.LayerEvent.Click,this.onClick)}},{key:"disableClick",value:function(){this.layers[0].off(e.LayerEvent.Click,this.onClick)}},{key:"enableContextMenu",value:function(){this.disableContextMenu(),this.layers[0].on(e.LayerEvent.Contextmenu,this.onContextmenu)}},{key:"disableContextMenu",value:function(){this.layers[0].off(e.LayerEvent.Contextmenu,this.onContextmenu)}}]),i}(ai),Ii=function(n){jt(i,n);var r=Ft(i);function i(){var t;Ct(this,i);for(var n=arguments.length,o=Array(n),a=0;n>a;a++)o[a]=arguments[a];return(t=r.call.apply(r,[this].concat(o))).onMouseMove=function(n){t.emit(e.RenderEvent.Mousemove,n)},t.onMouseOut=function(n){t.emit(e.RenderEvent.Mouseout,n)},t.onMouseDown=function(n){t.emit(e.RenderEvent.Dragstart,n)},t.onDragging=function(n){t.emit(e.RenderEvent.Dragging,n)},t.onDragEnd=Hi((function(n){t.emit(e.RenderEvent.Dragend,n)}),0),t.onUnClick=function(n){t.emit(e.RenderEvent.UnClick,n)},t.enableHover=function(){var n,r;t.disableHover(),null===(n=t.layers[0])||void 0===n||n.on(e.LayerEvent.Mousemove,t.onMouseMove),null===(r=t.layers[0])||void 0===r||r.on(e.LayerEvent.Mouseout,t.onMouseOut)},t.disableHover=function(){var n,r;null===(n=t.layers[0])||void 0===n||n.off(e.LayerEvent.Mousemove,t.onMouseMove),null===(r=t.layers[0])||void 0===r||r.off(e.LayerEvent.Mouseout,t.onMouseOut)},t}return Rt(i,[{key:"initLayers",value:function(){var e=this.style,n=e.normal,r=e.hover,i=e.active,o=e.style,a=e.options,s=new t.PolygonLayer(null!=a?a:{});return s.source(Zt([])).color("isHover*isActive",(function(e,t){return t?i.color:e?r.color:n.color})).style(o),[s]}},{key:"enableDrag",value:function(){this.disableDrag(),this.layers[0].on(e.LayerEvent.Mousedown,this.onMouseDown),this.scene.on(e.SceneEvent.Dragging,this.onDragging),this.scene.on(e.SceneEvent.Mouseup,this.onDragEnd),this.scene.on(e.SceneEvent.Dragend,this.onDragEnd)}},{key:"disableDrag",value:function(){this.layers[0].off(e.LayerEvent.Mousedown,this.onMouseDown),this.scene.off(e.SceneEvent.Dragging,this.onDragging),this.scene.off(e.SceneEvent.Mouseup,this.onDragEnd),this.scene.off(e.SceneEvent.Dragend,this.onDragEnd)}},{key:"enableUnClick",value:function(){this.disableUnClick(),this.layers[0].on(e.LayerEvent.UnClick,this.onUnClick)}},{key:"disableUnClick",value:function(){this.layers[0].off(e.LayerEvent.UnClick,this.onUnClick)}}]),i}(ai),Ui=function(t){jt(r,t);var n=Ft(r);function r(t){var i;return Ct(this,r),(i=n.call(this)).scene=void 0,i.previousClick=void 0,i.onDblClick=function(t){var n,r,o=null!==(n=null!==(r=t.pixel)&&void 0!==r?r:t.point)&&void 0!==n?n:{},a=o.x,s=void 0===a?0:a,u=o.y,l=void 0===u?0:u,c=Date.now();if(i.previousClick){var h=i.previousClick,d=h.y;300>c-h.time&&5>Math.abs(s-h.x)&&5>Math.abs(l-d)&&i.emit(e.RenderEvent.DblClick,t)}i.previousClick={x:s,y:l,time:c}},i.onMouseMove=function(t){i.emit(e.RenderEvent.Mousemove,t)},i.onMouseDown=function(t){i.emit(e.RenderEvent.Dragstart,t)},i.onDragging=function(t){i.emit(e.RenderEvent.Dragging,t)},i.onDragEnd=Hi((function(t){i.emit(e.RenderEvent.Dragend,t)}),0),i.scene=t,i}return Rt(r,[{key:"enableDrag",value:function(){this.disableDrag(),this.scene.on(e.SceneEvent.Mousedown,this.onMouseDown),this.scene.on(e.SceneEvent.Dragging,this.onDragging),this.scene.on(e.SceneEvent.Mouseup,this.onDragEnd),this.scene.on(e.SceneEvent.Dragend,this.onDragEnd)}},{key:"disableDrag",value:function(){this.scene.off(e.SceneEvent.Mousedown,this.onMouseDown),this.scene.off(e.SceneEvent.Dragging,this.onDragging),this.scene.off(e.SceneEvent.Mouseup,this.onDragEnd),this.scene.off(e.SceneEvent.Dragend,this.onDragEnd)}},{key:"enableMouseMove",value:function(){this.disableMouseMove(),this.scene.on(e.SceneEvent.Mousemove,this.onMouseMove)}},{key:"disableMouseMove",value:function(){this.scene.off(e.SceneEvent.Mousemove,this.onMouseMove)}},{key:"enableDblClick",value:function(){this.disableDblClick(),this.scene.on(e.SceneEvent.Mousedown,this.onDblClick)}},{key:"disableDblClick",value:function(){this.scene.off(e.SceneEvent.Mousedown,this.onDblClick)}}]),r}(oi),Yi=function(e){jt(r,e);var n=Ft(r);function r(){return Ct(this,r),n.apply(this,arguments)}return Rt(r,[{key:"initLayers",value:function(){var e=this.style,n=e.normal,r=e.active,i=e.style,o=void 0===i?{}:i,a=e.options;return[new t.PointLayer(null!=a?a:{}).source(Zt([])).size("isActive",(function(e){return e?r.size:n.size})).color("isActive",(function(e){return e?r.color:n.color})).shape("text","text").style(o)]}}]),r}(ai),Xi={point:Ni,line:Bi,dashLine:si,midPoint:Fi,text:Yi,polygon:Ii},zi="#1990FF",Vi="#ED9D48",qi={blend:"normal",pickingBuffer:5},Wi={color:zi,shape:"circle",size:6},$i={color:Vi,shape:"circle",size:6},Gi={shape:"circle",size:6,color:Vi},Ki={options:qi,normal:Wi,hover:At(At({},Wi),{},{size:8}),active:At(At({},Wi),{},{size:8,color:Vi}),style:{stroke:"#ffffff",strokeWidth:2}},Ji={options:qi,normal:$i,hover:At(At({},$i),{},{size:8}),active:At(At({},$i),{},{size:8}),style:{stroke:"#ffffff",strokeWidth:2}},Zi={color:zi,size:12},Qi={point:Ji,line:{options:qi,normal:{color:zi,size:2},hover:{color:zi,size:2},active:{color:Vi,size:2},style:{}},polygon:{options:qi,normal:{color:zi},hover:{color:zi},active:{color:Vi},style:{opacity:.15}},midPoint:{options:qi,normal:Gi},dashLine:{options:qi,normal:{color:Vi,size:2},style:{lineType:"dash",dashArray:[6,6]}},text:{options:qi,normal:Zi,active:At(At({},Zi),{},{color:Vi}),style:{fontWeight:"800",textOffset:[0,Zi.size+6],textAllowOverlap:!0,stroke:"#ffffff",strokeWidth:2}}};var eo=function(e,t){return e===t||e!=e&&t!=t};var to=function(e,t){for(var n=e.length;n--;)if(eo(e[n][0],t))return n;return-1},no=Array.prototype.splice;var ro=function(e){var t=this.__data__,n=to(t,e);return n>=0&&(n==t.length-1?t.pop():no.call(t,n,1),--this.size,!0)};var io=function(e){var t=this.__data__,n=to(t,e);return 0>n?void 0:t[n][1]};var oo=function(e){return to(this.__data__,e)>-1};var ao=function(e,t){var n=this.__data__,r=to(n,e);return 0>r?(++this.size,n.push([e,t])):n[r][1]=t,this};function so(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}so.prototype.clear=function(){this.__data__=[],this.size=0},so.prototype.delete=ro,so.prototype.get=io,so.prototype.has=oo,so.prototype.set=ao;var uo=so;var lo=function(){this.__data__=new uo,this.size=0};var co=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var ho=function(e){return this.__data__.get(e)};var fo=function(e){return this.__data__.has(e)};var po,vo=function(e){if(!ui(e))return!1;var t=Mi(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},go=hi["__core-js_shared__"],yo=(po=/[^.]+$/.exec(go&&go.keys&&go.keys.IE_PROTO||""))?"Symbol(src)_1."+po:"";var mo=function(e){return!!yo&&yo in e},bo=Function.prototype.toString;var Do=function(e){if(null!=e){try{return bo.call(e)}catch(e){}try{return e+""}catch(e){}}return""},wo=/^\[object .+?Constructor\]$/,Eo=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var xo=function(e){return!(!ui(e)||mo(e))&&(vo(e)?Eo:wo).test(Do(e))};var Po=function(e,t){return null==e?void 0:e[t]};var ko=function(e,t){var n=Po(e,t);return xo(n)?n:void 0},Mo=ko(hi,"Map"),Lo=ko(Object,"create");var Ao=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Oo=Object.prototype.hasOwnProperty;var Co=function(e){var t=this.__data__;if(Lo){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Oo.call(t,e)?t[e]:void 0},_o=Object.prototype.hasOwnProperty;var Ro=function(e){var t=this.__data__;return Lo?void 0!==t[e]:_o.call(t,e)};var So=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Lo&&void 0===t?"__lodash_hash_undefined__":t,this};function jo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}jo.prototype.clear=function(){this.__data__=Lo?Lo(null):{},this.size=0},jo.prototype.delete=Ao,jo.prototype.get=Co,jo.prototype.has=Ro,jo.prototype.set=So;var To=jo;var Ho=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Bo=function(e,t){var n=e.__data__;return Ho(t)?n["string"==typeof t?"string":"hash"]:n.map};var Fo=function(e){var t=Bo(this,e).delete(e);return this.size-=t?1:0,t};var No=function(e){return Bo(this,e).get(e)};var Io=function(e){return Bo(this,e).has(e)};var Uo=function(e,t){var n=Bo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Yo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Yo.prototype.clear=function(){this.size=0,this.__data__={hash:new To,map:new(Mo||uo),string:new To}},Yo.prototype.delete=Fo,Yo.prototype.get=No,Yo.prototype.has=Io,Yo.prototype.set=Uo;var Xo=Yo;var zo=function(e,t){var n=this.__data__;if(n instanceof uo){var r=n.__data__;if(!Mo||199>r.length)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Xo(r)}return n.set(e,t),this.size=n.size,this};function Vo(e){var t=this.__data__=new uo(e);this.size=t.size}Vo.prototype.clear=lo,Vo.prototype.delete=co,Vo.prototype.get=ho,Vo.prototype.has=fo,Vo.prototype.set=zo;var qo=Vo;var Wo=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},$o=function(){try{var e=ko(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Go=function(e,t,n){"__proto__"==t&&$o?$o(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Ko=Object.prototype.hasOwnProperty;var Jo=function(e,t,n){var r=e[t];Ko.call(e,t)&&eo(r,n)&&(void 0!==n||t in e)||Go(e,t,n)};var Zo=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),i?Go(n,s,u):Jo(n,s,u)}return n};var Qo=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};var ea=function(e){return Li(e)&&"[object Arguments]"==Mi(e)},ta=Object.prototype,na=ta.hasOwnProperty,ra=ta.propertyIsEnumerable,ia=ea(function(){return arguments}())?ea:function(e){return Li(e)&&na.call(e,"callee")&&!ra.call(e,"callee")},oa=ia,aa=Array.isArray;var sa=function(){return!1},ua=Zn((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?hi.Buffer:void 0;e.exports=(i?i.isBuffer:void 0)||sa})),la=/^(?:0|[1-9]\d*)$/;var ca=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&la.test(e))&&e>-1&&e%1==0&&t>e};var ha=function(e){return"number"==typeof e&&e>-1&&e%1==0&&9007199254740991>=e},da={};da["[object Float32Array]"]=da["[object Float64Array]"]=da["[object Int8Array]"]=da["[object Int16Array]"]=da["[object Int32Array]"]=da["[object Uint8Array]"]=da["[object Uint8ClampedArray]"]=da["[object Uint16Array]"]=da["[object Uint32Array]"]=!0,da["[object Arguments]"]=da["[object Array]"]=da["[object ArrayBuffer]"]=da["[object Boolean]"]=da["[object DataView]"]=da["[object Date]"]=da["[object Error]"]=da["[object Function]"]=da["[object Map]"]=da["[object Number]"]=da["[object Object]"]=da["[object RegExp]"]=da["[object Set]"]=da["[object String]"]=da["[object WeakMap]"]=!1;var fa=function(e){return Li(e)&&ha(e.length)&&!!da[Mi(e)]};var pa=function(e){return function(t){return e(t)}},va=Zn((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n&&li.process,o=function(){try{var e=r&&r.require&&r.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o})),ga=va&&va.isTypedArray,ya=ga?pa(ga):fa,ma=Object.prototype.hasOwnProperty;var ba=function(e,t){var n=aa(e),r=!n&&oa(e),i=!n&&!r&&ua(e),o=!n&&!r&&!i&&ya(e),a=n||r||i||o,s=a?Qo(e.length,String):[],u=s.length;for(var l in e)!t&&!ma.call(e,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ca(l,u))||s.push(l);return s},Da=Object.prototype;var wa=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Da)};var Ea=function(e,t){return function(n){return e(t(n))}},xa=Ea(Object.keys,Object),Pa=Object.prototype.hasOwnProperty;var ka=function(e){if(!wa(e))return xa(e);var t=[];for(var n in Object(e))Pa.call(e,n)&&"constructor"!=n&&t.push(n);return t};var Ma=function(e){return null!=e&&ha(e.length)&&!vo(e)};var La=function(e){return Ma(e)?ba(e):ka(e)};var Aa=function(e,t){return e&&Zo(t,La(t),e)};var Oa=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},Ca=Object.prototype.hasOwnProperty;var _a=function(e){if(!ui(e))return Oa(e);var t=wa(e),n=[];for(var r in e)("constructor"!=r||!t&&Ca.call(e,r))&&n.push(r);return n};var Ra=function(e){return Ma(e)?ba(e,!0):_a(e)};var Sa=function(e,t){return e&&Zo(t,Ra(t),e)},ja=Zn((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?hi.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=o?o(n):new e.constructor(n);return e.copy(r),r}}));var Ta=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t};var Ha=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o};var Ba=function(){return[]},Fa=Object.prototype.propertyIsEnumerable,Na=Object.getOwnPropertySymbols,Ia=Na?function(e){return null==e?[]:Ha(Na(e=Object(e)),(function(t){return Fa.call(e,t)}))}:Ba;var Ua=function(e,t){return Zo(e,Ia(e),t)};var Ya=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},Xa=Ea(Object.getPrototypeOf,Object),za=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ya(t,Ia(e)),e=Xa(e);return t}:Ba;var Va=function(e,t){return Zo(e,za(e),t)};var qa=function(e,t,n){var r=t(e);return aa(e)?r:Ya(r,n(e))};var Wa=function(e){return qa(e,La,Ia)};var $a=function(e){return qa(e,Ra,za)},Ga=ko(hi,"DataView"),Ka=ko(hi,"Promise"),Ja=ko(hi,"Set"),Za=ko(hi,"WeakMap"),Qa="[object Map]",es="[object Promise]",ts="[object Set]",ns="[object WeakMap]",rs="[object DataView]",is=Do(Ga),os=Do(Mo),as=Do(Ka),ss=Do(Ja),us=Do(Za),ls=Mi;(Ga&&ls(new Ga(new ArrayBuffer(1)))!=rs||Mo&&ls(new Mo)!=Qa||Ka&&ls(Ka.resolve())!=es||Ja&&ls(new Ja)!=ts||Za&&ls(new Za)!=ns)&&(ls=function(e){var t=Mi(e),n="[object Object]"==t?e.constructor:void 0,r=n?Do(n):"";if(r)switch(r){case is:return rs;case os:return Qa;case as:return es;case ss:return ts;case us:return ns}return t});var cs=ls,hs=Object.prototype.hasOwnProperty;var ds=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&hs.call(e,"index")&&(n.index=e.index,n.input=e.input),n},fs=hi.Uint8Array;var ps=function(e){var t=new e.constructor(e.byteLength);return new fs(t).set(new fs(e)),t};var vs=function(e,t){var n=t?ps(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},gs=/\w*$/;var ys=function(e){var t=new e.constructor(e.source,gs.exec(e));return t.lastIndex=e.lastIndex,t},ms=yi?yi.prototype:void 0,bs=ms?ms.valueOf:void 0;var Ds=function(e){return bs?Object(bs.call(e)):{}};var ws=function(e,t){var n=t?ps(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Es=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return ps(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return vs(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ws(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return ys(e);case"[object Symbol]":return Ds(e)}},xs=Object.create,Ps=function(){function e(){}return function(t){if(!ui(t))return{};if(xs)return xs(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var ks=function(e){return"function"!=typeof e.constructor||wa(e)?{}:Ps(Xa(e))};var Ms=function(e){return Li(e)&&"[object Map]"==cs(e)},Ls=va&&va.isMap,As=Ls?pa(Ls):Ms;var Os=function(e){return Li(e)&&"[object Set]"==cs(e)},Cs=va&&va.isSet,_s=Cs?pa(Cs):Os,Rs="[object Arguments]",Ss="[object Function]",js="[object Object]",Ts={};Ts[Rs]=Ts["[object Array]"]=Ts["[object ArrayBuffer]"]=Ts["[object DataView]"]=Ts["[object Boolean]"]=Ts["[object Date]"]=Ts["[object Float32Array]"]=Ts["[object Float64Array]"]=Ts["[object Int8Array]"]=Ts["[object Int16Array]"]=Ts["[object Int32Array]"]=Ts["[object Map]"]=Ts["[object Number]"]=Ts[js]=Ts["[object RegExp]"]=Ts["[object Set]"]=Ts["[object String]"]=Ts["[object Symbol]"]=Ts["[object Uint8Array]"]=Ts["[object Uint8ClampedArray]"]=Ts["[object Uint16Array]"]=Ts["[object Uint32Array]"]=!0,Ts["[object Error]"]=Ts[Ss]=Ts["[object WeakMap]"]=!1;var Hs=function e(t,n,r,i,o,a){var s,u=1&n,l=2&n,c=4&n;if(r&&(s=o?r(t,i,o,a):r(t)),void 0!==s)return s;if(!ui(t))return t;var h=aa(t);if(h){if(s=ds(t),!u)return Ta(t,s)}else{var d=cs(t),f=d==Ss||"[object GeneratorFunction]"==d;if(ua(t))return ja(t,u);if(d==js||d==Rs||f&&!o){if(s=l||f?{}:ks(t),!u)return l?Va(t,Sa(s,t)):Ua(t,Aa(s,t))}else{if(!Ts[d])return o?t:{};s=Es(t,d,u)}}a||(a=new qo);var p=a.get(t);if(p)return p;a.set(t,s),_s(t)?t.forEach((function(i){s.add(e(i,n,r,i,t,a))})):As(t)&&t.forEach((function(i,o){s.set(o,e(i,n,r,o,t,a))}));var v=h?void 0:(c?l?$a:Wa:l?Ra:La)(t);return Wo(v||t,(function(i,o){v&&(i=t[o=i]),Jo(s,o,e(i,n,r,o,t,a))})),s};var Bs=function(e){return Hs(e,5)};var Fs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r};var Ns=function(e){return this.__data__.has(e)};function Is(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Xo;++t<n;)this.add(e[t])}Is.prototype.add=Is.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Is.prototype.has=Ns;var Us=Is;var Ys=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1};var Xs=function(e,t){return e.has(t)};var zs=function(e,t,n,r,i,o){var a=1&n,s=e.length,u=t.length;if(!(s==u||a&&u>s))return!1;var l=o.get(e),c=o.get(t);if(l&&c)return l==t&&c==e;var h=-1,d=!0,f=2&n?new Us:void 0;for(o.set(e,t),o.set(t,e);++h<s;){var p=e[h],v=t[h];if(r)var g=a?r(v,p,h,t,e,o):r(p,v,h,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!Ys(t,(function(e,t){if(!Xs(f,t)&&(p===e||i(p,e,n,r,o)))return f.push(t)}))){d=!1;break}}else if(p!==v&&!i(p,v,n,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d};var Vs=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n};var qs=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},Ws=yi?yi.prototype:void 0,$s=Ws?Ws.valueOf:void 0;var Gs=function(e,t,n,r,i,o,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new fs(e),new fs(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eo(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=Vs;case"[object Set]":if(s||(s=qs),e.size!=t.size&&!(1&r))return!1;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var l=zs(s(e),s(t),r,i,o,a);return a.delete(e),l;case"[object Symbol]":if($s)return $s.call(e)==$s.call(t)}return!1},Ks=Object.prototype.hasOwnProperty;var Js=function(e,t,n,r,i,o){var a=1&n,s=Wa(e),u=s.length;if(u!=Wa(t).length&&!a)return!1;for(var l=u;l--;){var c=s[l];if(!(a?c in t:Ks.call(t,c)))return!1}var h=o.get(e),d=o.get(t);if(h&&d)return h==t&&d==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=a;++l<u;){var v=e[c=s[l]],g=t[c];if(r)var y=a?r(g,v,c,t,e,o):r(v,g,c,e,t,o);if(!(void 0===y?v===g||i(v,g,n,r,o):y)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var m=e.constructor,b=t.constructor;m==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof b&&b instanceof b||(f=!1)}return o.delete(e),o.delete(t),f},Zs="[object Arguments]",Qs="[object Array]",eu="[object Object]",tu=Object.prototype.hasOwnProperty;var nu=function(e,t,n,r,i,o){var a=aa(e),s=aa(t),u=a?Qs:cs(e),l=s?Qs:cs(t),c=(u=u==Zs?eu:u)==eu,h=(l=l==Zs?eu:l)==eu,d=u==l;if(d&&ua(e)){if(!ua(t))return!1;a=!0,c=!1}if(d&&!c)return o||(o=new qo),a||ya(e)?zs(e,t,n,r,i,o):Gs(e,t,u,n,r,i,o);if(!(1&n)){var f=c&&tu.call(e,"__wrapped__"),p=h&&tu.call(t,"__wrapped__");if(f||p){var v=f?e.value():e,g=p?t.value():t;return o||(o=new qo),i(v,g,n,r,o)}}return!!d&&(o||(o=new qo),Js(e,t,n,r,i,o))};var ru=function e(t,n,r,i,o){return t===n||(null==t||null==n||!Li(t)&&!Li(n)?t!=t&&n!=n:nu(t,n,r,i,e,o))};var iu=function(e,t){return ru(e,t)};var ou=function(e,t,n){(void 0!==n&&!eo(e[t],n)||void 0===n&&!(t in e))&&Go(e,t,n)};var au=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===n(o[u],u,o))break}return t}},su=au();var uu=function(e){return Li(e)&&Ma(e)},lu=Function.prototype.toString,cu=Object.prototype.hasOwnProperty,hu=lu.call(Object);var du=function(e){if(!Li(e)||"[object Object]"!=Mi(e))return!1;var t=Xa(e);if(null===t)return!0;var n=cu.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&lu.call(n)==hu};var fu=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var pu=function(e){return Zo(e,Ra(e))};var vu=function(e,t,n,r,i,o,a){var s=fu(e,n),u=fu(t,n),l=a.get(u);if(l)ou(e,n,l);else{var c=o?o(s,u,n+"",e,t,a):void 0,h=void 0===c;if(h){var d=aa(u),f=!d&&ua(u),p=!d&&!f&&ya(u);c=u,d||f||p?aa(s)?c=s:uu(s)?c=Ta(s):f?(h=!1,c=ja(u,!0)):p?(h=!1,c=ws(u,!0)):c=[]:du(u)||oa(u)?(c=s,oa(s)?c=pu(s):ui(s)&&!vo(s)||(c=ks(u))):h=!1}h&&(a.set(u,c),i(c,u,r,o,a),a.delete(u)),ou(e,n,c)}};var gu=function e(t,n,r,i,o){t!==n&&su(n,(function(a,s){if(o||(o=new qo),ui(a))vu(t,n,s,r,e,i,o);else{var u=i?i(fu(t,s),a,s+"",t,n,o):void 0;void 0===u&&(u=a),ou(t,s,u)}}),Ra)};var yu=function(e){return e};var mu=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},bu=Math.max;var Du=function(e,t,n){return t=bu(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=bu(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),mu(e,this,s)}};var wu=function(e){return function(){return e}},Eu=Date.now;var xu=function(e){var t=0,n=0;return function(){var r=Eu(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},Pu=xu($o?function(e,t){return $o(e,"toString",{configurable:!0,enumerable:!1,value:wu(t),writable:!0})}:yu);var ku=function(e,t){return Pu(Du(e,t,yu),e+"")};var Mu=function(e,t,n){if(!ui(n))return!1;var r=typeof t;return!!("number"==r?Ma(n)&&ca(t,n.length):"string"==r&&t in n)&&eo(n[t],e)};var Lu=function(e){return ku((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Mu(n[0],n[1],a)&&(o=3>i?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))},Au=Lu((function(e,t,n){gu(e,t,n)}));var Ou=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i};var Cu=function(e,t){return Ou(t,(function(t){return[t,e[t]]}))};var _u=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n};var Ru=function(e){return function(t){var n=cs(t);return"[object Map]"==n?Vs(t):"[object Set]"==n?_u(t):Cu(t,e(t))}}(La),Su=Zn((function(e){!function(t,n,r){if(t){for(var i,o={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},a={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l=1;20>l;++l)o[111+l]="f"+l;for(l=0;9>=l;++l)o[l+96]=""+l;g.prototype.bind=function(e,t,n){var r=this;return r._bindMultiple.call(r,e=e instanceof Array?e:[e],t,n),r},g.prototype.unbind=function(e,t){return this.bind.call(this,e,(function(){}),t)},g.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},g.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},g.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(v(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var n=e.composedPath()[0];n!==e.target&&(t=n)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},g.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},g.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(o[t]=e[t]);i=null},g.init=function(){var e=g(n);for(var t in e)"_"!==t.charAt(0)&&(g[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},g.init(),t.Mousetrap=g,e.exports&&(e.exports=g)}function c(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function h(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return o[e.which]?o[e.which]:a[e.which]?a[e.which]:String.fromCharCode(e.which).toLowerCase()}function d(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function f(e,t,n){return n||(n=function(){if(!i)for(var e in i={},o)e>95&&112>e||o.hasOwnProperty(e)&&(i[o[e]]=e);return i}()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function p(e,t){var n,r,i,o=[];for(n=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),i=0;n.length>i;++i)u[r=n[i]]&&(r=u[r]),t&&"keypress"!=t&&s[r]&&(r=s[r],o.push("shift")),d(r)&&o.push(r);return{key:r,modifiers:o,action:t=f(r,o,t)}}function v(e,t){return null!==e&&e!==n&&(e===t||v(e.parentNode,t))}function g(e){var t=this;if(e=e||n,!(t instanceof g))return new g(e);t.target=e,t._callbacks={},t._directMap={};var r,i={},o=!1,a=!1,s=!1;function u(e){e=e||{};var t,n=!1;for(t in i)e[t]?n=!0:i[t]=0;n||(s=!1)}function l(e,n,r,o,a,s){var u,l,c,h=[],f=r.type;if(!t._callbacks[e])return[];for("keyup"==f&&d(e)&&(n=[e]),u=0;t._callbacks[e].length>u;++u){if(l=t._callbacks[e][u],o||!l.seq||i[l.seq]==l.level)if(f==l.action)if("keypress"==f&&!r.metaKey&&!r.ctrlKey||(c=l.modifiers,n.sort().join(",")===c.sort().join(",")))(!o&&l.combo==a||o&&l.seq==o&&l.level==s)&&t._callbacks[e].splice(u,1),h.push(l)}return h}function f(e,n,r,i){t.stopCallback(n,n.target||n.srcElement,r,i)||!1===e(n,r)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(n),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(n))}function v(e){"number"!=typeof e.which&&(e.which=e.keyCode);var n=h(e);n&&("keyup"!=e.type||o!==n?t.handleKey(n,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):o=!1)}function y(e,t,n,a){function l(t){return function(){s=t,++i[e],clearTimeout(r),r=setTimeout(u,1e3)}}function c(t){f(n,t,e),"keyup"!==a&&(o=h(t)),setTimeout(u,10)}i[e]=0;for(var d=0;t.length>d;++d){var v=d+1===t.length?c:l(a||p(t[d+1]).action);m(t[d],v,a,e,d)}}function m(e,n,r,i,o){t._directMap[e+":"+r]=n;var a,s=(e=e.replace(/\s+/g," ")).split(" ");s.length>1?y(e,s,n,r):(a=p(e,r),t._callbacks[a.key]=t._callbacks[a.key]||[],l(a.key,a.modifiers,{type:a.action},i,e,o),t._callbacks[a.key][i?"unshift":"push"]({callback:n,modifiers:a.modifiers,action:a.action,seq:i,level:o,combo:e}))}t._handleKey=function(e,t,n){var r,i=l(e,t,n),o={},c=0,h=!1;for(r=0;i.length>r;++r)i[r].seq&&(c=Math.max(c,i[r].level));for(r=0;i.length>r;++r)if(i[r].seq){if(i[r].level!=c)continue;h=!0,o[i[r].seq]=1,f(i[r].callback,n,i[r].combo,i[r].seq)}else h||f(i[r].callback,n,i[r].combo);var p="keypress"==n.type&&a;n.type!=s||d(e)||p||u(o),a=h&&"keydown"==n.type},t._bindMultiple=function(e,t,n){for(var r=0;e.length>r;++r)m(e[r],t,n)},c(e,"keypress",v),c(e,"keydown",v),c(e,"keyup",v)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)}));var ju,Tu=function(e){return e&&e.length?e[0]:void 0},Hu=(ju=1,function(e){return"".concat(e,"-").concat(ju++)}),Bu=function(e,t){var n,r;return!(!e||!t||(null===(n=e.properties)||void 0===n?void 0:n.id)!==(null===(r=t.properties)||void 0===r?void 0:r.id))},Fu=function(e){var t=e.target,n=e.targetHandler,r=e.otherHandler;return e.data.map((function(e,i){var o,a=Bu(e,t)?n:r;return null!==(o=null==a?void 0:a(e,i))&&void 0!==o?o:e}))},Nu=function(){return{id:Hu("point"),isHover:!1,isActive:!1,isDrag:!1,createTime:Date.now()}},Iu=function(){return{id:Hu("line"),isHover:!1,isActive:!1,isDrag:!1,isDraw:!1,createTime:Date.now()}},Uu=function(){return{id:Hu("polygon"),isHover:!1,isActive:!1,isDrag:!1,isDraw:!1,createTime:Date.now()}},Yu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Gt(e,At(At({},Nu()),t))},Xu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"Feature",properties:At(At({},Iu()),{},{nodes:e},t),geometry:{type:"LineString",coordinates:fn(Zt(e))}}},zu=function(e){return Jt(e,{id:Hu("dashLine")})},Vu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"Feature",properties:At(At({},Uu()),{},{nodes:e},t),geometry:{type:"Polygon",coordinates:[fn(Zt([].concat(Ut(e),[Tu(e)])))]}}},qu=function(e){return function(e,t,n){void 0===n&&(n={});for(var r=kn(e).coordinates,i=0,o=0;r.length>o&&(i>t||o!==r.length-1);o++){if(i>=t){var a=t-i;if(a){var s=wr(r[o],r[o-1])-180;return Dr(r[o],a,s,n)}return Gt(r[o])}i+=mr(r[o],r[o+1],n)}return Gt(r[r.length-1])}(e,ti(e,{units:"meters"})/2,{units:"meters"})},Wu=function(e,t){var n=t.format,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[];if(t.showTotalDistance){var o=qu(e),a=ti(e,{units:"meters"});o.properties=At({id:Hu("text"),isActive:!1,meters:a,text:n(a),type:"totalDistance"},r),i.push(o)}else for(var s=e.geometry.coordinates,u=0;s.length-1>u;u++){var l=Gt(s[u]),c=Gt(s[u+1]),h=mr(l,c,{units:"meters"}),d=Er(Zt([l,c]));d.properties=At({id:Hu("text"),isActive:!1,meters:h,text:n(h),type:"distance"},r),i.push(d)}return i},$u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.format,i=Jr(e);return Pr(e,{properties:At({meters:i,text:r(i),type:"area",isActive:!1},n)})},Gu=function(e){var t,n,r=e.getContainer();return null!==(t=null!==(n=null==r?void 0:r.querySelector(".l7-marker-container"))&&void 0!==n?n:null==r?void 0:r.querySelector(".amap-maps"))&&void 0!==t?t:null},Ku=function(e){return e.lngLat||e.lnglat},Ju=function(e){var t=Ku(e);return[t.lng,t.lat]},Zu=function(e){return[e.lng,e.lat]},Qu=function(e){for(var t=Number.MAX_SAFE_INTEGER,n=0,r=e.length,i=0;r>i;i++)t>e[i]&&(t=e[i],n=i);return n},el=function(e,t){var n=[],r=[];return e.forEach((function(e){iu(e,t)?r.length&&(n.push(r),r=[]):r.push(e)})),r.length&&n.push(r),n},tl=function(e,t,n){var r=[],i=[],o=[];return r="allDrawData"===e?cl.instances.map((function(e){return e.getData()})).flat():"drawData"===e?t.getData():e instanceof Function?e(n):e,r.length&&(i=r.map((function(e){var t,r=null!==(t=e.properties)&&void 0!==t?t:{},i=r.nodes,o=void 0===i?[]:i,a=r.isActive;return void 0!==a&&a?o.filter((function(e){return!iu(e.geometry.coordinates,n)})):o})).flat().filter((function(e){return e})),i.length||(i=fn(Zt(r)).map((function(e){return Gt(e)}))),o=r.map((function(e){var t,r,i=null===(t=e.properties)||void 0===t?void 0:t.line;return(null===(r=e.properties)||void 0===r?void 0:r.isActive)&&i?el(i.properties.nodes.map((function(e){return e.geometry.coordinates})),n).filter((function(e){return e.length>1})).map((function(e){return Jt(e)})):[i]})).flat().filter((function(e){return e})),o.length||r.forEach((function(e){var t=Mn(e);if(/linestring/i.test(t)&&o.push(e),/polygon/i.test(t)){var n,r,i=ni(e);return(n=o).push.apply(n,Ut(null!==(r=null==i?void 0:i.features)&&void 0!==r?r:[i]))}}))),{points:i,lines:o}},nl=function(e,t,n,r){var i=n.pointAdsorbPixel,o=It(e,2),a=r.lngLatToPixel([o[0],o[1]]),s=a.x,u=a.y,l=t.map((function(e){var t=It(e.geometry.coordinates,2),n=r.lngLatToPixel([t[0],t[1]]),i=n.y;return Math.pow(s-n.x,2)+Math.pow(u-i,2)})),c=Qu(l);return Math.pow(l[c],.5)>i?null:t[c].geometry.coordinates},rl=function(e,t,n,r){var i=n.lineAdsorbPixel,o=It(e,2),a=r.lngLatToPixel([o[0],o[1]]),s=a.x,u=a.y,l=t.filter((function(e){return fn(e).length>1})).map((function(t){return function(e,t,n){void 0===n&&(n={});var r=Gt([1/0,1/0],{dist:1/0}),i=0;return gn(e,(function(e){for(var o=Pn(e),a=0;o.length-1>a;a++){var s=Gt(o[a]);s.properties.dist=mr(t,s,n);var u=Gt(o[a+1]);u.properties.dist=mr(t,u,n);var l=mr(s,u,n),c=Math.max(s.properties.dist,u.properties.dist),h=wr(s,u),d=Dr(t,c,h+90,n),f=Dr(t,c,h-90,n),p=$r(Jt([d.geometry.coordinates,f.geometry.coordinates]),Jt([s.geometry.coordinates,u.geometry.coordinates])),v=null;p.features.length>0&&((v=p.features[0]).properties.dist=mr(t,v,n),v.properties.location=i+mr(s,v,n)),r.properties.dist>s.properties.dist&&((r=s).properties.index=a,r.properties.location=i),r.properties.dist>u.properties.dist&&((r=u).properties.index=a+1,r.properties.location=i+l),v&&r.properties.dist>v.properties.dist&&((r=v).properties.index=a),i+=l}})),r}(t,e)}));if(!l.length)return null;var c=l.map((function(e){var t=It(e.geometry.coordinates,2),n=r.lngLatToPixel([t[0],t[1]]),i=n.y;return Math.pow(s-n.x,2)+Math.pow(u-i,2)})),h=Qu(c);return Math.pow(c[h],.5)>i?null:l[h].geometry.coordinates},il=function(e,t){var n=It(t,2),r=n[0],i=n[1];e.lngLat&&(e.lngLat={lng:r,lat:i}),e.lnglat&&(e.lnglat={lng:r,lat:i})};var ol=function(){function e(t,n){Ct(this,e),this.container=void 0,this.cursor=null,this.options=void 0,this.container=Gu(t),this.options=n}return Rt(e,[{key:"setCursor",value:function(e){e!==this.cursor&&this.container&&(this.container.style.cursor=e?this.options[e]:"",this.cursor=e)}},{key:"destroy",value:function(){this.setCursor(null)}}]),e}();function al(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}al('.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;white-space:normal;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}');al(".tippy-box[data-theme~=light]{color:#26323d;box-shadow:0 0 20px 4px rgba(154,161,177,.15),0 4px 80px -8px rgba(36,40,47,.25),0 4px 4px -2px rgba(91,94,105,.15);background-color:#fff}.tippy-box[data-theme~=light][data-placement^=top]>.tippy-arrow:before{border-top-color:#fff}.tippy-box[data-theme~=light][data-placement^=bottom]>.tippy-arrow:before{border-bottom-color:#fff}.tippy-box[data-theme~=light][data-placement^=left]>.tippy-arrow:before{border-left-color:#fff}.tippy-box[data-theme~=light][data-placement^=right]>.tippy-arrow:before{border-right-color:#fff}.tippy-box[data-theme~=light]>.tippy-backdrop{background-color:#fff}.tippy-box[data-theme~=light]>.tippy-svg-arrow{fill:#fff}");var sl=function(){function t(n,r){var i=this;Ct(this,t),this.content="",this.tippy=void 0,this.scene=void 0,this.isMouseInner=!1,this.onMouseMove=function(){i.isMouseInner=!0,i.checkTippyShow()},this.onMouseOut=function(){i.isMouseInner=!1,i.checkTippyShow()},this.setContent=Hi((function(e){i.content=null!=e?e:"",i.tippy.setContent(null!=e?e:""),i.checkTippyShow()}),16,{maxWait:16}),this.tippy=ct(Gu(n),At(At({},kt),r)),this.tippy.hide(),this.scene=n,n.on(e.SceneEvent.Mousemove,this.onMouseMove),n.on(e.SceneEvent.Mouseout,this.onMouseOut)}return Rt(t,[{key:"getContent",value:function(){return this.content}},{key:"checkTippyShow",value:function(){this.content&&this.isMouseInner?this.tippy.show():this.tippy.hide()}},{key:"destroy",value:function(){this.scene.off(e.SceneEvent.Mousemove,this.onMouseMove),this.scene.off(e.SceneEvent.Mouseout,this.onMouseOut),this.tippy.destroy()}}]),t}(),ul=function(){function e(t){var n=t.config;Ct(this,e),this.historyList=[],this.historyIndex=0,this.config=void 0,this.config=n}return Rt(e,[{key:"save",value:function(e){if(this.config){var t=this.config.maxSize;this.historyIndex&&(this.historyList=this.historyList.slice(this.historyIndex),this.historyIndex=0),t>this.historyList.length||this.historyList.pop();var n=Bs(e);return this.historyList.unshift(n),n}}},{key:"revert",value:function(){if(this.historyList.length&&this.historyList.length-1>this.historyIndex){var e=this.historyList[++this.historyIndex];return e?Bs(e):void 0}}},{key:"redo",value:function(){if(this.historyList.length&&this.historyIndex>0){var e=this.historyList[--this.historyIndex];return e?Bs(e):void 0}}}]),e}(),ll=function(t){jt(i,t);var n=Ft(i);function i(e){var t,o=e.data,a=e.render,s=e.history,u=e.scene;return Ct(this,i),(t=n.call(this)).scene=void 0,t.render=void 0,t.data=Bs(r),t.timeout=null,t.diffData={},t.history=void 0,t.scene=u,t.render=a,s&&(t.history=new ul({config:s})),o&&t.setData(o),t}return Rt(i,[{key:"saveHistory",value:function(){var e;return null===(e=this.history)||void 0===e?void 0:e.save(this.data)}},{key:"revertHistory",value:function(){var e,t=null===(e=this.history)||void 0===e?void 0:e.revert();if(t)return this.setData(t),t}},{key:"redoHistory",value:function(){var e,t=null===(e=this.history)||void 0===e?void 0:e.redo();if(t)return this.setData(t),t}},{key:"setData",value:function(t){var n=this;return Object.keys(t).length&&(this.data=At(At({},this.data),t),this.diffData=At(At({},this.diffData),t),this.timeout||(this.timeout=requestAnimationFrame((function(){return n.updateDiffData()}))),this.emit(e.SourceEvent.Change,{data:this.data})),this.data}},{key:"getData",value:function(){return this.data}},{key:"getRenderData",value:function(e){return this.data[e]}},{key:"setRenderData",value:function(t,n){var r="function"==typeof n?n(this.getRenderData(t)):n;return this.setData(St({},t,r)),this.emit(e.SourceEvent.Change,this.data),r}},{key:"updateDiffData",value:function(){var t=this,n=Object.entries(this.diffData);n.length&&(n.forEach((function(e){var n,r=It(e,2),i=r[0],o=r[1];Array.isArray(o)&&(null===(n=t.getRender(i))||void 0===n||n.setData(o))})),this.emit(e.SourceEvent.Update,this.data,this.diffData),this.diffData={},this.timeout=null,requestAnimationFrame((function(){t.scene.render()})))}},{key:"getRender",value:function(e){return this.render[e]}},{key:"clear",value:function(){this.setData(Fs(Object.keys(this.render).map((function(e){return[e,[]]}))))}}]),i}(oi),cl=function(t){jt(i,t);var r=Ft(i);function i(t,n){var o;Ct(this,i),(o=r.call(this)).scene=void 0,o.source=void 0,o.render=void 0,o.cursor=void 0,o.options=void 0,o.enabled=!1,o.allowCreate=!1,o.sceneRender=void 0,o.mouseLngLat={lng:0,lat:0},o.popup=void 0,o.addCount=0,o.saveMouseLngLat=Hi((function(e){o.mouseLngLat=Ku(e)}),100,{maxWait:100}),o.saveHistory=Hi((function(){o.options.history&&o.source.saveHistory()}),100),o.bindThis(),o.scene=t,o.sceneRender=new Ui(t),o.options=Au({},o.getDefaultOptions(n),n),o.render=o.initRender(),o.source=new ll({render:o.render,history:o.options.history||void 0,scene:t}),o.cursor=new ol(t,o.options.cursor);var a=o.options,s=a.initialData,u=a.popup;return s&&o.setData(s),u&&(o.popup=new sl(t,u instanceof Object?u:{})),o.saveHistory(),o.bindCommonEvent(),o.emit(e.DrawEvent.Init,Bt(o)),o.bindEnableEvent(),i.instances.push(Bt(o)),o}return Rt(i,[{key:"addable",get:function(){var e=this.getData(),t=this.options,n=t.multiple,r=t.maxCount,i=e.find((function(e){return e.properties.isDraw}));return!(!this.enabled||!this.allowCreate)&&(!!(n&&0>=r||i)||!(!n&&this.addCount>=1)&&(0>=r||r>e.length))}},{key:"getOptions",value:function(){return this.options}},{key:"getEditItem",value:function(){return this.editItem}},{key:"getDragItem",value:function(){return this.dragItem}},{key:"setHelper",value:function(e){var t,n,r=this.options.helper;if(r){var i=null!==(t=e in r?r[e]:e)&&void 0!==t?t:null;null===(n=this.popup)||void 0===n||n.setContent(i)}}},{key:"isEnable",value:function(){return this.enabled}},{key:"bindThis",value:function(){this.initRender=this.initRender.bind(this),this.getData=this.getData.bind(this),this.setData=this.setData.bind(this),this.emitChangeEvent=this.emitChangeEvent.bind(this),this.saveHistory=this.saveHistory.bind(this),this.onSceneMouseMove=this.onSceneMouseMove.bind(this),this.revertHistory=this.revertHistory.bind(this),this.redoHistory=this.redoHistory.bind(this),this.removeActiveFeature=this.removeActiveFeature.bind(this),this.bindCommonEvent=this.bindCommonEvent.bind(this),this.bindEnableEvent=this.bindEnableEvent.bind(this),this.unbindEnableEvent=this.unbindEnableEvent.bind(this),this.setActiveFeature=this.setActiveFeature.bind(this)}},{key:"bindCommonEvent",value:function(){var t=this;this.on(e.DrawEvent.Add,this.emitChangeEvent),this.on(e.DrawEvent.Add,(function(){t.addCount++})),this.on(e.DrawEvent.Edit,this.emitChangeEvent),this.on(e.DrawEvent.Remove,this.emitChangeEvent),this.on(e.DrawEvent.Clear,this.emitChangeEvent),this.on(e.DrawEvent.AddNode,this.saveHistory),this.on(e.DrawEvent.RemoveNode,this.emitChangeEvent),this.bindEmitSelectEvent(!0)}},{key:"bindEmitSelectEvent",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=null,i=function(){var n,i,o,a=t.getData().find((function(e){var t;return null===(t=e.properties)||void 0===t?void 0:t.isActive}))||null;(null===(n=r)||void 0===n||null===(i=n.properties)||void 0===i?void 0:i.id)!==(null==a||null===(o=a.properties)||void 0===o?void 0:o.id)&&(r=a,t.emit(e.DrawEvent.Select,a))};this.source.on(e.SourceEvent.Change,i),n&&i()}},{key:"bindEnableEvent",value:function(){this.unbindKeyboardEvent(),this.scene.setMapStatus({doubleClickZoom:!1}),this.scene.on(e.SceneEvent.Mousemove,this.saveMouseLngLat),this.bindKeyboardEvent()}},{key:"unbindEnableEvent",value:function(){this.scene.setMapStatus({doubleClickZoom:!0}),this.scene.off(e.SceneEvent.Mousemove,this.saveMouseLngLat),this.unbindKeyboardEvent()}},{key:"bindKeyboardEvent",value:function(){var e=this,t=this.options.keyboard||{},n=t.revert,r=t.redo,i=t.remove;i&&Su.bind(i,(function(){e.removeActiveFeature()})),this.options.history&&(n&&Su.bind(n,this.revertHistory),r&&Su.bind(r,this.redoHistory))}},{key:"unbindKeyboardEvent",value:function(){var e=this.options.keyboard||{},t=e.revert,n=e.redo,r=e.remove;r&&Su.unbind(r),this.options.history&&(t&&Su.unbind(t),n&&Su.unbind(n))}},{key:"emitChangeEvent",value:function(){this.emit(e.DrawEvent.Change,this.getData()),this.saveHistory()}},{key:"revertHistory",value:function(){this.enabled&&this.options.history&&this.source.revertHistory()&&(this.correctDrawItem(),this.emit(e.DrawEvent.Change,this.getData()))}},{key:"redoHistory",value:function(){this.enabled&&this.options.history&&this.source.redoHistory()&&(this.correctDrawItem(),this.emit(e.DrawEvent.Change,this.getData()))}},{key:"getRenderLayers",value:function(){return Fs(Ru(this.render).map((function(e){var t=It(e,2);return[t[0],t[1].getLayers()]})))}},{key:"getTargetFeature",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getData(),i=null;e&&(i=null!==(t=r.find((function(t){var n;return t.properties.id===("string"==typeof e?e:null===(n=e.properties)||void 0===n?void 0:n.id)})))&&void 0!==t?t:null,!i&&e instanceof Object&&(i=null!==(n=r.find((function(t){return iu(e.geometry,t.geometry)})))&&void 0!==n?n:null));return i}},{key:"removeActiveFeature",value:function(){var e=this.getData().find((function(e){var t=e.properties;return t.isActive||t.isDraw}));return e&&this.removeFeature(e),e}},{key:"removeFeature",value:function(t){var n=this.getData(),r=this.getTargetFeature(t);r&&(this.setData(n.filter((function(e){return!Bu(r,e)}))),this.emit(e.DrawEvent.Remove,t,this.getData()))}},{key:"correctDrawItem",value:function(){this.getData().find((function(e){return e.properties.isDraw}))&&this.onSceneMouseMove({type:"mousemove",lnglat:this.mouseLngLat,lngLat:this.mouseLngLat})}},{key:"initRender",value:function(){var e,t={},n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Yt(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return e.length>r?{done:!1,value:e[r++]}:{done:!0}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.getRenderTypes());try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=new(0,Xi[r])(this.scene,{style:this.options.style[r]})}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getCommonOptions",value:function(e){return{initialData:[],autoActive:!0,cursor:Bs(n),editable:!0,style:Bs(Qi),multiple:!0,history:Bs(xt),keyboard:Bs(Pt),popup:!0,helper:{},maxCount:-1}}},{key:"setCursor",value:function(e){this.cursor.setCursor(e)}},{key:"resetCursor",value:function(){this.setCursor(this.addable?"draw":null)}},{key:"enable",value:function(){var t=this;this.allowCreate=0>=arguments.length||void 0===arguments[0]||arguments[0],this.addCount=0,this.enabled=!0,this.bindEnableEvent(),this.resetCursor(),this.setHelper(this.addable?"draw":null),setTimeout((function(){t.emit(e.DrawEvent.Enable,t)}),0)}},{key:"disable",value:function(){var t=this;this.resetFeatures(),this.enabled=!1,this.setCursor(null),this.unbindEnableEvent(),this.addCount=0,this.setHelper(null),setTimeout((function(){t.emit(e.DrawEvent.Disable,t)}),0)}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.source.clear(),this.emit(e.DrawEvent.Clear,this),t&&this.disable()}},{key:"show",value:function(){return Object.values(this.render).forEach((function(e){e.show()}))}},{key:"hide",value:function(){return Object.values(this.render).forEach((function(e){e.hide()}))}},{key:"destroy",value:function(){var t,n=this;Object.values(this.render).forEach((function(e){e.destroy()})),Object.values(e.RenderEvent).forEach((function(e){Object.values(n.render).forEach((function(t){t.removeAllListeners(e)})),n.sceneRender.removeAllListeners(e)})),setTimeout((function(){Object.values(e.DrawEvent).forEach((function(e){n.removeAllListeners(e)}))}),0),null===(t=this.popup)||void 0===t||t.destroy(),this.cursor.destroy(),this.emit(e.DrawEvent.Destroy,this);var r=i.instances.indexOf(this);r>-1&&i.instances.splice(r,1)}}]),i}(oi);cl.instances=[];var hl=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},dl=function(t){jt(r,t);var n=Ft(r);function r(){return Ct(this,r),n.apply(this,arguments)}return Rt(r,[{key:"pointRender",get:function(){return this.render.point}},{key:"dragPoint",get:function(){return this.getPointData().find((function(e){return e.properties.isDrag}))}},{key:"editPoint",get:function(){return this.getPointData().find((function(e){return e.properties.isActive}))}},{key:"hoverPoint",get:function(){return this.getPointData().find((function(e){return e.properties.isHover}))}},{key:"getDragPoint",value:function(){return this.dragPoint}},{key:"getEditPoint",value:function(){return this.editPoint}},{key:"getPointData",value:function(){return this.source.getRenderData("point")}},{key:"setPointData",value:function(e){return this.source.setRenderData("point",e)}},{key:"bindPointRenderEvent",value:function(){var t,n,r,i,o,a;null===(t=this.pointRender)||void 0===t||t.on(e.RenderEvent.UnClick,this.onPointCreate.bind(this)),null===(n=this.pointRender)||void 0===n||n.on(e.RenderEvent.Mousemove,this.onPointMouseMove.bind(this)),null===(r=this.pointRender)||void 0===r||r.on(e.RenderEvent.Mouseout,this.onPointMouseOut.bind(this)),null===(i=this.pointRender)||void 0===i||i.on(e.RenderEvent.Dragstart,this.onPointDragStart.bind(this)),null===(o=this.pointRender)||void 0===o||o.on(e.RenderEvent.Dragging,this.onPointDragging.bind(this)),null===(a=this.pointRender)||void 0===a||a.on(e.RenderEvent.Dragend,this.onPointDragEnd.bind(this))}},{key:"handleCreatePoint",value:function(e){var t=this.options,n=t.autoActive,r=t.editable,i=Yu(e);return this.setPointData((function(e){return Fu({target:i,data:[].concat(Ut(e),[i]),targetHandler:function(e){e.properties=At(At({},e.properties),{},{isHover:r,isActive:n&&r})},otherHandler:function(e){e.properties=At(At({},e.properties),{},{isHover:!1,isActive:!1,isDrag:!1})}})})),i}},{key:"handlePointHover",value:function(e){return this.setCursor("pointHover"),Bu(e,this.hoverPoint)||this.setPointData((function(t){return Fu({target:e,data:t,targetHandler:function(e){e.properties.isHover=!0},otherHandler:function(e){e.properties.isHover=!1}})})),e}},{key:"handlePointUnHover",value:function(e){return this.resetCursor(),this.setPointData((function(e){return e.map((function(e){return e.properties.isHover=!1,e}))})),e}},{key:"handlePointDragStart",value:function(e){return this.setPointData((function(t){return Fu({target:e,data:t,targetHandler:function(e){e.properties=At(At({},e.properties),{},{isDrag:!0,isActive:!0})},otherHandler:function(e){e.properties=At(At({},e.properties),{},{isDrag:!1,isActive:!1})}})})),this.scene.setMapStatus({dragEnable:!1}),this.setCursor("pointDrag"),e}},{key:"handlePointDragging",value:function(e,t){return this.setPointData((function(n){return Fu({target:e,data:n,targetHandler:function(e){e.geometry.coordinates=Zu(t)}})})),this.scene.setMapStatus({dragEnable:!1}),this.setCursor("pointDrag"),e}},{key:"handlePointDragEnd",value:function(e){return this.setPointData((function(t){return Fu({target:e,data:t,targetHandler:function(e){e.properties.isDrag=!1}})})),this.scene.setMapStatus({dragEnable:!0}),this.setCursor("pointHover"),e}},{key:"onPointCreate",value:function(e){return this.handleCreatePoint(Zu(Ku(e)))}},{key:"onPointMouseMove",value:function(e){return this.handlePointHover(e.feature)}},{key:"onPointMouseOut",value:function(e){return this.handlePointUnHover(e.feature)}},{key:"onPointDragStart",value:function(e){if(this.options.editable)return this.handlePointDragStart(e.feature)}},{key:"onPointDragging",value:function(e){var t=this.dragPoint;if(this.options.editable&&t)return this.handlePointDragging(t,Ku(e))}},{key:"onPointDragEnd",value:function(e){var t=this.dragPoint;if(this.options.editable&&t)return this.handlePointDragEnd(t)}},{key:"enablePointRenderAction",value:function(){var e,t,n,r,i=this.options.editable;this.enabled&&(null===(t=this.pointRender)||void 0===t||t.enableCreate());(null===(e=this.pointRender)||void 0===e||e.enableClick(),i)&&(null===(n=this.pointRender)||void 0===n||n.enableHover(),null===(r=this.pointRender)||void 0===r||r.enableDrag())}},{key:"disablePointRenderAction",value:function(){var e,t,n,r;null===(e=this.pointRender)||void 0===e||e.disableCreate(),null===(t=this.pointRender)||void 0===t||t.disableHover(),null===(n=this.pointRender)||void 0===n||n.disableDrag(),null===(r=this.pointRender)||void 0===r||r.disableClick()}}]),r}(cl),fl=function(t){jt(r,t);var n=Ft(r);function r(){return Ct(this,r),n.apply(this,arguments)}return Rt(r,[{key:"midPointRender",get:function(){return this.render.midPoint}},{key:"getCommonOptions",value:function(e){return At(At({},Nt(Tt(r.prototype),"getCommonOptions",this).call(this,e)),{},{showMidPoint:!0})}},{key:"bindMidPointRenderEvent",value:function(){var t,n,r;null===(t=this.midPointRender)||void 0===t||t.on(e.RenderEvent.Click,this.onMidPointClick.bind(this)),null===(n=this.midPointRender)||void 0===n||n.on(e.RenderEvent.Mousemove,this.onMidPointHover.bind(this)),null===(r=this.midPointRender)||void 0===r||r.on(e.RenderEvent.Mouseout,this.onMidPointUnHover.bind(this))}},{key:"getMidPointData",value:function(){return this.source.getRenderData("midPoint")}},{key:"setMidPointData",value:function(e){return this.source.setRenderData("midPoint",e)}},{key:"getMidPointsByLine",value:function(e){var t=e.properties.nodes;if(!this.options.showMidPoint||2>t.length)return[];for(var n=[],r=0;t.length-1>r;r++){var i,o,a,s,u=Er(Zt([t[r],t[r+1]]),{properties:{id:Hu("midPoint"),startId:null!==(i=null===(o=t[r].properties)||void 0===o?void 0:o.id)&&void 0!==i?i:"",endId:null!==(a=null===(s=t[r+1].properties)||void 0===s?void 0:s.id)&&void 0!==a?a:""}});n.push(u)}return n}},{key:"onMidPointHover",value:function(e){this.setCursor("pointHover")}},{key:"onMidPointUnHover",value:function(e){this.resetCursor()}},{key:"enableMidPointRenderAction",value:function(){var e,t;null===(e=this.midPointRender)||void 0===e||e.enableClick(),null===(t=this.midPointRender)||void 0===t||t.enableHover()}},{key:"disableMidPointRenderAction",value:function(){var e,t;null===(e=this.midPointRender)||void 0===e||e.disableClick(),null===(t=this.midPointRender)||void 0===t||t.disableHover()}}]),r}(dl),pl={draw:"单击绘制点",pointHover:"可拖拽调整点位置",pointDrag:null},vl={draw:"单击绘制首个节点",pointHover:"可拖拽调整节点位置",pointDrag:null,lineHover:"可拖拽调整线位置",lineDrag:null,midPointHover:"单击在该位置新增节点",drawFinish:"单击继续绘制，双击结束绘制"},gl={draw:"单击绘制首个节点",drawContinue:"单击继续绘制",drawFinish:"单击继续绘制，双击结束绘制",midPointHover:"单击在该位置新增节点",pointHover:"可拖拽调整节点位置",pointDrag:null,lineHover:"可拖拽调整面位置",lineDrag:null,polygonHover:"可拖拽调整面位置",polygonDrag:null},yl=At(At({},gl),{},{draw:"单击绘制首个节点",drawFinish:"单击结束绘制"}),ml={draw:"拖拽开始绘制",drawFinish:"松开鼠标结束绘制"},bl={lineHover:"可拖拽调整矩形位置",polygonHover:"可拖拽调整矩形位置"},Dl={lineHover:"可拖拽调整圆位置",polygonHover:"可拖拽调整圆位置"},wl=function(t){jt(r,t);var n=Ft(r);function r(){var e;Ct(this,r);for(var t=arguments.length,i=Array(t),o=0;t>o;o++)i[o]=arguments[o];return(e=n.call.apply(n,[this].concat(i))).previousPosition=[0,0],e}return Rt(r,[{key:"lineRender",get:function(){return this.render.line}},{key:"dragLine",get:function(){return this.getLineData().find((function(e){return e.properties.isDrag}))}},{key:"drawLine",get:function(){return this.getLineData().find((function(e){return e.properties.isDraw}))}},{key:"editLine",get:function(){return this.getLineData().find((function(e){var t=e.properties;return!t.isDraw&&t.isActive}))}},{key:"hoverLine",get:function(){return this.getLineData().find((function(e){return e.properties.isHover}))}},{key:"getDragLine",value:function(){return this.dragLine}},{key:"getDrawLine",value:function(){return this.drawLine}},{key:"getEditLine",value:function(){return this.editLine}},{key:"getDefaultOptions",value:function(e){var t=At(At({},this.getCommonOptions(e)),{},{showMidPoint:!0,distanceOptions:!1,helper:Bs(vl)});return e.distanceOptions&&(t.distanceOptions=At(At({},wt),t.distanceOptions)),e.adsorbOptions&&(t.adsorbOptions=At(At({},Mt),t.adsorbOptions)),t}},{key:"getAdsorbPosition",value:function(e){var t=this.options.adsorbOptions;if("boolean"==typeof t)return e;var n=this.scene,r=t.pointAdsorbPixel,i=t.lineAdsorbPixel,o=null,a=tl(t.data,this,e),s=a.points,u=a.lines;return s.length&&r>0&&(o=nl(e,s,t,n)),!o&&u.length&&i>0&&(o=rl(e,u,t,n)),o}},{key:"bindSceneEvent",value:function(){this.sceneRender.on(e.RenderEvent.Mousemove,this.onSceneMouseMove.bind(this))}},{key:"bindPointRenderEvent",value:function(){var t;Nt(Tt(r.prototype),"bindPointRenderEvent",this).call(this),null===(t=this.pointRender)||void 0===t||t.on(e.RenderEvent.Click,this.onPointClick.bind(this))}},{key:"bindLineRenderEvent",value:function(){var t,n,r,i,o,a;null===(t=this.lineRender)||void 0===t||t.on(e.RenderEvent.UnClick,this.onLineUnClick.bind(this)),null===(n=this.lineRender)||void 0===n||n.on(e.RenderEvent.Mousemove,this.onLineMouseMove.bind(this)),null===(r=this.lineRender)||void 0===r||r.on(e.RenderEvent.Mouseout,this.onLineMouseOut.bind(this)),null===(i=this.lineRender)||void 0===i||i.on(e.RenderEvent.Dragstart,this.onLineDragStart.bind(this)),null===(o=this.lineRender)||void 0===o||o.on(e.RenderEvent.Dragging,this.onLineDragging.bind(this)),null===(a=this.lineRender)||void 0===a||a.on(e.RenderEvent.Dragend,this.onLineDragEnd.bind(this))}},{key:"getDashLineDistanceTexts",value:function(e,t){var n=t.showTotalDistance,r=t.format;return t.showDashDistance?e.map((function(e){return Wu(e,{showTotalDistance:n,format:r},{isActive:!0,type:"dash"})})).flat():[]}},{key:"getLineDistanceTexts",value:function(e,t){var n=t.showTotalDistance,r=t.format,i=t.showWhen,o=[];if(i.includes("active")){var a=e.filter((function(e){return e.properties.isActive&&e.properties.nodes.length>1}));o.push.apply(o,Ut(a.map((function(e){return Wu(e,{showTotalDistance:n,format:r},{isActive:!0})})).flat()))}if(i.includes("normal")){var s=e.filter((function(e){return!e.properties.isActive&&e.properties.nodes.length>1}));o.push.apply(o,Ut(s.map((function(e){return Wu(e,{showTotalDistance:n,format:r})})).flat()))}return o}},{key:"getDistanceTexts",value:function(){var e=this.options.distanceOptions;if(!e)return[];var t=[],n=e.showWhen,r=e.showDashDistance,i=e.format,o=e.showTotalDistance;return t.push.apply(t,Ut(this.getDashLineDistanceTexts(this.getDashLineData(),{showTotalDistance:!1,format:i,showDashDistance:r})).concat(Ut(this.getLineDistanceTexts(this.getLineData(),{showTotalDistance:o,format:i,showWhen:n})))),t}},{key:"getAllTexts",value:function(){return this.getDistanceTexts()}},{key:"handleCreateLine",value:function(e){var t=Xu([e],{isActive:!0,isDraw:!0});return this.setLineData((function(e){return Fu({target:t,data:[].concat(Ut(e),[t]),otherHandler:function(e){e.properties.isActive=!1}})})),this.setPointData([e]),this.setTextData(this.getAllTexts()),t}},{key:"syncLineNodes",value:function(e,t){return e.properties.nodes=t,e.geometry.coordinates=fn(Zt(t)),this.setLineData((function(t){return t.map((function(t){return Bu(t,e)?e:t}))})),Bu(this.editLine,e)&&this.setMidPointData(this.getMidPointsByLine(e)),this.setPointData(e.properties.nodes),this.setTextData(this.getAllTexts()),e}},{key:"setActiveLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setLineData((function(n){return Fu({target:e,data:n,targetHandler:function(e){e.properties=At(At({},e.properties),{},{isDraw:!1,isActive:!0,isDrag:!1,isHover:!1},t)},otherHandler:function(e){e.properties=At(At({},e.properties),{},{isDraw:!1,isActive:!1,isDrag:!1})}})})),this.setPointData(e.properties.nodes.map((function(e){return e.properties=At(At({},e.properties),{},{isHover:!1,isActive:!1}),e}))),this.setMidPointData(this.getMidPointsByLine(e)),this.setDashLineData([]),this.setTextData(this.getAllTexts()),e}},{key:"clearActiveLine",value:function(){this.source.setData({point:[],line:this.getLineData().map((function(e){return e.properties=At(At({},e.properties),{},{isDrag:!1,isActive:!1,isHover:!1}),e})),midPoint:[],text:this.getAllTexts()})}},{key:"handleLineUnClick",value:function(e){return this.clearActiveLine(),e}},{key:"handleLineHover",value:function(e){if(!this.drawLine)return this.setCursor("lineHover"),Bu(e,this.hoverLine)||this.setLineData((function(t){return Fu({target:e,data:t,targetHandler:function(e){e.properties.isHover=!0},otherHandler:function(e){e.properties.isHover=!1}})})),e}},{key:"handleLineUnHover",value:function(e){if(!this.drawLine)return this.resetCursor(),this.setLineData((function(e){return e.map((function(e){return e.properties.isHover=!1,e}))})),e}},{key:"handleLineDragStart",value:function(e){return this.setActiveLine(e,{isDrag:!0,isActive:!0}),this.scene.setMapStatus({dragEnable:!1}),this.setCursor("lineDrag"),e}},{key:"handleLineDragging",value:function(e,t){var n=t.lng,r=t.lat,i=e.properties.nodes,o=It(this.previousPosition,2),a=o[0],s=o[1];return i.forEach((function(e){var t=e.geometry.coordinates;e.geometry.coordinates=[t[0]+n-a,t[1]+r-s]})),this.syncLineNodes(e,i),this.setActiveLine(e,{isDrag:!0}),this.setCursor("lineDrag"),this.previousPosition=[n,r],e}},{key:"handleLineDragEnd",value:function(e){return e.properties.isDrag=!1,this.setLineData((function(e){return e})),this.scene.setMapStatus({dragEnable:!0}),e}},{key:"resetAdsorbLngLat",value:function(e){if(this.options.adsorbOptions){var t=this.getAdsorbPosition(Zu(Ku(e)));return t&&il(e,t),t}}},{key:"onPointCreate",value:function(e){if(!this.editLine){this.resetAdsorbLngLat(e);var t=Nt(Tt(r.prototype),"onPointCreate",this).call(this,e),n=this.drawLine;if(t)return n?(this.syncLineNodes(n,[].concat(Ut(n.properties.nodes),[t])),this.setDashLineData([])):this.handleCreateLine(t),t}}},{key:"onPointDragStart",value:function(e){if(this.editLine)return this.setHelper("pointDrag"),Nt(Tt(r.prototype),"onPointDragStart",this).call(this,e)}},{key:"onPointDragging",value:function(e){var t=Nt(Tt(r.prototype),"onPointDragging",this).call(this,e);if(t){var n=this.resetAdsorbLngLat(e);n&&(t.geometry.coordinates=Bs(n))}var i=this.editLine;return i&&t&&(this.syncLineNodes(i,i.properties.nodes.map((function(e){return Bu(t,e)?t:e}))),this.setActiveLine(i)),t}},{key:"onPointDragEnd",value:function(e){if(this.editLine){var t=Nt(Tt(r.prototype),"onPointDragEnd",this).call(this,e);return this.setPointData((function(e){return e.map((function(e){return e.properties.isActive=!1,e}))})),this.setHelper("pointHover"),t}}},{key:"onLineUnClick",value:function(e){var t=this.editLine;if(t)return this.handleLineUnClick(t)}},{key:"onLineMouseMove",value:function(e){if(!this.drawLine)return this.dragLine||this.drawLine||!this.options.editable||this.setHelper("lineHover"),this.handleLineHover(e.feature)}},{key:"onLineMouseOut",value:function(e){if(!this.drawLine)return this.dragLine||this.drawLine||this.setHelper(this.addable?"draw":null),this.handleLineUnHover(e.feature)}},{key:"onLineDragStart",value:function(e){if(this.options.editable&&!this.drawLine)return this.previousPosition=Ju(e),this.setHelper("lineDrag"),this.handleLineDragStart(e.feature)}},{key:"onLineDragging",value:function(e){var t=this.dragLine;if(t)return this.handleLineDragging(t,Ku(e))}},{key:"onLineDragEnd",value:function(e){var t=this.dragLine;if(t)return this.setHelper("lineHover"),this.handleLineDragEnd(t)}},{key:"onPointMouseMove",value:function(e){var t=Nt(Tt(r.prototype),"onPointMouseMove",this).call(this,e);return this.dragLine||this.drawLine||this.dragPoint||this.setHelper("pointHover"),t}},{key:"onPointMouseOut",value:function(e){var t=Nt(Tt(r.prototype),"onPointMouseOut",this).call(this,e);return this.dragLine||this.drawLine||this.dragPoint||this.setHelper(this.addable?"draw":null),t}},{key:"onMidPointHover",value:function(e){Nt(Tt(r.prototype),"onMidPointHover",this).call(this,e),this.setHelper("midPointHover")}},{key:"onMidPointUnHover",value:function(e){Nt(Tt(r.prototype),"onMidPointUnHover",this).call(this,e),this.setHelper(null)}},{key:"onPointClick",value:function(e){}},{key:"getLineData",value:function(){return this.source.getRenderData("line")}},{key:"setLineData",value:function(e){return this.source.setRenderData("line",e)}},{key:"getTextData",value:function(){return this.source.getRenderData("text")}},{key:"setTextData",value:function(e){return this.source.setRenderData("text",e)}},{key:"getDashLineData",value:function(){return this.source.getRenderData("dashLine")}},{key:"setDashLineData",value:function(e){return this.source.setRenderData("dashLine",e)}},{key:"onMidPointClick",value:function(e){var t=this.editLine,n=e.feature;if(t&&n&&!this.dragPoint){var r=t.properties.nodes,i=n.properties,o=i.startId,a=i.endId,s=r.findIndex((function(e){return e.properties.id===o})),u=r.findIndex((function(e){return e.properties.id===a}));if(s>-1&&u>-1){var l=Yu(n.geometry.coordinates,{isDrag:!0,isHover:!0});return this.setHelper("pointDrag"),r.splice(u,0,l),t.geometry.coordinates=fn(Zt(r)),this.syncLineNodes(t,r),this.setActiveLine(t),l}}}},{key:"enableSceneRenderAction",value:function(){this.sceneRender.enableDrag(),this.sceneRender.enableMouseMove(),this.sceneRender.enableDblClick()}},{key:"disableSceneRenderAction",value:function(){this.sceneRender.disableDrag(),this.sceneRender.disableMouseMove(),this.sceneRender.disableDblClick()}},{key:"enableLineRenderAction",value:function(){var e,t,n,r=this.options.editable;(null===(e=this.lineRender)||void 0===e||e.enableUnClick(),r)&&(null===(t=this.lineRender)||void 0===t||t.enableHover(),null===(n=this.lineRender)||void 0===n||n.enableDrag())}},{key:"disableLineRenderAction",value:function(){var e,t,n;null===(e=this.lineRender)||void 0===e||e.disableUnClick(),null===(t=this.lineRender)||void 0===t||t.disableHover(),null===(n=this.lineRender)||void 0===n||n.disableDrag()}}]),r}(fl),El=function(t){jt(r,t);var n=Ft(r);function r(){return Ct(this,r),n.apply(this,arguments)}return Rt(r,[{key:"dragItem",get:function(){return this.dragPolygon}},{key:"editItem",get:function(){return this.editPolygon}},{key:"polygonRender",get:function(){return this.render.polygon}},{key:"dragPolygon",get:function(){return this.getPolygonData().find((function(e){return e.properties.isDrag}))}},{key:"drawPolygon",get:function(){return this.getPolygonData().find((function(e){return e.properties.isDraw}))}},{key:"editPolygon",get:function(){return this.getPolygonData().find((function(e){var t=e.properties;return!t.isDraw&&t.isActive}))}},{key:"hoverPolygon",get:function(){return this.getPolygonData().find((function(e){return e.properties.isHover}))}},{key:"getDragPolygon",value:function(){return this.dragPolygon}},{key:"getDrawPolygon",value:function(){return this.drawPolygon}},{key:"getEditPolygon",value:function(){return this.editPolygon}},{key:"getRenderTypes",value:function(){return["polygon","line","dashLine","midPoint","point","text"]}},{key:"getData",value:function(){return this.getPolygonData()}},{key:"getMainLayer",value:function(){var e,t;return null!==(e=null===(t=this.render.polygon)||void 0===t?void 0:t.getLayers())&&void 0!==e?e:[]}},{key:"getDefaultOptions",value:function(e){var t=At(At({},Nt(Tt(r.prototype),"getDefaultOptions",this).call(this,e)),{},{areaOptions:!1,helper:Bs(gl)});return e.areaOptions&&(t.areaOptions=At(At({},Et),e.areaOptions)),t}},{key:"getAreaTexts",value:function(e){var t=this.options.areaOptions;if(!t)return[];var n=t.format,r=t.showWhen,i=[],o=e.filter((function(e){return e.geometry.coordinates[0].length>=4}));return r.includes("active")&&o.filter((function(e){return e.properties.isActive})).forEach((function(e){i.push($u(e,{format:n},{isActive:!0}))})),r.includes("normal")&&o.filter((function(e){return!e.properties.isActive})).forEach((function(e){i.push($u(e,{format:n},{isActive:!1}))})),i}},{key:"getAllTexts",value:function(){return[].concat(Ut(Nt(Tt(r.prototype),"getAllTexts",this).call(this)),Ut(this.getAreaTexts(this.getPolygonData())))}},{key:"getPolygonData",value:function(){return this.source.getRenderData("polygon")}},{key:"setPolygonData",value:function(e){return this.source.setRenderData("polygon",e)}},{key:"handleCreatePolygon",value:function(e,t){var n=Vu(e,{nodes:e,line:t,isActive:!0,isDraw:!0});return this.setPolygonData((function(e){return Fu({target:n,data:[].concat(Ut(e),[n]),otherHandler:function(e){e.properties.isActive=!1}})})),n}},{key:"handlePolygonUnClick",value:function(e){return this.clearActivePolygon(),e}},{key:"handlePolygonHover",value:function(e){return this.setCursor("polygonHover"),Bu(e,this.hoverPolygon)||this.setPolygonData((function(t){return Fu({target:e,data:t,targetHandler:function(e){e.properties.isHover=!0},otherHandler:function(e){e.properties.isHover=!1}})})),e}},{key:"handlePolygonUnHover",value:function(){this.resetCursor(),this.setPolygonData((function(e){return e.map((function(e){return e.properties.isHover=!1,e}))}))}},{key:"handlePolygonDragStart",value:function(e){return this.setActivePolygon(e,{isDrag:!0}),this.scene.setMapStatus({dragEnable:!1}),this.setCursor("polygonDrag"),e}},{key:"bindPolygonRenderEvent",value:function(){var t,n,r,i;null===(t=this.polygonRender)||void 0===t||t.on(e.RenderEvent.UnClick,this.onPolygonUnClick.bind(this)),null===(n=this.polygonRender)||void 0===n||n.on(e.RenderEvent.Mousemove,this.onPolygonHover.bind(this)),null===(r=this.polygonRender)||void 0===r||r.on(e.RenderEvent.Mouseout,this.onPolygonUnHover.bind(this)),null===(i=this.polygonRender)||void 0===i||i.on(e.RenderEvent.Dragstart,this.onPolygonDragStart.bind(this))}},{key:"syncPolygonNodes",value:function(e,t){var n=fn(Zt([].concat(Ut(t),[Tu(t)]))),r=e.properties,i=r.line;if(e.properties.nodes=t,e.geometry.coordinates=[ii(Jt(n))?n:n.reverse()],this.setPolygonData((function(t){return t.map((function(t){return Bu(t,e)?e:t}))})),!Bu(this.drawPolygon,e)){var o=i.properties.nodes,a=Ut(t),s=Tu(a);a.push(o.length===t.length?Yu(s.geometry.coordinates):hl(o));var u=hl(a);iu(s.geometry.coordinates,u.geometry.coordinates)||(u.geometry.coordinates=Bs(s.geometry.coordinates)),this.syncLineNodes(i,a)}return e}},{key:"setActivePolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setActiveLine(e.properties.line,t),this.setPolygonData((function(n){return Fu({target:e,data:n,targetHandler:function(e){e.properties=At(At({},e.properties),{},{isDraw:!1,isActive:!0,isDrag:!1,isHover:!1},t)},otherHandler:function(e){e.properties=At(At({},e.properties),{},{isDraw:!1,isActive:!1,isDrag:!1})}})})),this.setTextData(this.getAllTexts()),e}},{key:"clearActivePolygon",value:function(){this.setPolygonData((function(e){return e.map((function(e){return e.properties=At(At({},e.properties),{},{isDrag:!1,isActive:!1,isHover:!1}),e}))})),this.clearActiveLine()}},{key:"onLineDragStart",value:function(t){var n=Nt(Tt(r.prototype),"onLineDragStart",this).call(this,t),i=this.getPolygonData().find((function(e){return Bu(e.properties.line,n)}));return i&&(this.setActivePolygon(i,{isDrag:!0}),this.emit(e.DrawEvent.DragStart,i,this.getPolygonData())),n}},{key:"onLineUnClick",value:function(e){return this.editLine}},{key:"onLineDragEnd",value:function(t){var n=Nt(Tt(r.prototype),"onLineDragEnd",this).call(this,t),i=this.dragPolygon;return n&&i&&(i.properties.isDrag=!1,this.emit(e.DrawEvent.DragEnd,i,this.getPolygonData()),this.emit(e.DrawEvent.Edit,i,this.getPolygonData())),n}},{key:"onPolygonUnClick",value:function(e){var t=this.editPolygon;if(t)return this.handlePolygonUnClick(t)}},{key:"onPolygonHover",value:function(e){if(!this.drawPolygon)return this.dragPolygon||this.setHelper("polygonHover"),this.handlePolygonHover(e.feature)}},{key:"onPolygonUnHover",value:function(e){if(!this.drawPolygon)return this.setHelper(this.addable?"draw":null),this.handlePolygonUnHover()}},{key:"onPolygonDragStart",value:function(t){if(this.options.editable&&!this.drawPolygon){var n=t.feature;return this.previousPosition=Ju(t),this.setHelper("polygonDrag"),this.emit(e.DrawEvent.DragStart,n,this.getPolygonData()),this.handlePolygonDragStart(n)}}},{key:"onMidPointClick",value:function(e){var t=this.editPolygon,n=Nt(Tt(r.prototype),"onMidPointClick",this).call(this,e);if(n&&t){var i=t.properties.line.properties.nodes;this.syncPolygonNodes(t,i.slice(0,i.length-1)),this.setActivePolygon(t)}return n}},{key:"onPointDragEnd",value:function(t){var n=this.editPolygon,i=Nt(Tt(r.prototype),"onPointDragEnd",this).call(this,t);return i&&n&&this.emit(e.DrawEvent.Edit,n,this.getPolygonData()),i}},{key:"enablePolygonRenderAction",value:function(){var e,t,n,r=this.options.editable;(null===(e=this.polygonRender)||void 0===e||e.enableUnClick(),r)&&(null===(t=this.polygonRender)||void 0===t||t.enableHover(),null===(n=this.polygonRender)||void 0===n||n.enableDrag())}},{key:"disablePolygonRenderAction",value:function(){var e,t,n;null===(e=this.polygonRender)||void 0===e||e.disableUnClick(),null===(t=this.polygonRender)||void 0===t||t.disableHover(),null===(n=this.polygonRender)||void 0===n||n.disableDrag()}},{key:"bindEnableEvent",value:function(){Nt(Tt(r.prototype),"bindEnableEvent",this).call(this),this.enableSceneRenderAction(),this.enablePointRenderAction(),this.enableLineRenderAction(),this.enableMidPointRenderAction(),this.enablePolygonRenderAction()}},{key:"unbindEnableEvent",value:function(){Nt(Tt(r.prototype),"unbindEnableEvent",this).call(this),this.disableSceneRenderAction(),this.disablePointRenderAction(),this.disableLineRenderAction(),this.disableMidPointRenderAction(),this.disablePolygonRenderAction()}},{key:"bindThis",value:function(){Nt(Tt(r.prototype),"bindThis",this).call(this),this.bindPointRenderEvent=this.bindPointRenderEvent.bind(this),this.bindSceneEvent=this.bindSceneEvent.bind(this),this.bindLineRenderEvent=this.bindLineRenderEvent.bind(this),this.bindMidPointRenderEvent=this.bindMidPointRenderEvent.bind(this),this.bindPolygonRenderEvent=this.bindPolygonRenderEvent.bind(this)}},{key:"setActiveFeature",value:function(e){var t=this.getTargetFeature(e);t?this.setActivePolygon(t):this.clearActivePolygon()}},{key:"resetFeatures",value:function(){var e=this.getPolygonData();this.drawPolygon&&(e=e.filter((function(e){return!e.properties.isDraw})),this.source.setData({point:[],dashLine:[],midPoint:[]}),this.setLineData((function(e){return e.filter((function(e){return!e.properties.isDraw}))})),this.setTextData((function(e){return e.filter((function(e){return!e.properties.isActive}))}))),this.editPolygon&&this.handlePolygonUnClick(this.editPolygon),this.setPolygonData(e.map((function(e){return e.properties=At(At({},e.properties),{},{isDrag:!1,isActive:!1,isHover:!1}),e})))}}]),r}(wl),xl=function(t){jt(r,t);var n=Ft(r);function r(e,t){var i;return Ct(this,r),(i=n.call(this,e,t)).onSceneDragStart=i.onSceneDragStart.bind(Bt(i)),i.onSceneDragEnd=i.onSceneDragEnd.bind(Bt(i)),i}return Rt(r,[{key:"drawLine",get:function(){var e;return null===(e=this.drawPolygon)||void 0===e?void 0:e.properties.line}},{key:"isDragTrigger",get:function(){return"drag"===this.options.trigger}},{key:"isClickTrigger",get:function(){return"click"===this.options.trigger}},{key:"getDefaultOptions",value:function(e){var t=At(At({},Nt(Tt(r.prototype),"getDefaultOptions",this).call(this,e)),{},{showMidPoint:!1,trigger:"click",autoActive:!1,helper:Bs(yl)});return"drag"===e.trigger&&(t.helper=At(At({},t.helper),ml)),t}},{key:"getMidPointsByLine",value:function(e){return[]}},{key:"handleCreatePolygon",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.properties.nodes;return Vu(r.slice(0,r.length-1),At({nodes:e,line:t},n))}},{key:"handleFirstNodeCreate",value:function(t){var n=Yu(t.geometry.coordinates),r=this.handleCreatePolygonLine(t,n,{isDraw:!0,isActive:!0}),i=this.handleCreatePolygon([t,n],r,{isDraw:!0,isActive:!0});return this.setPolygonData((function(e){return Fu({target:i,data:[].concat(Ut(e),[i]),targetHandler:function(e){e.properties=At(At({},e.properties),{},{isDraw:!0,isActive:!0})}})})),this.emit(e.DrawEvent.AddNode,t,this.drawPolygon,this.getPolygonData()),this.setHelper("drawFinish"),t}},{key:"handleLastNodeCreate",value:function(t){var n=this.options,r=n.autoActive,i=n.editable,o=this.drawPolygon;return o?(this.setLineData((function(e){return[].concat(Ut(e),[o.properties.line])})),this.setActivePolygon(o),r&&i||this.handlePolygonUnClick(o),this.emit(e.DrawEvent.Add,o,this.getPolygonData()),this.emit(e.DrawEvent.AddNode,o.properties.nodes[1],this.drawPolygon,this.getPolygonData()),this.setHelper(i?r?"pointHover":"polygonHover":this.addable?"draw":null),t):t}},{key:"onPointCreate",value:function(e){var t=this;if(this.addable&&!this.dragPoint&&!this.editLine&&this.isClickTrigger){var n=this.drawPolygon,r=Ju(e),i=this.handleCreatePoint(r);return n?requestAnimationFrame((function(){t.handleLastNodeCreate(i)})):this.handleFirstNodeCreate(i),i}}},{key:"setActivePolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setActiveLine(e.properties.line,t),this.setPolygonData((function(n){return Fu({target:e,data:n,targetHandler:function(e){e.properties=At(At({},e.properties),{},{isDraw:!1,isActive:!0,isDrag:!1,isHover:!1},t)},otherHandler:function(e){e.properties=At(At({},e.properties),{},{isDraw:!1,isActive:!1,isDrag:!1})}})})),this.setPointData(e.properties.nodes),this.setDashLineData([]);var n=this.getAllTexts();return this.setTextData(n),e}},{key:"onPointDragging",value:function(e){var t=this.dragPoint;if(t){var n=this.handlePointDragging(t,Ku(e)),r=this.editPolygon;return n&&r&&(this.syncPolygonNodes(r,r.properties.nodes.map((function(e){return Bu(e,n)?n:e}))),this.setActivePolygon(r)),n}}},{key:"onSceneDragStart",value:function(e){this.isDragTrigger&&this.addable&&!this.dragPoint&&!this.editLine&&(this.scene.setMapStatus({dragEnable:!1}),this.handleFirstNodeCreate(this.handleCreatePoint(Ju(e))))}},{key:"onSceneDragEnd",value:function(e){this.isDragTrigger&&this.addable&&!this.dragPoint&&!this.editLine&&this.drawPolygon&&(this.scene.setMapStatus({dragEnable:!1}),this.handleLastNodeCreate(this.handleCreatePoint(Ju(e))))}},{key:"onSceneMouseMove",value:function(e){var t=this.drawPolygon;if(t){var n=t.properties.nodes,r=Tu(n),i=hl(n);i.geometry.coordinates=Ju(e),this.syncPolygonNodes(t,[r,i]),this.setDashLineData([t.properties.line]),this.setTextData(this.getAllTexts()),this.resetCursor()}}},{key:"bindSceneDragEvent",value:function(){this.unbindSceneDragEvent(),this.sceneRender.on(e.RenderEvent.Dragstart,this.onSceneDragStart),this.sceneRender.on(e.RenderEvent.Dragend,this.onSceneDragEnd),this.scene.setMapStatus({dragEnable:!1})}},{key:"unbindSceneDragEvent",value:function(){this.sceneRender.off(e.RenderEvent.Dragstart,this.onSceneDragStart),this.sceneRender.off(e.RenderEvent.Dragend,this.onSceneDragEnd),this.scene.setMapStatus({dragEnable:!0})}},{key:"bindEnableEvent",value:function(){Nt(Tt(r.prototype),"bindEnableEvent",this).call(this),this.isDragTrigger&&this.bindSceneDragEvent()}},{key:"unbindEnableEvent",value:function(){Nt(Tt(r.prototype),"unbindEnableEvent",this).call(this),this.isDragTrigger&&this.unbindSceneDragEvent()}},{key:"bindThis",value:function(){Nt(Tt(r.prototype),"bindThis",this).call(this),this.onSceneDragStart=this.onSceneDragStart.bind(this),this.onSceneDragEnd=this.onSceneDragEnd.bind(this)}}]),r}(El),Pl=function(t){jt(r,t);var n=Ft(r);function r(e,t){var i;return Ct(this,r),(i=n.call(this,e,t)).bindPointRenderEvent(),i.bindSceneEvent(),i.bindMidPointRenderEvent(),i.bindLineRenderEvent(),i.bindPolygonRenderEvent(),i}return Rt(r,[{key:"getDefaultOptions",value:function(e){var t=At(At({},Nt(Tt(r.prototype),"getDefaultOptions",this).call(this,e)),{},{showMidPoint:!1,circleSteps:60});return t.distanceOptions&&(t.distanceOptions.showTotalDistance=!0,void 0===t.distanceOptions.showOnRadius&&(t.distanceOptions.showOnRadius=!0)),t.helper&&(t.helper=At(At({},t.helper),Dl)),t}},{key:"getDistanceTexts",value:function(){var e=this.options.distanceOptions;if(!e)return[];var t=[],n=e.showWhen,r=e.showDashDistance,i=e.format,o=e.showTotalDistance;return t.push.apply(t,Ut(this.getDashLineDistanceTexts(this.getDashLineData(),{showTotalDistance:!0,format:i,showDashDistance:r})).concat(Ut(this.getLineDistanceTexts(this.getLineData(),{showTotalDistance:o,format:i,showWhen:n})))),t}},{key:"setData",value:function(e){var t=this,n=e.map((function(e){var n,r,i;e.properties=At(At({},Uu()),e.properties);var o=null===(n=e.properties)||void 0===n?void 0:n.nodes;if(2!==(null===(r=o)||void 0===r?void 0:r.length)){var a=It(Er(e).geometry.coordinates,2),s=a[0],u=a[1],l=wn(e),c=l[2],h=(l[1]+l[3])/2;o=[Yu([s,u]),Yu([c,h])],e.properties.nodes=o}var d=o[0],f=o[1],p=!!(null===(i=e.properties)||void 0===i?void 0:i.isActive),v=e.properties.line;return v||(v=t.handleCreatePolygonLine(d,f,{isActive:p}),e.properties.line=v),t.handleCreatePolygon([d,f],v,At(At({},e.properties),{},{isActive:p}))}));this.source.setData({point:[],midPoint:[],dashLine:[],polygon:n,line:n.map((function(e){return e.properties.line}))}),this.setTextData(this.getAllTexts()),this.editPolygon&&this.setActivePolygon(this.editPolygon)}},{key:"handleCreatePolygonLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getBoundaryPositions(e,t).map((function(e){return Yu(e)}));return Xu(r,n)}},{key:"syncPolygonNodes",value:function(e,t){var n=e.properties.line,r=this.getBoundaryPositions(t[0],t[1]);return e.properties.nodes=t,e.geometry.coordinates=[r],this.setPolygonData((function(t){return t.map((function(t){return Bu(t,e)?e:t}))})),this.setPointData(e.properties.isDraw?[t[0]]:t),n.properties.nodes.forEach((function(e,t){e.geometry.coordinates=r[t]})),n.geometry.coordinates=r,e}},{key:"onLineDragging",value:function(t){var n=this.dragPolygon,i=It(this.previousPosition,2),o=i[0],a=i[1],s=Nt(Tt(r.prototype),"onLineDragging",this).call(this,t);if(n){var u=It(Ju(t),2),l=u[0],c=u[1];n.properties.nodes.forEach((function(e){var t=It(e.geometry.coordinates,2);e.geometry.coordinates=[t[0]+l-o,t[1]+c-a]})),this.syncPolygonNodes(n,n.properties.nodes),this.setActivePolygon(n,{isDrag:!0}),this.emit(e.DrawEvent.Dragging,n,this.getPolygonData())}return s}},{key:"getBoundaryPositions",value:function(e,t){for(var n=this.options.circleSteps,r=mr(e,t,{units:"meters"}),i=[],o=0;n>o;o++)i.push(Dr(e,r,-360*o/n,{units:"meters"}).geometry.coordinates);return i.push(i[0]),i}}]),r}(xl),kl=function(t){jt(r,t);var n=Ft(r);function r(t,i){var o;return Ct(this,r),(o=n.call(this,t,i)).drawLineFinish=function(){var t,n=o.drawLine,r=null!==(t=null==n?void 0:n.properties.nodes)&&void 0!==t?t:[];if(n&&(null==r?void 0:r.length)>1){o.setActiveLine(n);var i=o.options,a=i.autoActive,s=i.editable;a&&s||o.handleLineUnClick(n),o.setHelper(s&&a?"pointHover":o.addable?"draw":null),o.emit(e.DrawEvent.Add,n,o.getLineData())}},o.sceneRender.on(e.RenderEvent.DblClick,o.drawLineFinish),o.bindPointRenderEvent(),o.bindSceneEvent(),o.bindMidPointRenderEvent(),o.bindLineRenderEvent(),o}return Rt(r,[{key:"dragItem",get:function(){return this.dragLine}},{key:"editItem",get:function(){return this.editLine}},{key:"getMainLayer",value:function(){var e,t;return null!==(e=null===(t=this.render.line)||void 0===t?void 0:t.getLayers())&&void 0!==e?e:[]}},{key:"setData",value:function(e){var t=e.map((function(e){var t,n;return e.properties=At(At({},Iu()),null!==(t=e.properties)&&void 0!==t?t:{}),(null===(n=e.properties.nodes)||void 0===n?void 0:n.length)||(e.properties.nodes=fn(e).map((function(e){return Yu(e)}))),e}));this.source.setData({point:[],midPoint:[],dashLine:[],line:t}),this.setTextData(this.getAllTexts()),this.editLine&&this.setActiveLine(this.editLine)}},{key:"getData",value:function(){return this.getLineData()}},{key:"getRenderTypes",value:function(){return["line","dashLine","midPoint","point","text"]}},{key:"bindPointRenderEvent",value:function(){var t;Nt(Tt(r.prototype),"bindPointRenderEvent",this).call(this),null===(t=this.pointRender)||void 0===t||t.on(e.RenderEvent.Contextmenu,this.onPointContextMenu.bind(this))}},{key:"onPointClick",value:function(e){var t,n=this,r=this.drawLine,i=null!==(t=null==r?void 0:r.properties.nodes)&&void 0!==t?t:[],o=e.feature;if(Bu(o,hl(i)))requestAnimationFrame((function(){n.drawLineFinish()}));else{var a=It(o.geometry.coordinates,2);e.lngLat={lng:a[0],lat:a[1]},this.onPointCreate(e)}}},{key:"removeNode",value:function(t,n){var r,i=this.getTargetFeature(n),o=this.getTargetFeature(t,null!==(r=null==i?void 0:i.properties.nodes)&&void 0!==r?r:[]);if(i&&o){var a,s=null!==(a=null==i?void 0:i.properties.nodes)&&void 0!==a?a:[];if(3>s.length)return;this.syncLineNodes(i,s.filter((function(e){return!Bu(o,e)}))),this.emit(e.DrawEvent.RemoveNode,o,i,this.getLineData()),this.emit(e.DrawEvent.Edit,i,this.getLineData())}}},{key:"onPointContextMenu",value:function(e){var t,n=this.editLine,r=e.feature,i=null!==(t=null==n?void 0:n.properties.nodes)&&void 0!==t?t:[];if(n&&i.length>=3)return this.removeNode(r,n),this.scene.setMapStatus({dragEnable:!0}),r}},{key:"onPointCreate",value:function(t){if(this.addable){var n=Nt(Tt(r.prototype),"onPointCreate",this).call(this,t);return n&&(this.setHelper("drawFinish"),this.emit(e.DrawEvent.AddNode,n,this.drawLine,this.getLineData())),n}}},{key:"onPointDragEnd",value:function(t){var n=this.editLine,i=Nt(Tt(r.prototype),"onPointDragEnd",this).call(this,t);return n&&i&&this.emit(e.DrawEvent.Edit,n,this.getLineData()),i}},{key:"onLineDragStart",value:function(t){var n=Nt(Tt(r.prototype),"onLineDragStart",this).call(this,t);return n&&this.emit(e.DrawEvent.DragStart,n,this.getLineData()),n}},{key:"onLineDragging",value:function(t){var n=Nt(Tt(r.prototype),"onLineDragging",this).call(this,t);return n&&this.emit(e.DrawEvent.Dragging,n,this.getLineData()),n}},{key:"onLineDragEnd",value:function(t){var n=Nt(Tt(r.prototype),"onLineDragEnd",this).call(this,t);return n&&(this.emit(e.DrawEvent.DragEnd,n,this.getLineData()),this.emit(e.DrawEvent.Edit,n,this.getLineData())),n}},{key:"onMidPointClick",value:function(t){var n=this.editLine,i=Nt(Tt(r.prototype),"onMidPointClick",this).call(this,t);return n&&i&&(this.emit(e.DrawEvent.Edit,n,this.getLineData()),this.emit(e.DrawEvent.AddNode,i,n,this.getLineData())),i}},{key:"onSceneMouseMove",value:function(e){var t=this.drawLine;if(t){var n,r=hl(t.properties.nodes),i=Ju(e);if(this.options.adsorbOptions)i=null!==(n=this.getAdsorbPosition(i))&&void 0!==n?n:i;this.setDashLineData([zu([i,r.geometry.coordinates])]),this.setTextData(this.getAllTexts())}}},{key:"setActiveFeature",value:function(e){var t=this.getTargetFeature(e);t?this.setActiveLine(t):this.clearActiveLine()}},{key:"resetFeatures",value:function(){var e=this.getLineData();this.drawLine&&(e=e.filter((function(e){return!e.properties.isDraw})),this.source.setData({point:[],dashLine:[],midPoint:[]}),this.setTextData((function(e){return e.filter((function(e){return!e.properties.isActive}))}))),this.editLine&&this.handleLineUnClick(this.editLine),this.setLineData(e.map((function(e){return e.properties=At(At({},e.properties),{},{isDrag:!1,isActive:!1,isHover:!1}),e})))}},{key:"enablePointRenderAction",value:function(){var e;(Nt(Tt(r.prototype),"enablePointRenderAction",this).call(this),this.options.editable)&&(null===(e=this.pointRender)||void 0===e||e.enableContextMenu())}},{key:"disablePointRenderAction",value:function(){var e;Nt(Tt(r.prototype),"disablePointRenderAction",this).call(this),null===(e=this.pointRender)||void 0===e||e.disableContextMenu()}},{key:"bindEnableEvent",value:function(){Nt(Tt(r.prototype),"bindEnableEvent",this).call(this),this.enableSceneRenderAction(),this.enablePointRenderAction(),this.enableLineRenderAction(),this.enableMidPointRenderAction(),this.sceneRender.enableDblClick()}},{key:"unbindEnableEvent",value:function(){Nt(Tt(r.prototype),"unbindEnableEvent",this).call(this),this.disableSceneRenderAction(),this.disablePointRenderAction(),this.disableLineRenderAction(),this.disableMidPointRenderAction(),this.sceneRender.disableDblClick()}},{key:"bindThis",value:function(){Nt(Tt(r.prototype),"bindThis",this).call(this),this.bindPointRenderEvent=this.bindPointRenderEvent.bind(this),this.bindSceneEvent=this.bindSceneEvent.bind(this),this.bindLineRenderEvent=this.bindLineRenderEvent.bind(this),this.bindMidPointRenderEvent=this.bindMidPointRenderEvent.bind(this)}}]),r}(wl),Ml=function(t){jt(r,t);var n=Ft(r);function r(e,t){var i;return Ct(this,r),(i=n.call(this,e,t)).bindPointRenderEvent(),i}return Rt(r,[{key:"dragItem",get:function(){return this.dragPoint}},{key:"editItem",get:function(){return this.editPoint}},{key:"getDefaultOptions",value:function(e){var t=At(At({},this.getCommonOptions(e)),{},{helper:Bs(pl),initialData:e.initialData});return t.style.point=Ki,t}},{key:"bindEnableEvent",value:function(){Nt(Tt(r.prototype),"bindEnableEvent",this).call(this),this.enablePointRenderAction()}},{key:"unbindEnableEvent",value:function(){Nt(Tt(r.prototype),"unbindEnableEvent",this).call(this),this.disablePointRenderAction()}},{key:"getRenderTypes",value:function(){return["point"]}},{key:"getMainLayer",value:function(){var e,t;return null!==(e=null===(t=this.render.point)||void 0===t?void 0:t.getLayers())&&void 0!==e?e:[]}},{key:"setData",value:function(e){this.setPointData(e.map((function(e){var t;return e.properties=At(At({},Nu()),null!==(t=e.properties)&&void 0!==t?t:{}),e})))}},{key:"getData",value:function(){return this.getPointData()}},{key:"onPointCreate",value:function(t){if(this.addable){var n=Nt(Tt(r.prototype),"onPointCreate",this).call(this,t);if(n)return this.options.editable&&this.setHelper("pointHover"),this.emit(e.DrawEvent.Add,n,this.getData()),n}else this.setPointData((function(e){return e.map((function(e){return e.properties=At(At({},e.properties),{},{isHover:!1,isActive:!1}),e}))}))}},{key:"onPointMouseMove",value:function(e){var t=Nt(Tt(r.prototype),"onPointMouseMove",this).call(this,e);return this.options.editable&&!this.dragPoint&&this.setHelper("pointHover"),t}},{key:"onPointMouseOut",value:function(e){var t=Nt(Tt(r.prototype),"onPointMouseOut",this).call(this,e);return this.setHelper(this.addable?"draw":null),t}},{key:"onPointDragStart",value:function(t){var n=Nt(Tt(r.prototype),"onPointDragStart",this).call(this,t);return this.setHelper("pointDrag"),this.emit(e.DrawEvent.DragStart,n,this.getData()),n}},{key:"onPointDragging",value:function(t){var n=Nt(Tt(r.prototype),"onPointDragging",this).call(this,t);return n&&this.options.editable&&this.emit(e.DrawEvent.Dragging,n,this.getData()),n}},{key:"onPointDragEnd",value:function(t){var n=Nt(Tt(r.prototype),"onPointDragEnd",this).call(this,t);return n&&this.options.editable&&(this.setHelper("pointHover"),this.emit(e.DrawEvent.DragEnd,n,this.getData()),this.emit(e.DrawEvent.Edit,n,this.getData())),n}},{key:"bindThis",value:function(){Nt(Tt(r.prototype),"bindThis",this).call(this),this.bindPointRenderEvent=this.bindPointRenderEvent.bind(this)}},{key:"onSceneMouseMove",value:function(e){}},{key:"setActiveFeature",value:function(e){var t=this.getTargetFeature(e);this.setPointData((function(e){return e.map((function(e){return e.properties.isActive=Bu(t,e),e}))}))}},{key:"resetFeatures",value:function(){this.setPointData((function(e){return e.map((function(e){return e.properties=At(At({},e.properties),{},{isDrag:!1,isActive:!1,isHover:!1}),e}))}))}}]),r}(dl),Ll=function(t){jt(r,t);var n=Ft(r);function r(t,i){var o;return Ct(this,r),(o=n.call(this,t,i)).drawPolygonFinish=function(){var t,n=o.drawPolygon,r=null!==(t=null==n?void 0:n.properties.nodes)&&void 0!==t?t:[];if(n&&r.length>=3){n.properties.isDraw=!1,o.syncPolygonNodes(n,r),o.setActivePolygon(n);var i=o.options,a=i.autoActive,s=i.editable;a&&s||o.handlePolygonUnClick(n),o.setHelper(s?a?"pointHover":"polygonHover":o.addable?"draw":null),o.emit(e.DrawEvent.Add,n,o.getPolygonData())}},o.sceneRender.on(e.RenderEvent.DblClick,o.drawPolygonFinish),o.bindPointRenderEvent(),o.bindSceneEvent(),o.bindMidPointRenderEvent(),o.bindLineRenderEvent(),o.bindPolygonRenderEvent(),o}return Rt(r,[{key:"getDefaultOptions",value:function(e){return At(At({},Nt(Tt(r.prototype),"getDefaultOptions",this).call(this,e)),{},{liveUpdate:!1})}},{key:"setData",value:function(e){var t=e.map((function(e){var t,n;if(e.properties=At(At({},Uu()),null!==(t=e.properties)&&void 0!==t?t:{}),!(null===(n=e.properties.nodes)||void 0===n?void 0:n.length)){var r=fn(e);r=r.slice(0,r.length-1),e.properties.nodes=r.map((function(e){return Yu(e)}))}if(!e.properties.line){var i=e.properties.nodes;e.properties.line=Xu([].concat(Ut(i),[Yu(Tu(i).geometry.coordinates)]))}return e}));this.source.setData({point:[],midPoint:[],dashLine:[],polygon:t,line:t.map((function(e){return e.properties.line}))}),this.setTextData(this.getAllTexts()),this.editPolygon&&this.setActivePolygon(this.editPolygon)}},{key:"onPointCreate",value:function(t){if(this.addable&&!this.dragPoint){var n=Nt(Tt(r.prototype),"onPointCreate",this).call(this,t),i=this.drawPolygon,o=this.drawLine;if(n){if(i)this.syncPolygonNodes(i,[].concat(Ut(i.properties.nodes),[n])),this.setDashLineData([zu([Ju(t),i.properties.nodes[0].geometry.coordinates])]),i.properties.nodes.length>1&&this.setHelper("drawFinish");else o&&(this.handleCreatePolygon([n],o),this.setHelper("drawContinue"));this.emit(e.DrawEvent.AddNode,n,i,this.getPolygonData())}return n}}},{key:"onPointClick",value:function(e){var t=this,n=this.drawPolygon,r=e.feature;if(n){var i=n.properties.nodes;if(i.length<3||!Bu(Tu(i),r)&&!Bu(hl(i),r)){var o=It(r.geometry.coordinates,2);e.lngLat={lng:o[0],lat:o[1]},this.onPointCreate(e)}else requestAnimationFrame((function(){t.drawPolygonFinish()}))}}},{key:"onPointDragging",value:function(e){var t=this.dragPoint,n=this.editPolygon;if(t&&n){var i=n.properties.line;i.properties.nodes=i.properties.nodes.map((function(e){return Bu(e,t)?t:e}));var o=i.properties.nodes,a=o.slice(0,o.length-1),s=Tu(o),u=hl(o),l=Bu(s,t)||Bu(u,t);if(l&&(s.geometry.coordinates=u.geometry.coordinates=Ju(e)),this.options.adsorbOptions&&l){var c=this.resetAdsorbLngLat(e);c&&(s.geometry.coordinates=u.geometry.coordinates=c)}Nt(Tt(r.prototype),"onPointDragging",this).call(this,e),this.syncPolygonNodes(n,a),this.setActivePolygon(n)}return t}},{key:"onLineDragging",value:function(t){var n=this.dragPolygon,i=Nt(Tt(r.prototype),"onLineDragging",this).call(this,t);if(i&&n){var o=i.properties.nodes;this.syncPolygonNodes(n,o.slice(0,o.length-1)),this.emit(e.DrawEvent.Dragging,n,this.getPolygonData())}return i}},{key:"onMidPointClick",value:function(t){var n=Nt(Tt(r.prototype),"onMidPointClick",this).call(this,t),i=this.editPolygon;return n&&i&&(this.emit(e.DrawEvent.Edit,i,this.getPolygonData()),this.emit(e.DrawEvent.AddNode,n,i,this.getPolygonData())),n}},{key:"onSceneMouseMove",value:function(e){var t,n=this.drawPolygon,r=null!==(t=null==n?void 0:n.properties.nodes)&&void 0!==t?t:[];if(n&&r.length){this.options.adsorbOptions&&this.resetAdsorbLngLat(e);var i=Ju(e),o=[];if(o.push(zu([i,Tu(r).geometry.coordinates])),r.length>1&&o.push(zu([i,hl(r).geometry.coordinates])),this.options.liveUpdate&&r.length>=2){var a=fn(Zt(r));n.geometry.coordinates=[[].concat(Ut(a),[i,a[0]])],this.setPolygonData(this.getPolygonData())}this.setDashLineData(o),this.setTextData(this.getAllTexts())}}},{key:"removeNode",value:function(t,n){var r,i=this.getTargetFeature(n),o=this.getTargetFeature(t,null!==(r=null==i?void 0:i.properties.nodes)&&void 0!==r?r:[]);if(i&&o){var a,s=null!==(a=null==i?void 0:i.properties.nodes)&&void 0!==a?a:[];if(4>s.length)return;this.syncPolygonNodes(i,s.filter((function(e){return!Bu(o,e)}))),this.emit(e.DrawEvent.RemoveNode,o,i,this.getLineData()),this.emit(e.DrawEvent.Edit,i,this.getPolygonData())}}},{key:"onPointContextMenu",value:function(e){var t,n=this.editPolygon,r=e.feature,i=null!==(t=null==n?void 0:n.properties.nodes)&&void 0!==t?t:[];if(n&&i.length>=4)return i.find((function(e){return Bu(e,r)}))||(r=i[0]),this.removeNode(r,n),r}},{key:"bindPointRenderEvent",value:function(){var t;Nt(Tt(r.prototype),"bindPointRenderEvent",this).call(this),null===(t=this.pointRender)||void 0===t||t.on(e.RenderEvent.Contextmenu,this.onPointContextMenu.bind(this))}},{key:"enablePointRenderAction",value:function(){var e;(Nt(Tt(r.prototype),"enablePointRenderAction",this).call(this),this.options.editable)&&(null===(e=this.pointRender)||void 0===e||e.enableContextMenu())}},{key:"disablePointRenderAction",value:function(){var e;Nt(Tt(r.prototype),"disablePointRenderAction",this).call(this),null===(e=this.pointRender)||void 0===e||e.disableContextMenu()}}]),r}(El),Al=function(t){jt(r,t);var n=Ft(r);function r(e,t){var i;return Ct(this,r),(i=n.call(this,e,t)).bindPointRenderEvent(),i.bindSceneEvent(),i.bindMidPointRenderEvent(),i.bindLineRenderEvent(),i.bindPolygonRenderEvent(),i}return Rt(r,[{key:"getDefaultOptions",value:function(e){var t=Nt(Tt(r.prototype),"getDefaultOptions",this).call(this,e);return t.helper&&(t.helper=At(At({},t.helper),bl)),t}},{key:"setData",value:function(e){var t=this,n=e.map((function(e){var n,r,i;e.properties=At(At({},Uu()),null!==(n=e.properties)&&void 0!==n?n:{});var o=e.properties.nodes;if(2!==(null===(r=o)||void 0===r?void 0:r.length)){var a=It(wn(e),4),s=a[2],u=a[3];o=[Yu([a[0],a[1]]),Yu([s,u])],e.properties.nodes=o}var l=It(o,2),c=l[0],h=l[1],d=!!(null===(i=e.properties)||void 0===i?void 0:i.isActive),f=e.properties.line;return f||(f=t.handleCreatePolygonLine(c,h,{isActive:d}),e.properties.line=f),t.handleCreatePolygon([c,h],f,At(At({},e.properties),{},{isActive:d}))}));this.source.setData({point:[],midPoint:[],dashLine:[],polygon:n,line:n.map((function(e){return e.properties.line}))}),this.setTextData(this.getAllTexts()),this.editPolygon&&this.setActivePolygon(this.editPolygon)}},{key:"handleCreatePolygonLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=fn(br(Zt([e,t]))).map((function(n,r){return 0===r?e:2===r?t:Yu(n)}));return Xu(r,n)}},{key:"syncPolygonNodes",value:function(e,t){var n=e.properties.line,r=fn(br(Zt(t)));e.properties.nodes=t,e.geometry.coordinates=[r],this.setPolygonData((function(t){return t.map((function(t){return Bu(t,e)?e:t}))})),this.setPointData(e.properties.isDraw?[t[0]]:t);var i=n.properties.nodes,o=r.filter((function(e){return!iu(e,t[0].geometry.coordinates)&&!iu(e,t[1].geometry.coordinates)}));return i.forEach((function(e,n){var r=[0,0];switch(n){case 0:r=t[0].geometry.coordinates;break;case 1:r=o[0];break;case 2:r=t[1].geometry.coordinates;break;case 3:r=o[1];break;case 4:r=Bs(t[0].geometry.coordinates)}e.geometry.coordinates=r})),n.geometry.coordinates=r,e}},{key:"onLineDragging",value:function(t){var n=Nt(Tt(r.prototype),"onLineDragging",this).call(this,t),i=this.dragPolygon;if(n&&i){var o=i.properties.line.properties.nodes;this.syncPolygonNodes(i,[o[0],o[2]]),this.setActivePolygon(i,{isDrag:!0}),this.emit(e.DrawEvent.Dragging,i,this.getPolygonData())}return n}}]),r}(xl),Ol=function(e,t){for(var n=e;n&&!Array.from(n.classList).includes(t);)n=n.parentElement;return n},Cl=["point","line","polygon","rect","circle","clear"],_l={point:"#l7draw-point",line:"#l7draw-line",polygon:"#l7draw-polygon",rect:"#l7draw-rect",circle:"#l7draw-circle",clear:"#l7draw-qingkong"},Rl={point:Ml,line:kl,polygon:Ll,rect:Al,circle:Pl},Sl="data-draw-type",jl="l7-draw-control",Tl="".concat(jl,"__btn"),Hl="".concat(Tl,"--active");!function(e){var t,n,r,i,o,a='<svg><symbol id="l7draw-qingkong" viewBox="0 0 1024 1024"><path d="M778.96777344 334.02148437h-148.31542969V284.58300781A71.78466797 71.78466797 0 0 0 556.49462891 215.36914062H467.50537109a71.78466797 71.78466797 0 0 0-74.15771484 69.11499024V334.02148437h-148.31542969a29.66308594 29.66308594 0 1 0 0 59.32617188h29.66308594v326.29394531A88.98925781 88.98925781 0 0 0 363.68457031 808.63085938h296.63085938a88.98925781 88.98925781 0 0 0 88.98925781-88.98925782V393.34765625h29.66308594a29.66308594 29.66308594 0 0 0 0-59.32617188zM452.67382812 284.58300781c0-4.74609375 6.22924805-9.78881836 14.83154297-9.78881836h88.98925782c8.60229492 0 14.83154297 5.04272461 14.83154296 9.78881836V334.02148437H452.67382812V284.53356934z m237.30468751 435.10803223a29.66308594 29.66308594 0 0 1-29.66308594 29.66308593H363.68457031a29.66308594 29.66308594 0 0 1-29.66308593-29.66308594V393.34765625h355.95703124v326.29394531z"  ></path><path d="M437.84228516 660.31542969c6.57531739 0 12.85400391-3.46069336 17.5012207-9.64050294A39.20471192 39.20471192 0 0 0 462.56152344 627.33996582V495.5369873a39.20471192 39.20471192 0 0 0-7.21801758-23.33496093A22.09899903 22.09899903 0 0 0 437.84228516 462.56152344c-6.57531739 0-12.85400391 3.46069336-17.50122071 9.64050293A39.20471192 39.20471192 0 0 0 413.12304687 495.5369873v131.80297853c0 8.75061036 2.62023926 17.15515137 7.21801758 23.33496092 4.6472168 6.17980958 10.92590333 9.64050293 17.50122071 9.64050294zM586.15771484 660.31542969c6.57531739 0 12.85400391-3.46069336 17.50122071-9.64050294a39.20471192 39.20471192 0 0 0 7.21801758-23.33496093V495.5369873a39.20471192 39.20471192 0 0 0-7.21801758-23.33496093A22.09899903 22.09899903 0 0 0 586.15771484 462.56152344c-6.57531739 0-12.85400391 3.46069336-17.5012207 9.64050293A39.20471192 39.20471192 0 0 0 561.43847656 495.5369873v131.80297853c0 8.75061036 2.62023926 17.15515137 7.21801758 23.33496092 4.6472168 6.17980958 10.92590333 9.64050293 17.5012207 9.64050294z"  ></path></symbol><symbol id="l7draw-rect" viewBox="0 0 1024 1024"><path d="M736.14 648.79V330c0-23.16-18.84-42-42-42H375.49c-11.07-19.13-31.74-32.01-55.43-32.01-35.35 0-64.01 28.66-64.01 64.01 0 23.69 12.88 44.36 32.01 55.43v318.8c0 23.16 18.84 42 42 42H648.7c11.07 19.13 31.74 32.01 55.43 32.01 35.35 0 64.01-28.66 64.01-64.01 0.01-23.7-12.87-44.37-32-55.44zM352.06 375.43A64.281 64.281 0 0 0 375.49 352h296.64v296.8a64.357 64.357 0 0 0-23.43 23.43H352.06v-296.8z"  ></path></symbol><symbol id="l7draw-circle" viewBox="0 0 1024 1024"><path d="M467.013228 557.765038a64.01 64.01 0 1 0 90.52223-90.52539 64.01 64.01 0 1 0-90.52223 90.52539Z"  ></path><path d="M832.16 512.22c0-26.06-15.58-48.46-37.93-58.45-11.21-54.67-38.11-104.92-78.48-145.3-54.42-54.42-126.78-84.4-203.75-84.4s-149.33 29.97-203.75 84.4c-54.42 54.42-84.4 126.79-84.4 203.75s29.97 149.33 84.4 203.75c54.42 54.42 126.78 84.4 203.75 84.4s149.33-29.97 203.75-84.4c40.37-40.37 67.28-90.62 78.48-145.3 22.35-9.98 37.93-32.39 37.93-58.45zM670.5 670.72c-42.34 42.34-98.62 65.65-158.5 65.65-59.87 0-116.16-23.32-158.5-65.65-42.34-42.34-65.65-98.62-65.65-158.5s23.32-116.16 65.65-158.5c42.34-42.34 98.62-65.65 158.5-65.65 59.87 0 116.16 23.32 158.5 65.65 29.9 29.9 50.3 66.77 59.71 106.95-15.81 11.66-26.07 30.4-26.07 51.55s10.26 39.9 26.07 51.55c-9.41 40.18-29.81 77.05-59.71 106.95z"  ></path></symbol><symbol id="l7draw-polygon" viewBox="0 0 1024 1024"><path d="M705.97 640.31c-5.79 0-11.39 0.78-16.72 2.22L381.94 336.66a64.079 64.079 0 0 0 2.14-16.43c0-35.35-28.66-64.01-64.01-64.01s-64.01 28.66-64.01 64.01c0 23.69 12.88 44.36 32.01 55.43V648.8c-19.13 11.07-32.01 31.74-32.01 55.43 0 35.35 28.66 64.01 64.01 64.01 23.69 0 44.35-12.87 55.42-32l275.05 0.07c11.07 19.14 31.74 32.03 55.44 32.03 35.35 0 64.01-28.66 64.01-64.01s-28.66-64.02-64.02-64.02z m-353.91 8.48V397.22L628.44 672.3l-252.94-0.07a64.411 64.411 0 0 0-23.44-23.44z"  ></path></symbol><symbol id="l7draw-line" viewBox="0 0 1024 1024"><path d="M832.16 449.21c0-35.35-28.66-64.01-64.01-64.01-29.2 0-53.81 19.56-61.5 46.28l-390.9 96.82 72.18-144.18c33.56-1.99 60.17-29.83 60.17-63.89 0-35.35-28.66-64.01-64.01-64.01s-64.01 28.66-64.01 64.01c0 13.04 3.91 25.17 10.61 35.28l-78.42 156.65c-33.58 1.97-60.21 29.81-60.21 63.89 0 35.35 28.66 64.01 64.01 64.01 29.2 0 53.81-19.56 61.5-46.28l390.8-96.79-71.97 143.34c-33.62 1.93-60.28 29.8-60.28 63.9 0 35.35 28.66 64.01 64.01 64.01s64.01-28.66 64.01-64.01c0-13-3.89-25.09-10.54-35.18l78.28-155.93c33.61-1.95 60.28-29.81 60.28-63.91z"  ></path></symbol><symbol id="l7draw-point" viewBox="0 0 1024 1024"><path d="M331.46 330.08m-64.01 0a64.01 64.01 0 1 0 128.02 0 64.01 64.01 0 1 0-128.02 0Z"  ></path><path d="M384.12 735.84m-64.01 0a64.01 64.01 0 1 0 128.02 0 64.01 64.01 0 1 0-128.02 0Z"  ></path><path d="M769.11 512.7m-64.01 0a64.01 64.01 0 1 0 128.02 0 64.01 64.01 0 1 0-128.02 0Z"  ></path></symbol></svg>',s=(s=document.getElementsByTagName("script"))[s.length-1].getAttribute("data-injectcss");if(s&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}function u(){o||(o=!0,r())}t=function(){var e,t=document.createElement("div");t.innerHTML=a,a=null,(t=t.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",(e=document.body).firstChild?function(e,t){t.parentNode.insertBefore(e,t)}(t,e.firstChild):e.appendChild(t))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(t,0):(n=function(){document.removeEventListener("DOMContentLoaded",n,!1),t()},document.addEventListener("DOMContentLoaded",n,!1)):document.attachEvent&&(r=t,i=e.document,o=!1,function e(){try{i.documentElement.doScroll("left")}catch(t){return void setTimeout(e,50)}u()}(),i.onreadystatechange=function(){"complete"==i.readyState&&(i.onreadystatechange=null,u())})}(window);al(".l7-draw-control{display:flex;overflow:hidden;background:#fff;border-radius:2px;box-shadow:0 0 20px rgba(0,0,0,.14901960784313725)}.l7-draw-control__btn{display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;padding:0;text-align:center;background:transparent;border-width:0;border-right:1px solid #e0e0e0;outline:0;cursor:pointer}.l7-draw-control__btn:hover{background-color:#e5e5e5}.l7-draw-control__btn:last-child{border-right:0;border-bottom:0}.l7-draw-control__btn .l7-draw-icon{width:26px;height:26px;overflow:hidden;fill:currentColor}.l7-draw-control__btn--active svg{color:#0370fe}");var Bl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fl=/^\w*$/;var Nl=function(e,t){if(aa(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Ai(e))||(Fl.test(e)||!Bl.test(e)||null!=t&&e in Object(t))};function Il(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Il.Cache||Xo),n}Il.Cache=Xo;var Ul=Il;var Yl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xl=/\\(\\)?/g,zl=function(e){var t=Ul(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Yl,(function(e,n,r,i){t.push(r?i.replace(Xl,"$1"):n||e)})),t})),Vl=yi?yi.prototype:void 0,ql=Vl?Vl.toString:void 0;var Wl=function e(t){if("string"==typeof t)return t;if(aa(t))return Ou(t,e)+"";if(Ai(t))return ql?ql.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n};var $l=function(e){return null==e?"":Wl(e)};var Gl=function(e,t){return aa(e)?e:Nl(e,t)?[e]:zl($l(e))};var Kl=function(e){if("string"==typeof e||Ai(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t};var Jl=function(e,t){for(var n=0,r=(t=Gl(t,e)).length;null!=e&&r>n;)e=e[Kl(t[n++])];return n&&n==r?e:void 0};var Zl=function(e,t,n){var r=-1,i=e.length;0>t&&(t=-t>i?0:i+t),0>(n=n>i?i:n)&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o};var Ql=function(e,t){return 2>t.length?e:Jl(e,Zl(t,0,-1))};var ec=function(e,t){return t=Gl(t,e),null==(e=Ql(e,t))||delete e[Kl(hl(t))]};var tc=function(e){return du(e)?void 0:e},nc=yi?yi.isConcatSpreadable:void 0;var rc=function(e){return aa(e)||oa(e)||!!(nc&&e&&e[nc])};var ic=function e(t,n,r,i,o){var a=-1,s=t.length;for(r||(r=rc),o||(o=[]);++a<s;){var u=t[a];n>0&&r(u)?n>1?e(u,n-1,r,i,o):Ya(o,u):i||(o[o.length]=u)}return o};var oc=function(e){return(null==e?0:e.length)?ic(e,1):[]};var ac=function(e){return Pu(Du(e,void 0,oc),e+"")}((function(e,t){var n={};if(null==e)return n;var r=!1;t=Ou(t,(function(t){return t=Gl(t,e),r||(r=t.length>1),t})),Zo(e,$a(e),n),r&&(n=Hs(n,7,tc));for(var i=t.length;i--;)ec(n,t[i]);return n})),sc=ac,uc=function(n){jt(i,n);var r=Ft(i);function i(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ct(this,i),(n=r.call(this,o)).controlOption=void 0,n.sceneInstance=void 0,n.drawMap={},n.btnMap={},n.activeType=null,n.emitDataChange=Hi((function(){n.emit(e.ControlEvent.DataChange,n.getDrawData())}),16),n.emitDrawSelect=function(t,r){n.emit(e.ControlEvent.DrawSelect,t,r)},n.sceneInstance=t,n.controlOption=At(At({},n.getDefault()),o||{}),n.onBtnClick=n.onBtnClick.bind(Bt(n)),n}return Rt(i,[{key:"getActiveType",value:function(){return this.activeType}},{key:"getDefault",value:function(){return At(At({},Nt(Tt(i.prototype),"getDefault",this).call(this)),{},{className:"",buttonClassName:"",activeButtonClassName:"",style:"",position:"topleft",commonDrawOptions:{},drawConfig:{point:!0,line:!0,polygon:!0,rect:!0,circle:!0,clear:!0}})}},{key:"addTo",value:function(e){return Nt(Tt(i.prototype),"addTo",this).call(this,e),this.init(),this}},{key:"onAdd",value:function(){var e=this.controlOption,n=e.className,r=e.style,i=t.DOM.create("div","".concat(jl," ").concat(n));return r&&i.setAttribute("style",r),i}},{key:"onRemove",value:function(){Object.values(this.drawMap).forEach((function(e){e.clear(!0)}))}},{key:"init",value:function(){var t,n=this,r=[];Object.entries(this.controlOption.drawConfig).filter((function(e){var t=It(e,2);return t[1]})).sort((function(e,t){var n=It(e,2)[1],r=It(t,2)[1],i=Number.MAX_SAFE_INTEGER;return("boolean"==typeof n?i:n.order)-("boolean"==typeof r?i:r.order)})).map((function(e){var t=It(e,2),n=t[1];return[t[0],"object"===Ot(n)?sc(n,"order"):n]})).forEach((function(t){var i=It(t,2),o=i[0],a=i[1];if("object"===Ot(a)&&a.button){var s=a.button;s.classList.contains("l7-draw-control__btn")||s.classList.add("l7-draw-control__btn"),n.btnMap[o]=s,r.push(s)}else if(a&&Cl.includes(o)){var u=n.initBtn(o);u.addEventListener("click",n.onBtnClick),r.push(u),n.btnMap[o]=u;var l=Rl[o];if(l&&n.sceneInstance){var c=new l(n.sceneInstance,At(At({},n.controlOption.commonDrawOptions),"boolean"==typeof a?{}:a));c.on(e.DrawEvent.Change,n.emitDataChange),c.on(e.DrawEvent.Select,(function(e){n.emitDrawSelect(o,e)})),n.drawMap[o]=c}}})),(t=this.container).append.apply(t,r),this.controlOption.defaultActiveType&&this.onDrawClick(this.controlOption.defaultActiveType)}},{key:"getDrawData",value:function(){return Fs(Ru(this.drawMap).map((function(e){var t=It(e,2);return[t[0],t[1].getData()]})))}},{key:"getTypeDraw",value:function(e){var t;return null!==(t=this.drawMap[e])&&void 0!==t?t:null}},{key:"onBtnClick",value:function(e){var t=Ol(e.target,Tl);if(t){var n=t.getAttribute(Sl);"clear"===n?this.clearDrawData():this.onDrawClick(n)}}},{key:"setActiveType",value:function(n){var r=null,i=this.activeType;if(i){var o,a=this.btnMap[i];if(a){t.DOM.removeClass(a,Hl);var s=this.controlOption.activeButtonClassName;s&&t.DOM.removeClass(a,s)}null===(o=this.drawMap[i])||void 0===o||o.disable(),r=null}if(i!==n&&n){var u;null===(u=this.drawMap[n])||void 0===u||u.enable();var l=this.btnMap[n];l&&t.DOM.addClass(l,"".concat(Hl," ").concat(this.controlOption.activeButtonClassName)),r=n}this.activeType=r,this.emit(e.ControlEvent.DrawChange,r)}},{key:"onDrawClick",value:function(e){this.setActiveType(e)}},{key:"clearDrawData",value:function(){Object.values(this.drawMap).forEach((function(e){null==e||e.clear()})),this.emit(e.ControlEvent.DrawClear)}},{key:"initBtn",value:function(e){var n=t.DOM.create("button","".concat(Tl," ").concat(this.controlOption.buttonClassName));return n.innerHTML='<svg class="l7-draw-icon" aria-hidden="true">\n      <use xlink:href="'.concat(_l[e],'"></use>\n    </svg>'),n.setAttribute(Sl,e),n}}]),i}(t.Control);e.ACTIVE_COLOR=Vi,e.BaseMode=cl,e.CircleDrawer=Pl,e.DEFAULT_ADSORB_CONFIG=Mt,e.DEFAULT_AREA_OPTIONS=Et,e.DEFAULT_COMMON_OPTIONS=qi,e.DEFAULT_CURSOR_MAP=n,e.DEFAULT_DISTANCE_OPTIONS=wt,e.DEFAULT_HISTORY_CONFIG=xt,e.DEFAULT_KEYBOARD_CONFIG=Pt,e.DEFAULT_MID_POINT_STYLE=Gi,e.DEFAULT_NODE_NORMAL_STYLE=$i,e.DEFAULT_NODE_STYLE=Ji,e.DEFAULT_POINT_NORMAL_STYLE=Wi,e.DEFAULT_POINT_STYLE=Ki,e.DEFAULT_POPUP_CONFIG=kt,e.DEFAULT_SOURCE_DATA=r,e.DEFAULT_STYLE=Qi,e.DEFAULT_TEXT_NORMAL_STYLE=Zi,e.DashLineRender=si,e.DragPolygonMode=xl,e.DrawCircle=Pl,e.DrawControl=uc,e.DrawLine=kl,e.DrawPoint=Ml,e.DrawPolygon=Ll,e.DrawRect=Al,e.LayerRender=ai,e.LineDrawer=kl,e.LineMode=wl,e.LineRender=Bi,e.MidPointMode=fl,e.MidPointRender=Fi,e.NORMAL_COLOR=zi,e.PointDrawer=Ml,e.PointMode=dl,e.PointRender=Ni,e.PolygonDrawer=Ll,e.PolygonMode=El,e.PolygonRender=Ii,e.RENDER_MAP=Xi,e.RectDrawer=Al,e.SceneRender=Ui,e.Source=ll,e.TextRender=Yi,e.calcAreaText=$u,e.calcDistanceTextsByLine=Wu,e.createDashLine=zu,e.createLineFeature=Xu,e.createPointFeature=Yu,e.createPolygonFeature=Vu,e.findMinIndex=Qu,e.getAdsorbFeature=tl,e.getAdsorbLine=rl,e.getAdsorbPoint=nl,e.getDefaultLineProperties=Iu,e.getDefaultPointProperties=Nu,e.getDefaultPolygonProperties=Uu,e.getLineCenterPoint=qu,e.getLngLat=Ku,e.getMapDom=Gu,e.getParentByClassName=Ol,e.getPosition=Ju,e.getSingleColorStyle=function(e){return{point:{normal:{color:e},hover:{color:e},active:{color:e}},line:{normal:{color:e},hover:{color:e},active:{color:e}},polygon:{normal:{color:e},hover:{color:e},active:{color:e},style:{opacity:.2}},text:{normal:{color:e},active:{color:e}},midPoint:{normal:{color:e}},dashLine:{normal:{color:e}}}},e.getUuid=Hu,e.isDev=!1,e.isSameFeature=Bu,e.resetEventLngLat=il,e.splitByPosition=el,e.transLngLat2Position=Zu,e.updateTargetFeature=Fu,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=l7-draw.min.js.map
